<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[Hadoop Âü∫Á°Ä‰πã HDFS ÂÖ•Èó®]]></title>
    <url>%2F2019%2F05%2F11%2FHadoop%E5%9F%BA%E7%A1%80%E4%B9%8BHDFS%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä Êú¨Êñá‰∏ªË¶Å‰ªãÁªç‰∫Ü HDFS ÁöÑ‰ΩìÁ≥ªÊû∂ÊûÑ‰ª•ÂèäÂÖ∂ÊâßË°åÊµÅÁ®ãÔºåÂπ∂ÁªôÂá∫‰∫ÜËØªÂÜôÊìç‰ΩúÁöÑÁºñÁ®ãÂÆû‰æãÔºåÂ∏åÊúõÂØπ HDFS Êúâ‰∏™ÂàùÊ≠•ÁöÑËÆ§ËØÜ„ÄÇ ÁÆÄ‰ªã HDFS (Hadoop Distributed File System) ÊòØ‰∏Ä‰∏™ËøêË°åÂú®ÂïÜ‰∏ö PC ‰∏äÁöÑÂàÜÂ∏ÉÂºèÊñá‰ª∂Á≥ªÁªüÔºåÂÖ∂ËÆæËÆ°ÊÄùÊÉ≥Ê∫êËá™‰∫é Google 2003 Âπ¥ÂèëÂ∏ÉÁöÑËÆ∫Êñá The Google File System „ÄÇHDFSÁöÑ‰∏ªË¶ÅÁõÆÁöÑÊòØ‰∏∫‰∫ÜËß£ÂÜ≥Â§ßËßÑÊ®°Êï∞ÊçÆÂ≠òÂÇ®ÂíåÁÆ°ÁêÜÁöÑÈóÆÈ¢ò„ÄÇ ‰ΩìÁ≥ªÊû∂ÊûÑ ‰∏äÂõæË°®Êòé HDFS ÊòØ‰∏Ä‰∏™Ê†áÂáÜÁöÑ master/slave Êû∂ÊûÑÔºå‰∏ªË¶ÅÁî±‰∏â‰∏™ÈÉ®ÂàÜÊûÑÊàêÔºö NameNodeÔºàmaster ËäÇÁÇπÔºâ ÂÖÉÊï∞ÊçÆÔºàMetaDataÔºâÁöÑÁÆ°ÁêÜÔºåÂÖ∂‰∏≠ÂÖÉÊï∞ÊçÆÁî±Êñá‰ª∂Ë∑ØÂæÑÂêç„ÄÅÊï∞ÊçÆÂùóID‰ª•ÂèäÂ≠òÂÇ®‰ΩçÁΩÆÁ≠â‰ø°ÊÅØÊûÑÊàê ÁÆ°ÁêÜ HDFS ÁöÑÂêçÂ≠óÁ©∫Èó¥„ÄÇ SecondaryNameNode ÂÆöÊúüÂêàÂπ∂ NameNode ÁöÑ edit logsÔºàÂØπÊñá‰ª∂Á≥ªÁªüÁöÑÊîπÂä®Â∫èÂàóÔºâ Âà∞ fsimageÔºàÂØπÊï¥‰∏™Êñá‰ª∂Á≥ªÁªüÁöÑÂø´ÁÖßÔºâÔºåÂπ∂Êã∑Ë¥ù‰øÆÊîπÂêéÁöÑ fsimage Âà∞ NameNode„ÄÇ Êèê‰æõ‰∏Ä‰∏™ NameNode ÁöÑÊ£ÄÊü•ÁÇπÔºàÂàáÂøåËÆ§‰∏∫ÊòØ NameNode ÁöÑÂ§á‰ªΩÔºâÔºåÂèØÁî®‰∫é NameNode ÁöÑÊïÖÈöúÊÅ¢Â§ç„ÄÇ DataNodeÔºàslave ËäÇÁÇπÔºâ Êèê‰æõÊñá‰ª∂Â≠òÂÇ®ÂíåËøõË°åÊï∞ÊçÆÂùóÊìç‰Ωú„ÄÇ Âë®ÊúüÊÄßÁöÑÂêë NameNode Ê±áÊä•Âùó‰ø°ÊÅØ„ÄÇ ËøôÈáåÂØπÂõæ‰∏≠Âá∫Áé∞ÁöÑ‰∏Ä‰∫õÊ¶ÇÂøµËøõË°åËØ¥ÊòéÔºö ReplicationÔºàÂâØÊú¨Ôºâ ‰∏∫‰∫Ü‰øùËØÅÊï∞ÊçÆÁöÑÈ´òÂèØÁî®ÔºåHDFS ‰ºöÂØπÂÜôÂÖ•ÁöÑÊï∞ÊçÆËøõË°åÂÜó‰ΩôÂ≠òÂÇ®ÔºåÈªòËÆ§ÊÉÖÂÜµ‰∏ã‰ºö‰øùÂ≠ò 3 ‰ªΩ„ÄÇ Blocks Block ÊòØÊúÄÂü∫Êú¨ÁöÑÂ≠òÂÇ®ÂíåÊìç‰ΩúÂçï‰ΩçÔºàÈªòËÆ§ÊÉÖÂÜµ‰∏ã‰∏∫ 128MÔºâÔºåËøôÈáåÁöÑ Block ‰∏çÊòØÊåáÁâ©ÁêÜ Block ÔºåËÄåÊòØÊåáÊñá‰ª∂Á≥ªÁªüÁöÑ BlockÔºåÂÖ∂Â§ßÂ∞è‰∏ÄËà¨ÊòØÁâ©ÁêÜ Block ÁöÑÊï¥Êï∞ÂÄç„ÄÇ ÊâßË°åÊµÅÁ®ã ËØªÊñá‰ª∂ ËØªÊñá‰ª∂ÁöÑËøáÁ®ãÂèØ‰ª•Ê¶ÇÊã¨‰∏∫Ôºö Client Âêë NameNode ÂèëËµ∑ËØ∑Ê±ÇËé∑ÂèñÊñá‰ª∂Êï∞ÊçÆÂùó‰ΩçÁΩÆ‰ø°ÊÅØ Client ÊåâÁÖßÊï∞ÊçÆÂùóË∑ù Client ÁöÑËøúËøë‰æùÊ¨°ËøõË°åËøûÊé•ÁÑ∂ÂêéËØªÂèñÊï∞ÊçÆ ÂÜôÊñá‰ª∂ ÂÜôÊñá‰ª∂ÁöÑËøáÁ®ãÂèØ‰ª•Ê¶ÇÊã¨‰∏∫Ôºö Client Âêë NameNode ÂèëËµ∑ÂÜôÊñá‰ª∂ÁöÑËØ∑Ê±ÇËé∑ÂæóÂèØÂÜôÁöÑ DataNode ÂàóË°®Á≠â‰ø°ÊÅØ Client Ê†πÊçÆ HDFS ËÆæÂÆöÁöÑÂàÜÂùóÂ§ßÂ∞èÂØπÊñá‰ª∂ËøõË°åÂàÜÂùó Client Âíå NameNode ÂàÜÈÖçÁöÑ DataNode ÊûÑÊàê pipeline Âπ∂ËøõË°åÊï∞ÊçÆÂÜôÂÖ• ÂÜôÂÖ•ÂÆåÊàê‰πãÂêéÔºåNameNode Êé•Êî∂Êù•Ëá™ DataNode ÁöÑÊ∂àÊÅØËøõË°åÂÖÉÊï∞ÊçÆÁöÑÊõ¥Êñ∞ Â∏∏Áî®ÂëΩ‰ª§ Êñá‰ª∂Êìç‰Ωú ÂàóÂá∫Êñá‰ª∂ 1hdfs dfs -ls &lt;path&gt; ÂàõÂª∫ÁõÆÂΩï 1hdfs dfs -mkdir &lt;path&gt; ‰∏ä‰º†Êñá‰ª∂ 1hdfs dfs -put &lt;localsrc&gt; &lt;dst&gt; ËæìÂá∫Êñá‰ª∂ÂÜÖÂÆπ 1hdfs dfs -cat &lt;src&gt; Êñá‰ª∂Â§çÂà∂Âà∞Êú¨Âú∞ 1hdfs dfs -get &lt;src&gt; &lt;localdst&gt; Âà†Èô§Êñá‰ª∂ÂíåÁõÆÂΩï 12hdfs dfs -rm &lt;src&gt;hdfs dfs -rmdir &lt;dir&gt; ÁÆ°ÁêÜ Êü•ÁúãÁªüËÆ°‰ø°ÊÅØ 1hdfs dfsadmin -report ËøõÂÖ•ÂíåÈÄÄÂá∫ÂÆâÂÖ®Ê®°ÂºèÔºàËØ•Ê®°Âºè‰∏çÂÖÅËÆ∏Êñá‰ª∂Á≥ªÁªüÊúâ‰ªª‰Ωï‰øÆÊîπÔºâ 12hdfs dfsadmin -safemode enterhdfs dfsadmin -safemode leave ÁºñÁ®ãÂÆû‰æã IDEA Êñ∞Âª∫ Maven È°πÁõÆ ÂãæÈÄâÁõ∏ÂÖ≥ÈÄâÈ°πÂêéÔºåÁÇπÂáª next Â°´ÂÖ•È°πÁõÆÁõ∏ÂÖ≥‰ø°ÊÅØÂç≥ÂèØ pom.xml ‰∏≠Ê∑ªÂä†‰æùËµñ 12345678910111213141516171819&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt; &lt;artifactId&gt;hadoop-common&lt;/artifactId&gt; &lt;version&gt;2.9.2&lt;/version&gt; //Ê†πÊçÆ Hadoop ÁâàÊú¨ËøõË°åÈÄâÊã© &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt; &lt;artifactId&gt;hadoop-hdfs&lt;/artifactId&gt; &lt;version&gt;2.9.2&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt; &lt;artifactId&gt;hadoop-client&lt;/artifactId&gt; &lt;version&gt;2.9.2&lt;/version&gt; &lt;/dependency&gt;&lt;/dependencies&gt; ËØªÂÜôÊñá‰ª∂ ÂàõÂª∫ Sample Á±ªÁºñÂÜôÁõ∏Â∫îÁöÑËØªÂÜôÂáΩÊï∞ Sample Á±ª 123456789101112131415161718192021222324252627282930313233343536373839import org.apache.hadoop.conf.Configuration;import org.apache.hadoop.fs.FSDataInputStream;import org.apache.hadoop.fs.FSDataOutputStream;import org.apache.hadoop.fs.FileSystem;import org.apache.hadoop.fs.Path;import java.io.*;/** * @author ikroal */public class Sample &#123; //ÈªòËÆ§ÁöÑ HDFS Âú∞ÂùÄ private static final String DEFAULT_FS = "hdfs://localhost:9000"; private static final String PATH = DEFAULT_FS + "/tmp/demo.txt"; private static final String DEFAULT_FILE = "demo.txt"; public static void main(String[] args) &#123; Configuration conf = new Configuration(); FileSystem fs = null; conf.set("fs.defaultFS", DEFAULT_FS); //ÈÖçÁΩÆ HDFS Âú∞ÂùÄ try &#123; fs = FileSystem.get(conf); write(fs, DEFAULT_FILE, PATH); read(fs, PATH); &#125; catch (IOException e) &#123; e.printStackTrace(); &#125; finally &#123; try &#123; if (fs != null) &#123; fs.close(); &#125; &#125; catch (IOException e) &#123; e.printStackTrace(); &#125; &#125; &#125;&#125; write ÂáΩÊï∞ 123456789101112131415161718192021222324252627282930/*** ËøõË°åÊñá‰ª∂ÂÜôÂÖ•* @param inputPath ÂæÖÂÜôÂÖ•Êñá‰ª∂Ë∑ØÂæÑ* @param outPath HDFS ÁöÑÂÜôÂÖ•Ë∑ØÂæÑ*/public static void write(FileSystem fileSystem, String inputPath, String outPath) &#123; FSDataOutputStream outputStream = null; FileInputStream inputStream = null; try &#123; outputStream = fileSystem.create(new Path(outPath)); //Ëé∑Âæó HDFS ÁöÑÂÜôÂÖ•ÊµÅ inputStream = new FileInputStream(inputPath); //ËØªÂèñÊú¨Âú∞Êñá‰ª∂ int data; while ((data = inputStream.read()) != -1) &#123; //ÂÜôÂÖ•Êìç‰Ωú outputStream.write(data); &#125; &#125; catch (IOException e) &#123; e.printStackTrace(); &#125; finally &#123; try &#123; if (outputStream != null) &#123; outputStream.close(); &#125; if (inputStream != null) &#123; inputStream.close(); &#125; &#125; catch (IOException e) &#123; e.printStackTrace(); &#125; &#125;&#125; read ÂáΩÊï∞ 1234567891011121314151617181920212223242526272829/*** ËøõË°åÊñá‰ª∂ËØªÂèñ* @param path HDFS ‰∏äÂæÖËØªÂèñÊñá‰ª∂Ë∑ØÂæÑ*/public static void read(FileSystem fileSystem, String path) &#123; FSDataInputStream inputStream = null; BufferedReader reader = null; try &#123; inputStream = fileSystem.open(new Path(path)); //Ëé∑Âèñ HDFS ËØªÂèñÊµÅ reader = new BufferedReader(new InputStreamReader(inputStream)); String content; while ((content = reader.readLine()) != null) &#123; //ËØªÂèñÂπ∂ËæìÂá∫Âà∞ÊéßÂà∂Âè∞ System.out.println(content); &#125; &#125; catch (IOException e) &#123; e.printStackTrace(); &#125; finally &#123; try &#123; if (inputStream != null) &#123; inputStream.close(); &#125; if (reader != null) &#123; reader.close(); &#125; &#125; catch (IOException e) &#123; e.printStackTrace(); &#125; &#125;&#125; Âú®Â∑•Á®ãÊñá‰ª∂Â§πÁöÑÊ†πÁõÆÂΩï‰∏ãÂàõÂª∫ËÆ°Âàí‰∏ä‰º†ÁöÑÊñá‰ª∂ÔºàËøôÈáåÊòØ demo.txtÔºâÔºåÂ°´ÂÖ• Hello WorldÔºÅ ÂêØÂä® Hadoop ÁÑ∂ÂêéËøêË°åÁ®ãÂ∫èÊü•ÁúãÁªìÊûú ÈÄöËøá http://localhost:50070/explorer.html#/ ÂèØ‰ª•Êü•ÁúãÂÜôÂÖ•ÁªìÊûú ÊéßÂà∂Âè∞Âàô‰ºöËæìÂá∫‰∏ä‰º†Êñá‰ª∂ÁöÑÂÜÖÂÆπ Thanks ÂàùÊ≠•ÊéåÊè°HDFSÁöÑÊû∂ÊûÑÂèäÂéüÁêÜ Ê∑±ÂÖ•ÁêÜËß£HDFSÔºöHadoopÂàÜÂ∏ÉÂºèÊñá‰ª∂Á≥ªÁªü HDFSËØªÂÜôÊµÅÁ®ãÔºàÂè≤‰∏äÊúÄÁ≤æÁÇºËØ¶ÁªÜÔºâ HadoopÂ≠¶‰π†‰πãË∑ØÔºàÂçÅ‰∏ÄÔºâHDFSÁöÑËØªÂÜôËØ¶Ëß£]]></content>
      <categories>
        <category>Hadoop Âü∫Á°Ä</category>
      </categories>
      <tags>
        <tag>BigData</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hadoop Âü∫Á°Ä‰πãÊê≠Âª∫ÁéØÂ¢É]]></title>
    <url>%2F2019%2F05%2F04%2FHadoop%E5%9F%BA%E7%A1%80%E4%B9%8B%E6%90%AD%E5%BB%BA%E7%8E%AF%E5%A2%83%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä Êú¨Êñá‰∏ªË¶Å‰ªãÁªç‰∫Ü Hadoop ÁöÑ‰∏âÁßçËøêË°åÊ®°Âºè‰ª•ÂèäÈÖçÁΩÆÁöÑÊñπÂºè„ÄÇ ËøêË°åÊ®°Âºè Hadoop ÁöÑËøêË°åÊ®°ÂºèÂàÜ‰∏∫‰∏âÁßçÔºö StandaloneÔºàÊú¨Âú∞Ê®°Âºè/ÂçïÊú∫Ê®°Âºè/localÊ®°ÂºèÔºâ ËØ•Ê®°Âºè‰∏ãÊ≤°Êúâ‰ªª‰ΩïÂÆàÊä§ËøõÁ®ãÔºåÁî®Êà∑Á®ãÂ∫èÂíå Hadoop Á®ãÂ∫èËøêË°åÂú®Âêå‰∏Ä‰∏™ Java ËøõÁ®ãÔºå‰ΩøÁî®ÁöÑÊñá‰ª∂Á≥ªÁªüÊòØÊú¨Âú∞Êñá‰ª∂Á≥ªÁªüËÄå‰∏çÊòØÂàÜÂ∏ÉÂºèÊñá‰ª∂Á≥ªÁªüÔºåÊ≠§Ê®°Âºè‰∏ã‰∏ÄËà¨Áî®‰∫éÊú¨Âú∞Ë∞ÉËØï„ÄÇ Pseudo-DistributedÔºà‰º™ÈõÜÁæ§Ê®°ÂºèÔºâ Âú®ÂçïÊú∫‰∏äÊ®°ÊãüÈõÜÁæ§Ê®°ÂºèÔºåÂêÑÂÆàÊä§ËøõÁ®ãËøêË°åÂú®ÂçïÁã¨ÁöÑ Java ËøõÁ®ãÂΩì‰∏≠Ôºå‰ΩøÁî®ÁöÑÊñá‰ª∂Á≥ªÁªüÊòØ HDFS Fully-DistributedÔºàÈõÜÁæ§Ê®°ÂºèÔºâ ÂÆàÊä§ËøõÁ®ãËøêË°åÂú®ÈõÜÁæ§‰∏äÔºå‰ΩøÁî®ÁöÑÊñá‰ª∂Á≥ªÁªü‰πüÊòØ HDFS ÈÖçÁΩÆËøáÁ®ã Êú¨Ê¨°ÈÖçÁΩÆÂü∫‰∫é Hadoop2.9.2ÔºåÂÖ∂‰∏≠ Standalone Âú® CentOS 7.2 Á≥ªÁªü‰∏ãËøõË°åÈÖçÁΩÆÔºå Pseudo-Distributed Ê®°ÂºèÂú® MacOS 10.14.4 ‰∏äËøõË°åÈÖçÁΩÆÔºåFully-Distributed Ê®°ÂºèÂú®ËÖæËÆØ‰∫ë‰∏ªÊú∫‰∏äËøõË°åÈÖçÁΩÆÔºåÈõÜÁæ§Áî±‰∏§Âè∞‰∫ë‰∏ªÊú∫ÁªÑÊàêÔºåÂàÜÂà´ËøêË°å Ubuntu 14.04.1 Âíå CentOS 7.2 Á≥ªÁªü„ÄÇ ÁéØÂ¢ÉÂáÜÂ§á Java 7/8 Hadoop 2.7.x to 2.x ÊîØÊåÅ Java 7/8ÔºåÂÖ∂ÂÆÉ Hadoop ÁâàÊú¨ÊîØÊåÅÁöÑ Java ÁâàÊú¨ËØ∑ÁÇπÂáª üîó ËøõË°åÊü•ËØ¢ ‰∏ãËΩΩÔºö 1sudo yum install java-1.8.0-openjdk-devel //centos ÂÆâË£Ö Java8Ôºåubuntu ‰∏ãÈúÄË¶ÅÁî® apt-get ËøõË°åÂÆâË£Ö ÈÖçÁΩÆÁéØÂ¢ÉÂèòÈáèÔºö 1234cd ~vi .bash_profileexport JAVA_HOME=/usr/lib/jvm/jre-1.8.0-openjdk.i386source .bash_profile ssh Âíå rsync: Áî® ssh Âíå rsync ÂëΩ‰ª§ÊµãËØïÂêéÂèëÁé∞ Centos Êú¨Ë∫´Â∞±ÊúâÔºåÊâÄ‰ª•Êó†È°ªËøõË°åÂÆâË£Ö„ÄÇ Hadoop 12sudo wget http://mirror.bit.edu.cn/apache/hadoop/common/hadoop-2.9.2/hadoop-2.9.2.tar.gztar -zxvf hadoop-2.9.2.tar.gz ËøôÈáåÁöÑ‰∏ãËΩΩÂú∞ÂùÄÊúÄÂ•ΩÊ†πÊçÆ‰∫ë‰∏ªÊú∫ÊâÄÂú®ÁöÑÂå∫ÂüüËøõË°åÈÄâÊã©ÔºåÂ¶ÇÊûúÊòØÂõΩÂÜÖÁöÑ‰∫ë‰∏ªÊú∫ÊúÄÂ•Ω‰ΩøÁî®ÂõΩÂÜÖÁöÑÈïúÂÉèÂú∞ÂùÄÔºåËøôÊ†∑‰∏ãËΩΩ‰ºöÂø´ÂæàÂ§ö„ÄÇ Standalone Ê®°Âºè ‰∏ãËΩΩËß£Âéã‰πãÂêéÁöÑ Hadoop ÈªòËÆ§Â∞±ÊòØ Standalone Ê®°ÂºèÔºåÂèØÁõ¥Êé•ËøêË°å wordcount ËøõË°åÊµãËØï 12345mkdir input //hadoop ÁöÑÂêåÁ∫ßÁõÆÂΩïÂàõÂª∫cp hadoop-2.9.2/LICENSE.txt input/hadoop-2.9.2/bin/hadoop jar hadoop-2.9.2/share/hadoop/mapreduce/hadoop-mapreduce-examples-2.9.2.jar wordcount input output //ËøêË°å wordcountcat output/part-r-00000 //Êü•ÁúãÁªìÊûú ÂêåÊó∂ÂÜçÂºÄ‰∏Ä‰∏™ÁªàÁ´ØÂú®‰Ωú‰∏öËøêË°åÁöÑÊó∂ÂÄôËæìÂÖ• jps Êü•ÁúãËøõÁ®ã ÂèØ‰ª•ÁúãÂà∞ Standalone Ê®°Âºè‰∏ã Hadoop Âè™‰ºöÂêØÂä® RunJar ËøõÁ®ãÊù•ËøêË°åÊï¥‰∏™‰Ωú‰∏ö Pseudo-Distributed Ê®°Âºè ‰øÆÊîπ etc/hadoop/core-site.xml 1234567891011&lt;configuration&gt; &lt;property&gt; &lt;name&gt;fs.defaultFS&lt;/name&gt; &lt;!--ÈÖçÁΩÆËÆøÈóÆ nameNode ÁöÑ URI--&gt; &lt;value&gt;hdfs://localhost:9000&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;hadoop.tmp.dir&lt;/name&gt; &lt;!--ÊåáÂÆö‰∏¥Êó∂ÁõÆÂΩïÔºåMapReduce Âíå HDFS ÁöÑËÆ∏Â§öË∑ØÂæÑÈÖçÁΩÆ‰æùËµñÊ≠§Ë∑ØÂæÑ--&gt; &lt;value&gt;/home/hadoop/tmp&lt;/value&gt; &lt;/property&gt;&lt;/configuration&gt; ‰øÆÊîπ etc/hadoop/hdfs-site.xml 1234567891011&lt;configuration&gt; &lt;property&gt; &lt;name&gt;dfs.replication&lt;/name&gt; &lt;!--ÈÖçÁΩÆÊñá‰ª∂ÁöÑÂâØÊú¨Êï∞Èáè--&gt; &lt;value&gt;1&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;dfs.permissions&lt;/name&gt; &lt;value&gt;false&lt;/value&gt; &lt;!--ÂÖ≥Èó≠Èò≤ÁÅ´Â¢ô--&gt; &lt;/property&gt;&lt;/configuration&gt; ÈÖçÁΩÆÂÖçÂØÜÁôªÂΩï 1234ssh localhost ÊµãËØïËÉΩÂê¶ÂÖçÂØÜÁôªÂΩïÔºàÂ¶ÇÊûúËÉΩÂ§üÂàôË∑≥Ëøá‰ª•‰∏ãÊìç‰ΩúÔºâssh-keygen -t rsa -P '' -f ~/.ssh/id_rsacat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keyschmod 0600 ~/.ssh/authorized_keys ‰øÆÊîπ etc/hadoop/hadoop-env.shÔºàÂ¶ÇÊûúÊèêÁ§∫Êâæ‰∏çÂà∞ JAVA_HOMEÔºâ 1export JAVA_HOME=/usr/lib/jvm/jre-1.8.0-openjdk.i386 //‰∏äÈù¢ÈÖçÁΩÆÁöÑ JAVA_HOME Â•ΩÂÉèÊ≤°Ëµ∑‰ΩúÁî® Ê†ºÂºèÂåñ HDFS 1bin/hdfs namenode -format ÂêØÂä® HDFS 1sbin/start-dfs.sh ÂêØÂä®ÂêéËæìÂÖ• jps ÁúãÂà∞‰ª•‰∏ãËøõÁ®ãÂç≥ÊàêÂäüÔºåËøô‰∏™Êó∂ÂÄôÂèØ‰ª•ÈÄöËøá http://localhost:50070/ ËÆøÈóÆ NameNode ËøêË°å wordcount 123456bin/hdfs dfs -mkdir /userbin/hdfs dfs -mkdir /user/&lt;username&gt;bin/hdfs dfs -mkdir /user/&lt;username&gt;/inputbin/hdfs dfs -put LICENSE.txt /user/&lt;username&gt;/input //ÂàõÂª∫Êñá‰ª∂Â§πÂπ∂‰∏ä‰º†Êñá‰ª∂bin/hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-2.9.2.jar wordcount input output //ËøêË°å wordcountbin/hdfs dfs -cat output/part-r-00000 //ÊòæÁ§∫ÁªìÊûú Âú®Âè¶‰∏ÄÁªàÁ´ØËæìÂÖ• jps ÂèØ‰ª•ÁúãÂà∞ËøêË°åÊó∂ÁöÑ‰ª•‰∏ãËøõÁ®ã ‰æùÊóßÊòØÁî® RunJar Êèê‰∫§ÔºåÂè™ÊòØËØªÂèñÂíåÂÜôÂÖ•ÈááÁî®‰∫Ü HDFS„ÄÇ ÈÄöËøá YARN ÊâßË°å JobÔºàÂèØÈÄâÈÖçÁΩÆÔºå‰∏çËøá‰∏∫‰∫ÜÊõ¥Êé•ËøëÁúüÂÆûÈõÜÁæ§ËøòÊòØÂª∫ËÆÆÈÖçÁΩÆÔºâ ‰øÆÊîπ etc/hadoop/mapred-site.xml 12cp etc/hadoop/mapred-site.xml.template etc/hadoop/mapred-site.xmlvi etc/hadoop/mapred-site.xml Â¢ûÂä†‰ª•‰∏ãÂÜÖÂÆπ 123456&lt;configuration&gt; &lt;property&gt; &lt;name&gt;mapreduce.framework.name&lt;/name&gt; &lt;!--Ë°®ÊòéËøêË°åÂú® YARN ‰∏ä--&gt; &lt;value&gt;yarn&lt;/value&gt; &lt;/property&gt;&lt;/configuration&gt; ‰øÆÊîπ etc/hadoop/yarn-site.xml 1234567891011&lt;configuration&gt; &lt;property&gt; &lt;name&gt;yarn.resourcemanager.hostname&lt;/name&gt;&lt;!--ËÆæÁΩÆresourcemanagerÁöÑhostname--&gt; &lt;value&gt;localhost&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt; &lt;!--ÊåáÂÆö nodemanager Ëé∑ÂèñÊï∞ÊçÆÁöÑÊñπÂºè--&gt; &lt;value&gt;mapreduce_shuffle&lt;/value&gt; &lt;/property&gt;&lt;/configuration&gt; ÂêØÂä® YARN 1sbin/start-yarn.sh ÂêØÂä®ÊàêÂäüÂêéÂèØ‰ª•ÈÄöËøá http://localhost:8088/ ËÆøÈóÆ ResourceManager ËäÇÁÇπÔºåÂπ∂‰∏îËæìÂÖ• jps ‰ºöÊòæÁ§∫‰ª•‰∏ãËøõÁ®ã ÂÖ∂‰∏≠ ResourceManager Âíå NodeManager ÊòØÂ±û‰∫é YARN ÁöÑËøõÁ®ã„ÄÇ ÈáçÂ§ç 7 ÁöÑÊìç‰ΩúÔºåËæìÂÖ• jps Êü•ËØ¢ËøõÁ®ã ÂèØ‰ª•ÁúãÂà∞Êñ∞Â¢ûÂä†‰∫Ü YarnChild ËøõÁ®ãÂíå MRAppMaster ËøõÁ®ãÔºå‰πãÊâÄ‰ª•Êúâ‰∏§‰∏™ YarnChild ËøõÁ®ãÊòØÂõ†‰∏∫ËæìÂÖ•Êñá‰ª∂Â§π‰∏≠Â≠òÂú®‰∏§‰∏™ÊñáÊú¨Êñá‰ª∂ÔºåËøôËØ¥Êòé‰∫Ü MapReduce ÊòØÈÄöËøáÂàõÂª∫Â§ö‰∏™ËøõÁ®ãÂπ∂Ë°åËÆ°ÁÆóÁöÑ„ÄÇ Fully-Distributed Ê®°Âºè ÈõÜÁæ§ÂåÖÊã¨‰∏§‰∏™ËäÇÁÇπÔºåËäÇÁÇπÂêçÂàÜÂà´‰∏∫ master Âíå slaveÔºåmaster Âíå slave ÁöÑËäÇÁÇπÈÖçÁΩÆËøáÁ®ãÂü∫Êú¨‰∏ÄËá¥Ôºå‰ª•‰∏ãÊòØÈÖçÁΩÆËøáÁ®ãÔºà‰∏§‰∏™ËäÇÁÇπÂ∑ÆÂºÇÈÖçÁΩÆ‰ºöËøõË°åÊ≥®ÊòéÔºåÂª∫ËÆÆÂÖàÈÖçÁΩÆÂ•Ω master ËäÇÁÇπÁöÑ HadoopÔºåÁÑ∂ÂêéÁî® scp ÂëΩ‰ª§Â§çÂà∂Âà∞ slave ËäÇÁÇπËøõË°å‰øÆÊîπ„ÄÇÔºâÔºö ‰øÆÊîπ /etc/hosts 12152.136.76.12 master //ËÖæËÆØ‰∫ëÂÖ¨ÁΩëip94.191.43.137 slave ÂÖçÂØÜÁôªÂΩïÔºà‚ö†Ô∏è‰∏§‰∏™ËäÇÁÇπÁöÑÁôªÂΩïÂêçÂøÖÈ°ª‰∏ÄËá¥ÔºåËøôÈáåÈÉΩ‰∏∫ rootÔºâ 123456789master ËäÇÁÇπÈÖçÁΩÆÊú¨Êú∫ÂÖçÂØÜÁôªÂΩï‰ª•ÂèäÁßªÂä®ÂÖ¨Èí•Âà∞Â≠êËäÇÁÇπssh-keygen -t rsa -P '' -f ~/.ssh/id_rsacat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keyschmod 0600 ~/.ssh/authorized_keysscp ~/.ssh/id_rsa.pub root@slave:~/slave ËäÇÁÇπÈÖçÁΩÆ master ËäÇÁÇπÂÖçÂØÜÁôªÂΩïcat ~/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keyschmod 600 ~/.ssh/authorized_keys ‰øÆÊîπ etc/hadoop/core-site.xml 1234567891011&lt;configuration&gt; &lt;property&gt; &lt;name&gt;fs.defaultFS&lt;/name&gt; &lt;!--ÈÖçÁΩÆËÆøÈóÆ nameNode ÁöÑ URI--&gt; &lt;value&gt;hdfs://localhost:9000&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;hadoop.tmp.dir&lt;/name&gt; &lt;!--ÊåáÂÆö‰∏¥Êó∂ÁõÆÂΩïÔºåMapReduce Âíå HDFS ÁöÑËÆ∏Â§öË∑ØÂæÑÈÖçÁΩÆ‰æùËµñÊ≠§Ë∑ØÂæÑ--&gt; &lt;value&gt;/home/hadoop/tmp&lt;/value&gt; &lt;/property&gt;&lt;/configuration&gt; ‰øÆÊîπ etc/hadoop/hdfs-site.xml 12345678910111213141516&lt;configuration&gt; &lt;property&gt; &lt;name&gt;dfs.replication&lt;/name&gt; &lt;!--ÈÖçÁΩÆÊñá‰ª∂ÁöÑÂâØÊú¨Êï∞Èáè--&gt; &lt;value&gt;1&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;dfs.permissions&lt;/name&gt; &lt;value&gt;false&lt;/value&gt; &lt;!--ÂÖ≥Èó≠Èò≤ÁÅ´Â¢ô--&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;dfs.namenode.secondary.http-address&lt;/name&gt; &lt;value&gt;slave:50090&lt;/value&gt; &lt;!-- ÊåáÂÆösecondarynamenode‰ΩçÁΩÆ --&gt; &lt;/property&gt;&lt;/configuration&gt; ‰øÆÊîπ etc/hadoop/mapred-site.xml 123456&lt;configuration&gt; &lt;property&gt; &lt;name&gt;mapreduce.framework.name&lt;/name&gt; &lt;!--Ë°®ÊòéËøêË°åÂú® YARN ‰∏ä--&gt; &lt;value&gt;yarn&lt;/value&gt; &lt;/property&gt;&lt;/configuration&gt; ‰øÆÊîπ etc/hadoop/yarn-site.xml 1234567891011&lt;configuration&gt; &lt;property&gt; &lt;name&gt;yarn.resourcemanager.hostname&lt;/name&gt;&lt;!--ËÆæÁΩÆresourcemanagerÁöÑhostname--&gt; &lt;value&gt;master&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt; &lt;!--ÊåáÂÆö nodemanager Ëé∑ÂèñÊï∞ÊçÆÁöÑÊñπÂºè--&gt; &lt;value&gt;mapreduce_shuffle&lt;/value&gt; &lt;/property&gt;&lt;/configuration&gt; ‰øÆÊîπ etc/hadoop/hadoop-env.sh 12export JAVA_HOME=/usr/lib/jvm/jre-1.8.0-openjdk.i386 //master Âíå slave Â°´ÂÖ•ÂêÑËá™Ë∑ØÂæÑexport HADOOP_LOG_DIR=/root/hadoop/hadoop-2.9.2/logs //ÂèØ‰ª•Ëá™Â∑±ÈÄâÂÆö ‰øÆÊîπ etc/hadoop/mapred-env.sh 1export JAVA_HOME=/usr/lib/jvm/jre-1.8.0-openjdk.i386 ‰øÆÊîπ etc/hadoop/yarn-env.sh 12export JAVA_HOME=/usr/lib/jvm/jre-1.8.0-openjdk.i386 export YARN_LOG_DIR=/root/hadoop/hadoop-2.9.2/logs ‰øÆÊîπ etc/hadoop/slaves 12masterslave ÂêØÂä® HDFS Âíå YARN 123bin/hdfs namenode -format //È¶ñÊ¨°ËøêË°åÊó∂Ê†ºÂºèÂåñsbin/start-dfs.shsbin/start-yarn.sh Âú® master Âíå slave ËäÇÁÇπÂàÜÂà´ËæìÂÖ• jps ÂêéÊúâ Ê≠§Êó∂ÂèØ‰ª•ÈÄöËøá http://152.136.76.12:8080 (ip ‰∏∫ master ÁöÑÂÖ¨ÁΩë ip) ‰ª•Âèä http://152.136.76.12:50070 ÂàÜÂà´ËÆøÈóÆ HDFS ÁöÑ web ÁïåÈù¢Âíå YARN ÁöÑ web ÁïåÈù¢ÔºåÂèØ‰ª•ÁúãÂà∞ HDFS ‰∏ãÊúâ‰∏Ä‰∏™ slave ËäÇÁÇπÔºåYARN ‰∏ãÊúâ‰∏§‰∏™ËäÇÁÇπ ËøêË°å wordcountÔºà‰∏é‰º™ÂàÜÂ∏ÉÂºè‰∏≠‰∏ÄËá¥Ôºâ 123456bin/hdfs dfs -mkdir /userbin/hdfs dfs -mkdir /user/&lt;username&gt;bin/hdfs dfs -mkdir /user/&lt;username&gt;/inputbin/hdfs dfs -put LICENSE.txt /user/&lt;username&gt;/input bin/hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-2.9.2.jar wordcount input outputbin/hdfs dfs -cat output/part-r-00000 ÁªßÁª≠Áî® jps Êü•Áúã‰∏§Âè∞‰∏ªÊú∫ÁöÑËøõÁ®ã ÂèØ‰ª•ÁúãÂà∞ÈõÜÁæ§Ê®°Âºè‰∏≠ÁöÑËøõÁ®ã‰∏é‰º™ÈõÜÁæ§Ê®°Âºè‰∏≠ÁöÑËøõÁ®ãÊ≤°ÊúâÂå∫Âà´ÔºåÂîØ‰∏ÄÁöÑÂå∫Âà´Âú®‰∫éËøõÁ®ãÂú®‰∏çÂêåÁöÑ‰∏ªÊú∫‰∏äËøêË°å„ÄÇ ÈîôËØØ ËøôÈáå‰∏ªË¶ÅËÆ∞ÂΩïÈÖçÁΩÆËøáÁ®ã‰∏≠ÈÅáÂà∞ÁöÑ‰∏ÄÈÉ®ÂàÜÈîôËØØ Container exited with a non-zero exit code 1. Error file: prelaunch.err. ËØ•ÈîôËØØÊòØÂú®ËÖæËÆØ‰∫ë‰∏ªÊú∫‰∏äÈÖçÁΩÆÁöÑ‰º™ÈõÜÁæ§Ê®°ÂºèËøêË°å wordcount Êó∂Âá∫Áé∞ÁöÑÔºåÂ∞ùËØï‰∫ÜÁΩë‰∏äÁöÑ‰∏Ä‰∫õÂäûÊ≥ïÈÉΩÊ≤°ÊúâËß£ÂÜ≥„ÄÇÊúÄÂêéÈááÁî®Ëá™Â∑±ÁîµËÑëÈÖçÁΩÆÂÜçËøêË°å‰∏ÄÈÅçÊàêÂäüÔºåÂèØËÉΩÊòØÂõ†‰∏∫‰∫ë‰∏ªÊú∫ÁöÑÈÖçÁΩÆÈóÆÈ¢ò„ÄÇ Âú® YARN ‰∏äËøêË°å Java.net.ConnectException: Connection refused ÂèØËÉΩÊòØÈò≤ÁÅ´Â¢ôÁöÑÂéüÂõ†ÔºåÊ†πÊçÆ üîó ‰∏≠ÁöÑÊèêÁ§∫Ëß£ÂÜ≥ Êó†Ê≥ïÂ§ñÁΩëËÆøÈóÆVM‰∏≠ÁöÑ Hadoop YARN ÁöÑ8088Á´ØÂè£ Êó†Ê≥ïÈÄöËøá‰∫ë‰∏ªÊú∫ ip:8088 ËÆøÈóÆ YARN ÁöÑ Web È°µÈù¢Êó∂Ôºå‰∏çÂ¶®ÈÄöËøá netstat -nlp | grep java Êü•ÁúãÂΩìÂâçÊèê‰æõ web ÊúçÂä°ÁöÑÁ´ØÂè£ÔºåÂ¶ÇÊûú ip ÊòØ 127.0.0.1 ËØÅÊòéÂ≠òÂú®ÈóÆÈ¢òÔºåÈúÄË¶Å‰øÆÊîπ hostsÔºåÂÖ∑‰ΩìËøáÁ®ãËßÅ üîó„ÄÇ slave: bash: line 0: cd: /root/hadoop/hadoop-2.9.2: No such file or directory ÈÖçÁΩÆÈõÜÁæ§Ê®°ÂºèÊó∂Âá∫Áé∞Ôºå‰∏ªË¶ÅÂéüÂõ†ÊòØÊâãÂä®ÈÖçÁΩÆ slave Êó∂ Hadoop Â≠òÊîæË∑ØÂæÑ‰∏é master ‰∏ç‰∏ÄËá¥ÔºåÂè™ÈúÄË¶ÅÂ∞Ü slave ÁöÑ Hadoop ÊîæÂú®‰∏é master ÁöÑÂêå‰∏ÄË∑ØÂæÑ‰∏ãÂç≥ÂèØËß£ÂÜ≥„ÄÇ Thanks HadoopÂÆåÂÖ®ÂàÜÂ∏ÉÂºèÈÉ®ÁΩ≤ Hadoop‰∏âÁßçÊ®°Âºè‰ªãÁªç hadoopÁöÑ‰∏âÁßçËøêË°åÊ®°ÂºèÂå∫Âà´ÂèäÈÖçÁΩÆËØ¶Ëß£]]></content>
      <categories>
        <category>Hadoop Âü∫Á°Ä</category>
      </categories>
      <tags>
        <tag>BigData</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hadoop Âü∫Á°Ä‰πãÁîüÊÄÅÂúà]]></title>
    <url>%2F2019%2F04%2F21%2FHadoop%E5%9F%BA%E7%A1%80%E4%B9%8B%E7%94%9F%E6%80%81%E5%9C%88%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä Êú¨Êñá‰∏ªË¶ÅÁõÆÁöÑÊòØ‰ªãÁªç Hadoop ÁöÑÂü∫Êú¨Êû∂ÊûÑ‰ª•ÂèäË°çÁîüÂá∫Êù•ÁöÑÂêÑÁßçÂ∑•ÂÖ∑Ôºå‰ª•ÊúüÂØπ Hadoop Êúâ‰∏™Êï¥‰ΩìÁöÑËÆ§ËØÜ„ÄÇ Hadoop ÁîüÊÄÅÁ≥ªÁªü Hadoop ÁîüÊÄÅÁ≥ªÁªüÊòØÊåá‰ª• ÂàÜÂ∏ÉÂºèÁöÑÊñá‰ª∂Á≥ªÁªü HDFS„ÄÅÂàÜÂ∏ÉÂºèÁöÑËÆ°ÁÆóÊ°ÜÊû∂ MapReduce ‰ª•ÂèäËµÑÊ∫êÁÆ°ÁêÜÂô® YARN‰∏∫Âü∫Á°ÄÊûÑÊàêÁöÑÂàÜÂ∏ÉÂºèÊï∞ÊçÆÂ§ÑÁêÜÁ≥ªÁªüÔºåÂÖ∂ÁªìÊûÑÂõæÂ¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö ‰∏ãÈù¢Â∞ÜÂØπÂõæ‰∏≠ÂêÑÈ°πÁªÑ‰ª∂ÂÅö‰∏Ä‰∏™‰ªãÁªç HDFS HDFS ÊòØ Google ‰∫é 2003 ÂèëË°®ÁöÑ ÂàÜÂ∏ÉÂºèÊñá‰ª∂Á≥ªÁªü GFS ËÆ∫ÊñáÁöÑÂºÄÊ∫êÂÆûÁé∞ÁâàÊú¨Ôºå‰∏ªË¶ÅÁõÆÁöÑÊòØ‰ΩøÁî®ÊôÆÈÄöÂïÜ‰∏öÁîµËÑëËß£ÂÜ≥Â§ßÈáèÊï∞ÊçÆÁöÑÂ≠òÂÇ®‰ª•ÂèäËØªÂèñÈÄüÂ∫¶ÈóÆÈ¢òÔºåÂú® GFS Âá∫Áé∞‰πãÂâç‰∏ÄËà¨‰∏ªË¶ÅÂú®ÂçïÂè∞ËÆ°ÁÆóÊú∫Áî® RAID Êù•ÊèêÈ´òÊï∞ÊçÆÂ≠òÂÇ®ÈáèÂíåËØªÂèñÈÄüÂ∫¶„ÄÇ‰ΩÜÊòØÈááÁî® RAID ‰∏ÄÊñπÈù¢ÊàêÊú¨ÊØîËæÉÈ´òÔºàÈúÄÊ±ÇÂ§™È´òÊó∂ÂèØËÉΩÂè™ÊúâË∂ÖÁ∫ßËÆ°ÁÆóÊú∫ÊâçËÉΩÊª°Ë∂≥ÔºâÔºåÂè¶‰∏ÄÊñπÈù¢Êï∞ÊçÆÈáèËøáÂ§ßÊó∂ÂèØËÉΩË∂ÖÁ∫ßËÆ°ÁÆóÊú∫‰πüÊó†Ê≥ïÊª°Ë∂≥ÈúÄÊ±Ç„ÄÇÊâÄ‰ª•Ëøô‰∏™Êó∂ÂÄôÂ∞±ÈúÄË¶ÅÈááÂèñÂàÜÂ∏ÉÂºèÁöÑÊñπÂºèÂéªÊª°Ë∂≥Êâ©Â§ßÂ≠òÂÇ®ÔºàÂ§öÂè∞Êú∫Âô®Â§ö‰∏™Á£ÅÁõòÔºâÂíåÂ¢ûÂä†ËØªÂèñÈÄüÂ∫¶ÁöÑÈúÄÊ±ÇÔºàÂ§öÂè∞Êú∫Âô®ÂèØ‰ª•ÂêåÊó∂ËØªÔºâ„ÄÇ MapReduce MapReduce ÊòØ‰∏Ä‰∏™ÂàÜÂ∏ÉÂºèÁöÑËÆ°ÁÆóÊ°ÜÊû∂ÔºåÂú® MapReduce Âá∫Áé∞‰πãÂâçÂ∞±Â∑≤ÁªèÊúâ‰∫ÜÂàÜÂ∏ÉÂºèËÆ°ÁÆóËøô‰∏™Ê¶ÇÂøµ„ÄÇ‰ΩÜÊòØÂ§ßÂ§öÊï∞ÂàÜÂ∏ÉÂºèËÆ°ÁÆóÂè™ËÉΩ‰∏ìÈó®Áî®‰∫éÂ§ÑÁêÜ‰∏ÄÁ±ªËøêÁÆóÔºåËÄå Google Âú®Â§ßÈáèÂÆûË∑µ‰∏≠ÊÄªÁªìÂá∫‰∫Ü‰∏Ä‰∏™ÈÄöÁî®ÁöÑÁºñÁ®ãÊ®°ÂûãÔºö map Âíå reduce„ÄÇÂÖ∂‰∏≠ map ÊòØÊåáÂàÜÂºÄËÆ°ÁÆóÁöÑËøáÁ®ãÔºåËÄå reduce ÊòØÊåáÂêàÂπ∂ÁªìÊûúÁöÑËøáÁ®ã„ÄÇËÄåÂú®Ëøô‰∏ÄÁºñÁ®ãÊ®°ÂûãÊ∑ªÂä†ÁöÑ‰∏ÄÁ≥ªÂàóÊú∫Âà∂ÂíåÊìç‰ΩúÊûÑÊàê‰∫Ü MapReduce„ÄÇMapReduce Â§ßÂ§ßÈôç‰Ωé‰∫ÜÂàÜÂ∏ÉÂºèËÆ°ÁÆóÁöÑÈó®ÊßõÔºåÂØπ‰∫éÂºÄÂèë‰∫∫ÂëòËÄåË®ÄÂè™ÈúÄË¶ÅÁºñÂÜô‰∏ÄÁ≥ªÂàó map Âíå reduce ÂáΩÊï∞Âç≥ÂèØÂÆåÊàêÊâÄÈúÄÁöÑÂàÜÂ∏ÉÂºèËÆ°ÁÆóËøáÁ®ã„ÄÇ YARN YARN ÊòØ‰∏Ä‰∏™ËµÑÊ∫êÁÆ°ÁêÜÊ°ÜÊû∂Ôºå‰∏ªË¶Å‰ΩúÁî®ÊòØË¥üË¥£ÈõÜÁæ§ÁöÑËµÑÊ∫êË∞ÉÂ∫¶Âíå‰Ωú‰∏ö‰ªªÂä°ÁÆ°ÁêÜ„ÄÇYARN ÁöÑÂá∫Áé∞Ê∫ê‰∫é Hadoop ‰∏çËÉΩÊª°Ë∂≥Áªü‰∏Ä‰ΩøÁî®ÈõÜÁæ§ËµÑÊ∫êÁöÑÈúÄÊ±ÇÔºåÂõ†‰∏∫ Hadoop1 ‰∏≠ÈõÜÁæ§ÁöÑËµÑÊ∫êË∞ÉÂ∫¶Âíå‰ªªÂä°ÁÆ°ÁêÜ‰∏é MapReduce ÁöÑÊâßË°åËøáÁ®ãÊòØËÄ¶ÂêàÂú®‰∏ÄËµ∑ÁöÑÔºåËÄåÂêéÁª≠Âá∫Áé∞ÁöÑ Spark„ÄÅStorm Á≠âÂàÜÂ∏ÉÂºèËÆ°ÁÆóÁ≥ªÁªüÂÖ∂Êû∂ÊûÑÂíåÊâßË°åËøáÁ®ã‰∏é MapReduce ‰∏çÂêåÔºåÊó†Ê≥ïÁõ¥Êé•Âêë Hadoop Áî≥ËØ∑ÈõÜÁæ§ËµÑÊ∫ê„ÄÇÊâÄ‰ª•‰∏∫‰∫ÜÂÆûÁé∞ÈõÜÁæ§ËµÑÊ∫êÁöÑÁªü‰∏ÄÁÆ°ÁêÜÔºåÂú® Hadoop2 ‰∏≠ÂØπ MapReduce ËøõË°å‰∫Ü‰∏Ä‰∏™Ëß£ËÄ¶ÔºåÊäΩÁ¶ªÂá∫‰∫Ü YARN Ëøô‰∏™Ê°ÜÊû∂„ÄÇ ZooKeeper Zookeeper ‰∏ªË¶Å‰ΩúÁî®ÊòØÊèê‰æõ‰∏Ä‰∏™ÂàÜÂ∏ÉÂºè„ÄÅÈ´òÂèØÁî®ÁöÑÂçèË∞ÉÊúçÂä°ÔºåËß£ÂÜ≥ÂàÜÂ∏ÉÂºèÁéØÂ¢É‰∏ãÁöÑÊï∞ÊçÆÁÆ°ÁêÜÈóÆÈ¢òÔºöÁªü‰∏ÄÂëΩÂêçÔºåÁä∂ÊÄÅÂêåÊ≠•ÔºåÈõÜÁæ§ÁÆ°ÁêÜÔºåÈÖçÁΩÆÂêåÊ≠•Á≠â„ÄÇ Pig ËôΩÁÑ∂ MapReduce ÊûÅÂ§ßÁöÑÁÆÄÂåñ‰∫ÜÂàÜÂ∏ÉÂºèËÆ°ÁÆóÁºñÁ®ãÁöÑÈó®ÊßõÔºå‰ΩÜÊòØ Yahoo ÁöÑÂ∑•Á®ãÂ∏à‰æùÁÑ∂ËßâÂæó MapReduce ÁºñÁ®ãÂ§™ËøáÈ∫ªÁÉ¶ÔºåÊâÄ‰ª•‰ªñ‰ª¨‰æøÂºÄÂèë‰∫Ü Pig Ëøô‰∏™ËÑöÊú¨ËØ≠Ë®ÄÁî®‰∫éÊèèËø∞ÂØπÂ§ßÊï∞ÊçÆÈõÜÁöÑÊìç‰Ωú„ÄÇËøôÊ†∑Â∞±ÂèØ‰ª•ÈÄöËøáÁºñËØë Pig ËÑöÊú¨ÁîüÊàêÂØπÂ∫îÁöÑ MapReduce Á®ãÂ∫è„ÄÇ Hive ‰∏∫‰∫ÜÊñπ‰æø‰ΩøÁî® SQL ÁöÑÂ∑•Á®ãÂ∏à‰ΩøÁî® MapReduceÔºåFacebook ÁöÑÂ∑•Á®ãÂ∏àÂºÄÂèë‰∫Ü HiveÔºåÈÄöËøá Hive ÁÜüÊÇâÊï∞ÊçÆÂ∫ìÁöÑÂ∑•Á®ãÂ∏àÂèØ‰ª•Êó†Èó®ÊßõÁöÑ‰ΩøÁî® MapReduce„ÄÇ Mahout Mahout ÁöÑ‰∏ªË¶ÅÁõÆÊ†áÊòØÂàõÂª∫‰∏Ä‰∫õÂèØÊâ©Â±ïÁöÑÊú∫Âô®Â≠¶‰π†È¢ÜÂüüÁªèÂÖ∏ÁÆóÊ≥ïÁöÑÂÆûÁé∞ÔºåÊó®Âú®Â∏ÆÂä©ÂºÄÂèë‰∫∫ÂëòÊõ¥Âä†Êñπ‰æøÂø´Êç∑Âú∞ÂàõÂª∫Êô∫ËÉΩÂ∫îÁî®Á®ãÂ∫è„ÄÇMahout Áé∞Âú®Â∑≤ÁªèÂåÖÂê´‰∫ÜËÅöÁ±ª„ÄÅÂàÜÁ±ª„ÄÅÊé®ËçêÂºïÊìéÔºàÂçèÂêåËøáÊª§ÔºâÂíåÈ¢ëÁπÅÈõÜÊåñÊéòÁ≠âÂπøÊ≥õ‰ΩøÁî®ÁöÑÊï∞ÊçÆÊåñÊéòÊñπÊ≥ï„ÄÇ Tez Tez ÊòØ Apache ÊúÄÊñ∞ÂºÄÊ∫êÁöÑÊîØÊåÅ DAG ‰Ωú‰∏öÁöÑËÆ°ÁÆóÊ°ÜÊû∂ÔºåÂÆÉÁõ¥Êé•Ê∫ê‰∫é MapReduce Ê°ÜÊû∂ÔºåÊ†∏ÂøÉÊÄùÊÉ≥ÊòØÂ∞Ü Map Âíå Reduce ‰∏§‰∏™Êìç‰ΩúËøõ‰∏ÄÊ≠•ÊãÜÂàÜÔºåÂç≥ Map Ë¢´ÊãÜÂàÜÊàê Input„ÄÅProcessor„ÄÅSort„ÄÅMergeÂíåOutputÔºå Reduce Ë¢´ÊãÜÂàÜÊàê Input„ÄÅShuffle„ÄÅSort„ÄÅMerge„ÄÅProcessor Âíå Output Á≠â„ÄÇ Hase HBase ÊòØ‰∏Ä‰∏™Âª∫Á´ãÂú® HDFS ‰πã‰∏äÔºåÈù¢ÂêëÂàóÁöÑÈíàÂØπÁªìÊûÑÂåñÊï∞ÊçÆÁöÑÂèØ‰º∏Áº©„ÄÅÈ´òÂèØÈù†„ÄÅÈ´òÊÄßËÉΩ„ÄÅÂàÜÂ∏ÉÂºèÂíåÈù¢ÂêëÂàóÁöÑÂä®ÊÄÅÊ®°ÂºèÊï∞ÊçÆÂ∫ì„ÄÇ Flume Cloudera ÂºÄÊ∫êÁöÑÊó•ÂøóÊî∂ÈõÜÁ≥ªÁªüÔºåÂÖ∑ÊúâÂàÜÂ∏ÉÂºè„ÄÅÈ´òÂèØÈù†„ÄÅÈ´òÂÆπÈîô„ÄÅÊòì‰∫éÂÆöÂà∂ÂíåÊâ©Â±ïÁöÑÁâπÁÇπ„ÄÇ Sqoop Sqoop ÊòØ SQL-to-Hadoop ÁöÑÁº©ÂÜôÔºå‰∏ªË¶ÅÁî®‰∫é‰º†ÁªüÊï∞ÊçÆÂ∫ìÂíå Hadoop ‰πãÂâç‰º†ËæìÊï∞ÊçÆ„ÄÇÊï∞ÊçÆÁöÑÂØºÂÖ•ÂíåÂØºÂá∫Êú¨Ë¥®‰∏äÊòØMapreduce Á®ãÂ∫èÔºåÂÖÖÂàÜÂà©Áî®‰∫Ü MR ÁöÑÂπ∂Ë°åÂåñÂíåÂÆπÈîôÊÄß„ÄÇ Ambari Ambari ÁöÑ‰ΩúÁî®Êù•ËØ¥ÔºåÂ∞±ÊòØÂàõÂª∫„ÄÅÁÆ°ÁêÜ„ÄÅÁõëËßÜ Hadoop ÁöÑÈõÜÁæ§ÔºåÊòØ‰∏∫‰∫ÜËÆ© Hadoop ‰ª•ÂèäÁõ∏ÂÖ≥ÁöÑÂ§ßÊï∞ÊçÆËΩØ‰ª∂Êõ¥ÂÆπÊòì‰ΩøÁî®ÁöÑ‰∏Ä‰∏™ web Â∑•ÂÖ∑„ÄÇ ÊÄªÁªì ÊÄªÁöÑÊù•ËØ¥ HDFS „ÄÅMapReduce ‰ª•Âèä YARN ÊòØ Hadoop ÁöÑÊ†∏ÂøÉÁªÑ‰ª∂ÔºåËÄåÊàë‰ª¨Â≠¶‰π† Hadoop ÊúÄÂ•Ω‰ªéÊ†∏ÂøÉÁªÑ‰ª∂ÂºÄÂßãÂ≠¶‰π†ÂÖ∂ÂéüÁêÜÊú∫Âà∂ÔºåÂÜçÈÄêÊ∏êÂæÄ‰∏äÂ±ÇËøõË°å‰∫ÜËß£„ÄÇ Thanks HadoopÁîüÊÄÅÂúàÊÄªÁªì‚Äî‚ÄîÂ§ßÊï∞ÊçÆ hadoopÁîüÊÄÅÂúàÂêÑ‰∏™ÁªÑ‰ª∂ÁÆÄ‰ªã Â§ßÊï∞ÊçÆÊäÄÊúØHadoopÂÖ•Èó®ÁêÜËÆ∫Á≥ªÂàó‰πã‰∏Ä----hadoopÁîüÊÄÅÂúà‰ªãÁªç ‰ªé0ÂºÄÂßãÂ≠¶Â§ßÊï∞ÊçÆ---ÊûÅÂÆ¢Êó∂Èó¥]]></content>
      <categories>
        <category>Hadoop Âü∫Á°Ä</category>
      </categories>
      <tags>
        <tag>BigData</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Java Âü∫Á°Ä‰πãÈõÜÂêàÊ°ÜÊû∂(‰∏Ä)ÔºöÈõÜÂêàÊ°ÜÊû∂]]></title>
    <url>%2F2018%2F03%2F17%2FJava%E5%9F%BA%E7%A1%80%E4%B9%8B%E9%9B%86%E5%90%88-%E4%B8%80%2F</url>
    <content type="text"><![CDATA[ÈóÆÈ¢ò ÈõÜÂêàÁ±ªÂ∫îËØ•ÊòØÂπ≥Êó∂‰ΩøÁî®ÁöÑÈùûÂ∏∏È¢ëÁπÅÁöÑÁ±ª‰∫ÜÔºå‰ΩÜÊòØÂØπÂÖ∂ÂÜÖÈÉ®ÊûÑÊàêÂç¥‰∏ÄÁõ¥‰∏çÂ§™Ê∏ÖÊô∞ÔºåÊâÄ‰ª•Â∏åÊúõÈÄöËøáÊú¨ÁØáÊñáÁ´†Â∞ùËØïÂéªÁêÜËß£ÈõÜÂêàÊ°ÜÊû∂ÁöÑÊï¥‰ΩìËÆæËÆ°‰ª•ÂèäÈõÜÂêàÂ≠òÂú®ÁöÑÂøÖË¶ÅÊÄß„ÄÇÂú®ÂºÄÂßãÂàÜÊûê‰πãÂâçÈ¶ñÂÖàËÆ©Êàë‰ª¨ÊÄùËÄÉ‰ª•‰∏ãÈóÆÈ¢òÔºö ÈõÜÂêàÂ≠òÂú®ÁöÑÊÑè‰πâÔºåÈõÜÂêàÂíåÊï∞ÁªÑÁöÑÂå∫Âà´ ÈõÜÂêàÊ°ÜÊû∂ÁöÑËÆæËÆ°ÊÑèÂõæ ÈõÜÂêàÁöÑÂ∏∏Áî®Êìç‰Ωú ÈõÜÂêàÂ≠òÂú®ÁöÑÊÑè‰πâ‰ª•Âèä‰∏éÊï∞ÁªÑÁöÑÂå∫Âà´ ÊÉ≥Ë¶Å‰∫ÜËß£ Java ‰∏∫‰ªÄ‰πà‰ºöËÆæËÆ°ÈõÜÂêàÔºåÂ∞±ÂæóÂÖàÊòéÁôΩÈõÜÂêàÁöÑÂá∫Áé∞Ëß£ÂÜ≥‰∫Ü‰ªÄ‰πàÈóÆÈ¢òÔºåÂÖ≥‰∫éËøô‰∏ÄÈóÆÈ¢ò„ÄåJava ÁºñÁ®ãÊÄùÊÉ≥„Äç‰∏≠ÊòØËøô‰πàÊèèËø∞ÁöÑ Â¶ÇÊûú‰∏Ä‰∏™Á®ãÂ∫è‰∏≠Âè™ÂåÖÂê´Âõ∫ÂÆöÊï∞ÈáèÁöÑ‰∏îÂÖ∂ÁîüÂëΩÂë®ÊúüÈÉΩÊòØÂ∑≤Áü•ÁöÑÂØπË±°ÔºåÈÇ£‰πàËøôÊòØ‰∏Ä‰∏™ÈùûÂ∏∏ÁÆÄÂçïÁöÑÁ®ãÂ∫è„ÄÇ ÈÄöÂ∏∏ÔºåÁ®ãÂ∫èÊÄªÊòØÊ†πÊçÆËøêË°åÊó∂ÊâçÁü•ÈÅìÁöÑÊüê‰∫õÊù°‰ª∂ÂéªÂàõÂª∫Êñ∞ÂØπË±°„ÄÇÂú®Ê≠§‰πãÂâçÔºå‰∏ç‰ºöÁü•ÈÅìÊâÄÈúÄÂØπË±°ÁöÑÊï∞ÈáèÔºåÁîöËá≥‰∏çÁü•ÈÅìÁ°ÆÂàáÁöÑÁ±ªÂûã„ÄÇ ÊâÄ‰ª•‰πãÊâÄ‰ª•ÈúÄË¶ÅÈõÜÂêàÊòØÂõ†‰∏∫Âú®ÁºñÁ®ãÁöÑËøáÁ®ã‰∏≠‰ºöÈúÄË¶Å‰øùÂ≠òÊï∞Èáè‰∏çÂÆö„ÄÅÁ±ªÂûã‰∏çÂÆöÁöÑÊï∞ÊçÆ„ÄÇ ÈíàÂØπÊï∞Èáè‰∏çÂÆöËÄÉËôë‰∏ãÈù¢ËøôÁßçÊÉÖÂÜµ 123456789101112131415161718public class Demo &#123; private static final int COUNT = 10; private static final String STOP_FLAG = "s"; public static void main(String[] args) &#123; Scanner scanner = new Scanner(System.in); String collection[] = new String[COUNT]; System.out.println("ËæìÂÖ•Âç≥Â∞Ü‰øùÂ≠òÁöÑÊï∞ÊçÆ"); int i = 0; while (!(collection[i] = scanner.next()).equals(STOP_FLAG)) &#123; i++; &#125; scanner.close(); for (i = 0; i &lt; collection.length; i++) &#123; System.out.print(collection[i] + " "); &#125; &#125;&#125; ‰Ωú‰∏∫‰∏Ä‰∏™ÁÆÄÂçïÁöÑËæìÂÖ•Á®ãÂ∫èÔºåÈááÁî®Êï∞ÁªÑÁöÑÂΩ¢ÂºèÂéª‰øùÂ≠òÁî®Êà∑ÁöÑËæìÂÖ•ÔºåÂΩìÁî®Êà∑ÁöÑËæìÂÖ•Ë∂ÖËøáÊï∞ÁªÑÂèØÂÆπÁ∫≥ÁöÑÊï∞ÈáèÁöÑÊó∂ÂÄô‰æø‰ºöÊäõÂá∫ÂºÇÂ∏∏ÔºåËøô‰∏™ÈóÆÈ¢òÂ¶Ç‰ΩïËß£ÂÜ≥Âë¢Ôºü‰∏ÄÁßçÊñπÂºèÊòØÂ∞ÜÊï∞ÁªÑÁöÑÊï∞ÈáèÂàÜÈÖçÁöÑË∂≥Â§üÂ§ßÔºå‰ΩÜÊòØÈááÂèñËøôÁßçÊñπÂºèÊûÅÊúâÂèØËÉΩÊµ™Ë¥πÂÜÖÂ≠òÁ©∫Èó¥„ÄÇÂè¶‰∏ÄÁßçÊñπÂºèÂàôÊòØÂä®ÊÄÅÊâ©Â±ïÂ§ßÂ∞èÔºåÈÄöËøáÂä®ÊÄÅÊâ©Â±ïÂ§ßÂ∞èÊó¢ËÉΩÂ§üÂÆπÁ∫≥Ë∂≥Â§üÂ§öÁöÑÂÖÉÁ¥†ÔºåÂèàËÉΩÂ§üËäÇÁ∫¶ÂÜÖÂ≠òÁ©∫Èó¥„ÄÇËÄåÈõÜÂêàÊ≠£ÂÖ∑Â§áÂä®ÊÄÅÊâ©Â±ïÂ§ßÂ∞èËøô‰∏ÄÁâπÊÄßÔºåÊâÄ‰ª•Âú®ËøôÁßçÊÉÖÂÜµ‰∏ãÔºåÈõÜÂêàÂ∞±‰ΩìÁé∞Âá∫‰∫ÜÂÆÉÁöÑ‰ΩúÁî®„ÄÇ Ëá≥‰∫éÁ±ªÂûã‰∏çÂÆöÔºåËÄÉËôëÂè¶‰∏ÄÁßçÊÉÖÂÜµ 123456789101112131415161718192021222324252627282930313233package com.rookieyang.collections;public class DataArray &#123; private String datas[]; private int index; private static final int COUNT = 5; public DataArray() &#123; datas = new String[COUNT]; &#125; //‰πüÂèØËá™Ë°åÂØπÊï∞ÁªÑËøõË°åÂä®ÊÄÅÊâ©Â±ïÔºåËøôÈáåÂè™ÊòØÊµãËØï public void addData(String data)&#123; try &#123; datas[index] = data; index++; &#125; catch (IndexOutOfBoundsException e) &#123; System.out.println("Ë∂ÖÂá∫ÊúÄÂ§ßÁöÑÂ≠òÂÇ®ËåÉÂõ¥"); &#125; &#125;&#125;package com.rookieyang.collections;import java.util.List;public class DataCollection&lt;T&gt; &#123; private List&lt;T&gt; datas; public void addData(T data) &#123; datas.add(data); &#125;&#125; ÂèØ‰ª•ÁúãÂá∫ÂØπ‰∫éÊï∞ÁªÑËÄåË®ÄÂú®Âä®ÊÄÅÊ∑ªÂä†Êï∞ÊçÆ‰ºöÁï•ÊòæÈ∫ªÁÉ¶ÔºåËÄå‰∏îÂè™ËÉΩ‰øùÂ≠ò String Á±ªÂûãÊï∞ÊçÆÔºå‰ΩÜÂØπ‰∫éÈááÁî®ÈõÜÂêàËÄåË®ÄÔºå‰ΩøÁî®Ëµ∑Êù•‰∏ç‰ªÖÁÆÄÂçïËÄå‰∏îÂÖ∂Êâ©Â±ïÊÄß‰πüÂº∫ÔºåÊàë‰ª¨ÂèØ‰ª•Ê†πÊçÆËá™Â∑±ÁöÑÈúÄÊ±ÇÂÜ≥ÂÆöÈõÜÂêà‰∏≠‰øùÂ≠ò‰ΩïÁßçÁ±ªÂûãÊï∞ÊçÆÔºåËøôÂ∞±ÂÆûÁé∞‰∫Ü‰ª£Á†ÅÁöÑÂ§çÁî®„ÄÇ ÂØπ‰∫éÈõÜÂêàÂíåÊï∞ÁªÑËÄåË®ÄÔºåÂÖ∂‰∏ªË¶ÅÂå∫Âà´Â¶Ç‰∏ã Êï∞ÁªÑÊòØÈùôÊÄÅÁöÑÔºå‰∏Ä‰∏™Êï∞ÁªÑÂÆû‰æãÂÖ∑ÊúâÂõ∫ÂÆöÁöÑÂ§ßÂ∞èÔºåÈõÜÂêàÊòØÂä®ÊÄÅÁöÑÔºåÂèØ‰ª•Ê†πÊçÆÂÆûÈôÖÈúÄË¶ÅÂä®ÊÄÅÊâ©Â±ïÂ§ßÂ∞è Êï∞ÁªÑÊó¢ÂèØ‰ª•‰øùÂ≠òÂü∫Êú¨Á±ªÂûãÔºå‰πüÂèØ‰øùÂ≠òÂºïÁî®Á±ªÂûãÔºåÈõÜÂêàÂè™ËÉΩ‰øùÂ≠òÂºïÁî®Á±ªÂûãÔºåÂú®‰øùÂ≠òÂü∫Êú¨Á±ªÂûãÁöÑÊó∂ÂÄô‰ºöËá™Âä®Ë£ÖÁÆ± ÈõÜÂêàÊï¥‰ΩìÊ°ÜÊû∂ÂàÜÊûê È¶ñÂÖàÁúã‰∏ãÈõÜÂêàÁöÑÊï¥‰ΩìÊ°ÜÊû∂ÂõæÔºåÂØπ‰∫éÈõÜÂêàËÄåË®Ä‰∏ªË¶ÅÂàÜ‰∏∫‰∏§‰∏™ÈÉ®ÂàÜÔºöCollection Âíå MapÔºåÂÖ∂‰∏≠ Collection ‰∏ªË¶Å‰øùÂ≠òÁöÑÊòØÂçï‰∏™ÂÖÉÁ¥†ÔºåËÄå Map ÂàôÂèØ‰ª•Â∞ÜÊüê‰∫õÂØπË±°‰∏éÂÖ∂ÂÆÉ‰∏Ä‰∫õÂØπË±°Â≠òÂú®ÁöÑÂÖ≥Á≥ªÁî® key-value ÊñπÂºè‰øùÂ≠ò‰∏ãÊù•„ÄÇÊé•‰∏ãÊù•Êàë‰ª¨Â∞ÜÂ∞±Ëøô‰∏§‰∏™ÈÉ®ÂàÜÂ±ïÂºÄÂàÜÊûê„ÄÇ Collection Êé•Âè£ ÁªìÊûÑÂàÜÊûê ËøôÈáå‰∏∫‰∫ÜÊñπ‰æøÂàÜÊûêÂè™Â±ïÁ§∫‰∫ÜÊé•Âè£ÁöÑÁªßÊâøÁªìÊûÑ È¶ñÂÖàÊü•Áúã Iterable 123456789101112131415public interface Iterable&lt;T&gt; &#123; Iterator&lt;T&gt; iterator(); default void forEach(Consumer&lt;? super T&gt; action) &#123; Objects.requireNonNull(action); for (T t : this) &#123; action.accept(t); &#125; &#125; default Spliterator&lt;T&gt; spliterator() &#123; return Spliterators.spliteratorUnknownSize(iterator(), 0); &#125;&#125; Itrable Êé•Âè£‰∏≠Êã•Êúâ‰∏Ä‰∏™ iterator ÊñπÊ≥ï‰ª•Âèä‰∏§‰∏™ 1.8 Ê∑ªÂä†ÁöÑÈªòËÆ§ÊñπÊ≥ïÔºö iteratorÔºöËøîÂõû‰∏Ä‰∏™Ëø≠‰ª£Âô®Áî®‰∫éÈÅçÂéÜ forEachÔºöÊ†πÊçÆÁªôÂÆöÁöÑ action Â§ÑÁêÜÊØè‰∏™ÂÖÉÁ¥† spliteratorÔºöÊèê‰æõ‰∫Ü‰∏Ä‰∏™Áî®‰∫éÂπ∂Ë°åÈÅçÂéÜÁöÑËø≠‰ª£Âô®ÔºåÁî±‰∫éËøôÈáå‰∏ªË¶ÅÊé¢ËÆ®ÁªìÊûÑËÆæËÆ°ÔºåÊâÄ‰ª•ÊöÇ‰∏î‰∏çÂ±ïÂºÄËØ¥Êòé ÁúãÂà∞ËøôÈáåÊàë‰∫ßÁîü‰∫ÜÁ¨¨‰∏Ä‰∏™ÁñëÈóÆÔºå‰∏∫‰ªÄ‰πà Collection ‰∏çÁõ¥Êé•ÁªßÊâø Iterator Êé•Âè£ÔºåËÄåÈúÄË¶ÅÁî® Iterable ËøõË°åÂåÖË£Ö‰πãÂêéÂÜçÁªßÊâøÂë¢Ôºü ËøôÈáåÂÅáËÆæÂ≠òÂú®‰∏Ä‰∏™ CustomizeCollection Êé•Âè£Âú®ÂåÖÂê´‰∫Ü Collection Êé•Âè£ÊñπÊ≥ïÁöÑÂü∫Á°Ä‰∏äÁªßÊâø‰∫Ü Iterator Êé•Âè£ËÄå‰∏çÊòØ IterableÔºàÊàñËÄÖÊòØÁõ¥Êé•ÂåÖÂê´‰∫Ü Collection Êé•Âè£ÊñπÊ≥ï‰ª•Âèä Iterator Êé•Âè£ÊñπÊ≥ïÔºâÔºåÈÇ£‰πàÂΩìÊàë‰ª¨ÂÆûÁé∞ CustomizeCollection Êé•Âè£ÁöÑÊó∂ÂÄôÊâÄÂæóÂà∞ÁöÑ CustomizeClass Á±ªÁªìÊûÑÂ∞ÜÂ¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö ÂèØ‰ª•ÁúãÂà∞Â¶ÇÊûúÊÉ≥ÂÆûÁé∞ CustomizeCollection ÂàôÂøÖÈ°ªË¶ÅÂÆûÁé∞ Iterator Êé•Âè£ÊñπÊ≥ïÔºåÂæàÊòæÁÑ∂ÈááÁî®ËøôÁßçÊñπÂºèÂèØËÉΩÂØºËá¥Âú®‰∏çÂêåÁöÑ CustomizeCollection Êé•Âè£ÂÆûÁé∞Á±ª‰∏≠Â≠òÂú®Áõ∏ÂêåÁöÑ Itrator Êé•Âè£ÊñπÊ≥ïÂÆûÁé∞ÔºàÈÅçÂéÜËøô‰∏ÄÊìç‰ΩúÊüê‰∫õÊó∂ÂÄôÂèØËÉΩÊòØÈÄöÁî®ÁöÑÔºâÔºåËøôÊ†∑‰∏ÄÊù•Â∞±Èôç‰Ωé‰∫Ü‰ª£Á†ÅÁöÑÂ§çÁî®ÊÄßÔºåÂè¶Â§ñ‰ªéÂçï‰∏ÄËÅåË¥£ÁöÑËßíÂ∫¶Êù•ËÄÉËôëÔºåCustomizeCollection Êé•Âè£‰∏≠ÊèâÂêà‰∫ÜÈõÜÂêàÂÖÉÁ¥†ÁöÑÁÆ°ÁêÜÂäüËÉΩ‰ª•ÂèäËø≠‰ª£Âô®ÁöÑÂäüËÉΩÔºåËÄåÈááÁî® Iterable ÂåÖË£Ö‰πãÂêéÂàôÂèØ‰ª•Â∞ÜËøô‰∏§‰∏™ÂäüËÉΩËøõË°å‰∏ÄÂÆöÁ®ãÂ∫¶‰∏äÁöÑÂàÜÂâ≤„ÄÇ Êé•ÁùÄ‰ªé Collection ÂèàÂª∂Â±ïÂá∫‰∏â‰∏™Êé•Âè£ÔºåËøô‰∏â‰∏™Êé•Âè£ÊòØÂØπÈõÜÂêàÂäüËÉΩÁöÑÂÖ∑‰ΩìÂåñÔºö Set Ë°®Á§∫ÁöÑÊòØÊó†Â∫è„ÄÅ‰∏çÂ≠òÂú®ÈáçÂ§çÂÖÉÁ¥†ÁöÑÈõÜÂêà List Ë°®Á§∫ÁöÑÊòØ‰∏ÄÁßçÊúâÂ∫è„ÄÅÂèØÈáçÂ§çÂÖÉÁ¥†ÁöÑÈõÜÂêà Queue Ë°®Á§∫ÁöÑÊòØ‰∏ÄÁßçÈòüÂàóÔºåÂÖ∂ÂÆûÈòüÂàó‰πüÊòØ‰∏ÄÁßçÊúâÂ∫èÁöÑÈõÜÂêàÔºå‰ΩÜ‰πãÊâÄ‰ª•‰ºöÂçïÁã¨ËÆæËÆ°Âá∫‰∏Ä‰∏™Êé•Âè£ÁöÑÂéüÂõ†Âú®‰∫éÔºåQueue Êé•Âè£ÂéªÈô§‰∫ÜÂæàÂ§ö‰∏çÈúÄË¶ÅÁöÑÂäüËÉΩÔºå‰ΩøÂæóÊé•Âè£Êú¨Ë∫´Êõ¥Á¨¶ÂêàÂçï‰∏ÄËÅåË¥£‰ª•ÂèäÊé•Âè£ÈöîÁ¶ªÂéüÂàô„ÄÇ ÂäüËÉΩÂàÜÊûê Collection Êé•Âè£ÁöÑÂäüËÉΩÂ§ßËá¥Ê¶ÇÊã¨Â¶Ç‰∏ãÔºàÊöÇ‰∏ç‰ªãÁªç 1.8 ÂºïÂÖ•ÁöÑÈªòËÆ§ÊñπÊ≥ïÔºâ Â¢ûÂä† boolean add(E e) Â¢ûÂä†ÂçïÂÖÉÂÖÉÁ¥† boolean addAll(Collection&lt;? extends E&gt; c) Â¢ûÂä†ÈõÜÂêà c ÁöÑÂÖÉÁ¥† Âà†Èô§ boolean remove(Object o) ÁßªÈô§ÂÖÉÁ¥† boolean removeAll(Collection&lt;?&gt; c) ÁßªÈô§ÈõÜÂêà c ÁöÑÂÖÉÁ¥† void clear() Ê∏ÖÁ©∫ÈõÜÂêà Êü•ËØ¢ boolean contains(Object o) Êü•ËØ¢ÈõÜÂêàÊòØÂê¶Â≠òÂú®ÂÖÉÁ¥† o boolean containsAll(Collection&lt;?&gt; c)Êü•ËØ¢ÂΩìÂâçÈõÜÂêàÊòØÂê¶Â≠òÂú®ÈõÜÂêà c ‰∏≠ÁöÑÊâÄÊúâÂÖÉÁ¥† boolean isEmpty() Êü•ËØ¢ÊòØÂê¶ÈõÜÂêà‰∏∫Á©∫ int size() Êü•ËØ¢ÈõÜÂêàÁöÑÂ§ßÂ∞è ÂÖ∂ÂÆÉ Iterator iterator() ËøîÂõûËø≠‰ª£Âô® boolean retainAll(Collection&lt;?&gt; c) ÂèñÂΩìÂâçÈõÜÂêàÂíåÈõÜÂêà c ÁöÑ‰∫§ÈõÜ Set Êé•Âè£‰∏é Colleciton Êé•Âè£ÂÆö‰πâÁöÑÊñπÊ≥ïÂÆåÂÖ®‰∏ÄËá¥ List Êé•Âè£Âú® Collectiion Êé•Âè£Âü∫Á°Ä‰∏äÊñ∞Â¢û‰∫Ü‰∏Ä‰∫õ‰∏éÁ¥¢ÂºïÊúâÂÖ≥ÁöÑÊñπÊ≥ï Â¢ûÂä† void add(int index, E element) Âú® index Â§ÑÊèíÂÖ•ÂÖÉÁ¥† Âà†Èô§ E remove(int index) Âà†Èô§ index Â§ÑÁöÑÂÖÉÁ¥† ‰øÆÊîπ E set(int index, E element) ‰øÆÊîπ index ÁöÑÂÖÉÁ¥†‰∏∫ element Êü•ËØ¢ E get(int index) Ëé∑Âèñ index Â§ÑÁöÑÂÖÉÁ¥† int indexOf(Object o) Ëé∑ÂèñÂÖÉÁ¥† o Á¨¨‰∏ÄÊ¨°Âá∫Áé∞ÁöÑ index int lastIndexOf(Object o) Ëé∑ÂèñÂÖÉÁ¥† o ÊúÄÂêé‰∏ÄÊ¨°Âá∫Áé∞ÁöÑ index ÂÖ∂ÂÆÉ ListIterator listIterator() ËøîÂõû ListIterator Á±ªÂûãÁöÑËø≠‰ª£Âô® ListIterator listIterator(int index) ËøîÂõû‰ªé index ÂºÄÂßãÁöÑ ListIterator Á±ªÂûãÁöÑËø≠‰ª£Âô® Queue Êé•Âè£Êñ∞Â¢ûÁöÑÊñπÊ≥ïÂ¶Ç‰∏ã Âá∫Èòü E peek() Âá∫Èòü‰ΩÜÊòØ‰∏çÂà†Èô§ÂÖÉÁ¥†ÔºåÂú®ÈòüÂàó‰∏∫Á©∫ÁöÑÊó∂ÂÄôËøîÂõû null E element() Âá∫Èòü‰ΩÜÊòØ‰∏çÂà†Èô§ÂÖÉÁ¥†ÔºåÂú®ÈòüÂàó‰∏∫Á©∫ÁöÑÊó∂ÂÄôÊäõÂá∫ÂºÇÂ∏∏ E poll() Âá∫ÈòüÂπ∂‰∏îÂà†Èô§ÂÖÉÁ¥†ÔºåÂú®ÈòüÂàó‰∏∫Á©∫ÁöÑÊó∂ÂÄôËøîÂõûnull E remove() Âá∫ÈòüÂπ∂‰∏îÂà†Èô§ÂÖÉÁ¥†ÔºåÂú®ÈòüÂàó‰∏∫Á©∫ÁöÑÊó∂ÂÄôÊäõÂá∫ÂºÇÂ∏∏ ÂÖ•Èòü boolean offer(E e) Map Êé•Âè£ ÁªìÊûÑÂàÜÊûê Map ÊòØ‰∏Ä‰∏™Âçï‰∏ÄÁöÑÊé•Âè£ÔºåÂπ∂Ê≤°ÊúâÂú®Ê≠§Âü∫Á°Ä‰∏äËøõË°åÊâ©Â±ïÔºå‰ΩÜÂú® Map Êé•Âè£ÁöÑÂÜÖÈÉ®Êúâ‰∏Ä‰∏™ Entry Êé•Âè£Ôºö 1234567891011121314interface Entry&lt;K,V&gt; &#123; K getKey(); V getValue(); V setValue(V value); boolean equals(Object o); int hashCode(); .....&#125; ÂèØ‰ª•ÁúãÂà∞ Entry ÈáåÈù¢Â∞ÅË£ÖÁöÑÈÉΩÊòØÂíå Map ‰∏≠ÂÖÉÁ¥†ÊúâÂÖ≥ÁöÑÊìç‰ΩúÔºåËøô‰∏ÄÊé•Âè£‰∏ªË¶ÅÁî®Êù•ËßÑÂÆö Map ‰∏≠Áî®Êù•Â≠òÂÇ® key-value ÊâÄÈúÄË¶ÅÊèê‰æõÁöÑÂäüËÉΩ ÂäüËÉΩÂàÜÊûê Map Êé•Âè£ÁöÑÂäüËÉΩÂ§ßËá¥Â¶Ç‰∏ãÔºö Â¢ûÂä†Êàñ‰øÆÊîπ V put(K key, V value) Â≠òÂÇ® key Âíå valueÔºåÂ¶ÇÊûú key Â∑≤ÁªèÂ≠òÂú®Âàô‰ºöÂ∞ÜÂéüÊù•ÁöÑ value ÊõøÊç¢‰∏∫Êñ∞ÁöÑ value void putAll(Map&lt;? extends K, ? extends V&gt; m) Â∞Ü m ‰∏≠ÁöÑ key Âíå value Ê∑ªÂä†Âà∞ÂΩìÂâç Map ‰∏≠ Âà†Èô§ V remove(Object key) ÁßªÈô§ÊåáÂÆöÁöÑ key ‰ª•ÂèäÂÖ≥ËÅîÁöÑ value void clear() Ê∏ÖÁ©∫ Map Êü•Êâæ V get(Object key) Ëé∑Âèñ key ÂÖ≥ËÅîÁöÑ value boolean containsKey(Object key) Âà§Êñ≠ÂΩìÂâç Map ÊòØÂê¶ÂåÖÂê´ÊåáÂÆöÁöÑ key boolean containsValue(Object value) Âà§Êñ≠ÂΩìÂâçMap ÊòØÂê¶ÂåÖÂê´ÊåáÂÆöÁöÑ value boolean isEmpty() Âà§Êñ≠ÂΩìÂâç Map ÊòØÂê¶‰∏∫Á©∫ int size() Ëé∑ÂèñÂΩìÂâç Map ÁöÑÂ§ßÂ∞è ÂÖ∂ÂÆÉ Set keySet() Â∞Ü key ÁîüÊàê Set ÈõÜÂêà Collection values() Â∞Ü value ÁîüÊàêÈõÜÂêà Set&lt;Map.Entry&lt;K, V&gt;&gt; entrySet() Â∞Ü Map ‰∏≠‰øùÂ≠òÁöÑÂÖÉÁ¥†ÁîüÊàê Set ÈõÜÂêàÔºå‰∏ÄËà¨Áî®‰∫éÈÅçÂéÜÈõÜÂêà ‰ªé Map Êé•Âè£ÊâÄÊèê‰æõÁöÑÊñπÊ≥ïÊù•ÁúãÔºåÂ§ßÈÉ®ÂàÜÊñπÊ≥ïÂÖ∂ÂÆû‰∏é Collection Êé•Âè£‰∏≠Êó†ÂºÇÔºåÂè™ÊòØÂú® Collection ‰∏≠ÊòØÂØπÂçï‰∏™ÂÖÉÁ¥†ËøõË°åÊìç‰ΩúÔºå‰ΩÜÊòØÂú® Map Êé•Âè£‰∏≠ÊòØÂØπ key-value ËøôÁßçÂÖ≥ËÅîÂÖÉÁ¥†ËøõË°åÊìç‰Ωú„ÄÇ ÊÄªÁªì Java ÈõÜÂêàÊ°ÜÊû∂‰ª• Colleciton Âíå Map ‰∏∫Âü∫Á°ÄÔºåÈ´òÂ∫¶ÊäΩË±°‰∫ÜÂØπÂçï‰∏™ÂÖÉÁ¥†‰ª•ÂèäÈîÆÂÄºÂØπÁöÑÊìç‰ΩúÔºåËÄåÂú®Ê≠§Âü∫Á°Ä‰∏ä‰∏∫‰∫ÜÂáèËΩª‰∏öÂä°ÂºÄÂèëÈöæÂ∫¶ÔºåÈõÜÂêàÊ°ÜÊû∂ÂèàÊèê‰æõ‰∫ÜÂ§ö‰∏™ÂÆûÁé∞Á±ª‰ª•‰æõ‰ΩøÁî®ÔºåÂ∞ΩÁÆ°ÁúãËµ∑Êù•ÈîôÁªºÂ§çÊùÇÔºå‰ΩÜÊòØÂè™Ë¶Å‰∫ÜËß£Ê†∏ÂøÉÁöÑÊé•Âè£‰πãÈó¥ÁöÑÁªßÊâøÂÖ≥Á≥ª‰æøÂèØÂØπÈõÜÂêàÊ°ÜÊû∂Êúâ‰∏™ËæÉ‰∏∫Ê∏ÖÊô∞ÁöÑËÆ§ËØÜ„ÄÇ]]></content>
      <categories>
        <category>JavaÂü∫Á°Ä</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>ÈõÜÂêà</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[AndroidÂêØÂä®ËøáÁ®ãÁÆÄÊûêÔºàÂõõÔºâ‰πãLanucherÁöÑÂêØÂä®]]></title>
    <url>%2F2018%2F02%2F28%2FAndroid%E5%90%AF%E5%8A%A8%E8%BF%87%E7%A8%8B%E7%AE%80%E6%9E%90%EF%BC%88%E5%9B%9B%EF%BC%89%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä ÈÄöËøáAndroidÂêØÂä®ËøáÁ®ãÁÆÄÊûêÔºà‰∏âÔºâËøôÁØáÊñáÁ´†Êàë‰ª¨Â∑≤ÁªèÂ§ßËá¥‰∫ÜËß£‰∫ÜÊúçÂä°ÊòØÂ¶Ç‰ΩïË¢´ÂêØÂä®ÁöÑÔºåÊé•ÁùÄÊú¨ÊñáÂ∞Ü‰ºöÂàÜÊûêÁ≥ªÁªüÂêØÂä®ÁöÑÊúÄÂêé‰∏ÄÊ≠•ÔºåÂç≥ Launcher ÁöÑÂêØÂä®„ÄÇ LanucherÁöÑÂêØÂä®ÊµÅÁ®ã Âú® SystemServer ‰∏≠ÂêØÂä®ÁöÑËøô‰πàÂ§öÊúçÂä°ÂΩì‰∏≠ ActivityManagerService ÊòØË¥üË¥£ÂõõÂ§ßÁªÑ‰ª∂ÁöÑÂêØÂä®„ÄÅÂàáÊç¢„ÄÅË∞ÉÂ∫¶ÁöÑÔºåÊâÄ‰ª• Launcher ÁöÑÂêØÂä®‰∏é ActivityManagerService Á¶ª‰∏çÂºÄÂÖ≥Á≥ª frameworks/base/services/java/com/android/server/SystemServer.java 1234567891011121314151617181920private void startOtherServices() &#123; .... // We now tell the activity manager it is okay to run third party // code. It will call back into us once it has gotten to the state // where third party code can really run (but before it has actually // started launching the initial applications), for us to complete our // initialization. mActivityManagerService.systemReady(new Runnable() &#123; @Override public void run() &#123; .... try &#123; startSystemUi(context); &#125; catch (Throwable e) &#123; reportWtf("starting System UI", e); &#125; ... &#125;);&#125; ÂèØ‰ª•ÁúãÂà∞Âú® startOtherServices ‰∏≠Ë∞ÉÁî®‰∫Ü mActivityManagerService ÁöÑ systemReady ÊñπÊ≥ïÔºåÂπ∂Âú®‰º†ÂÖ•ÁöÑ Runnable ÂØπË±°‰∏≠ÂêØÂä®‰∫Ü SystemUiÔºåÊé•ÁùÄÁªßÁª≠Êü•Áúã systemReady ÊñπÊ≥ï frameworks/base/services/core/java/com/android/server/am/ActivityManagerService.java 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849public void systemReady(final Runnable goingCallback) &#123; synchronized(this) &#123; //Á¨¨‰∏ÄÊ¨°‰∏∫false‰∏ç‰ºöËøõÂÖ• if (mSystemReady) &#123; // If we're done calling all the receivers, run the next "boot phase" passed in // by the SystemServer if (goingCallback != null) &#123; goingCallback.run(); &#125; return; &#125; .... mSystemReady = true; &#125; ... synchronized(this) &#123; // Make sure we have no pre-ready processes sitting around. if (mFactoryTest == FactoryTest.FACTORY_TEST_LOW_LEVEL) &#123; .... &#125; &#125; ... //ÊâßË°å‰º†ÂÖ•ÁöÑRunnableÂØπË±° if (goingCallback != null) goingCallback.run(); ... synchronized (this) &#123; // Only start up encryption-aware persistent apps; once user is // unlocked we'll come back around and start unaware apps startPersistentApps(PackageManager.MATCH_DIRECT_BOOT_AWARE); // Start up initial activity. mBooting = true; // Enable home activity for system user, so that the system can always boot ... //ÂêØÂä®LanucherÁöÑ‰∏ªActivity startHomeActivityLocked(currentUserId, "systemReady"); ... mStackSupervisor.resumeFocusedStackTopActivityLocked(); mUserController.sendUserSwitchBroadcastsLocked(-1, currentUserId); &#125;&#125; Âú® systemReady ÊñπÊ≥ï‰∏≠‰ºöË∞ÉÁî® startHomeActivityLocked 123456789101112131415161718192021222324252627282930boolean startHomeActivityLocked(int userId, String reason) &#123; if (mFactoryTest == FactoryTest.FACTORY_TEST_LOW_LEVEL &amp;&amp; mTopAction == null) &#123; // We are running in factory test mode, but unable to find // the factory test app, so just sit around displaying the // error message and don't try to start anything. return false; &#125; //ÊûÑÂª∫ÂêØÂä®Lanucher‰∏ªActivityÁöÑIntentÂØπË±° Intent intent = getHomeIntent(); ActivityInfo aInfo = resolveActivityInfo(intent, STOCK_PM_FLAGS, userId); if (aInfo != null) &#123; intent.setComponent(new ComponentName(aInfo.applicationInfo.packageName, aInfo.name)); // Don't do this if the home app is currently being // instrumented. aInfo = new ActivityInfo(aInfo); aInfo.applicationInfo = getAppInfoForUser(aInfo.applicationInfo, userId); ProcessRecord app = getProcessRecordLocked(aInfo.processName, aInfo.applicationInfo.uid, true); if (app == null || app.instrumentationClass == null) &#123; intent.setFlags(intent.getFlags() | Intent.FLAG_ACTIVITY_NEW_TASK); //ÂêØÂä®Lanucher‰∏ªActivity mActivityStarter.startHomeActivityLocked(intent, aInfo, reason); &#125; &#125; else &#123; Slog.wtf(TAG, "No home screen found for " + intent, new Throwable()); &#125; return true;&#125; ËøõÂÖ• startHomeActivityLocked ÊñπÊ≥ï‰πãÂêéÂèØ‰ª•ÁúãÂà∞Ë∞ÉÁî®‰∫Ü getHomeIntent ËøîÂõû‰∫Ü‰∏Ä‰∏™ IntentÔºåÊàë‰ª¨ÈÉΩÁü•ÈÅìÂêØÂä®‰∏Ä‰∏™ Activity ÁöÑ‰ø°ÊÅØÈÉΩÊòØÈÄöËøá Intent ËøõË°å‰º†ÈÄíÁöÑÔºåÊâÄ‰ª•ÁªßÁª≠Êü•Áúã getHomeIntent ÁúãÁúã Intent ÂåÖÂê´ÁöÑ‰ø°ÊÅØ 12345678910Intent getHomeIntent() &#123; //mTopAction ÊòØ android.intent.action.MAIN Intent intent = new Intent(mTopAction, mTopData != null ? Uri.parse(mTopData) : null); intent.setComponent(mTopComponent); intent.addFlags(Intent.FLAG_DEBUG_TRIAGED_MISSING); if (mFactoryTest != FactoryTest.FACTORY_TEST_LOW_LEVEL) &#123; intent.addCategory(Intent.CATEGORY_HOME); &#125; return intent;&#125; Âú® getHomeIntent ‰∏≠È¶ñÂÖàÂàõÂª∫‰∫Ü‰∏Ä‰∏™ Intent ÂØπË±°ÔºåÁÑ∂ÂêéÁªôËøô‰∏™ÂØπË±°Â¢ûÂä†‰∫Ü‰∏Ä‰∏™ categoryÔºåcategory ÂØπÂ∫îÁöÑ‰ø°ÊÅØÊòØ android.intent.category.HOMEÔºåÊü•Êâæ Lanucher3 ÁöÑ AndroidManifest.xml ÂèØ‰ª•ÁúãËßÅ 12345678910111213141516171819&lt;activity android:name="com.android.launcher3.Launcher" android:launchMode="singleTask" android:clearTaskOnLaunch="true" android:stateNotNeeded="true" android:theme="@style/Theme" android:windowSoftInputMode="adjustPan" android:screenOrientation="nosensor" android:configChanges="keyboard|keyboardHidden|navigation" android:resumeWhilePausing="true" android:taskAffinity="" android:enabled="true"&gt; &lt;intent-filter&gt; &lt;action android:name="android.intent.action.MAIN" /&gt; &lt;category android:name="android.intent.category.HOME" /&gt; &lt;category android:name="android.intent.category.DEFAULT" /&gt; &lt;category android:name="android.intent.category.MONKEY"/&gt; &lt;/intent-filter&gt;&lt;/activity&gt; ËøôËØ¥ÊòéÂç≥Â∞ÜÂêØÂä®ÁöÑ Activity ÊòØ com.android.launcher3.LauncherÔºåÁé∞Âú®ÂõûÂà∞ startHomeActivityLocked ÊñπÊ≥ï‰∏≠ÔºåÁªßÁª≠ÂæÄ‰∏ãÁúãÂèØ‰ª•Áü•ÈÅìÂú®ÂæóÂà∞ Intent ÂØπË±°‰πãÂêéÔºåÊúÄÂêéÊòØÈÄöËøá ActivityStarter ÁöÑ startHomeActivityLocked ÂêØÂä®‰∫Ü Launcher„ÄÇ‰πãÂêéÁöÑÈÉ®ÂàÜÁî±‰∫éÊ∂âÂèäÂà∞ Lanucher Ê∫êÁ†ÅÂíå Activity ÂêØÂä®ÁöÑÁªÜËá¥ÊµÅÁ®ãÔºåÊâÄ‰ª•Â∞±ÊöÇÊó∂‰∏çÂÅöÂàÜÊûê‰∫Ü„ÄÇ ÊÄªÁªì ÈÄöËøáÂõõÁØáÊñáÁ´†ÁöÑÂàÜÊûêÂØπÁ≥ªÁªüÂêØÂä®ÁöÑËøáÁ®ãÊúâ‰∫Ü‰∏Ä‰∏™Â§ßËá¥ÁöÑ‰∫ÜËß£Ôºå‰ΩÜÊòØÈôê‰∫éÊ∞¥Âπ≥ÊúâÈôêÔºåÊúâ‰∫õÈÉ®ÂàÜÂàÜÊûêÁöÑÊØîËæÉÁ≤óÁ≥ôÔºåÂ∏åÊúõ‰πãÂêéÂú®Ê∞¥Âπ≥ÊèêÂçá‰πãÂêéËÉΩÂ§üÂØπÂêÑ‰∏™ÈÉ®ÂàÜËøõË°åËøõ‰∏ÄÊ≠•ÁöÑÂÆåÂñÑÔºå‰æãÂ¶ÇÔºöBinder„ÄÅActivityManagerService„ÄÅAcitvity ÁöÑÂêØÂä®ËøáÁ®ãÁ≠âÁ≠â„ÄÇ ÊúÄÂêéÂÄüÁî® Gityuan AndroidÁ≥ªÁªüÂºÄÁØá‰∏≠ÁöÑ‰∏ÄÂº†ÂõæÁâáËØ¥ÊòéÁ≥ªÁªüÂêØÂä®ÁöÑËøáÁ®ã Thanks AndroidÁ≥ªÁªüÂêØÂä®ÊµÅÁ®ãÔºàÂõõÔºâLauncherÂêØÂä®ËøáÁ®ã‰∏éÁ≥ªÁªüÂêØÂä®ÊµÅÁ®ã]]></content>
      <categories>
        <category>AndroidËøõÈò∂</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>Ê∫êÁ†ÅÂàÜÊûê</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ÁôΩËØùÊ∑±Â∫¶Â≠¶‰π†-Âü∫Á°ÄÁØá]]></title>
    <url>%2F2018%2F01%2F28%2F%E7%99%BD%E8%AF%9D%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%9F%BA%E7%A1%80%E7%AF%87%2F</url>
    <content type="text"><![CDATA[Êî∂Ëé∑ „ÄåÁôΩËØùÊ∑±Â∫¶Â≠¶‰π†‰∏éTensorFlow„ÄçÁöÑÂü∫Á°ÄÁØá‰∏ªË¶ÅÂÜÖÂÆπ‰∏∫‚ÄúÊú∫Âô®Â≠¶‰π†ÊòØ‰ªÄ‰πà‚Äù„ÄÅ‚ÄúÊ∑±Â∫¶Â≠¶‰π†ÊòØ‰ªÄ‰πà‚Äù‰ª•Âèä‚ÄúTensorFlow‚ÄùÊ°ÜÊû∂ÁâπÊÄß‰∏éÂÆâË£ÖÔºåÈÄöËøáÈòÖËØªÂü∫Á°ÄÁØáÁöÑÂÜÖÂÆπÂ§ßËá¥‰∫ÜËß£‰∫Ü‰ª•‰∏ãÂá†‰∏™ÈÉ®ÂàÜÔºö Êú∫Âô®Â≠¶‰π†‰∏éÊ∑±Â∫¶Â≠¶‰π†ÁöÑÊ¶ÇÂøµ Êú∫Âô®Â≠¶‰π†‰∏éÊ∑±Â∫¶Â≠¶‰π†ÁöÑÂå∫Âà´ Êú∫Âô®Â≠¶‰π†ÁöÑÂ∏∏Áî®ÊñπÊ≥ï ÂÆâË£ÖTensorFlowÊ°ÜÊû∂ Á¨¨‰∏ÄÁ´† Êú∫Âô®Â≠¶‰π†ÊòØ‰ªÄ‰πà Êú∫Âô®Â≠¶‰π†ÊòØ‰∫∫Á±ªÂÆö‰πâ‰∏ÄÂÆöÁöÑËÆ°ÁÆóÊú∫ÁÆóÊ≥ïÔºåËÆ©ËÆ°ÁÆóÊú∫Ê†πÊçÆËæìÂÖ•ÁöÑÊ†∑Êú¨Âíå‰∏Ä‰∫õ‰∫∫Á±ªÁöÑÂπ≤È¢ÑÊù•ÊÄªÁªìÂπ∂ÂΩíÁ∫≥ÂÖ∂ÁâπÂæÅÂíåÁâπÁÇπÔºåÂπ∂Áî®Ëøô‰∫õÁâπÂæÅÂíåÁâπÁÇπ‰∏é‰∏ÄÂÆöÁöÑÂ≠¶‰π†ÁõÆÊ†áÂΩ¢ÊàêÊò†Â∞ÑÂÖ≥Á≥ªÔºåËøõËÄåËá™Âä®ÂåñÂú∞ÂÅöÂá∫Áõ∏Â∫îÂèçÂ∫îÁöÑËøáÁ®ã„ÄÇ Êú∫Âô®Â≠¶‰π†ÁöÑÁõÆÁöÑ ‰∫∫Á±ªÂ≠¶‰π†ÁöÑÁõÆÁöÑÊòØÊéåÊè°Áü•ËØÜ„ÄÅÊéåÊè°ËÉΩÂäõ„ÄÅÊéåÊè°ÊäÄÂ∑ßÁÑ∂ÂêéÊúÄÁªàËÉΩÂ§üËøõË°åÊØîËæÉÂ§çÊùÇÁöÑÊàñËÄÖÈ´òË¶ÅÊ±ÇÁöÑÂ∑•‰Ωú„ÄÇÁõ∏‰ººÁöÑÊú∫Âô®Â≠¶‰π†ÁöÑÊúÄÁªàÁõÆÁöÑÂú®‰∫éËÆ©ËÆ°ÁÆóÊú∫ËÉΩÂ§üÁã¨Á´ãÊàñËÄÖÂçäÁã¨Á´ãÁöÑËøõË°åÁõ∏ÂØπÂ§çÊùÇÊàñËÄÖÈ´òË¶ÅÊ±ÇÁöÑÂ∑•‰Ωú„ÄÇ Êú∫Âô®Â≠¶‰π†‰∏éÈùûÊú∫Âô®Â≠¶‰π†ÁöÑÂå∫Âà´Âú®‰∫éËøáÂéªÁöÑËÆ°ÁÆóÊú∫Âú®Á®ãÂ∫èÁªôÂÆöÁöÑÊÉÖÂÜµ‰∏ãÔºåÂÖ∂Ë°å‰∏∫ÈÄªËæëÂ∞±Â∑≤ÁªèÁ°ÆÂÆö‰∫ÜÔºåËÄåÊú∫Âô®Â≠¶‰π†ÂàôÈúÄË¶ÅÈÄöËøáÊ†∑Êú¨ËøõË°åÁªüËÆ°ÂΩíÁ∫≥ÁÑ∂ÂêéÊâç‰ºöÁ°ÆÂÆöÂÖ∂Ë°å‰∏∫ÈÄªËæë„ÄÇÊâÄ‰ª•ÈÄöËøáÊú∫Âô®Â≠¶‰π†ÂèØ‰ª•ËøõË°åÁõ∏ÁâáËØÜÂà´‰ø°ÊÅØ„ÄÅÊñ∞ÈóªÁöÑËá™Âä®ÂàÜÁ±ªÁ≠âÂ∑•‰Ωú„ÄÇÂõ†‰∏∫ËÆ°ÁÆóÊú∫‰∫ãÂÖàÊòØ‰∏ç‰ºöÁü•ÈÅìÈúÄË¶ÅÊèêÂèñÁöÑ‰ø°ÊÅØÂú®ÁªôÂÆöÁöÑÁõ∏Áâá‰∏≠ÊâÄÂÖ∑Â§áÁöÑÁâπÂæÅÔºåÂè™ÊúâÈÄöËøáÊú∫Âô®Â≠¶‰π†‰∏çÊñ≠ÁöÑÁªüËÆ°ÂΩíÁ∫≥ÊâçËÉΩÂæóÂá∫ÈÄÇÂêàËØÜÂà´Â§ßÂ§öÊï∞Áõ∏Áâá‰∏≠ÊâÄÈúÄÊèêÂèñÁöÑ‰ø°ÊÅØÁöÑÊ®°Âûã„ÄÇ Êú∫Âô®Â≠¶‰π†ÁöÑÂàÜÁ±ª ‰ªéÂ≠¶‰π†ÁöÑÁßçÁ±ªÊù•ËØ¥ÔºåÊú∫Âô®Â≠¶‰π†‰∏ÄËà¨ÂàÜ‰∏∫‰∏§ÁßçÔºöÊúâÁõëÁù£Â≠¶‰π†ÂíåÊó†ÁõëÁù£Â≠¶‰π†ÊúâÁõëÁù£Â≠¶‰π†ÊòØÊåáÂÖàÂØπÁªô‰∫àÁöÑÊ†∑Êú¨ËøõË°åÊÄªÁªìÂæóÂá∫ÂàÜÁ±ªËßÑÂàôÔºå‰πãÂêéÊ†πÊçÆËøô‰∏™ËßÑÂàôËøõË°åÂàÜÁ±ªÊìç‰ΩúÔºåÂØπ‰∫éÊúâÁõëÁù£Â≠¶‰π†ËÄåË®ÄÂü∫Êú¨ÂàÜ‰∏∫‰∏â‰∏™ËøáÁ®ãÔºö ËÆ≠ÁªÉ ËÆ≠ÁªÉÁöÑËøáÁ®ã‰∏ªË¶ÅÊòØÊãø‰∏ÄÂÆöÂÖ∑ÊúâÊ†áÁ≠æÁöÑÊ†∑Êú¨ËøõË°åÁªüËÆ°ÂíåÂΩíÁ∫≥ÊÄªÁªìÂá∫‰∏Ä‰∏™Ê®°Âûã È™åËØÅ È™åËØÅÁöÑËøáÁ®ã‰∏ªË¶ÅÊòØÊãø‰∏Ä‰∫õÊú™ÂàÜÁ±ªÁöÑÊ†∑Êú¨ÂØπËøô‰∏™Ê®°ÂûãËøõË°åÈ™åËØÅÔºåÂà§Êñ≠ÂÖ∂ÊòØÂê¶ÂÖ∑ÊúâÊ≥õÂåñÊÄß(generalization)„ÄÇ ÊµãËØï ÊµãËØïÂàôÊòØÁî®‰∏ÄÂÆöÈáèÁöÑÊ†∑Êú¨Âà§Êñ≠Ê®°ÂûãÁöÑËØÜÂà´ËÉΩÂäõ Êó†ÁõëÁù£Â≠¶‰π†ÂàôÊòØÂú®Ëé∑ÂæóËÆ≠ÁªÉÁöÑÂêëÈáèÊï∞ÊçÆÂêéÂú®Ê≤°ÊúâÊ†áÁ≠æÁöÑÊÉÖÂÜµ‰∏ãÂ∞ùËØïÊâæÂá∫ÂÖ∂ÂÜÖÈÉ®Ëï¥Âê´ÂÖ≥Á≥ªÁöÑ‰∏ÄÁßçÊåñÊéòÂ∑•‰Ωú„ÄÇ ÊúâÁõëÁù£Â≠¶‰π†ÂíåÊó†ÁõëÁù£Â≠¶‰π†ÁöÑÂå∫Âà´Âú®‰∫éÂâçËÄÖÁöÑËæìÂÖ•Êï∞ÊçÆÂÖ∑ÊúâÊ†áÁ≠æÔºåËÄåÂêéËÄÖÁöÑËæìÂÖ•Êï∞ÊçÆÊ≤°ÊúâÊ†áÁ≠æ Êú∫Âô®Â≠¶‰π†ÁöÑÂ∏∏Áî®ÊñπÊ≥ï ËÅöÁ±ª ËÅöÁ±ªÊòØÊåáÂ∞ÜÁâ©ÁêÜÂØπË±°ÊàñÊäΩË±°ÂØπË±°ÁöÑÈõÜÂêàÂàÜÁªÑ‰∏∫Áî±ÂΩºÊ≠§Á±ª‰ººÁöÑÂØπË±°ÁªÑÊàêÂ§ö‰∏™Á±ªÁöÑÂàÜÊûêËøáÁ®ã ÁâπÂæÅÂΩ¢ÊÄÅÁöÑÁõ∏ÂêåÊàñËøë‰ººÁöÑÂàíÂú®‰∏Ä‰∏™Ê¶ÇÂøµ‰∏ãÔºåÁâπÂæÅÂΩ¢ÊÄÅ‰∏çÂêåÁöÑÂàíÂú®‰∏çÂêåÊ¶ÇÂøµ‰∏ã ËÅöÁ±ªÂ∏∏Áî®ÁöÑÁÆóÊ≥ïÊúâ K-Means„ÄÅDBSCAN Á≠âÂá†ÁßçÔºåÂÖ∂Âü∫Êú¨ÊÄùË∑ØÈÉΩÊòØÂà©Áî®ÊØè‰∏™ÂêëÈáè‰πãÈó¥ÁöÑË∑ùÁ¶ªÔºå‰ªéËøúËøëÂà§Êñ≠ÊòØÂê¶‰ªéÂ±û‰∫éÂêå‰∏ÄÁ±ªÂà´„ÄÇ ÂõûÂΩí ÂõûÂΩíÊòØ‰∏Ä‰∏™„ÄåÁî±ÊûúÁ¥¢Âõ†„ÄçÁöÑËøáÁ®ãÔºåÊòØ‰∏ÄÁßçÂΩíÁ∫≥ÁöÑÊÄùÊÉ≥ÔºåÂΩìÊàë‰ª¨ÁúãÂà∞Â§ßÈáèÁöÑ‰∫ãÂÆûÊâÄÂëàÁé∞ÁöÑÊ†∑ÊÄÅÂéªÊé®Êñ≠ÂéüÂõ†ÊàñÂÆ¢ËßÇËï¥Âê´ÁöÑÂÖ≥Á≥ªÊòØÂ¶Ç‰ΩïÁöÑ„ÄÇ ÂõûÂΩíÁöÑËÆ≠ÁªÉËøáÁ®ã‰∏ÄËà¨Â¶Ç‰∏ãÔºö Ê†πÊçÆËßÇÂØüÂíåÂΩíÁ∫≥Ê†∑Êú¨ÔºàËÆ≠ÁªÉÈõÜÔºâÁöÑÁªìÊûúÊé®Êñ≠ÂêëÈáèÂíåÊúÄÁªàÁöÑÂáΩÊï∞ÂÄºÂëàÁé∞Â¶Ç‰∏ãÊò†Â∞ÑÂÖ≥Á≥ª \[ y=f(x)=wx+b \] ËøôÈáåÁöÑ \(w\) Âíå \(x\) ÂàÜÂà´ÊòØ \(1*n\) Âíå \(n*1\) ÁöÑÁü©ÈòµÔºå‰πüÂ∞±ÊòØËØ¥Êé•‰∏ãÊù•ÁöÑÈóÆÈ¢òÊòØÊ±ÇËß£ w Âíå b ‰ª£ÂÖ•Ê†∑Êú¨ÂÄºÔºàÈ™åËØÅÈõÜÔºâÂæóÂà∞ËØØÂ∑ÆÂíå \(Loss\) \[ Loss=\sum_{i=1}^n|wx_i+b-y_i| \] ËøôÈáåÁöÑ \(wx_i+b\) ÊòØÊ†πÊçÆÁ¨¨‰∏ÄÊ≠•Êé®Êñ≠ÂÖ≥Á≥ªËÆ°ÁÆóÂá∫ÁöÑÂÄºÔºå\(y_i\) ÊòØÂÆûÈôÖËßÇÊµãÂà∞ÁöÑÂÄºÔºåÂ∞ÜÊâÄÊúâÊµãËØïÁöÑËØØÂ∑ÆÁõ∏Âä†‰πãÂêéÂç≥ÂèØÂæóÂà∞ÊÄªÁöÑËØØÂ∑ÆÔºå\(Loss\) Ë∂äÂ∞èÂàô‰ª£Ë°®Êò†Â∞ÑÂÖ≥Á≥ªË∂äÁ≤æÁ°Æ ËøôÈáå‰ª•Á∫øÊÄßÂõûÂΩí‰∏∫‰æãÔºåËá≥‰∫éÈùûÁ∫øÊÄßÂõûÂΩíËøáÁ®ãÊòØ‰∏ÄËá¥ÁöÑÔºåÂè™ÊòØÊò†Â∞ÑÂÖ≥Á≥ªÂíå \(Loss\) ÂáΩÊï∞Êúâ‰∫õ‰∏çÂêå„ÄÇ ÂàÜÁ±ª ÂàÜÁ±ªËøô‰∏™Ê¶ÇÂøµ‰∏ÄÁõ¥ÈÉΩÂæàÁÜüÊÇâÔºåÂÖ∑‰ΩìÂà∞Êú∫Âô®Â≠¶‰π†ÂΩì‰∏≠ÂàôÊòØÂà©Áî®Êàë‰ª¨ÁºñÂÜôÁöÑÂàÜÁ±ªÂô®ÂØπÊ†∑Êú¨ËøõË°åÂàÜÁ±ªÔºåËÄåÂà§Êñ≠ËøôÁßçÂàÜÁ±ªÂô®ÊòØÂê¶ÂêàÁêÜÁöÑÂéüÂàôÂú®‰∫éÂè¨ÂõûÁéáÂíåÁ≤æÁ°ÆÁéáËøô‰∏§‰∏™ÊåáÊ†á Âè¨ÂõûÁéáÊòØÊ£ÄÁ¥¢Âá∫ÁöÑÁõ∏ÂÖ≥Ê†∑Êú¨ÂíåÊ†∑Êú¨Â∫ì‰∏≠ÊâÄÊúâÁöÑÁõ∏ÂÖ≥Ê†∑Êú¨ÁöÑÊØîÁéáÔºåË°°ÈáèÁöÑÊòØÂàÜÁ±ªÂô®ÁöÑÊü•ÂÖ®Áéá Á≤æÁ°ÆÁéáÊòØÊ£ÄÁ¥¢Âá∫ÁöÑÁõ∏ÂÖ≥Ê†∑Êú¨Êï∞‰∏éÊ£ÄÁ¥¢Âá∫Ê†∑Êú¨ÊÄªÊï∞ÁöÑÊØîÁéáÔºåË°°ÈáèÁöÑÊòØÂàÜÁ±ªÂô®ÁöÑÊü•ÂáÜÁéá ÂàÜÁ±ªÁöÑËÆ≠ÁªÉËøáÁ®ãÂíåÂõûÂΩíÁöÑËÆ≠ÁªÉËøáÁ®ãÂü∫Êú¨‰∏ÄËá¥Ôºö ËæìÂÖ•Ê†∑Êú¨ÂíåÂàÜÁ±ªÊ†áÁ≠æ Âª∫Á´ãÊò†Â∞ÑÂÅáËØ¥ÁöÑÊüê‰∏™\(y=f(x)\) Ê±ÇËß£Âá∫ÂÖ®Â±ÄÁöÑÊçüÂ§±ÂáΩÊï∞\(Loss\)ÂíåÂæÖÂÆöÁ≥ªÊï∞\(w\)ÁöÑÊò†Â∞ÑÂÖ≥Á≥ªÔºå\(Loss=g(w)\) ÈÄöËøáËø≠‰ª£‰ºòÂåñÈÄêÊ≠•Èôç‰Ωé\(Loss\)ÔºåÊúÄÁªàÊâæÂà∞‰∏Ä‰∏™\(w\)ËÉΩ‰ΩøÂè¨ÂõûÁéáÂíåÁ≤æÁ°ÆÁéáÊª°Ë∂≥ÂΩìÂâçÂú∫ÊôØÈúÄË¶Å Á¨¨‰∫åÁ´† Ê∑±Â∫¶Â≠¶‰π†ÊòØ‰ªÄ‰πà Ê∑±Â∫¶Â≠¶‰π†ÊòØÊåáÂü∫‰∫éÊ∑±Â∫¶Á•ûÁªèÁΩëÁªú„Äådeep neural networks„ÄçÁöÑÂ≠¶‰π†Ôºå‰πüÂ∞±ÊòØÊ∑±Â∫¶‰∫∫Â∑•Á•ûÁªèÁΩëÁªúÊâÄËøõË°åÁöÑÂ≠¶‰π†ËøáÁ®ã„ÄÇ Ê∑±Â∫¶Á•ûÁªèÁΩëÁªúÁöÑÁªÑÊàê Ê∑±Â∫¶Á•ûÁªèÁΩëÁªúÁî±Â§ö‰∏™Á•ûÁªèÂÖÉÁªÑÊàêÔºåËÄåÁ•ûÁªèÂÖÉÊòØ‰∫∫Á±ªÂèóÂà∞ÁîüÁâ©Á•ûÁªèÁªÜËÉûÁªìÊûÑÂêØÂèëËÄåÁ†îÁ©∂Âá∫ÁöÑ‰∏ÄÁßçÁÆóÊ≥ï‰ΩìÁ≥ªÔºå‰∏Ä‰∏™ÂÆåÊï¥ÁöÑÁ•ûÁªèÂÖÉÁî±Á∫øÊÄßÊ®°ÂûãÂíåÊøÄÂä±ÂáΩÊï∞‰∏§ÈÉ®ÂàÜÈ¶ñÂ∞æÁõ∏Êé•ÁªÑÊàê„ÄÇÂü∫Êú¨Ê®°ÂûãÂ¶Ç‰∏ãÔºöÂÖ∂‰∏≠\(wx+b\)ÊòØÁ∫øÊÄßÊ®°ÂûãÔºå\(\int\)Ë°®Á§∫ÊøÄÂä±ÂáΩÊï∞ Â∏∏ËßÅÁöÑÊøÄÂä±ÂáΩÊï∞ÊúâÂ¶Ç‰∏ãÂá†ÁßçÔºö Sigmoid ÂáΩÊï∞ \[ f(x)={1 \over 1+e^{-(wx+b)}} \] Tanh ÂáΩÊï∞ \[ tanh(x)={e^x-e^{-x}\over e^x+e^{-x}} \] ReLu ÂáΩÊï∞ \[ y=max(x,0) \] Linear ÂáΩÊï∞ \[ f(x)=x \] ÂØπ‰∫éÁ•ûÁªèÁΩëÁªúËÄåË®Ä‰∏ªË¶ÅÂàÜ‰∏∫‰∏âÂ±ÇÔºöËæìÂÖ•Â±Ç (input layer)„ÄÅÈöêËóèÂ±Ç (hidden layer)„ÄÅËæìÂá∫Â±Ç (output layer) ËæìÂÖ•Â±ÇÁõ¥Êé•Êé•Êî∂ËæìÂÖ•ÁöÑÂêëÈáèÔºå‰∏çÂØπÊï∞ÊçÆËøõË°å‰ªª‰ΩïÂ§ÑÁêÜ ÈöêËóèÂ±ÇÂèØ‰ª•Êúâ‰∏ÄÂ±ÇÊàñËÄÖÂ§öÂ±Ç ËæìÂá∫Â±ÇÊòØÊúÄÂêé‰∏ÄÂ±ÇÔºåÁî®‰∫éËæìÂá∫Êï¥‰∏™ÁΩëÁªúÂ§ÑÁêÜÁöÑÂÄºÔºåËøô‰∏™ÂÄºÂèØËÉΩÊòØ‰∏Ä‰∏™ÂàÜÁ±ªÂêëÈáèÂÄºÔºå‰πüÂèØËÉΩÊòØ‰∏Ä‰∏™Á±ª‰ººÁ∫øÊÄßÂõûÂΩí‰∫ßÁîüÁöÑËøûÁª≠ÁöÑÂÄº Ê∑±Â∫¶Â≠¶‰π†ÂíåÊú∫Âô®Â≠¶‰π†ÁöÑÂå∫Âà´ Ê∑±Â∫¶Â≠¶‰π†ÊòØÊú∫Âô®Â≠¶‰π†ÁöÑÂ≠êÈõÜÔºåÂΩìÊ∑±Â∫¶Â≠¶‰π†Âíå‰º†ÁªüÁöÑÊú∫Âô®Â≠¶‰π†ÁöÑÂå∫Âà´Âú®‰∫éÔºå‰º†ÁªüÁöÑÊú∫Âô®Â≠¶‰π†ÈÄöÂ∏∏ÊòØÈúÄË¶Å‰∫∫ÊèêÂâçËøõË°åÁâπÂæÅÊèêÂèñÔºåÊääÊèêÂèñËøáÁöÑÁâπÂæÅÂêëÈáèÂåñÂêéÂÜç‰∏¢ÁªôÊ®°ÂûãÂéªËÆ≠ÁªÉÔºåËøôÈáå‰∫∫Ë¶ÅÂÅöÁõ∏ÂΩìÁöÑÂâçÁΩÆÂ∑•‰Ωú„ÄÇËÄåÊ∑±Â∫¶Â≠¶‰π†ÈÄöÂ∏∏ÂèØ‰ª•ÈááÁî® End-to-End ÁöÑÂ≠¶‰π†ÊñπÂºèÔºåËæìÂÖ•ÁöÑÂÜÖÂÆπÂè™ÈúÄË¶ÅÂÅöÂæàÂ∞ëÁöÑ‰∏Ä‰∫õÂΩí‰∏ÄÂåñ (normalization)„ÄÅÁôΩÂåñ (whitening) Á≠âÂ§ÑÁêÜÂ∞±ÂèØ‰ª•‰∏¢ÁªôÊ®°ÂûãÂéªËÆ≠ÁªÉÔºåÈÄöÂ∏∏‰∏çÈúÄË¶Å‰∫∫ÂÅöÁâπÂæÅÊèêÂèñÁöÑÂ∑•‰Ωú„ÄÇ Á¨¨‰∏âÁ´† ÂÆâË£Ö TensorFlow Ê°ÜÊû∂ Êú¨Ê¨°ÂÆâË£ÖÁéØÂ¢ÉÊòØ macos„ÄÅPython3 ÂÆâË£Ö Anaconda Âú® Anaconda ÂÆòÁΩë ‰∏ãËΩΩ Python3.6 ÁâàÊú¨ pkg Êñá‰ª∂ËøõË°åÂÆâË£Ö Âª∫Á´ã TensorFlow ËøêË°åÁéØÂ¢É 12conda create -n tensorflow python=3.6source activate tensorflow ÂÆâË£Ö TensorFlow 1pip3 install tensorflow ÊµãËØï TensorFlow 12345678910&gt;&gt;&gt; import tensorflow as tf&gt;&gt;&gt; hello = tf.constant('Hello,TensorFlow!')&gt;&gt;&gt; sess = tf.Session()&gt;&gt;&gt; print(sess.run(hello))b'Hello,TensorFlow!'&gt;&gt;&gt; a = tf.constant(10)&gt;&gt;&gt; b = tf.constant(32)&gt;&gt;&gt; print(sess.run(a + b))42]]></content>
      <categories>
        <category>ËØª‰π¶Á¨îËÆ∞</category>
      </categories>
      <tags>
        <tag>ÁôΩËØùÊ∑±Â∫¶Â≠¶‰π†‰∏éTensorFlow</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[AndroidÂêØÂä®ËøáÁ®ãÁÆÄÊûêÔºà‰∏âÔºâ‰πã SystemServer ËøõÁ®ã]]></title>
    <url>%2F2018%2F01%2F22%2FAndroid%E5%90%AF%E5%8A%A8%E8%BF%87%E7%A8%8B%E7%AE%80%E6%9E%90%EF%BC%88%E4%B8%89%EF%BC%89%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä Âú®AndroidÂêØÂä®ËøáÁ®ãÁÆÄÊûêÔºà‰∫åÔºâ‰∏≠Â∑≤ÁªèÂ§ßËá¥ÂàÜÊûê‰∫Ü zygote ËøõÁ®ãÁöÑÂêØÂä®ËøáÁ®ãÂΩì‰∏≠ÊâÄÂÅöÁöÑ‰∏ªË¶ÅÂ∑•‰ΩúÔºåÊú¨ÁØáÂ∞ÜÁªßÁª≠ÂØπ SystemServer ÁöÑÂêØÂä®ËøáÁ®ãËøõË°åÂàÜÊûê„ÄÇ SystemServer ÂêØÂä®ËøáÁ®ã ‰∏äÊñáËØ¥Âà∞ SystemServer ËøõÁ®ãÂú® ZygoteInit.java ‰∏≠Ë¢´ÂàõÂª∫ÔºåÁÑ∂Âêé‰æø‰ºöÂú® SystemServer ËøõÁ®ãË∞ÉÁî® handleSystemServerProcess ÊñπÊ≥ïÂ§ÑÁêÜ SystemServer ËøõÁ®ãÁöÑÂâ©‰ΩôÂ∑•‰Ωú frameworks/base/core/java/com/android/internal/os/ZygoteInit.java 1234567891011121314151617181920212223242526272829303132333435private static void handleSystemServerProcess( ZygoteConnection.Arguments parsedArgs) throws ZygoteInit.MethodAndArgsCaller &#123; //SystemServer ËøõÁ®ã‰∏çÈúÄË¶ÅËøõË°åSocketÈÄö‰ø°ÔºåÊâÄ‰ª•ÂÖ≥Èó≠ closeServerSocket(); ... //ËÆæÁΩÆËøõÁ®ãÂêç‰∏∫system_server if (parsedArgs.niceName != null) &#123; Process.setArgV0(parsedArgs.niceName); &#125; final String systemServerClasspath = Os.getenv("SYSTEMSERVERCLASSPATH"); ... //ËøôÈáå parsedArgs.invokeWith ‰∏∫ null if (parsedArgs.invokeWith != null) &#123; .... &#125; else &#123; ClassLoader cl = null; if (systemServerClasspath != null) &#123; //ÂàõÂª∫ SystemServer ÁöÑÁ±ªÂä†ËΩΩÂô®ÂØπË±° cl = createSystemServerClassLoader(systemServerClasspath, parsedArgs.targetSdkVersion); Thread.currentThread().setContextClassLoader(cl); &#125; //Â∞ÜÂâ©‰ΩôÂèÇÊï∞‰º†ÈÄíÁªô SystemServer RuntimeInit.zygoteInit(parsedArgs.targetSdkVersion, parsedArgs.remainingArgs, cl); &#125; /* should never reach here */&#125; Âú® handleSystemServerProcess ÊñπÊ≥ï‰∏≠È¶ñÂÖà‰ºöÂÖ≥Èó≠Êéâ Socket ËøûÊé•ÔºåÁÑ∂Âêé‰ºöÊ†πÊçÆ‰º†ÈÄíËøáÊù•ÁöÑÂèÇÊï∞ËÆæÁΩÆËøõÁ®ãÂêçÁß∞ÔºåÂú®ËÆæÁΩÆÂÆåËøõÁ®ãÂêçÁß∞‰πãÂêéÔºåÁî±‰∫é parseArgs ÁöÑÊàêÂëò invokeWith ‰∏∫ nullÔºåÊâÄ‰ª•‰ºöÂà©Áî® systemServerClasspath ÂàõÂª∫ÂØπÂ∫îÁöÑÁ±ªÂä†ËΩΩÂô®ÂØπË±°ÔºåÊúÄÂêé‰ºöÈÄöËøá RuntimeInit ÁöÑ zygoteInit ÊñπÊ≥ïÂ∞ÜÂâ©‰ΩôÂèÇÊï∞‰º†ÈÄíÁªô SystemServer„ÄÇ RuntimeInit ÂàÜÊûê frameworks/base/core/java/com/android/internal/os/RuntimeInit.java 1234567891011public static final void zygoteInit(int targetSdkVersion, String[] argv, ClassLoader classLoader) throws ZygoteInit.MethodAndArgsCaller &#123; if (DEBUG) Slog.d(TAG, "RuntimeInit: Starting application from zygote"); Trace.traceBegin(Trace.TRACE_TAG_ACTIVITY_MANAGER, "RuntimeInit"); redirectLogStreams(); commonInit(); nativeZygoteInit(); applicationInit(targetSdkVersion, argv, classLoader);&#125; zygoteInit ‰∏≠‰æùÊ¨°Ë∞ÉÁî®‰∫Ü nativeZygoteInit Âíå applicationInitÔºåÂÖ∂‰∏≠ÂâçËÄÖÂêØÂä®‰∫Ü‰∏Ä‰∏™Á∫øÁ®ãÊ±†ÔºåËÄåÂêéËÄÖÂàô‰ºöË∞ÉÁî®‰∫Ü SystemServer Á±ªÁöÑ main ÊñπÊ≥ï„ÄÇ ÂêØÂä®Á∫øÁ®ãÊ±† nativeZygoteInit ÂÆûÈôÖ‰∏äÂØπÂ∫îÁùÄ com_android_internal_os_RuntimeInit_nativeZygoteInit frameworks/base/core/jni/AndroidRuntime.cpp 1234567891011121314static const JNINativeMethod gMethods[] = &#123; &#123; "nativeFinishInit", "()V", (void*) com_android_internal_os_RuntimeInit_nativeFinishInit &#125;, &#123; "nativeZygoteInit", "()V", (void*) com_android_internal_os_RuntimeInit_nativeZygoteInit &#125;, &#123; "nativeSetExitWithoutCleanup", "(Z)V", (void*) com_android_internal_os_RuntimeInit_nativeSetExitWithoutCleanup &#125;,&#125;;int register_com_android_internal_os_RuntimeInit(JNIEnv* env)&#123; return jniRegisterNativeMethods(env, "com/android/internal/os/RuntimeInit", gMethods, NELEM(gMethods));&#125; ÁªßÁª≠Êü•Áúã com_android_internal_os_RuntimeInit_nativeZygoteInit ÂèØ‰ª•Áü•ÈÅìÊúÄÁªàË∞ÉÁî®‰∫Ü gCurRuntime ÁöÑ onZygoteInit ÊñπÊ≥ïÔºåËÄå gCurRuntime ÂÆûÈôÖ‰∏äÊòØ‰∏Ä‰∏™ AndroidRuntime ÁöÑÊåáÈíà 1234static void com_android_internal_os_RuntimeInit_nativeZygoteInit(JNIEnv* env, jobject clazz)&#123; gCurRuntime-&gt;onZygoteInit();&#125; onZygoteInit ÁöÑÂÖ∑‰ΩìÂÆûÁé∞Âú® AndroidRuntime ÁöÑÂ≠êÁ±ª AppRuntime ‰∏≠ÔºåÂèØ‰ª•ÁúãÂà∞ÊúÄÁªàÈÄöËøá startThreadPool ÂêØÂä®‰∫ÜÁ∫øÁ®ãÊ±† frameworks/base/cmds/app_process/app_main.cpp 123456virtual void onZygoteInit()&#123; sp&lt;ProcessState&gt; proc = ProcessState::self(); ALOGV("App process: starting thread pool.\n"); proc-&gt;startThreadPool();&#125; Ë∞ÉÁî® SystemServer ÁöÑ main ÊñπÊ≥ï frameworks/base/core/java/com/android/internal/os/RuntimeInit.java 1234567891011121314151617181920private static void applicationInit(int targetSdkVersion, String[] argv, ClassLoader classLoader) throws ZygoteInit.MethodAndArgsCaller &#123; ... //Ê†πÊçÆ argv ÊûÑÂª∫ RuntimeInit.ArgumentsÔºåËøôÈáåÁöÑ argv[] ÂÆûÈôÖ‰∏äÊòØ ‚Äúcom.android.server.SystemServer‚Äù final Arguments args; try &#123; args = new Arguments(argv); &#125; catch (IllegalArgumentException ex) &#123; Slog.e(TAG, ex.getMessage()); // let the process exit return; &#125; // The end of of the RuntimeInit event (see #zygoteInit). Trace.traceEnd(Trace.TRACE_TAG_ACTIVITY_MANAGER); // Remaining arguments are passed to the start class's static main invokeStaticMain(args.startClass, args.startArgs, classLoader);&#125; Âú® applicationInit ÊñπÊ≥ï‰∏≠‰ºöÂØπ argv ËøõË°åËß£ÊûêÂàõÂª∫ RuntimeInit.Arguments ÂèÇÊï∞ÔºåÁÑ∂Âêé‰ºöË∞ÉÁî® invokeStaticMain 12345678910111213141516171819202122232425262728293031323334353637383940private static void invokeStaticMain(String className, String[] argv, ClassLoader classLoader) throws ZygoteInit.MethodAndArgsCaller &#123; Class&lt;?&gt; cl; try &#123; //Ëé∑ÂèñSystemServerÁöÑClassÂØπË±° cl = Class.forName(className, true, classLoader); &#125; catch (ClassNotFoundException ex) &#123; throw new RuntimeException( "Missing class when invoking static main " + className, ex); &#125; Method m; try &#123; //Ëé∑Âèñ main ÊñπÊ≥ï m = cl.getMethod("main", new Class[] &#123; String[].class &#125;); &#125; catch (NoSuchMethodException ex) &#123; throw new RuntimeException( "Missing static main on " + className, ex); &#125; catch (SecurityException ex) &#123; throw new RuntimeException( "Problem getting static main on " + className, ex); &#125; //Ëé∑ÂèñÊñπÊ≥ï‰øÆÈ•∞Á¨¶ÔºåÂà§Êñ≠ÊòØÂê¶ÊòØÂÖ•Âè£ main ÊñπÊ≥ï int modifiers = m.getModifiers(); if (! (Modifier.isStatic(modifiers) &amp;&amp; Modifier.isPublic(modifiers))) &#123; throw new RuntimeException( "Main method is not public and static on " + className); &#125; /* * This throw gets caught in ZygoteInit.main(), which responds * by invoking the exception's run() method. This arrangement * clears up all the stack frames that were required in setting * up the process. */ throw new ZygoteInit.MethodAndArgsCaller(m, argv);&#125; Âú® invokeStaticMain ÊñπÊ≥ï‰∏≠‰ºöÈÄöËøáÊñπÊ≥ïÁ≠æÂêçËé∑ÂèñÂà∞ SystemServer ÁöÑ main ÊñπÊ≥ïÔºå‰πãÂêé‰ºöÊäõÂá∫ MethodAndArgsCaller ÂºÇÂ∏∏ÔºåÁÑ∂ÂêéÂú® ZygoteInit ÁöÑ main ÊñπÊ≥ï‰∏≠ËøõË°åÊçïËé∑ÔºåÊçïËé∑‰πãÂêé‰ºöÊâßË°å MethodAndArgsCaller ÁöÑ run ÊñπÊ≥ïÔºåËÄåÂú® run ÊñπÊ≥ï‰∏≠‰ºöÂÆåÊàêÂØπ SystemServer ÁöÑ main ÊñπÊ≥ïÁöÑË∞ÉÁî® 1234567891011121314151617181920212223242526//MethodAndArgsCaller ÁöÑ run ÊñπÊ≥ïpublic void run() &#123; try &#123; mMethod.invoke(null, new Object[] &#123; mArgs &#125;); &#125; catch (IllegalAccessException ex) &#123; throw new RuntimeException(ex); &#125; catch (InvocationTargetException ex) &#123; Throwable cause = ex.getCause(); if (cause instanceof RuntimeException) &#123; throw (RuntimeException) cause; &#125; else if (cause instanceof Error) &#123; throw (Error) cause; &#125; throw new RuntimeException(ex); &#125;&#125;//ZygoteInit ÊçïËé∑ÂºÇÂ∏∏//frameworks/base/core/java/com/android/internal/os/ZygoteInit.javapublic static void main(String argv[]) &#123; ... &#125; catch (MethodAndArgsCaller caller) &#123; caller.run(); &#125; ....&#125; SystemServer ÂàÜÊûê 123public static void main(String[] args) &#123; new SystemServer().run();&#125; SystemServer ÁöÑ main ÊñπÊ≥ï‰∏≠ÂàõÂª∫‰∫Ü‰∏Ä‰∏™ SystemServer ÂØπË±°ÔºåÂπ∂Ë∞ÉÁî®‰∫ÜÂÖ∂ run ÊñπÊ≥ïÔºåÊâÄ‰ª•ÁªßÁª≠Áúã run ÊñπÊ≥ïÈÉ®ÂàÜ 123456789101112131415161718192021222324252627282930313233343536373839private void run() &#123; try &#123; ... //ÂàõÂª∫ SystemServer ‰∏ªÁ∫øÁ®ãÁöÑ Looper Looper.prepareMainLooper(); // ÂàùÂßãÂåñ mSystemContext createSystemContext(); // ÂàõÂª∫ SystemServiceManager ÂØπË±° mSystemServiceManager = new SystemServiceManager(mSystemContext); LocalServices.addService(SystemServiceManager.class, mSystemServiceManager); &#125; finally &#123; Trace.traceEnd(Trace.TRACE_TAG_SYSTEM_SERVER); &#125; // ÂêØÂä®ÊúçÂä° try &#123; Trace.traceBegin(Trace.TRACE_TAG_SYSTEM_SERVER, "StartServices"); startBootstrapServices(); startCoreServices(); startOtherServices(); &#125; catch (Throwable ex) &#123; Slog.e("System", "******************************************"); Slog.e("System", "************ Failure starting system services", ex); throw ex; &#125; finally &#123; Trace.traceEnd(Trace.TRACE_TAG_SYSTEM_SERVER); &#125; // For debug builds, log event loop stalls to dropbox for analysis. if (StrictMode.conditionallyEnableDebugLogging()) &#123; Slog.i(TAG, "Enabled StrictMode for system server main thread."); &#125; // Loop forever. Looper.loop(); throw new RuntimeException("Main thread loop unexpectedly exited");&#125; Âú® run ÊñπÊ≥ï‰∏≠ÔºåÈ¶ñÂÖàË∞ÉÁî® Looper.prepareMainLooper() ÂàõÂª∫‰∫ÜÂΩìÂâç‰∏ªÁ∫øÁ®ãÁöÑ LooperÔºå‰πãÂêé‰ºöË∞ÉÁî® createSystemContext ÂàùÂßãÂåñ mSystemContext ÂÆû‰æãÔºåËøôÈáåÁöÑ mSystemContext ÊòØ‰∏Ä‰∏™ ContextImpl ÂÆû‰æãÔºå‰∏ªË¶ÅÁî®‰∫éÂàùÂßãÂåñ‰∏Ä‰∫õ ServiceÔºåÊúÄÂêéÂàôÊòØÂêØÂä®Á≥ªÁªüÂêÑÈ°πÊúçÂä°„ÄÇ ÂêØÂä®Á≥ªÁªüÊúçÂä° ‰ªéÂêØÂä®ÊúçÂä°ÁöÑËøáÁ®ã‰∏≠ÁúãÔºåÁ≥ªÁªüÂ∞ÜÊúçÂä°ÂàÜ‰∏∫‰∏âÁ±ªÔºö ÂºïÂØºÊúçÂä°----------startBootstrapServices() Installer„ÄÅActivityManagerService„ÄÅPackageManagerService Á≠â Ê†∏ÂøÉÊúçÂä°----------startCoreServices() BatteryService„ÄÅUsageStatsService„ÄÅWebViewUpdateService ÂÖ∂ÂÆÉÊúçÂä°----------startOtherServices() AlarmManagerService„ÄÅVibratorService Á≠â ËÄåÂØπ‰∫éÊúçÂä°ÁöÑÂêØÂä®ÊñπÂºèËÄåË®Ä‰πüÂàÜ‰∏∫‰∏âÁßçÔºàÂêØÂä®ÊñπÂºè‰∏éÊúçÂä°Á±ªÂà´Âπ∂‰∏çÂØπÂ∫îÔºâÔºö mSystemServiceManager.startService() 12345678910111213141516171819202122232425262728public &lt;T extends SystemService&gt; T startService(Class&lt;T&gt; serviceClass) &#123; try &#123; final String name = serviceClass.getName(); ... //ÂàõÂª∫ServiceÂÆû‰æã final T service; try &#123; Constructor&lt;T&gt; constructor = serviceClass.getConstructor(Context.class); service = constructor.newInstance(mContext); &#125; catch (InstantiationException ex) &#123; .... &#125; // Âä†ÂÖ• List&lt;SystemService&gt; ÂΩì‰∏≠ mServices.add(service); //ÂõûË∞É Service ÁöÑ onStart ÊñπÊ≥ï try &#123; service.onStart(); &#125; catch (RuntimeException ex) &#123; throw new RuntimeException("Failed to start service " + name + ": onStart threw an exception", ex); &#125; return service; &#125; finally &#123; Trace.traceEnd(Trace.TRACE_TAG_SYSTEM_SERVER); &#125;&#125; ‰ªéËøôÈáåÂèØ‰ª•ÁúãÂá∫ startService ÂêØÂä®ÁöÑÊúçÂä°ÈÉΩÊòØ SystemService ÁöÑÂ≠êÁ±ªÔºåÂêØÂä®ÁöÑËøáÁ®ãÊòØÂÖàÂØπÊúçÂä°Á±ªËøõË°åÂä†ËΩΩÔºåÂä†ËΩΩ‰πãÂêéËøõË°åÂÆû‰æãÂåñÔºåÂÆû‰æãÂåñ‰πãÂêéÂàô‰ºöË∞ÉÁî®ÂÆû‰æãÁöÑ onStart ÊñπÊ≥ï„ÄÇ xxxService.main() ËøôÁßçÊñπÂºè‰∏ªË¶ÅÂú®ÂêØÂä®‰ª•‰∏ã‰∏â‰∏™ÊúçÂä°‰∏≠Áî®Âà∞ PackageManagerService OtaDexoptService WindowManagerService ËøôÈáå‰ª• PackageManagerService ‰∏∫‰æãËøõË°åÂàÜÊûê 12345678910111213public static PackageManagerService main(Context context, Installer installer, boolean factoryTest, boolean onlyCore) &#123; // Self-check for initial settings. PackageManagerServiceCompilerMapping.checkProperties(); PackageManagerService m = new PackageManagerService(context, installer, factoryTest, onlyCore); m.enableSystemUserPackages(); //Ê≥®ÂÜåÂêØÂä®ÊúçÂä° ServiceManager.addService("package", m); return m;&#125; ÂèØ‰ª•ÁúãÂà∞Âú® main ÊñπÊ≥ï‰∏≠Áõ¥Êé•ÂàõÂª∫‰∫Ü PackageManagerService ÁöÑÂÆû‰æãÔºåÁÑ∂ÂêéÈÄöËøá ServiceManager ËøõË°åÊ≥®ÂÜåÂêØÂä®„ÄÇ ServiceManager.addService() 1ServiceManager.addService("scheduling_policy", new SchedulingPolicyService()); ServiceManager Ê∂âÂèäÂà∞ Binder ÊöÇ‰∏çÂÅöÂàÜÊûê ‰∏äÊñá‰∏≠ÊèêÂà∞‰∫ÜÊúçÂä°ÁöÑÊ≥®ÂÜåÔºåÂØπ‰∫éÊúçÂä°ÁöÑÊ≥®ÂÜåËÄåË®ÄÂÆûÈôÖ‰∏äÂàÜ‰∏∫‰∏§ÁßçÔºö‰∏ÄÊòØ ServiceManager.addServiceÔºå‰∫åÊòØ LocalServices.addService 12345678910111213141516171819202122232425262728293031/** * This class is used in a similar way as ServiceManager, except the services registered here * are not Binder objects and are only available in the same process. * * Once all services are converted to the SystemService interface, this class can be absorbed * into SystemServiceManager. * * &#123;@hide&#125; */public final class LocalServices &#123; private LocalServices() &#123;&#125; private static final ArrayMap&lt;Class&lt;?&gt;, Object&gt; sLocalServiceObjects = new ArrayMap&lt;Class&lt;?&gt;, Object&gt;(); ... /** * Adds a service instance of the specified interface to the global registry of local services. */ public static &lt;T&gt; void addService(Class&lt;T&gt; type, T service) &#123; synchronized (sLocalServiceObjects) &#123; if (sLocalServiceObjects.containsKey(type)) &#123; throw new IllegalStateException("Overriding service registration"); &#125; sLocalServiceObjects.put(type, service); &#125; &#125; ...&#125; Êü•Áúã LocalServices ÁöÑÁ±ªÊèèËø∞ÂèØ‰ª•Áü•ÈÅì LocalServices ‰∏é ServiceManager Áî®Â§ÑÁ±ª‰ººÔºå‰∏çÂêåÁÇπÂú®‰∫éServiceManager Áî®‰∫é‰∏çÂêåËøõÁ®ãÈó¥Ëé∑Âèñ ServiceÔºåËÄå LocalServices Âè™ËÉΩÂ§üÁî®‰∫éÂêå‰∏ÄËøõÁ®ã‰∏≠Ëé∑Âèñ Service„ÄÇ ÊÄªÁªì Ëá≥Ê≠§Â§ßÊ¶ÇÂ∞±ËÉΩÁü•ÈÅìÂú® SystemServer ÂêØÂä®ËøáÁ®ã‰∏≠‰∏ªË¶ÅÂÅö‰∫Ü‰∏â‰ª∂‰∫ã ÂºÄÂêØÁ∫øÁ®ãÊ±† ÂàõÂª∫ SystemServerManager ÂØπË±°Ë¥üË¥£ÁªßÊâøËá™ SystemService ÁöÑÊúçÂä°ÁöÑÂàõÂª∫„ÄÅÂêØÂä®‰ª•ÂèäÁîüÂëΩÂë®ÊúüÁöÑÁÆ°ÁêÜ ÂêØÂä®Á≥ªÁªüÁöÑÊúçÂä° Thanks AndroidÁ≥ªÁªüÂêØÂä®-SystemServer‰∏äÁØá AndroidÁ≥ªÁªüÂêØÂä®-SystemServer‰∏ãÁØá AndroidÁ≥ªÁªüÊúçÂä°ÁöÑÊ≥®ÂÜåÊñπÂºè AndroidÁ≥ªÁªüÂêØÂä®ÊµÅÁ®ãÔºà‰∏âÔºâËß£ÊûêSyetemServerËøõÁ®ãÂêØÂä®ËøáÁ®ã]]></content>
      <categories>
        <category>AndroidËøõÈò∂</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>Ê∫êÁ†ÅÂàÜÊûê</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaÂü∫Á°Ä‰πãÊ≥®Ëß£]]></title>
    <url>%2F2018%2F01%2F15%2FJava%E5%9F%BA%E7%A1%80%E4%B9%8B%E6%B3%A8%E8%A7%A3%2F</url>
    <content type="text"><![CDATA[ÈóÆÈ¢ò ÂÖ≥‰∫éÊ≥®Ëß£È¶ñÂÖàËØ∑ÊÄùËÄÉ‰∏Ä‰∏ã‰ª•‰∏ãÈóÆÈ¢òÔºö Ê≥®Ëß£ÊòØ‰ªÄ‰πàÔºü Ê≥®Ëß£ÁöÑ‰∏ªË¶Å‰ΩøÁî®Âú∫ÊôØÔºü Ê≥®Ëß£ÂèØ‰ª•ÂàÜ‰∏∫Âì™‰∫õÁ±ªÂûãÔºü Ê≥®Ëß£ÁöÑÂ§ÑÁêÜËøáÁ®ãÔºü Êé•‰∏ãÊù•Êàë‰ª¨Â∞ÜÂØπËøôÂá†‰∏™ÈóÆÈ¢òËøõË°åÊé¢ËÆ® Ê≥®Ëß£ÁÆÄ‰ªã Annotations, a form of metadata, provide data about a program that is not part of the program itself. Annotations have no direct effect on the operation of the code they annotate. ‰∏äËø∞ÊòØÂÆòÊñπÁªôÂá∫ÁöÑÂÖ≥‰∫éÊ≥®Ëß£ÁöÑÂÆö‰πâÔºåÂ§ßËá¥ÊÑèÊÄùÊòØÊ≥®Ëß£ÊòØÂÖÉÊï∞ÊçÆÔºàMetaDataÔºâÁöÑ‰∏ÄÁßçÂΩ¢ÂºèÔºåÂÆÉÁî®‰∫éÊèê‰æõ‰∏Ä‰∫õÂíåÁ®ãÂ∫èÂÖÉÁ¥†ÊúâÂÖ≥ÁöÑÂÖÉÊï∞ÊçÆÔºåËøô‰∫õÊï∞ÊçÆÊú¨Ë∫´‰∏çÂ±û‰∫éÁ®ãÂ∫èÔºåÂπ∂‰∏î‰πü‰∏ç‰ºöÁõ¥Êé•ÂΩ±ÂìçÁ®ãÂ∫èÁöÑÊìç‰Ωú„ÄÇ ‰∏∫‰∫ÜÊõ¥Áõ¥ËßÇÁöÑÁêÜËß£Ê≥®Ëß£ÁöÑÊ¶ÇÂøµÔºåÊàë‰ª¨ËøòÈúÄË¶ÅËøõ‰∏ÄÊ≠•‰∫ÜËß£ÂÖÉÊï∞ÊçÆËøô‰∏™Ê¶ÇÂøµÔºåÂÖ≥‰∫éÂÖÉÊï∞ÊçÆ Wiki ‰∏äÁöÑÊèèËø∞Â¶Ç‰∏ãÔºö Metadata is &quot;data [information] that provides information about other data&quot;ÔºåFor example, a digital image may include metadata that describes how large the picture is, the color depth, the image resolution, when the image was created, the shutter speed, and other data. ÂÖÉÊï∞ÊçÆÊòØÊèèËø∞Êï∞ÊçÆÁöÑÊï∞ÊçÆÔºåÂØπ‰∫é‰∏ÄÂº†Áõ∏ÁâáËÄåË®ÄÂÖÉÊï∞ÊçÆÂåÖÊã¨Áõ∏ÁâáÁöÑÂ§ßÂ∞è„ÄÅËâ≤ÂΩ©Ê∑±Â∫¶„ÄÅÂõæÁâáÁöÑÂàÜËæ®Áéá„ÄÅÂõæÁâáÂª∫Á´ãÊó∂Èó¥‰ª•ÂèäÂø´Èó®ÈÄüÂ∫¶Á≠âÁõ∏ÂÖ≥Êï∞ÊçÆ„ÄÇ ÁªìÂêà‰∏§ËÄÖÂèØ‰ª•ÂæóÂà∞ÔºöÊ≥®Ëß£ÊòØ‰∏ÄÁßçÁî®‰∫éÊèèËø∞Á®ãÂ∫èÂÖÉÁ¥†‰ø°ÊÅØÁöÑ‰øÆÈ•∞Á¨¶ÔºåÂèØ‰ª•Áî®Êù•‰øÆÈ•∞ÂåÖ„ÄÅÁ±ª„ÄÅÊûÑÈÄ†Âô®„ÄÅÊñπÊ≥ï„ÄÅÊàêÂëòÂèòÈáè„ÄÅÂèÇÊï∞„ÄÅÂ±ÄÈÉ®ÂèòÈáè„ÄÇ ËøôÈáåÂÜçÁªìÂêàÂÖ∑‰ΩìÁöÑÂú∫ÊôØËøõË°åÁêÜËß£Ôºö 12@BindView(R.id.toolbar)public Toolbar mToolbar; ÂØπ‰∫éÊàêÂëòÂèòÈáè mToolbar ËÄåË®ÄÔºåÂÖ∂Âü∫Êú¨ÁöÑ‰ø°ÊÅØÂåÖÂê´ width„ÄÅheigth„ÄÅidÔºåÈÄöËøáÊ≥®Ëß£Êàë‰ª¨ËÉΩÂ§üÂæàÊòéÁ°ÆÁöÑÊèèËø∞ÂÆÉÁöÑ id ‰ø°ÊÅØ„ÄÇ Ê≥®Ëß£ÁöÑ‰∏ªË¶Å‰ΩøÁî®Âú∫ÊôØ Ë¶ÅÊòéÁôΩÊ≥®Ëß£ÁöÑ‰ΩøÁî®Âú∫ÊôØÔºåÈ¶ñÂÖàÈúÄË¶Å‰∫ÜËß£ÁöÑÊòØÊ≥®Ëß£ÁöÑ‰∏ªË¶Å‰ΩúÁî®Ôºö Information for the compiler‚Äî Annotations can be used by the compiler to detect errors or suppress warnings. Compile-time and deployment-time processing‚Äî Software tools can process annotation information to generate code, XML files, and so forth. Runtime processing‚Äî Some annotations are available to be examined at runtime. Êé•‰∏ãÊù•‰∏æÂá†‰∏™Â∏∏ËßÅÁöÑ‰æãÂ≠êËØ¥ÊòéÔºö ‰∏∫ÁºñËØëÂô®Êèê‰æõ‰ø°ÊÅØÁî®‰∫éÊ£ÄÊµãÈîôËØØÊàñËÄÖÊäëÂà∂Ë≠¶Âëä 12345@SuppressWarnings("unchecked")public void addItems(@NonNull String item) &#123; List list = new ArrayList(); list.add(item);&#125; ÁºñËØëÊó∂ÂíåÈÉ®ÁΩ≤Êó∂ÈÄöËøáÂØπÊ≥®Ëß£ËøõË°åÂ§ÑÁêÜÁîüÊàê‰ª£Á†Å„ÄÅXML Êñá‰ª∂Á≠â ÊØîËæÉÂ∏∏ËßÅÁöÑÂ¶ÇbutterknifeÔºåbutterknife ËÉΩÂ§üÈÄöËøáÊ≥®Ëß£Ëá™Âä®ÁîüÊàê findViewById ÁöÑ‰ª£Á†ÅÔºåÊúâÂä©‰∫éÂáèËΩªÊ†∑Êùø‰ª£Á†ÅÁöÑË¥üÊãÖ„ÄÇ 12@BindView(R.id.toolbar)public Toolbar mToolbar; ËøêË°åÊó∂ÈÄöËøáÊ≥®Ëß£ËøõË°åÊ£ÄÊü•Â§ÑÁêÜ Âú®ËøêË°åÊó∂Êàë‰ª¨ÂèØ‰ª•ÈÄöËøáÂèçÂ∞ÑÊú∫Âà∂ÂØπÊ≥®Ëß£Êèê‰æõÁöÑ‰ø°ÊÅØËøõË°åÂ§ÑÁêÜÔºåÁÑ∂ÂêéÂÆûÁé∞ÈúÄË¶ÅÁöÑÂäüËÉΩ„ÄÇ Âú®ÊòéÁ°Æ‰∫ÜÊ≥®Ëß£ÁöÑ‰∏ªË¶Å‰ΩúÁî®‰πãÂêéÔºåÊ≥®Ëß£ÁöÑ‰ΩøÁî®Âú∫ÊôØÂ∞±Â∑≤ÁªèÂëº‰πãÊ¨≤Âá∫‰∫ÜÔºåÂΩìÊàë‰ª¨ÈúÄË¶Å‰∏∫Á®ãÂ∫è‰∏≠ÁöÑÂÖÉÁ¥†Êèê‰æõ‰ø°ÊÅØÔºåÂπ∂‰∏îËøô‰∫õ‰ø°ÊÅØÈúÄË¶ÅÂæóÂà∞Â§ÑÁêÜÁöÑÊó∂ÂÄôÔºåÂ∞±ÂèØ‰ª•ËÄÉËôë‰ΩøÁî®Ê≥®Ëß£„ÄÇ Ê≥®Ëß£ÁöÑÂàÜÁ±ª Âü∫Êú¨Ê≥®Ëß£ Java Êèê‰æõ‰∫Ü 5 ‰∏™Âü∫Êú¨ÁöÑ Annotation Ê≥®Ëß£Âêç ‰ΩúÁî® @Override ÈôêÂÆöÈáçÂÜôÁà∂Á±ªÊñπÊ≥ï @Deprecated Ë°®Á§∫Êüê‰∏™Á®ãÂ∫èÂÖÉÁ¥†Â∑≤ÁªèËøáÊó∂ @SuppressWarnings ÊäëÂà∂ÁºñËØëÂô®ÁöÑË≠¶Âëä @SafeVarargs ÊäëÂà∂Â†ÜÊ±°ÊüìË≠¶Âëä @FunctionalInterface ÊåáÂÆöÊüê‰∏™Êé•Âè£ÂøÖÈ°ªÊòØÂáΩÊï∞ÂºèÊé•Âè£ Êé•‰∏ãÊù•ËÅäËÅäÂÆÉ‰ª¨ÁöÑ‰ΩøÁî® Override 123456789101112public class FatherClass &#123; public void overridedMethod() &#123; &#125; &#125;public class BaseAnnotationUse extends FatherClass&#123; @Override public void overridedMethod() &#123; super.overridedMethod(); &#125;&#125; OverrideÁöÑ‰∏ªË¶Å‰ΩúÁî®ÊòØÔºö Â∏ÆÂä©Ê£ÄÊü•ÊòØÂê¶Ê≠£Á°ÆÁöÑÂ§çÂÜô‰∫ÜÁà∂Á±ª‰∏≠ÁöÑÂ∑≤ÊúâÊñπÊ≥ïÔºàÂ¶ÇÊûú‰∏çÂ∞èÂøÉÊãºÂÜôÈîôËØØÊàñËÄÖÊñπÊ≥ïÁ≠æÂêçÂØπ‰∏ç‰∏äË¢´Ë¶ÜÁõñÁöÑÊñπÊ≥ïÔºåÁºñËæëÂô®ÈÉΩ‰ºöÂèëÂá∫Ë≠¶Âëä‰ø°ÊÅØÔºâ Ë°®Á§∫ÂΩìÂâçÊñπÊ≥ïÂÆö‰πâÂ∞ÜË¶ÜÁõñË∂ÖÁ±ªÁöÑÊñπÊ≥ï„ÄÇ Â¶ÇÊûúÊ≤°ÊúâÊ≠£Á°ÆÁöÑÂ§çÂÜôÁà∂Á±ª‰∏≠ÁöÑÊñπÊ≥ïÂàô‰ºöÊèêÁ§∫ Method does not override method from its superclass„ÄÇ Deprecated Âú® FatherClass Â¢ûÂä†Â¶Ç‰∏ãÊñπÊ≥ïÔºö 1234@Deprecatedpublic void deprecatedMethod() &#123;&#125; ÁÑ∂ÂêéÂú® BaseAnnotationUse ‰∏≠Â¢ûÂä†Ôºö 123public void useDeprecatedMethod() &#123; deprecatedMethod();&#125; Ëøô‰∏™Êó∂ÂÄôÂ∞Ü‰ºöÁúãÂà∞ deprecatedMethod() ÊòæÁ§∫Á∫¢Ëâ≤ÔºåÂπ∂‰∏îÁºñËæëÂô®ÊèêÁ§∫deprecatedMethod() Â∑≤ÁªèËøáÊó∂‰∫Ü SuppressWarning ÂØπ BaseAnnotationUse ‰∏≠ÁöÑ useDeprecatedMethod ÊñπÊ≥ïËøõË°åÂ¶Ç‰∏ã‰øÆÊîπ 1234@SuppressWarnings("deprecation")public void useDeprecatedMethod() &#123; deprecatedMethod();&#125; ÈÄöËøáÂ¢ûÂä† SuppressWarning ÊäëÂà∂‰∫Ü Deprecated ÁöÑË≠¶ÂëäÔºådeprecatedMethod() ÁöÑÁ∫¢Ëâ≤Â∞Ü‰ºöÊ∂àÂ§± SafeVarargs 1234@SafeVarargspublic static void faultyMethod(List&lt;String&gt;... listStrArray) &#123; List[] listArray = listStrArray;&#125; ÂΩìÊää‰∏Ä‰∏™‰∏çÂ∏¶Ê≥õÂûãÁöÑÂØπË±°ËµãÁªô‰∏Ä‰∏™Â∏¶Ê≥õÂûãÁöÑÂèòÈáèÁöÑÊó∂ÂÄôÔºåÂæÄÂæÄÂ∞Ü‰ºöÂØºËá¥‚ÄùÂ†ÜÊ±°Êüì‚ÄúÔºåÊâÄ‰ª•Âú® Java 7 ‰∏≠Â¢ûÂä†‰∫Ü SafeVarargs Áî®‰∫éÊäëÂà∂Â†ÜÊ±°ÊüìÁöÑË≠¶ÂëäÔºåSafeVarargs Âè™ËÉΩÁî®Âú®ÂèÇÊï∞ÈïøÂ∫¶ÂèØÂèòÁöÑÊñπÊ≥ïÊàñÊûÑÈÄ†ÊñπÊ≥ï‰∏äÔºå‰∏îÊñπÊ≥ïÂøÖÈ°ªÂ£∞Êòé‰∏∫staticÊàñfinalÔºåÂê¶Âàô‰ºöÂá∫Áé∞ÁºñËØëÈîôËØØ„ÄÇ FunctionalInterface 1234@FunctionalInterfacepublic interface BaseInterface &#123; int add(int x, int y);&#125; FunctionalInterface ÊòØ Java 8 ‰∏ìÈó®‰∏∫ Lambda Ë°®ËææÂºèÊñ∞Â¢ûÁöÑÔºåÈÄöËøá FunctionalInterface ÂèØ‰ª•ÈôêÂà∂Êé•Âè£‰∏≠Âè™ËÉΩÂ≠òÂú®‰∏Ä‰∏™ÊäΩË±°ÊñπÊ≥ïÔºåÂ¶ÇÊûúÂú® BaseInterface Êé•Âè£‰∏≠Êñ∞Â¢ûÊäΩË±°ÊñπÊ≥ïÔºåÁºñËØëÊó∂Â∞Ü‰ºöÊèêÁ§∫ BaseInterface ‰∏çÊòØÂáΩÊï∞ÂºèÊé•Âè£„ÄÇ ÂÖÉÊ≥®Ëß£ JDK Âú® java.lang.annotation ‰∏≠ÂÜÖÁΩÆ‰∫Ü 6 ÁßçÂÖÉÊ≥®Ëß£ÔºåÈô§‰∫Ü Native ‰πãÂ§ñÈÉΩÁî®‰∫é‰øÆÈ•∞ÂÖ∂ÂÆÉÁöÑ Annotation ÂÆö‰πâ Ê≥®Ëß£Âêç ‰ΩúÁî® @Retention ÊåáÂÆöË¢´‰øÆÈ•∞ÁöÑÊ≥®Ëß£ÁöÑ‰øùÁïôÊó∂Èó¥ @Target ÊåáÂÆöË¢´‰øÆÈ•∞ÁöÑÊ≥®Ëß£ÂèØ‰ª•‰øÆÈ•∞ÁöÑÁ®ãÂ∫èÂÖÉÁ¥† @Documented ÊåáÂÆöË¢´‰øÆÈ•∞ÁöÑÊ≥®Ëß£ÂèØ‰ª•Ë¢´ javadoc ÊèêÂèñÊàêÊñáÊ°£ @Inherited ÊåáÂÆöË¢´‰øÆÈ•∞ÁöÑÊ≥®Ëß£ÂÖ∑ÊúâÁªßÊâøÊÄßÔºåÂ¶ÇÊûúÊüê‰∏™Á±ª‰ΩøÁî®‰∫ÜË¢´ @Inherited ‰øÆÈ•∞ÁöÑÊ≥®Ëß£ÔºåÈÇ£‰πàÂÖ∂Â≠êÁ±ªÂ∞ÜËá™Âä®Ë¢´ËØ•Ê≥®Ëß£‰øÆÈ•∞ @Repeatable Áî®‰∫éÂÆö‰πâÈáçÂ§çÊ≥®Ëß£ @Native Ë°®Á§∫ÂÆö‰πâÂ∏∏ÈáèÂÄºÁöÑÂ≠óÊÆµÂèØ‰ª•‰ªéÊú¨Âú∞‰ª£Á†ÅÂºïÁî®„ÄÇ Êé•‰∏ãÊù•‰∏ªË¶Å‰ªãÁªçÂâç‰∫îÁßçÔºå@Native ÂÆûÂú®ÊòØ‰∏çÂ∏∏Áî® Retention 12345678910@Documented@Retention(RetentionPolicy.RUNTIME)@Target(ElementType.ANNOTATION_TYPE)public @interface Retention &#123; /** * Returns the retention policy. * @return the retention policy */ RetentionPolicy value();&#125; RetentionÁöÑÂÆö‰πâÂ¶Ç‰∏äÔºåÂÖ∂Êã•Êúâ‰∏Ä‰∏™ RetentionPolicy Á±ªÂûãÁöÑÊàêÂëòÂèòÈáèÔºåRetentionPolicy ÊòØÊûö‰∏æÁ±ªÔºå‰∏ªË¶ÅÊúâ‰∏â‰∏™Êûö‰∏æÂÄºÔºö RetentionPolicy.SOURCE Ê≥®Ëß£Âè™ËÉΩ‰øùÁïôÂú®Ê∫êÊñá‰ª∂ÂΩì‰∏≠ÔºåÁºñËØëÂô®‰∏ç‰ºöÁºñËØëËøôÁßçÊ≥®Ëß£ RetentionPolicy.CLASS Ê≥®Ëß£ËÉΩÂ§ü‰øùÁïôÂú® class Êñá‰ª∂ÂΩì‰∏≠Ôºå‰ΩÜÊòØÂΩìÁ®ãÂ∫èËøêË°åÁöÑÊó∂ÂÄôÔºåJVM ‰∏çËÉΩÂ§üËé∑ÂèñÂà∞Ê≥®Ëß£‰ø°ÊÅØ RetentionPolicy.RUNTIME Ê≥®Ëß£ËÉΩÂ§ü‰øùÁïôÂú® class Êñá‰ª∂ÂΩì‰∏≠ÔºåÁ®ãÂ∫èËøêË°åÁöÑÊó∂ÂÄôÔºåJVM ‰πüËÉΩÂ§üËé∑ÂèñÂà∞Ê≥®Ëß£‰ø°ÊÅØÔºåÁ®ãÂ∫èËÉΩÂ§üÈÄöËøáÂèçÂ∞ÑÂéªËé∑ÂèñÂà∞ Annotation ‰ø°ÊÅØ Target 123456789101112@Documented@Retention(RetentionPolicy.RUNTIME)@Target(ElementType.ANNOTATION_TYPE)public @interface Target &#123; /** * Returns an array of the kinds of elements an annotation type * can be applied to. * @return an array of the kinds of elements an annotation type * can be applied to */ ElementType[] value();&#125; ElementType ‰πüÊòØ‰∏Ä‰∏™Êûö‰∏æÁ±ªÔºåÂÖ∂Êûö‰∏æÂÄºÂíåÊÑè‰πâÊòØÔºö ElementType.TYPE Ë°®ÊòéÊ≥®Ëß£ÂèØ‰ª•‰øÆÈ•∞Á±ª„ÄÅÊé•Âè£ÊàñËÄÖÊûö‰∏æÂÆö‰πâ ElementType.FIELD Ë°®ÊòéÊ≥®Ëß£ÂèØ‰ª•‰øÆÈ•∞ÊàêÂëòÂèòÈáè ElementType.METHOD Ë°®ÊòéÊ≥®Ëß£ÂèØ‰ª•‰øÆÈ•∞ÊñπÊ≥ïÂÆö‰πâ ElementType.PARAMETER Ë°®ÊòéÊ≥®Ëß£ÂèØ‰ª•‰øÆÈ•∞ÂèÇÊï∞ ElementType.CONSTRUCTOR Ë°®ÊòéÊ≥®Ëß£ÂèØ‰ª•‰øÆÈ•∞ÊûÑÈÄ†ÂáΩÊï∞ ElementType.LOCAL_VARIABLE Ë°®ÊòéÊ≥®Ëß£ÂèØ‰ª•‰øÆÈ•∞Â±ÄÈÉ®ÂèòÈáè ElementType.ANNOTATION_TYPE Ë°®ÊòéÊ≥®Ëß£ÂèØ‰ª•‰øÆÈ•∞Ê≥®Ëß£ ElementType.PACKAGE Ë°®ÊòéÊ≥®Ëß£ÂèØ‰ª•‰øÆÈ•∞ÂåÖÂÆö‰πâ ElementType.TYPE_PARAMETER Ë°®ÊòéÊ≥®Ëß£Âè™ËÉΩÂÆö‰πâÁ®ãÂ∫èÂÖÉÁ¥†ÁöÑ‰øÆÈ•∞ ElementType.TYPE_USE Ë°®ÊòéÊ≥®Ëß£‰∏ç‰ªÖÂèØ‰ª•Âú®ÂÆö‰πâÁ®ãÂ∫èÂÖÉÁ¥†ÁöÑÊó∂ÂÄô‰ΩøÁî®ÔºåËøòÂèØ‰ª•Âú®ÂàõÂª∫ÂØπË±°„ÄÅÁ±ªÂûãËΩ¨Êç¢„ÄÅ‰ΩøÁî® implements ÂÆûÁé∞Êé•Âè£„ÄÅ‰ΩøÁî® throws Â£∞ÊòéÊäõÂá∫ÂºÇÂ∏∏ÁöÑÊó∂ÂÄô‰ΩøÁî® Documented ÂØπ‰∫é‰ΩøÁî®Ë¢´ @Documented ‰øÆÈ•∞ÁöÑÊ≥®Ëß£Âíå‰∏çÂ∏¶ @Documented ‰øÆÈ•∞ÁöÑÊ≥®Ëß£ÔºåÂÖ∂Âå∫Âà´Â¶Ç‰∏ãÔºö annotation_1 annotation_2 Inherited Inherited ÁöÑÁªßÊâø‰ΩúÁî®ÂèØ‰ª•ÈÄöËøá‰ª•‰∏ã‰æãÂ≠êÊù•‰ΩìÁé∞ÔºåÈ¶ñÂÖàÂàõÂª∫‰∏Ä‰∏™ Interitable Ê≥®Ëß£ 12345@Retention(RetentionPolicy.CLASS)@Target(ElementType.TYPE)@Inheritedpublic @interface Inheritable &#123;&#125; ÁÑ∂ÂêéÂàõÂª∫‰∏Ä‰∏™Áî± Inheritable ‰øÆÈ•∞ÁöÑ Base Á±ª 123@Inheritablepublic class Base &#123;&#125; ÊúÄÂêéÂàõÂª∫‰∏Ä‰∏™ÁªßÊâøËá™ Base Á±ªÁöÑ InheritableTest Á±ª 1234567public class InheritableTest extends Base &#123; public static void main(String[] args) &#123; //Âà§Êñ≠ÊòØÂê¶Ë¢´ Inheritable Ê≥®Ëß£ System.out.println(InheritableTest.class.isAnnotationPresent(Inheritable.class)); &#125;&#125; ËøêË°å‰πãÂêéÂèØ‰ª•ÂèëÁé∞ÁªìÊûú‰∏∫ true Repeatable Repeatable ÊòØ Java8 Êñ∞Â¢ûÁöÑÊ≥®Ëß£ÔºåÁî®‰∫éÂÆö‰πâÈáçÂ§çÊ≥®Ëß£ÔºåÂú® Java8 ‰πãÂâçÁöÑÈáçÂ§çÊ≥®Ëß£Âè™ËÉΩÂÜôÊàê‰ª•‰∏ãÂΩ¢Âºè 123456789@Infos(&#123;@Info(name = &quot;zhangsan&quot;), @Info(name = &quot;lisi&quot;)&#125;)private Person mPerson;public class Person &#123; private String mName; private int mAge; private int mHeight; private int mWeight;&#125; ÂÖ∂‰∏≠ Info Âíå Infos ÂàÜÂà´ÊòØ 12345678910111213@Target(ElementType.FIELD)@Retention(RetentionPolicy.CLASS)public @interface Info &#123; String name();&#125;@Retention(RetentionPolicy.CLASS)@Target(ElementType.FIELD)public @interface Infos &#123; Info[] value();&#125; Áî±‰∫é Infos ‰∏≠‰øùÁïô‰∫Ü Info ÁöÑ‰ø°ÊÅØÔºåÊâÄ‰ª• Infos ÁöÑ‰øùÁïôÊó∂Èó¥‰∏çËÉΩÊØî Info Â∞ëÔºåÂê¶ÂàôÁºñËØëÂô®Â∞Ü‰ºöÊä•Èîô„ÄÇÂ¶ÇÊûú Info ÁöÑ‰øùÁïôÊó∂Èó¥ÊòØ RUNTIMEÔºåËÄå Infos ÁöÑ‰øùÁïôÊó∂Èó¥ÊòØ SOURCEÔºåÈÇ£‰πà JVM ÊúÄÁªà‰ºö‰∏¢ÂºÉ Infos ‰ª•Âèä Infos ‰∏≠ÁöÑ Info ‰ø°ÊÅØÔºåËøô‰∏é Info ÊúüÊúõÁöÑ‰øùÁïôÊó∂Èó¥Áõ∏ÁüõÁõæ„ÄÇ Ëá™ÂÆö‰πâÊ≥®Ëß£ JDK ÂÜÖÁΩÆÁöÑÊ≥®Ëß£Âπ∂‰∏çËÉΩÂÆåÂÖ®Êª°Ë∂≥Êàë‰ª¨ÁöÑÈúÄÊ±ÇÔºåÂ§ßÂ§öÊï∞ÊÉÖÂÜµ‰∏ãÊàë‰ª¨ËøòÈúÄË¶ÅÂ≠¶‰ºöËá™ÂÆö‰πâÊ≥®Ëß£ÔºåÂÆö‰πâ‰∏Ä‰∏™Ê≥®Ëß£ÈúÄË¶ÅÁî®Âà∞ @Interface ÂÖ≥ÈîÆÂ≠ó 12345678910111213141516171819@Target(ElementType.FIELD)@Retention(RetentionPolicy.RUNTIME)public @interface BindView &#123; /** * @return View ÁöÑ Id */ int value();&#125;@Target(ElementType.FIELD)@Retention(RetentionPolicy.RUNTIME)public @interface BindOnClickListener &#123; /** * @return ÂÆûÁé∞ OnClickListener Êé•Âè£ÁöÑÁ±ª */ Class&lt;? extends OnClickListener&gt; value();&#125; ‰∏äÈù¢ÂÆö‰πâ‰∫Ü‰∏§‰∏™Ê≥®Ëß£Áî®‰∫éÁªëÂÆö View ÁöÑ id ‰ª•Âèä ÁÇπÂáª‰∫ã‰ª∂ÔºåÂπ∂‰∏îÊåáÂÆö‰∫ÜÊ≥®Ëß£ÂèØ‰ª•‰øÆÈ•∞ÁöÑÂÖÉÁ¥†‰ª•Âèä‰øùÁïôÊó∂Èó¥ÔºåÂèØ‰ª•ÁúãÂà∞ÂÆö‰πâ‰∏Ä‰∏™Ê≥®Ëß£‰∏éÂÆö‰πâ‰∏Ä‰∏™Êé•Âè£ÈùûÂ∏∏Á±ª‰ººÔºåËÄåÂÆûÈôÖ‰∏äÊØè‰∏™Ê≥®Ëß£ÈÉΩÊòØÁªßÊâøËá™ Annotation Êé•Âè£ÁöÑÊé•Âè£ÔºåÂèçÁºñËØë BindView ÁîüÊàêÁöÑ class Êñá‰ª∂ÂèØ‰ª•ÁúãÂà∞ 1234Compiled from "BindView.java"public interface com.rookieyang.runtimeannotation.customizeannotation.BindView extends java.lang.annotation.Annotation &#123; public abstract int value();&#125; ËøôÈáåËá™ÂÆö‰πâÁöÑÊ≥®Ëß£ÈÉΩÊòØÂê´ÊúâÊàêÂëòÂèòÈáèÁöÑÔºåËÄåÊ≥®Ëß£Èô§‰∫ÜÊåâÁÖßÂü∫Êú¨Ê≥®Ëß£„ÄÅÂÖÉÊ≥®Ëß£„ÄÅËá™ÂÆö‰πâÊ≥®Ëß£ËøõË°åÂàÜÁ±ª‰πãÂ§ñÔºåÊàëËøòÂèØ‰ª•Ê†πÊçÆÊòØÂê¶ÂåÖÂê´ÊàêÂëòÂèòÈáèÂ∞ÜÂÆÉÂàÜ‰∏∫‰∏§Á±ªÔºö Ê†áËÆ∞Ê≥®Ëß£ÔºöËøôÁßçÊ≥®Ëß£Ê≤°ÊúâÊàêÂëòÂèòÈáèÔºåÂÆÉ‰ªÖ‰ªÖÈÄöËøáÊòØÂê¶Â≠òÂú®Êù•Êèê‰æõ‰ø°ÊÅØÔºåÂ¶Ç@Override„ÄÅ@Deprecated ÂÖÉÊï∞ÊçÆÊ≥®Ëß£ÔºöËøôÁßçÊ≥®Ëß£ÂåÖÂê´ÊàêÂëòÂèòÈáèÔºåÂÆÉÈÄöËøáÊàêÂëòÂèòÈáèÊèê‰æõÊõ¥Â§öÁöÑ‰ø°ÊÅØÔºåÂ¶Ç@Retention„ÄÅ@Target Ê≥®Ëß£ÁöÑÂ§ÑÁêÜ Âú®‰ΩøÁî®Ëá™ÂÆö‰πâÁöÑÊ≥®Ëß£ÁöÑÊó∂ÂÄôÔºåÂ¶ÇÊûú‰∏çÊèê‰æõÊ≥®Ëß£ÁöÑÂ§ÑÁêÜÂ∑•ÂÖ∑ÔºåÊ≥®Ëß£ÊòØ‰∏ç‰ºöËá™Âä®ÁîüÊïàÁöÑÔºåÊ≥®Ëß£ÁöÑÂ§ÑÁêÜÊñπÊ≥ï‰∏ªË¶ÅÊúâ‰∏§ÁßçÔºå‰∏ÄÁßçÊòØËøêË°åÊó∂Â§ÑÁêÜÊ≥®Ëß£Ôºå‰∏ÄÁßçÊòØÁºñËØëÊó∂Â§ÑÁêÜÊ≥®Ëß£„ÄÇ ËøêË°åÊó∂Â§ÑÁêÜÊ≥®Ëß£ ËøêË°åÊó∂Â§ÑÁêÜÊ≥®Ëß£‰∏ªË¶ÅÂà©Áî® Java ÁöÑÂèçÂ∞ÑÊú∫Âà∂ÔºåÊé•‰∏ãÊù•Â∞ÜÁªìÂêàÂÖ∑‰ΩìÂÆû‰æãËØ¥ÊòéÂ¶Ç‰ΩïÈÄöËøáÂèçÂ∞ÑÂ§ÑÁêÜÊ≥®Ëß£„ÄÇ È¶ñÂÖàÂà©Áî®Ëá™ÂÆö‰πâÊ≥®Ëß£ÈÉ®ÂàÜÂÆö‰πâÁöÑ‰∏§‰∏™Ê≥®Ëß£ BindView Âíå BindOnClickListener ÂØπ View ËøõË°åÊ≥®Ëß£ 123@BindView(R.id.hello_world)@BindOnClickListener(CustomizeOnClickListener.class)private Button mHelloWorld; ÁÑ∂ÂêéÂú® Activity ‰∏≠ÂÆö‰πâ‰∏Ä‰∏™ CustomizeOnClickListener ÂÜÖÈÉ®Á±ª 12345678class CustomizeOnClickListener implements OnClickListener &#123; @Override public void onClick(View view) &#123; Toast.makeText(MainActivity.this, R.string.hello_world, Toast.LENGTH_SHORT).show(); &#125;&#125; Êé•ÁùÄÂÆö‰πâ‰∏Ä‰∏™Â§ÑÁêÜÊ≥®Ëß£ÁöÑÁ±ª 12345678910111213141516171819202122232425262728293031323334353637383940public class AnnotationProcess &#123; public static void process(Object obj) &#123; Field[] fields = obj.getClass().getDeclaredFields(); Activity activity; if (!(obj instanceof Activity)) &#123; throw new RuntimeException("‰º†ÂÖ•ÁöÑÂèÇÊï∞‰∏çÊòØActivity"); &#125; activity = (Activity) obj; for (Field field : fields) &#123; try &#123; View view = null; field.setAccessible(true ); BindView bindView = field.getAnnotation(BindView.class); BindOnClickListener bindOnClickListener = field .getAnnotation(BindOnClickListener.class); //Âà§Êñ≠ÊòØÂê¶ÊòØ View boolean isView = View.class.isAssignableFrom(field.getType()); if (bindView != null &amp;&amp; isView) &#123; view = activity.findViewById(bindView.value()); //ËÆæÁΩÆ obj ÂØπË±°ÂΩì‰∏≠ÁöÑ field ÂÄº‰∏∫ view field.set(obj, view); &#125; if (bindOnClickListener != null &amp;&amp; isView &amp;&amp; view != null) &#123; Class&lt;? extends OnClickListener&gt; listener = bindOnClickListener.value(); //ÂÆû‰æãÂåñ CustomizeOnClickListener ÂÜÖÈÉ®Á±ª OnClickListener onClickListener = listener.getConstructor( obj.getClass()).newInstance(activity); view.setOnClickListener(onClickListener); &#125; &#125; catch (Exception e) &#123; Log.i(obj.getClass().getSimpleName(), e.getMessage()); &#125; &#125; &#125;&#125; ÊúÄÂêéÂú® Activity ‰∏≠Ë∞ÉÁî®Âç≥ÂèØÔºö 1AnnotationProcess.process(this); ÁºñËØëÊó∂Â§ÑÁêÜÊ≥®Ëß£ Áõ∏ÂØπ‰∏éËøêË°åÊó∂Âà©Áî®ÂèçÂ∞ÑÂ§ÑÁêÜÊ≥®Ëß£‰ºöÊúâÊÄßËÉΩÊçüÂ§±ËÄåË®ÄÔºåÁºñËØëÊó∂Â§ÑÁêÜÊ≥®Ëß£Âà©Áî® APTÔºàAnnotation Processing ToolÔºâÂØπÊ≥®Ëß£ËøõË°åÂ§ÑÁêÜÁÑ∂ÂêéÁîüÊàê‰ª£Á†Å„ÄÅXML Êñá‰ª∂ÔºåÂà©Áî® APT ÂéªÂ§ÑÁêÜÊ≥®Ëß£ÊÄßËÉΩÊõ¥Â•Ω„ÄÇÂèÇÁÖß JDK ÊñáÊ°£‰∏≠ÂØπ‰∫é Processor Êé•Âè£ÁöÑÊèèËø∞ÔºåÊàë‰ª¨ÂèØ‰ª•Â§ßËá¥Áü•ÈÅìÊ≥®Ëß£Â§ÑÁêÜÂô®ÁöÑÂ∑•‰ΩúÊµÅÁ®ã If an existing Processor object is not being used, to create an instance of a processor the tool calls the no-arg constructor of the processor class. Next, the tool calls the init method with an appropriate ProcessingEnvironment. Afterwards, the tool calls getSupportedAnnotationTypes, getSupportedOptions, and getSupportedSourceVersion. These methods are only called once per run, not on each round. As appropriate, the tool calls the process method on the Processor object; a new Processor object is not created for each round. ÁºñËØëÂ∑•ÂÖ∑Â∞Ü‰ºöÈÄöËøáÊ≥®Ëß£Â§ÑÁêÜÂô®ÁöÑÊó†ÂèÇÊûÑÈÄ†ÂáΩÊï∞ÂÆû‰æãÂåñ‰∏Ä‰∏™Ê≥®Ëß£Â§ÑÁêÜÂô®ÂØπË±°ÔºåÁÑ∂ÂêéË∞ÉÁî®Ê≥®Ëß£Â§ÑÁêÜÂô®ÁöÑ init ÊñπÊ≥ïÂπ∂‰º†ÂÖ• ProcessingEnvironmentÔºå‰πãÂêéÂàôË∞ÉÁî® getSupportedAnnotationTypesÔºågetSupportedOptionsÂíågetSupportedSourceVersionÔºåÊúÄÂêéÂ∞Ü‰ºöË∞ÉÁî® process ÊñπÊ≥ï„ÄÇ Êé•‰∏ãÊù•Â∞ÜËØ¥ÊòéÂ¶Ç‰ΩïÂà©Áî® APT ÁîüÊàê‰∏Ä‰∏™Á±ªÊñá‰ª∂Áî®‰∫éÊòæÁ§∫ HelloWorldÔºö È¶ñÂÖàÈúÄË¶ÅÊòéÁ°ÆÂ∏åÊúõÁîüÊàêÁöÑÁ±ªÊñá‰ª∂Ôºö 123456789101112package com.rookieyang.myannotationtwo;import android.content.Context;import android.widget.Toast;public class MainActivity_HelloWorld &#123; public static void show(Context context) &#123; Toast.makeText(context, "HelloWorld", Toast.LENGTH_SHORT).show(); &#125;&#125; ÊÉ≥Ë¶ÅÁîüÊàêËøô‰∏™Á±ªÊñá‰ª∂ÈúÄË¶ÅËé∑ÂèñÂà∞‰∏§ÁÇπ‰ø°ÊÅØÔºöÂåÖÂêçÂíåÁ±ªÂêçÔºåÈÄöËøáÂåÖÂêçÂèØ‰ª•‰ΩøÁ±ªÊñá‰ª∂ÁîüÊàêÂú®‰ΩøÁî®Ê≥®Ëß£ÁöÑÂåÖ‰∏ãÔºå‰æø‰∫éËß£ÊûêÊ≥®Ëß£ÁöÑÊó∂ÂÄôÂä†ËΩΩÁ±ªÊñá‰ª∂ÔºåÈÄöËøáÁ±ªÂêçÂä†‰∏ä &quot;_HelloWorld&quot; Á°Æ‰øùÁîüÊàêÁöÑÁ±ªÊñá‰ª∂ÂîØ‰∏ÄÂ≠òÂú®ÔºåÂêåÊó∂‰πüËææÂà∞‰∫Ü‰ΩøÁî®Ê≥®Ëß£ÁöÑÁ±ªÂíåÁîüÊàêÁöÑÁ±ªÁªëÂÆöÁöÑÊïàÊûú„ÄÇ Êé•‰∏ãÊù•ÈúÄË¶ÅÂàõÂª∫‰∏§‰∏™ ModuleÔºåÂÖ∂‰∏≠‰∏Ä‰∏™ÂÆö‰πâ‰∫ÜÊâÄÊúâÁöÑÊ≥®Ëß£ÔºåÂè¶Â§ñ‰∏Ä‰∏™ÂÆö‰πâ‰∫Ü APTÔºå‰πãÊâÄ‰ª•ÈúÄË¶ÅÂÆö‰πâ‰∏§‰∏™ Module ÁöÑÂéüÂõ†ÔºåÂÖ∂‰∏Ä‰∏∫‰∫ÜËÆ©Â∑•Á®ãÁªìÊûÑÊõ¥Ê∏ÖÊô∞ÔºåÂè¶‰∏ÄÊñπÈù¢ÂÆö‰πâ APT ÈúÄË¶ÅÁî®Âà∞ javax ÂåÖ„ÄÇÊï¥‰ΩìÁöÑÂ∑•Á®ãÁªìÊûÑÂ¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö ‰πãÂêéÈúÄË¶Å‰∏∫ annotations-compiler Âíå app Ê®°ÂùóÂºïÂÖ•Áõ∏ÂÖ≥‰æùËµñ 1234567annotations-compiler Ê®°Âùócompile 'com.google.auto.service:auto-service:1.0-rc3'compile project(path: ':annotations')app Ê®°Âùócompile project(path: ':annotations')annotationProcessor project(':annotations-compiler') ÂÖ∂‰∏≠ auto-service ÁöÑ‰ΩúÁî®ÊòØÂ∏ÆÂä©Êàë‰ª¨ÁîüÊàê‰∏ãÂàóÊñá‰ª∂Ôºå‰∏ªË¶Å‰ΩúÁî®ÊòØÂ£∞ÊòéÊ≥®Ëß£Â§ÑÁêÜÂô®„ÄÇ annotationProcessor ÂàôÊòØ‰∏∫Ê®°ÂùóÊåáÂÆöÊ≥®Ëß£Â§ÑÁêÜÂô® ÈÖçÁΩÆ‰πãÂêéÈ¶ñÂÖàÂú® annotations Ê®°ÂùóÂÆö‰πâ‰∏Ä‰∏™ HelloWorld Ê≥®Ëß£ 1234@Target(ElementType.FIELD)@Retention(RetentionPolicy.CLASS)public @interface HelloWorld &#123;&#125; ÁÑ∂ÂêéÂú® annotations-compiler Ê®°ÂùóÁºñÂÜôÂØπÂ∫îÊ≥®Ëß£Â§ÑÁêÜÂô® 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495//Ê†áËØÜ‰∏Ä‰∏™Ê≥®Ëß£Â§ÑÁêÜÂô®@AutoService(Processor.class)public class AnnotationsCompiler extends AbstractProcessor &#123; private Elements mElements; private Filer mFiler; private Messager mMessager; /* * Áî®‰∫éÂàùÂßãÂåñ mElements„ÄÅmFiler„ÄÅmMessager */ @Override public synchronized void init(ProcessingEnvironment processingEnvi) &#123; super.init(processingEnvi); mElements = processingEnvi.getElementUtils(); mFiler = processingEnvi.getFiler(); mMessager = processingEnvi.getMessager(); &#125; /** * * @param elements ÂÆûÈôÖ‰∏ä‰º†ÂÖ•ÁöÑÈÉΩÊòØ &#123;@link #getSupportedAnnotationTypes()&#125; * ‰∏≠ÊîØÊåÅÁöÑÂπ∂‰∏îË¢´Êâ´ÊèèÂà∞Ôºà‰ΩøÁî®ËøáÔºâÊ≥®Ëß£ÂÖÉÁ¥†Ôºå‰æãÂ¶ÇËøôÈáåËé∑ÂèñÂà∞ÁöÑÁ±ªÂÖÉÁ¥†Â∞±ÊòØ HelloWorld Ê≥®Ëß£ * @param roundEnvi ‰∏Ä‰∏™Ê≥®Ëß£Â§ÑÁêÜÂ∑•ÂÖ∑Ê°ÜÊû∂ÔºåÈÄöËøáÂÆÉÂèØ‰ª•Êü•ËØ¢Âà∞‰ΩøÁî®‰∫ÜÊ≥®Ëß£ÁöÑÂÖÉÁ¥† * @return ËøîÂõûÂ§ÑÁêÜÁªìÊûú */ @Override public boolean process(Set&lt;? extends TypeElement&gt; elements, RoundEnvironment roundEnvi) &#123; String packageName; String className; //Ëé∑Âèñ‰ΩøÁî®‰∫Ü HelloWorld Ê≥®Ëß£ÁöÑÂÖÉÁ¥† for (Element element : roundEnvi.getElementsAnnotatedWith(HelloWorld.class)) &#123; //ÈÄöËøá Elements ÂéªËé∑ÂèñÂåÖÂêç packageName = mElements.getPackageOf(element).toString(); //HelloWorld Ê≥®Ëß£Âè™ËÉΩË¢´Áî®Âú®ÊàêÂëòÂèòÈáèÔºåÊâÄ‰ª•ÈÄöËøáËé∑ÂèñÂ§ñÂ±ÇÂÖÉÁ¥†Â∞±ÂèØ‰ª•Ëé∑ÂèñÂà∞‰ΩøÁî®Ê≥®Ëß£ÁöÑÂÖÉÁ¥†ÊâÄÂú®ÁöÑÁ±ª className = element.getEnclosingElement().getSimpleName() + "_HelloWorld"; try &#123; //ÈÄöËøá Filer ÊåáÂÆöÁöÑË∑ØÂæÑ‰∏ãÂàõÂª∫‰∏Ä‰∏™ java Ê∫êÊñá‰ª∂ÔºåÁÑ∂ÂêéÂÜôÂÖ•ÂØπÂ∫îÁöÑ‰ª£Á†Å JavaFileObject javaFileObject = mFiler.createSourceFile( packageName + "." + className); Writer writer = javaFileObject.openWriter(); writer.write("package " + packageName + ";\n\n"); writer.write("import android.content.Context;\n"); writer.write("import android.widget.Toast;\n\n"); writer.write("public class " + className + " &#123;\n\n"); writer.write("\tpublic static void show(Context context) &#123;\n"); writer.write("\t\tToast.makeText(context," + " \"HelloWorld\", Toast.LENGTH_SHORT).show();\n"); writer.write("\t&#125;\n"); writer.write("\n&#125;"); writer.flush(); writer.close(); &#125; catch (IOException e) &#123; e.printStackTrace(); &#125; &#125; return false; &#125; /** * * @return ËøîÂõûÊ≥®Ëß£Â§ÑÁêÜÂô®ÊîØÊåÅÁöÑ Java ÁâàÊú¨ */ @Override public SourceVersion getSupportedSourceVersion() &#123; return SourceVersion.latestSupported(); &#125; /** * * @return ËøîÂõûÊ≥®Ëß£Â§ÑÁêÜÂô®ÊîØÊåÅÁöÑÊ≥®Ëß£ÈõÜÂêà */ @Override public Set&lt;String&gt; getSupportedAnnotationTypes() &#123; Set&lt;String&gt; annotationTypes = new LinkedHashSet&lt;&gt;(); for (Class&lt;? extends Annotation&gt; annotation : getSupportedAnnotations()) &#123; annotationTypes.add(annotation.getCanonicalName()); &#125; return annotationTypes; &#125; /** * * @return ËøîÂõûÊîØÊåÅÁöÑÊ≥®Ëß£Á±ªÂûãÈõÜÂêà */ private Set&lt;Class&lt;? extends Annotation&gt;&gt; getSupportedAnnotations() &#123; Set&lt;Class&lt;? extends Annotation&gt;&gt; annotationSet = new LinkedHashSet&lt;&gt;(); annotationSet.add(HelloWorld.class); return annotationSet; &#125;&#125; Êé•‰∏ãÊù•ËØ¥‰∏ãÂá†‰∏™ÊúâÂä©‰∫éÁêÜËß£Ê≥®Ëß£Â§ÑÁêÜÂô®ÁöÑÁÇπÔºö Elements ÊòØ‰∏Ä‰∏™Ëé∑ÂèñÁ®ãÂ∫èÂÖÉÁ¥†‰ø°ÊÅØÁöÑÊé•Âè£Ôºå‰æãÂ¶ÇËé∑ÂèñÂÖÉÁ¥†ÁöÑÂåÖÂêç„ÄÅÂà§Êñ≠ÊòØÂê¶ÊòØÈáçÂÜôÊñπÊ≥ïÔºå‰æãÂ¶Ç Filer ÂàôÊòØ‰∏Ä‰∏™ÊîØÊåÅÈÄöËøáÊ≥®Ëß£Â§ÑÁêÜÂô®ÂàõÂª∫Êñá‰ª∂ÁöÑÊé•Âè£ÔºåÂèØ‰ª•Áî®‰∫éÂàõÂª∫ ClassÊñá‰ª∂„ÄÅÊ∫êÊñá‰ª∂„ÄÅËµÑÊ∫êÊñá‰ª∂ Messager ÂàôÊòØ‰∏∫Ê≥®Ëß£Â§ÑÁêÜÂô®Êèê‰æõÁöÑËæìÂá∫ÈîôËØØ‰ø°ÊÅØÁöÑÊé•Âè£„ÄÇ Element ‰∏é Elements Âå∫Âà´Âú®‰∫é Element ÊòØËé∑ÂèñÂçï‰∏™Á®ãÂ∫èÂÖÉÁ¥†‰ø°ÊÅØÁöÑÊé•Âè£ÔºåËÄå Elements ÂèØ‰ª•Ëé∑ÂèñÊï¥‰∏™Á®ãÂ∫èÁöÑÂÖÉÁ¥†‰ø°ÊÅØ„ÄÇÈô§‰∫Ü Element ‰πãÂ§ñÔºå‰∏äËø∞Á®ãÂ∫èËøòÂèØ‰ª•ÁúãÂà∞ TypeElementÔºåËÄå TypeElement ÊòØ‰∏Ä‰∏™ÁªßÊâø‰∫Ü Element Êé•Âè£ÁöÑÊé•Âè£ÔºåÁî®‰∫éË°®Á§∫Á±ªÂÖÉÁ¥†„ÄÇÂÆûÈôÖ‰∏ä JDK ËøòÊèê‰æõ‰∫ÜÂæàÂ§öÁªßÊâøËá™ Element ÁöÑÊé•Âè£Áî®‰∫éË°®Á§∫Á®ãÂ∫è‰∏≠ÁöÑÂêÑÈ°πÂÖÉÁ¥†ÔºåÂÖ∑‰ΩìÁöÑ Element ÁªßÊâøÁªìÊûÑÂ¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö Âú®ÁºñÂÜôÂÆåÊ≥®Ëß£Â§ÑÁêÜÂô®‰πãÂêéÔºåÊúÄÂêéÂú® App Ê®°Âùó‰∏≠ÁºñÂÜôÂØπÂ∫îÁöÑË∞ÉÁî®‰ª£Á†ÅÂç≥ÂèØ 123456789101112private void show() &#123; try &#123; //Ëé∑ÂæóÁîüÊàêÁöÑÁ±ªÁöÑ Class ÂØπË±° Class&lt;?&gt; helloClass = Class.forName(getPackageName() + "." + getClass().getSimpleName() + "_HelloWorld"); //Âà©Áî®ÂèçÂ∞ÑÂèñÂæó show ÊñπÊ≥ïÔºåÁÑ∂ÂêéÊâßË°åÂØπÂ∫îÁöÑÊñπÊ≥ïÂç≥ÂèØ Method showMethod = helloClass.getMethod("show", Context.class); showMethod.invoke(this, this); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125;&#125; ÂÆûÈôÖ‰∏äÁºñËØëÊó∂Ê≥®Ëß£ÁöÑÊï¥‰∏™Â§ÑÁêÜËøáÁ®ãÊòØÂà©Áî®Ê≥®Ëß£Â§ÑÁêÜÂô®ÂØπÁ®ãÂ∫è‰∏≠‰ΩøÁî®‰∫ÜÊ≥®Ëß£ÁöÑÂÖÉÁ¥†ËøõË°åÈÅçÂéÜÔºå‰ªéÂÖÉÁ¥†‰∏≠ÊèêÂèñÊâÄÈúÄÁöÑ‰ø°ÊÅØÔºåÁÑ∂ÂêéÁîüÊàêÁ±ªÊñá‰ª∂ÔºåÊúÄÂêéÂú®Á®ãÂ∫è‰∏≠Âä†ËΩΩÁîüÊàêÁöÑÁ±ªÂπ∂Ë∞ÉÁî®ÂÖ∂‰∏≠ÁöÑÊñπÊ≥ï„ÄÇ ÊúÄÂêéÁªôÂá∫Êú¨Ê¨°ÊµãËØïÁöÑÂ∑•Á®ãÈìæÊé• Annotation ÊµãËØï ÊÄªÁªì ÊúÄÂêéËÆ©Êàë‰ª¨ÂõûÁ≠îÂºÄÂßãÁöÑÂá†‰∏™ÈóÆÈ¢ò Ê≥®Ëß£ÊòØ‰∏ÄÁßçÁî®‰∫éÊèèËø∞Á®ãÂ∫èÂÖÉÁ¥†‰ø°ÊÅØÁöÑ‰øÆÈ•∞Á¨¶ÔºåÂèØ‰ª•Áî®Êù•‰øÆÈ•∞ÂåÖ„ÄÅÁ±ª„ÄÅÊûÑÈÄ†Âô®„ÄÅÊñπÊ≥ï„ÄÅÊàêÂëòÂèòÈáè„ÄÅÂèÇÊï∞„ÄÅÂ±ÄÈÉ®ÂèòÈáè„ÄÇ ÂΩìÊàë‰ª¨ÈúÄË¶Å‰∏∫Á®ãÂ∫è‰∏≠ÁöÑÂÖÉÁ¥†Êèê‰æõ‰ø°ÊÅØÔºåÂπ∂‰∏îËøô‰∫õ‰ø°ÊÅØÂæóÂà∞Â§ÑÁêÜÁöÑÊó∂ÂÄôÔºåÂ∞±ÂèØ‰ª•ËÄÉËôë‰ΩøÁî®Ê≥®Ëß£„ÄÇ ÊåâÁÖßÁ≥ªÁªüÂÜÖÁΩÆÁöÑÊ≥®Ëß£ÔºåÂèØ‰ª•ÂàÜ‰∏∫Âü∫Êú¨Ê≥®Ëß£„ÄÅÂÖÉÊ≥®Ëß£„ÄÅËá™ÂÆö‰πâÊ≥®Ëß£„ÄÇÊåâÁÖßÊòØÂê¶ÊúâÊàêÂëòÂèòÈáèÂèØ‰ª•ÂàÜ‰∏∫Ê†áËÆ∞Ê≥®Ëß£„ÄÅÂÖÉÊï∞ÊçÆÊ≥®Ëß£„ÄÇÊåâÁÖßÂ§ÑÁêÜÊñπÂºèÔºåÂèØ‰ª•ÂàÜ‰∏∫ËøêË°åÊó∂Ê≥®Ëß£„ÄÅÁºñËØëÊó∂Ê≥®Ëß£„ÄÇ Ê≥®Ëß£ÁöÑÂ§ÑÁêÜËøáÁ®ã‰∏ªË¶Å‰∏∫ËøêË°åÊó∂ÈÄöËøáÂèçÂ∞ÑÂ§ÑÁêÜÂíåÁºñËØëÊó∂ÈÄöËøáÊ≥®Ëß£Â§ÑÁêÜÂô®ËøõË°åÂ§ÑÁêÜ„ÄÇ Thanks „ÄäJava ÁºñÁ®ãÊÄùÊÉ≥„Äã „ÄäÁñØÁãÇ Java ËÆ≤‰πâ„Äã Annotation Tutorials Ëá™Â∑±Âä®ÊâãÂÆûÁé∞JavaÊ≥®Ëß£ÔºàJava Annotation in ActionÔºâ Ê≥®Ëß£Â§ÑÁêÜÂô®ÔºàAnnotation ProcessorÔºâÂéüÁêÜÁÆÄÊûê AndroidÊ≥®Ëß£‰ΩøÁî®‰πãÈÄöËøáannotationProcessorÊ≥®Ëß£ÁîüÊàê‰ª£Á†ÅÂÆûÁé∞Ëá™Â∑±ÁöÑButterKnifeÊ°ÜÊû∂ AndroidÊ≥®Ëß£‰ΩøÁî®‰πãÊ≥®Ëß£ÁºñËØëandroid-aptÂ¶Ç‰ΩïÂàáÊç¢Âà∞annotationProcessor]]></content>
      <categories>
        <category>JavaÂü∫Á°Ä</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>Ê≥®Ëß£</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[2017Âπ¥Âπ¥ÁªàÊÄªÁªì]]></title>
    <url>%2F2018%2F01%2F07%2F2018%E8%AE%A1%E5%88%92%2F</url>
    <content type="text"><![CDATA[2017 Âø´ÁªìÊùü‰∫ÜÔºåÊ≠£Â•ΩË∂ÅËøô‰∏™Êó∂Èó¥ÂØπËøáÂéª‰∏ÄÂπ¥ÂÅö‰∏™ÊÄªÁªìÔºåËøáÂéª‰∏ÄÂπ¥‰∏äÂçäÂπ¥ÁöÑË°®Áé∞Â∫îËØ•ËÉΩÊúâ 70 ÂàÜÔºåÊØïÁ´üÂú®ÂÅöÊØïËÆæÊúüÈó¥Âä≤Â§¥Ë∂≥ÔºåËÄå‰∏î‰πüÂ≠¶‰π†Âà∞‰∫Ü‰∏çÂ∞ë‰∏úË•øÔºåËÄåÂèÇÂä†Â∑•‰ΩúÁöÑ‰∏ãÂçäÂπ¥ÂàôÊÅêÊÄïËøû 30 ÂàÜÈÉΩ‰∏çÂà∞„ÄÇÂ§ßËá¥ÂàÜÊûê‰∫Ü‰∏Ä‰∏ãÈóÆÈ¢òÊâÄÂú® ÈóÆÈ¢ò Áº∫‰πè‰∏Ä‰∏™ÊòéÁ°ÆÁöÑÂ≠¶‰π†Ë∑ØÁ∫øÂíåÊâßË°åÂäõ Ê≤°ÊúâÊ†πÊçÆËá™Ë∫´ÁöÑÂÆûÈôÖÈúÄÊ±ÇÂÅö‰∏Ä‰∏™ËØ¶ÁªÜÁöÑËßÑÂàíÔºåÂπ∂Ê†πÊçÆËßÑÂàí‰∏ÄÊ≠•‰∏ÄÊ≠•ÁöÑÊâéÂÆûÊé®ËøõÂ≠¶‰π†ËÆ°ÂàíÔºåÂèçËÄåÊòØÂêÑ‰∏™ÊñπÈù¢ÈÉΩÊÉ≥Ë¶ÅËøõË°åÂ≠¶‰π†ÔºåÂºÇÂ∏∏ÁöÑÊÄ•ÂäüËøëÂà©Ôºå‰ªéËÄåÂØºËá¥ËÉΩÂ§üÊ∑±ÂÖ•ÁöÑÈÉ®ÂàÜÊØîËæÉÂ∞ë ÂÆûË∑µÈóÆÈ¢ò ÂØπ‰∫éÂÆûË∑µËÄåË®Ä‰∏Ä‰∏™ÈóÆÈ¢òÊòØÂ§™Ëøá‰∫éÂ∞ÜÈáçÂøÉÊîæÂú® UI ÊïàÊûú‰∏äÔºåÂπ∂‰∏îÂú®‰∏Ä‰∫õÂéüÁêÜÊÄßÁöÑÁü•ËØÜÁÇπÊ≤°ÊúâÊéåÊè°ÁöÑÂæàÂ•ΩÁöÑÊÉÖÂÜµ‰∏ãÂØºËá¥Âú® UI ÊñπÈù¢Êµ™Ë¥π‰∫ÜÂæàÂ§öÊó∂Èó¥‰πüÊ∂àÁ£®‰∫ÜÂ§ßÈÉ®ÂàÜÁöÑÁ≤æÂäõÔºåÊâÄ‰ª•ÂØºËá¥Ëá™Â∑±ÂÆûË∑µËøáÂ∞ë ÂçöÂÆ¢ÁöÑÈóÆÈ¢ò ÂçöÂÆ¢ÁªèÂ∏∏Êñ≠Êñ≠Áª≠Áª≠ÔºåÈóÆÈ¢òÂú®‰∫éÊ≤°ÊúâËßÑÂàíÊÄßÔºå‰∏çËÆ∫ÊòØË¶ÅÂÜôÁöÑÊñáÁ´†ËøòÊòØÊñáÁ´†Êú¨Ë∫´ÁöÑÁªìÊûÑÈÉΩÊ≤°Êúâ‰∏Ä‰∏™ÂÆåÊï¥ÁöÑÊÄùË∑ØÔºåÊâÄ‰ª•‰ªé‰ª•ÂâçÁöÑÂçöÂÆ¢ÂèØ‰ª•ÁúãÂà∞ÊùÇ‰π±Êó†Á´† Êñ∞ÁöÑËßÑÂàí Âà∂ÂÆöÂêàÁêÜÂèØË°åÁöÑÂ≠¶‰π†ËÆ°ÂàíË°® ÁõÆÂâçÂ§ßËá¥ÊÄùË∑ØÂ¶Ç‰∏ã Âà∂ÂÆöÂÖ≥‰∫éÂü∫Á°ÄÊñπÈù¢ÁöÑËÆ°ÂàíÔºåÁõÆÂâçÂ§ßËá¥ÂàÜ‰∏∫ÔºöJava Âü∫Á°Ä„ÄÅAndroid Âü∫Á°Ä„ÄÅÊï∞ÊçÆÁªìÊûÑÂíåÁÆóÊ≥ï„ÄÅÁΩëÁªúÂçèËÆÆ„ÄÅËÆæËÆ°Ê®°Âºè„ÄÅËØª‰π¶Á¨îËÆ∞„ÄÅÂ∏∏Áî®Ê°ÜÊû∂„ÄÇËÆ°ÂàíÈúÄË¶ÅÂú®ÊåÅÁª≠Êõ¥Êñ∞ÁöÑËøáÁ®ã‰∏≠ËøõË°åÁªÜÂåñ ‰ª•Âë®‰∏∫Âçï‰ΩçÂ∞ΩÂèØËÉΩËß£ÂÜ≥‰∏Ä‰∏™Â§ßÁöÑÁü•ËØÜÁÇπÔºåÂπ∂Êï¥ÁêÜÊàêÊñáÁ´†ÂèëË°®Âá∫ÂéªÔºàÂ§öÂπ≥Âè∞Â∏åÊúõÊé•ÂèóÂà´‰∫∫ÁöÑÊåáÊ≠£Ôºâ ÂÖ∂‰ΩôÁöÑÂ∞èÁü•ËØÜÁÇπÂíåËøõÈò∂Áü•ËØÜÁÇπ‰ºöÂ∞ÜÊï¥ÁêÜÂú® Gitbook ‰∏ä ÊúÄÂêéÈúÄË¶ÅÂØπÁ¨îËÆ∞ÂíåÊñáÁ´†ËøõË°åËâØÂ•ΩÁöÑÂàÜÁ±ª ÂÆûË∑µÈóÆÈ¢ò ‰ªäÂπ¥ÂèØËÉΩ‰ºöÂÆåÊàê‰∏§‰∏™ APPÔºå‰∏Ä‰∏™ÊòØÂÖ≥‰∫éÂçïËØçËÆ∞ÂøÜÁöÑÔºà‰πãÂâçÁïô‰∏ãÁöÑÁÉÇÊëäÂ≠êÔºåÈúÄË¶ÅËøõË°åÈáçÊûÑÔºâÔºåÂè¶Â§ñ‰∏Ä‰∏™ÊòØÁΩëÁªúÂ£ÅÁ∫∏ÁöÑÔºåÈô§Ê≠§‰πãÂ§ñÂ∏åÊúõÊØè‰∏™ÊòüÊúüËÉΩÂÆâÊéíÂçäÂ§©ÁªôËá™Â∑±ÂçïÁ∫ØÁöÑÁºñÁ†ÅÊó∂Èó¥Ôºå‰∏ªË¶ÅÊòØÂíåËá™Â∑±ÂÅöÁöÑ APP Áõ∏ÂÖ≥ÊàñËÄÖÊ®°‰ªøÂà´‰∫∫ÁöÑ Demo ÂçöÂÆ¢ÈóÆÈ¢ò ÁõÆÂâç‰∏ªË¶ÅÈúÄË¶ÅËøõË°åÊï¥ÁêÜÔºå‰πãÂâçÁöÑÂçöÂÆ¢Â∑≤Áªè‰øÆÊ≠£‰∫ÜÂàÜÁ±ªÔºåÂçöÂÆ¢ÁöÑÂàÜÁ±ªÂ§ßËá¥‰∏éÊï¥ÁêÜÂá∫Êù•ÁöÑËÆ°ÂàíË°®Áõ∏ÂØπÂ∫îÔºåÂêéÁª≠ÂÜôÂçöÂÆ¢ÁöÑÊó∂ÂÄôÂ∏åÊúõÁ≤æÁõäÊ±ÇÁ≤æÔºåÂÖªÊàê‰∏Ä‰∏™ËâØÂ•ΩÁöÑË°åÊñáÊÄùË∑Ø ‰∏çÁÆ°Â¶Ç‰ΩïÔºåÊñ∞ÁöÑ‰∏ÄÂπ¥ÈúÄË¶Å GO FIGHTINGÔºÅ 2018-3-4 Êõ¥Êñ∞ Â≠¶‰π†ËÆ°Âàí]]></content>
      <categories>
        <category>Êñ∞Âπ¥ËÆ°Âàí</category>
      </categories>
      <tags>
        <tag>Êñ∞Âπ¥ËÆ°Âàí</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Android ÂêØÂä®ËøáÁ®ãÁÆÄÊûêÔºà‰∫åÔºâ‰πã zygote ËøõÁ®ã]]></title>
    <url>%2F2017%2F11%2F05%2FAndroid%E5%90%AF%E5%8A%A8%E8%BF%87%E7%A8%8B%E7%AE%80%E6%9E%90%EF%BC%88%E4%BA%8C%EF%BC%89%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä Âú® AndroidÂêØÂä®ËøáÁ®ãÁÆÄÊûêÔºà‰∏ÄÔºâ‰∏≠Êàë‰ª¨Â∑≤ÁªèÂàÜÊûêËøá‰∫Ü init ËøõÁ®ãÊòØÂ¶Ç‰ΩïË¢´ÂêØÂä®ÁöÑÔºåÊú¨ÁØáÊñáÁ´†Â∞Ü‰ºöÁªßÁª≠ÂàÜÊûê zygote ÂêØÂä®ËøáÁ®ã‰ª•Âèä‰ΩúÁî®„ÄÇ zygote ÂêØÂä®ËøáÁ®ã zygote ËøõÁ®ãÂàõÂª∫‰πãÂêé‰ºöÈ¶ñÂÖàËøõÂÖ•Âà∞ app_main.cpp ÁöÑ main ÂáΩÊï∞ÂΩì‰∏≠ÂéªÔºåÊâÄ‰ª•È¶ñÂÖàÂØπ app_main ËøõË°åÂàÜÊûê app_main ÂàÜÊûê frameworks/base/cmds/app_process/app_main.cpp 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192int main(int argc, char* const argv[])&#123; ... //ÂàõÂª∫ AppRuntime ÂØπË±° AppRuntime runtime(argv[0], computeArgBlockSize(argc, argv)); ... // Ëß£ÊûêËøêË°åÊó∂ÂèÇÊï∞ÔºåÂΩìÈÅáÂà∞Êó†Ê≥ïËØÜÂà´ÁöÑÈÄâÈ°πÊó∂ÂÅúÊ≠¢ bool zygote = false; bool startSystemServer = false; bool application = false; String8 niceName; String8 className; ++i; // Skip unused "parent dir" argument. while (i &lt; argc) &#123; const char* arg = argv[i++]; //Â¶ÇÊûú‰º†ÂÖ•ÁöÑÂèÇÊï∞Êúâ ‚Äù--zygote‚Äú ÂàôÂ∞Ü zygote ÁΩÆ‰∏∫ true if (strcmp(arg, "--zygote") == 0) &#123; zygote = true; niceName = ZYGOTE_NICE_NAME; //Â¶ÇÊûú‰º†ÂÖ•ÁöÑÂèÇÊï∞Êúâ "--start-system-server" ÂàôÂ∞Ü startSystemServer ÁΩÆ‰∏∫ true &#125; else if (strcmp(arg, "--start-system-server") == 0) &#123; startSystemServer = true; &#125; else if (strcmp(arg, "--application") == 0) &#123; application = true; &#125; else if (strncmp(arg, "--nice-name=", 12) == 0) &#123; niceName.setTo(arg + 12); &#125; else if (strncmp(arg, "--", 2) != 0) &#123; className.setTo(arg); break; &#125; else &#123; --i; break; &#125; &#125; Vector&lt;String8&gt; args; //Èùû zygote Ê®°ÂºèÂ§ÑÁêÜ if (!className.isEmpty()) &#123; // We're not in zygote mode, the only argument we need to pass // to RuntimeInit is the application argument. // // The Remainder of args get passed to startup class main(). Make // copies of them before we overwrite them with the process name. args.add(application ? String8("application") : String8("tool")); runtime.setClassNameAndArgs(className, argc - i, argv + i); &#125; else &#123; //zygote Ê®°Âºè‰∏ãÁöÑÂ§ÑÁêÜ maybeCreateDalvikCache(); //Â¶ÇÊûú startSystemServer ‰∏∫ true ÂàôÂ∞Ü "start-system-server" Ê∑ªÂä†Âà∞ args if (startSystemServer) &#123; args.add(String8("start-system-server")); &#125; char prop[PROP_VALUE_MAX]; if (property_get(ABI_LIST_PROPERTY, prop, NULL) == 0) &#123; LOG_ALWAYS_FATAL("app_process: Unable to determine ABI list from property %s.", ABI_LIST_PROPERTY); return 11; &#125; String8 abiFlag("--abi-list="); abiFlag.append(prop); args.add(abiFlag); // In zygote mode, pass all remaining arguments to the zygote // main() method. for (; i &lt; argc; ++i) &#123; args.add(String8(argv[i])); &#125; &#125; if (!niceName.isEmpty()) &#123; runtime.setArgv0(niceName.string()); set_process_name(niceName.string()); &#125; //Â¶ÇÊûú zygote ‰∏∫ true ÂàôÂêØÂä® zygote if (zygote) &#123; //ÈÄöËøá runtime ÂØπË±°ÂêØÂä® zygote runtime.start("com.android.internal.os.ZygoteInit", args, zygote); &#125; else if (className) &#123; runtime.start("com.android.internal.os.RuntimeInit", args, zygote); &#125; else &#123; fprintf(stderr, "Error: no class name or --zygote supplied.\n"); app_usage(); LOG_ALWAYS_FATAL("app_process: no class name or --zygote supplied."); return 10; &#125;&#125; ÂèØ‰ª•ÁúãÂà∞Âú® main ÂáΩÊï∞‰∏≠È¶ñÂÖàÂàõÂª∫‰∫Ü‰∏Ä‰∏™ AppRuntime ÂØπË±°ÔºåÁÑ∂ÂêéÂ∞±‰ºöÊ†πÊçÆ‰º†ÂÖ•ÁöÑÂèÇÊï∞ÂØπ‰∏Ä‰∫õÊ†áÂøó‰ΩçËøõË°åÁõ∏Â∫îÁöÑÁΩÆ‰ΩçÔºåËøôÈáåÂÄºÂæóÊ≥®ÊÑèÁöÑ‰∏Ä‰∏™Ê†áÂøó‰ΩçÊòØ startSystemServerÔºå‰∏äÊñáËØ¥Ëøá Android 5.0 ‰πãÂêéÁ≥ªÁªüÂèØËÉΩ‰ºöÂêØÂä®‰∏§‰∏™ zygote ËøõÁ®ãÔºåËÄå SystemServer Âè™ÈúÄË¶ÅÂêØÂä®‰∏ÄÊ¨°ÔºåÊâÄ‰ª•ÈÄöËøáËøô‰∏™Ê†áÂøó‰ΩçÊéßÂà∂Âè™Âú®ÂêØÂä®‰∏ª zygote ËøõÁ®ãÁöÑÊó∂ÂÄôÂ∞Ü &quot;start-system-server&quot; Â¢ûÂä†Âà∞ argsÔºåÁÑ∂ÂêéÂàô‰ºöÈÄöËøá AppRuntime ÁöÑ start ÂáΩÊï∞Ë∞ÉÁî® Java Â±ÇÁöÑ zygote ‰ª£Á†Å„ÄÇ AndroidRuntime ÂàÜÊûê Áî±‰∫é AppRuntime ÁªßÊâøËá™ AndroidRuntimeÔºåÊâÄ‰ª•ÊÉ≥Ë¶Å‰∫ÜËß£Á≥ªÁªüÊòØÂ¶Ç‰ΩïË∞ÉÁî® Java Â±ÇÁöÑ zygote ‰ª£Á†ÅÂàôÈúÄË¶ÅÁªßÁª≠‰∫ÜËß£ AndroidRuntime ÁöÑ start ÂáΩÊï∞ 1class AppRuntime : public AndroidRuntime AndroidRuntime ‰Ωç‰∫é frameworks/base/core/jni 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106/* * Start the Android runtime. This involves starting the virtual machine * and calling the "static void main(String[] args)" method in the class * named by "className". * * Passes the main function two arguments, the class name and the specified * options string. */void AndroidRuntime::start(const char* className, const Vector&lt;String8&gt;&amp; options, bool zygote)&#123; ... static const String8 startSystemServer("start-system-server"); /* * 'startSystemServer == true' means runtime is obsolete and not run from * init.rc anymore, so we print out the boot start event here. */ for (size_t i = 0; i &lt; options.size(); ++i) &#123; //Âè™Êúâ startSystemServer == trueÔºåoptions Êâç‰ºöÊúâ start-system-server if (options[i] == startSystemServer) &#123; /* track our progress through the boot sequence */ const int LOG_BOOT_PROGRESS_START = 3000; LOG_EVENT_LONG(LOG_BOOT_PROGRESS_START, ns2ms(systemTime(SYSTEM_TIME_MONOTONIC))); &#125; &#125; ... //const char* kernelHack = getenv("LD_ASSUME_KERNEL"); //ALOGD("Found LD_ASSUME_KERNEL='%s'\n", kernelHack); /* start the virtual machine */ JniInvocation jni_invocation; jni_invocation.Init(NULL); JNIEnv* env; //ÂàõÂª∫ÂêØÂä® DVM if (startVm(&amp;mJavaVM, &amp;env, zygote) != 0) &#123; return; &#125; onVmCreated(env); /* * Register android functions. */ //Ê≥®ÂÜå JNI ÊñπÊ≥ï if (startReg(env) &lt; 0) &#123; ALOGE("Unable to register all android natives\n"); return; &#125; /* * We want to call main() with a String array with arguments in it. * At present we have two arguments, the class name and an option string. * Create an array to hold them. */ //Â∞Ü options ËΩ¨Âåñ‰∏∫ java ‰∏≠ÁöÑ String Êï∞ÁªÑ jclass stringClass; jobjectArray strArray; jstring classNameStr; stringClass = env-&gt;FindClass("java/lang/String"); assert(stringClass != NULL); //ÂàõÂª∫ÂØπË±°Êï∞ÁªÑÔºåÁ±ªÂûã‰∏∫ stringClassÔºàÂç≥ String Á±ªÂûãÔºâÔºåÈïøÂ∫¶‰∏∫ options.size() + 1 strArray = env-&gt;NewObjectArray(options.size() + 1, stringClass, NULL); assert(strArray != NULL); classNameStr = env-&gt;NewStringUTF(className); assert(classNameStr != NULL); env-&gt;SetObjectArrayElement(strArray, 0, classNameStr); //Â∞Ü options ÈÄê‰∏™Â¢ûÂä†Âà∞ÂØπË±°Êï∞ÁªÑÂΩì‰∏≠ for (size_t i = 0; i &lt; options.size(); ++i) &#123; jstring optionsStr = env-&gt;NewStringUTF(options.itemAt(i).string()); assert(optionsStr != NULL); env-&gt;SetObjectArrayElement(strArray, i + 1, optionsStr); &#125; /* * Start VM. This thread becomes the main thread of the VM, and will * not return until the VM exits. */ char* slashClassName = toSlashClassName(className); //ÂØªÊâæÁ±ªÂêç‰∏∫ slashClassName ÁöÑÁ±ª jclass startClass = env-&gt;FindClass(slashClassName); if (startClass == NULL) &#123; ALOGE("JavaVM unable to locate class '%s'\n", slashClassName); /* keep going */ &#125; else &#123; //Êü•Êâæ main ÊñπÊ≥ïÔºå([Ljava/lang/String;)V ÊòØ main ÊñπÊ≥ïÁöÑÁ≠æÂêç jmethodID startMeth = env-&gt;GetStaticMethodID(startClass, "main", "([Ljava/lang/String;)V"); if (startMeth == NULL) &#123; ALOGE("JavaVM unable to find main() in '%s'\n", className); /* keep going */ &#125; else &#123; //Ë∞ÉÁî® startClass Á±ªÂΩì‰∏≠ÁöÑ main ÊñπÊ≥ïÔºå‰º†ÂÖ•ÂèÇÊï∞ strArray env-&gt;CallStaticVoidMethod(startClass, startMeth, strArray);#if 0 if (env-&gt;ExceptionCheck()) threadExitUncaughtException(env);#endif &#125; &#125; ...&#125; ÈÄöËøá start ÂáΩÊï∞ÁöÑÊ≥®ÈáäÊàë‰ª¨ÂèØ‰ª•Â§ßËá¥‰∫ÜËß£Âà∞ start ÂáΩÊï∞ÁöÑ‰∏ªË¶Å‰ΩúÁî®ÊòØÂêØÂä®ËôöÊãüÊú∫ÂíåÂêç‰∏∫ classname ÁöÑ main ÊñπÊ≥ï„ÄÇ ËÄå‰∏äÊñáÂèØ‰ª•Áü•ÈÅìÔºå‰º†ÂÖ•ÁöÑ classname ÊòØ &quot;com.android.internal.os.ZygoteInit&quot; „ÄÇÈÇ£‰πàÊï¥‰∏™ÁöÑÊâßË°åÊµÅÁ®ãÂ∞±ÊòØÔºö È¶ñÂÖà‰ºöÂà§Êñ≠‰º†ÈÄíËøõÊù•ÁöÑÂèÇÊï∞ÊòØÂê¶Â≠òÂú® &quot;start-system-server&quot; ÔºåÂ¶ÇÊûúÂ≠òÂú®Âàô‰ºöËæìÂá∫ÂêØÂä®Êó•ÂøóÔºåÁÑ∂Âêé‰ºöÈÄöËøá startVm ÂáΩÊï∞ÂàõÂª∫ÂêØÂä® DVMÔºåÂú®ÂêØÂä® DVM ‰πãÂêé‰ºöÈÄöËøá startReg ÂáΩÊï∞Ê≥®ÂÜå JNI ÊñπÊ≥ïÔºåÂú®Ê≥®ÂÜåÂÆåÊØï‰πãÂêé‰ºöÂ∞Ü‰º†ÂÖ•ÁöÑ options ÂèÇÊï∞ËΩ¨Êç¢‰∏∫ Java ÁöÑÂØπË±°Êï∞ÁªÑÔºåËÄå‰πãÊâÄ‰ª•ÈúÄË¶ÅËΩ¨Êç¢ÊàêÂØπË±°Êï∞ÁªÑÊòØÂõ†‰∏∫Âú®‰∫é options ÈúÄË¶Å‰Ωú‰∏∫ main ÊñπÊ≥ïÁöÑÂèÇÊï∞‰º†ÂÖ•Ôºå‰πãÂêéÂÜçÈÄöËøá‰º†ÂÖ•ÁöÑ className ÂéªËé∑Âæó jclass ÂØπË±°ÔºåÂπ∂Ê†πÊçÆ main ÊñπÊ≥ïÁöÑ JNI Á≠æÂêçÂæóÂà∞ jmethodIDÔºåÊúÄÁªàÈÄöËøáCallStaticVoidMethod ÊñπÊ≥ïÂÆåÊàê main ÊñπÊ≥ïÁöÑË∞ÉÁî®„ÄÇ ZygoteInit ÂàÜÊûê frameworks/base/core/java/com/android/internal/os 1234567891011121314151617181920212223242526272829303132public static void main(String argv[]) &#123; ... String socketName = "zygote"; ... try &#123; ... //Ê≥®ÂÜå socket registerZygoteSocket(socketName); ... //È¢ÑÂä†ËΩΩÁ±ªÂíåËµÑÊ∫ê preload(); ... if (startSystemServer) &#123; //ÂàõÂª∫ SystemServer ËøõÁ®ã startSystemServer(abiList, socketName); &#125; ... //Á≠âÂæÖÂÆ¢Êà∑Á´ØËØ∑Ê±Ç runSelectLoop(abiList); ... closeServerSocket(); &#125; catch (MethodAndArgsCaller caller) &#123; caller.run(); &#125; catch (RuntimeException ex) &#123; Log.e(TAG, "Zygote died with exception", ex); closeServerSocket(); throw ex; &#125;&#125; Êï¥‰∏™ main ÊñπÊ≥ïÁöÑÊâßË°åÊµÅÁ®ãÊòØÔºöÈ¶ñÂÖàÈÄöËøá registerZygoteSocket ÊñπÊ≥ïÂØπ socket ËøõË°å‰∫ÜÊ≥®ÂÜåÔºåÊ≥®ÂÜåÁöÑ socket Áî®‰∫éÂíå ActivityManagerService ËøõË°åÈÄö‰ø°ÔºåÁÑ∂ÂêéË∞ÉÁî® preload ÊñπÊ≥ïÂØπÁ±ªÂíåËµÑÊ∫êËøõË°åÂä†ËΩΩÔºå‰πãÂêéÂàô‰ºöË∞ÉÁî® startSystemServer ÂàõÂª∫ SystemServer ËøõÁ®ãÔºåÊúÄÂêéÈÄöËøá runSelectLoop Á≠âÂæÖÊù•Ëá™ ActivityManagerService ÁöÑËØ∑Ê±Ç„ÄÇ ËøôÈáåÊúÄ‰∏∫ÂÖ≥ÈîÆÁöÑÊòØ socket ‰ª•ÂèäÂàõÂª∫ SystemServer ËøõÁ®ãÔºåÊâÄ‰ª•Êàë‰ª¨ÈúÄË¶ÅËøõ‰∏ÄÊ≠•‰∫ÜËß£Ëøô‰∏§‰∏™ÈÉ®ÂàÜ„ÄÇ Ê≥®ÂÜå Socket ËøáÁ®ã È¶ñÂÖàÊòØÊ≥®ÂÜå Socket ÈÉ®ÂàÜÔºå registerZygoteSocket ‰∏ªË¶ÅÊòØÂà©Áî®Êñá‰ª∂ÊèèËø∞Á¨¶ÂàõÂª∫‰∫Ü‰∏Ä‰∏™ LocalServerSocket ÂØπË±° 1234567891011121314151617181920212223private static void registerZygoteSocket(String socketName) &#123; if (sServerSocket == null) &#123; int fileDesc; //socket Âêç‰∏∫ ANDROID_SOCKET_zygote final String fullSocketName = ANDROID_SOCKET_PREFIX + socketName; try &#123; String env = System.getenv(fullSocketName); fileDesc = Integer.parseInt(env); &#125; catch (RuntimeException ex) &#123; throw new RuntimeException(fullSocketName + " unset or invalid", ex); &#125; try &#123; FileDescriptor fd = new FileDescriptor(); fd.setInt$(fileDesc); //ÂàõÂª∫ LocalServerSockt sServerSocket = new LocalServerSocket(fd); &#125; catch (IOException ex) &#123; throw new RuntimeException( "Error binding to local socket '" + fileDesc + "'", ex); &#125; &#125;&#125; ÂêØÂä® SystemServer startSystemServer ‰∏ªË¶ÅÂ∑•‰ΩúÊòØÂØπËÆæÁΩÆÁöÑÂèÇÊï∞ËøõË°åËß£ÊûêÔºåÁÑ∂ÂêéÈÄöËøá forkSystemServer ÂàõÂª∫ SystemServer ËøõÁ®ãÔºåÊúÄÂêéÂú® SystemServer ËøõÁ®ã‰∏≠Ë∞ÉÁî® handleSystemServerProcess ÊñπÊ≥ïÂ§ÑÁêÜÂâ©‰ΩôÂ∑•‰Ωú 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152private static boolean startSystemServer(String abiList, String socketName) throws MethodAndArgsCaller, RuntimeException &#123;... /* Hardcoded command line to start the system server */ //ËÆæÁΩÆ uid ‰∏∫ 1000,ËÆæÁΩÆ gid ‰∏∫ 1000ÔºåÂêØÂä® com.android.server.SystemServer String args[] = &#123; "--setuid=1000", "--setgid=1000", /// M: ANR mechanism for system_server add shell(2000) group to access /// /sys/kernel/debug/tracing/tracing_on "--setgroups=1001,1002,1003,1004,1005,1006,1007,1008,1009,1010,1018,1021,1032,2000," + "3001,3002,3003,3006,3007,3009,3010", "--capabilities=" + capabilities + "," + capabilities, "--nice-name=system_server", "--runtime-args", "com.android.server.SystemServer", &#125;; ZygoteConnection.Arguments parsedArgs = null; int pid; try &#123; //ÂØπ args ËøõË°åËß£Êûê parsedArgs = new ZygoteConnection.Arguments(args); ZygoteConnection.applyDebuggerSystemProperty(parsedArgs); ZygoteConnection.applyInvokeWithSystemProperty(parsedArgs); /* Request to fork the system server process */ //ÂàõÂª∫ SystemServer ËøõÁ®ã pid = Zygote.forkSystemServer( parsedArgs.uid, parsedArgs.gid, parsedArgs.gids, parsedArgs.debugFlags, null, parsedArgs.permittedCapabilities, parsedArgs.effectiveCapabilities); &#125; catch (IllegalArgumentException ex) &#123; throw new RuntimeException(ex); &#125; /* For child process */ if (pid == 0) &#123; if (hasSecondZygote(abiList)) &#123; waitForSecondaryZygote(socketName); &#125; //Â§ÑÁêÜ SystemServer ËøõÁ®ãÂâ©‰ΩôÂ∑•‰Ωú handleSystemServerProcess(parsedArgs); &#125; return true;&#125; ÁõëÂê¨ÂÆ¢Êà∑Á´ØÁöÑËØ∑Ê±Ç runSelectLoop ÁöÑ‰∏ªË¶ÅÂ∑•‰ΩúÊòØÈÄöËøá ZygoteConnection ÁöÑ acceptCommandPeer ÊñπÊ≥ïÁõëÂê¨ÂÆ¢Êà∑Á´ØÁöÑËØ∑Ê±ÇÔºåÁÑ∂ÂêéË∞ÉÁî® runOnce ÊñπÊ≥ïÂØπÊù•Ëá™ÂÆ¢Êà∑Á´ØÁöÑËØ∑Ê±ÇËøõË°åÂ§ÑÁêÜ„ÄÇ 123456789101112131415161718192021222324252627282930313233343536373839private static void runSelectLoop(String abiList) throws MethodAndArgsCaller &#123; ArrayList&lt;FileDescriptor&gt; fds = new ArrayList&lt;FileDescriptor&gt;(); ArrayList&lt;ZygoteConnection&gt; peers = new ArrayList&lt;ZygoteConnection&gt;(); fds.add(sServerSocket.getFileDescriptor()); peers.add(null); //Âæ™ÁéØÂ§ÑÁêÜËøûÊé•ËØ∑Ê±Ç while (true) &#123; StructPollfd[] pollFds = new StructPollfd[fds.size()]; for (int i = 0; i &lt; pollFds.length; ++i) &#123; pollFds[i] = new StructPollfd(); pollFds[i].fd = fds.get(i); pollFds[i].events = (short) POLLIN; &#125; try &#123; Os.poll(pollFds, -1);//Êó†ÈôêÁ≠âÂæÖËÉΩÂ§üËøõË°å I/O Êìç‰Ωú &#125; catch (ErrnoException ex) &#123; throw new RuntimeException("poll failed", ex); &#125; for (int i = pollFds.length - 1; i &gt;= 0; --i) &#123; //ËØ¥ÊòéÊ≤°ÊúâÊù•Ëá™ÂÆ¢Êà∑Á´ØÁöÑËøûÊé•ËØ∑Ê±ÇÊàñÊï∞ÊçÆÂ§ÑÁêÜËØ∑Ê±Ç if ((pollFds[i].revents &amp; POLLIN) == 0) &#123; continue; &#125; if (i == 0) &#123;//Â§ÑÁêÜÊù•Ëá™ÂÆ¢Êà∑Á´ØÁöÑËøûÊé•ËØ∑Ê±Ç ZygoteConnection newPeer = acceptCommandPeer(abiList); peers.add(newPeer); fds.add(newPeer.getFileDesciptor()); &#125; else &#123; boolean done = peers.get(i).runOnce();//Â§ÑÁêÜÂÆ¢Êà∑Á´ØÊï∞ÊçÆÂ§ÑÁêÜËØ∑Ê±ÇÔºåÂàõÂª∫ÂØπÂ∫îÁöÑËøõÁ®ã if (done) &#123;//Â§ÑÁêÜÂÆåÊØïÂàôËøõË°åÁßªÈô§ peers.remove(i); fds.remove(i); &#125; &#125; &#125; &#125;&#125; Â§ÑÁêÜÂÆ¢Êà∑Á´ØËØ∑Ê±Ç ÂØπ‰∫é runOnce ËÄåË®Ä‰∏ªË¶ÅÂÅöÁöÑÂ∑•‰ΩúÊòØ‰ªéËøûÊé•‰∏≠ËØªÂèñÂèÇÊï∞ÔºåÁÑ∂ÂêéÊ†πÊçÆÂèÇÊï∞ÂàõÂª∫Áõ∏Â∫îÁöÑËøõÁ®ã„ÄÇ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263boolean runOnce() throws ZygoteInit.MethodAndArgsCaller &#123; String args[]; Arguments parsedArgs = null; ... try &#123; args = readArgumentList();//ËØªÂèñÂèÇÊï∞ descriptors = mSocket.getAncillaryFileDescriptors(); &#125; catch (IOException ex) &#123; Log.w(TAG, "IOException on command socket " + ex.getMessage()); closeSocket(); return true; &#125; if (args == null) &#123; // EOF reached. closeSocket(); return true; &#125; ... try &#123; parsedArgs = new Arguments(args);//ÊûÑÈÄ† Arguments ÂØπË±° ... //ÂàõÂª∫ËøõÁ®ã pid = Zygote.forkAndSpecialize(parsedArgs.uid, parsedArgs.gid, parsedArgs.gids, parsedArgs.debugFlags, rlimits, parsedArgs.mountExternal, parsedArgs.seInfo, parsedArgs.niceName, fdsToClose, parsedArgs.instructionSet, parsedArgs.appDataDir); &#125; catch (ErrnoException ex) &#123; logAndPrintError(newStderr, "Exception creating pipe", ex); &#125; catch (IllegalArgumentException ex) &#123; logAndPrintError(newStderr, "Invalid zygote arguments", ex); &#125; catch (ZygoteSecurityException ex) &#123; logAndPrintError(newStderr, "Zygote security policy prevents request: ", ex); &#125; try &#123; if (pid == 0) &#123; // in child IoUtils.closeQuietly(serverPipeFd); serverPipeFd = null; //ËøõÂÖ•Â≠êËøõÁ®ãÁöÑÂ§ÑÁêÜÊµÅÁ®ã handleChildProc(parsedArgs, descriptors, childPipeFd, newStderr); // should never get here, the child is expected to either // throw ZygoteInit.MethodAndArgsCaller or exec(). return true; &#125; else &#123; // in parent...pid of &lt; 0 means failure IoUtils.closeQuietly(childPipeFd); childPipeFd = null; return handleParentProc(pid, descriptors, serverPipeFd, parsedArgs); &#125; &#125; finally &#123; IoUtils.closeQuietly(childPipeFd); IoUtils.closeQuietly(serverPipeFd); &#125;&#125; ÊÄªÁªì Âà∞ËøôÈáåÊàë‰ª¨Â§ßËá¥ËÉΩÂ§üÁü•Êôì Zygote ËøõÁ®ãÁöÑÂêØÂä®ËøáÁ®ãÂíå‰∏ªË¶Å‰ΩúÁî®‰∫ÜÔºö Á≥ªÁªüÂú®ÂêØÂä® Zygote ÁöÑËøáÁ®ã‰∏≠È¶ñÂÖàÂêØÂä®‰∫ÜËôöÊãüÊú∫ÔºåÁÑ∂ÂêéÈÄöËøá JNI Ë∞ÉÁî®‰∫Ü ZygoteInit ‰∏≠ÁöÑ main ÊñπÊ≥ïÔºåÁî±Ê≠§Á≥ªÁªü‰ªé C++ ÁöÑ FrameWork Â±ÇÂà∞‰∫Ü Java ÁöÑ FrameWork Â±ÇÔºå‰πãÂêéÂú®ÂàôÊ≥®ÂÜå‰∫ÜÁî®‰∫éÂíå ActvityManagerService ÈÄö‰ø°ÁöÑ SocketÔºåÂÆåÊàêÊ≥®ÂÜå‰πãÂêéÂàô‰ºöË∞ÉÁî® startSystemServer ÂêØÂä® SystemServer ËøõÁ®ãÔºåÊúÄÂêé Zygote ËøõÁ®ãÂ∞Ü‰ºöÈÄöËøá runSelectLoop ÂØπÊù•Ëá™ÂÆ¢Êà∑Á´ØÁöÑËøûÊé•ËøõË°åÁõëÂê¨„ÄÇ ÊÄªÁöÑÊù•ËØ¥ Zygote ÁöÑ‰∏ªË¶Å‰ΩúÁî®ÂêØÂä® SystemServer ËøõÁ®ã‰ª•ÂèäÊ†πÊçÆÂÆ¢Êà∑Á´ØÁöÑËøûÊé•ÂàõÂª∫Áõ∏Â∫îÁöÑËøõÁ®ã„ÄÇ Thanks AndroidÁ≥ªÁªüÂêØÂä®ÊµÅÁ®ãÔºà‰∫åÔºâËß£ÊûêZygoteËøõÁ®ãÂêØÂä®ËøáÁ®ã AndroidÁ≥ªÁªüÂêØÂä®-zygoteÁØá]]></content>
      <categories>
        <category>AndroidËøõÈò∂</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>Ê∫êÁ†ÅÂàÜÊûê</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Android ÂêØÂä®ËøáÁ®ãÁÆÄÊûêÔºà‰∏ÄÔºâ‰πã init ËøõÁ®ã]]></title>
    <url>%2F2017%2F10%2F28%2FAndroid%E5%90%AF%E5%8A%A8%E8%BF%87%E7%A8%8B%E7%AE%80%E6%9E%90%EF%BC%88%E4%B8%80%EF%BC%89%2F</url>
    <content type="text"><![CDATA[ÈóÆÈ¢ò Âú®ËøõÂÖ•Âà∞ Android ÂêØÂä®ËøáÁ®ã‰πãÂâçÂÖàËÆ©Êàë‰ª¨ÊÄùËÄÉ‰ª•‰∏ãÂá†‰∏™ÈóÆÈ¢ò 1. Android Á≥ªÁªüÁöÑÂêØÂä®ËøáÁ®ãÊòØÊÄéÊ†∑ÁöÑÔºü 2. init „ÄÅzygote ËøõÁ®ãÊòØ‰ªÄ‰πàÔºüÂú®Á≥ªÁªüÂêØÂä®ÁöÑËøáÁ®ã‰∏≠ÂêÑËá™ÂèëÊå•‰∫Ü‰ªÄ‰πà‰ΩúÁî®Ôºü 3. AMS„ÄÅPMS Á≠âËøô‰∫õÊúçÂä°ÊòØÂ¶Ç‰ΩïË¢´ÂêØÂä®ÁöÑÔºü 4. Launcher ÊòØÂ¶Ç‰ΩïË¢´ÂêØÂä®ÁöÑÔºü Ê≠§ÁØáÊñáÁ´†Â∞ÜÈíàÂØπ init ÈÉ®ÂàÜÁªôÂá∫ÂàÜÊûê ÂêØÂä®ÊµÅÁ®ãÁÆÄËø∞ Âú®‰∫ÜËß£ init ÈÉ®ÂàÜ‰πãÂâçÔºåÈ¶ñÂÖàÁÆÄÂçï‰ªãÁªç‰∏ãÁ≥ªÁªüÁöÑÂêØÂä®ÊµÅÁ®ã‰ª•‰æøÊäì‰Ωè‰∏ªÁ∫øÔºåÂΩìÊàë‰ª¨ÈÄöËøáÁîµÊ∫êÈîÆÂºÄÂêØÁ≥ªÁªüÁöÑÊó∂ÂÄôÔºåÁ≥ªÁªüÈ¶ñÂÖà‰ºöÂä†ËΩΩ bootloader Á®ãÂ∫èÂà∞ RAM ‰∏≠ÔºåÁÑ∂ÂêéÈÄöËøá bootloader Â∞ÜÂÜÖÊ†∏Á®ãÂ∫èÂä†ËΩΩÂà∞ RAM ‰∏≠Ôºå‰πãÂêéÂÜÖÊ†∏Á®ãÂ∫è‰ºöÂàõÂª∫init ËøõÁ®ãÔºåÂú® init ËøõÁ®ã‰∏≠‰ºöÂàõÂª∫ zygote ËøõÁ®ãÔºåËÄå zygote ËøõÁ®ãÂàô‰ºöÂàõÂª∫ DVM Âπ∂‰∏îÂêØÂä® SystemServer ËøõÁ®ãÔºåÈÄöËøáSystemServer Á≥ªÁªü‰ºöÂêØÂä®‰∏ÄÁ≥ªÂàóÁöÑÊúçÂä°ÔºåÂåÖÊã¨Â∏∏ËßÅÁöÑ AMS„ÄÅPMS Á≠âÔºåÊúÄÂêéÂÜçÈÄöËøá AMS ËøõÂÖ•Âà∞Êàë‰ª¨ÁÜüÁü•ÁöÑ Launcher Á®ãÂ∫è„ÄÇ ÊâÄ‰ª•Êï¥‰∏™ÊµÅÁ®ãÁöÑÂÖ≥ÈîÆÁÇπÂú®‰∫é init ËøõÁ®ãÂ¶Ç‰ΩïÂàõÂª∫ zygote„ÄÅzygote ËøõÁ®ãÂ¶Ç‰ΩïÂàõÂª∫ SystemServer„ÄÅSystemServer ËøõÁ®ãÂ¶Ç‰ΩïÂêØÂä® AMS„ÄÅAMS Â¶Ç‰ΩïÂêØÂä® Launcher„ÄÇ init ÂêØÂä®ÊµÅÁ®ãÂàÜÊûê Áî±‰∫é bootloader ÂíåÂÜÖÊ†∏‰∏çÊòØÂÖ≥ÂøÉÁöÑÈáçÁÇπÔºåÊâÄ‰ª•ËøôÈáåÂè™ÊòØÁÆÄÂçï‰ªãÁªçÂÆÉ‰ª¨ÁöÑ‰ΩúÁî®„ÄÇ Âä†ËΩΩËøêË°å BootLoader Âú®ÁîµÊ∫ê‰∏äÁîµ‰πãÂêéÔºåCPU ‰∏≠ÁöÑÊìç‰ΩúÊéßÂà∂Âô®Â∞ÜÂèëÂá∫ÊéßÂà∂‰ø°Âè∑ÔºåÂ∞ÜÁ®ãÂ∫èËÆ°Êï∞Âô®ÔºàPCÔºâÁöÑÂÜÖÂÆπÈÄÅËá≥Âú∞ÂùÄÂØÑÂ≠òÂô®ÔºàARÔºâÔºå‰πãÂêéÂêØÂä®ÂØπ‰∏ªÂ≠òÁöÑËØªÊìç‰ΩúÔºåÊúÄÁªàÂ∞Ü BootLoader Âä†ËΩΩÂà∞ RAM ÂΩì‰∏≠„ÄÇÁÑ∂Âêé BootLoader ÂºÄÂßãÊâßË°åÔºå‰∏ªË¶ÅË¥üË¥£Á°¨‰ª∂ÁöÑÂàùÂßãÂåñÔºåÂ∞ÜÂÜÖÊ†∏Á®ãÂ∫èÂä†ËΩΩÂà∞ÂÜÖÂ≠ò„ÄÇ init ËøõÁ®ãÁöÑÂêØÂä® ÂÜÖÊ†∏ÂêØÂä®‰πãÂêéÂ∞Ü‰ºöÂàùÂßãÂåñËΩØÁ°¨‰ª∂ÁéØÂ¢ÉÔºåÂä†ËΩΩÈ©±Âä®Á®ãÂ∫èÔºåÊåÇËΩΩÊ†πÊñá‰ª∂Á≥ªÁªüÔºåÁÑ∂ÂêéÂàõÂª∫ init ËøõÁ®ãÔºåinit ‰Ωú‰∏∫Á≥ªÁªü‰∏≠ÁöÑÁ¨¨‰∏Ä‰∏™Áî®Êà∑ËøõÁ®ãÔºåÂÖ∂ËøõÁ®ãÂè∑‰∏∫ 1ÔºåÂú®ÂàõÂª∫ init ËøõÁ®ã‰πãÊó∂ÔºåÁ≥ªÁªü‰ºöÊâßË°å‰Ωç‰∫é system/core/init ‰∏ãÁöÑ init.cpp Á®ãÂ∫è 123456789101112131415161718192021222324252627282930313233343536int main(int argc, char** argv) &#123; ... //ÂàõÂª∫Áî®Êà∑Á©∫Èó¥ÁõÆÂΩïÂπ∂ÊåÇËΩΩ if (is_first_stage) &#123; mount("tmpfs", "/dev", "tmpfs", MS_NOSUID, "mode=0755"); mkdir("/dev/pts", 0755); mkdir("/dev/socket", 0755); mount("devpts", "/dev/pts", "devpts", 0, NULL); #define MAKE_STR(x) __STRING(x) mount("proc", "/proc", "proc", 0, "hidepid=2,gid=" MAKE_STR(AID_READPROC)); mount("sysfs", "/sys", "sysfs", 0, NULL); &#125; ... signal_handler_init(); property_load_boot_defaults(); export_oem_lock_status(); //ÂêØÂä®Â±ûÊÄßÊúçÂä° start_property_service(); ... const BuiltinFunctionMap function_map; Action::set_function_map(&amp;function_map); Parser&amp; parser = Parser::GetInstance(); parser.AddSectionParser("service",std::make_unique&lt;ServiceParser&gt;()); parser.AddSectionParser("on", std::make_unique&lt;ActionParser&gt;()); parser.AddSectionParser("import", std::make_unique&lt;ImportParser&gt;()); //Ëß£Êûê init.rc Êñá‰ª∂ parser.ParseConfig("/init.rc"); ... return 0;&#125; ÂèØ‰ª•ÁúãÂà∞ init ËøõÁ®ã‰∏ªË¶ÅÂÅö‰∫Ü‰∏â‰ª∂‰∫ãÊÉÖÔºöÂàõÂª∫Áî®Êà∑Á©∫Èó¥Êñá‰ª∂Â§πÂπ∂ÊåÇËΩΩ„ÄÅÂêØÂä®Â±ûÊÄßÊúçÂä°„ÄÅËß£Êûê‰Ωç‰∫é systemÊñá‰ª∂Â§π‰∏ãÁöÑ init.rc Êñá‰ª∂„ÄÇ ËøôÈáåÊàë‰ª¨‰∏ªË¶ÅÂÖ≥Ê≥®Ëß£Êûê init.rc Êñá‰ª∂ÁöÑËøáÁ®ãÔºåÂõ†‰∏∫ zygote ËøõÁ®ãÂ∞±ÊòØÂú®Ëøô‰∏™ËøáÁ®ã‰∏≠ÂàõÂª∫ÁöÑ„ÄÇ Android Init Language Áî±‰∫é init.rc ÊòØ‰∏Ä‰∏™Áî® Android ÂàùÂßãÂåñËØ≠Ë®ÄÔºàAILÔºâÁºñÂÜôÁöÑÊñá‰ª∂Ôºå‰∏∫‰∫ÜÊõ¥Â•ΩÁöÑÁêÜËß£ rc Êñá‰ª∂ÁöÑËß£ÊûêËøáÁ®ãÈúÄË¶Å‰∫ÜËß£‰∏ÄÈÉ®ÂàÜ AIL ËØ≠Ê≥ï„ÄÇ AIL ‰∏ªË¶ÅÊúâ‰∫îÁßçÁ±ªÂûãËØ≠Âè• Actions„ÄÅCommands„ÄÅServices„ÄÅOptions„ÄÅImportsÔºåÂú® AIL ‰∏≠ÊØè‰∏™ÈÉ®ÂàÜ(ËØ≠Âè•Âùó)Ë°®Á§∫‰∏∫‰∏Ä‰∏™ SectionÔºåÊØîÂ¶ÇÔºö 1234on boot ifup lo hostname localhost domainname localdomain ‰∫îÁßçËØ≠Âè•‰∏≠Âè™Êúâ Actions„ÄÅServices„ÄÅImport ÂèØ‰ª•Áî®‰∫éÁ°ÆÂÆö‰∏Ä‰∏™ Section„ÄÇÂÖ∂‰∏≠ Actions Áî±‰∏ÄÁ≥ªÂàó command ÁªÑÊàêÔºåActions Êã•Êúâ‰∏Ä‰∏™ trigger Áî®‰∫éÁ°ÆÂÆö‰ΩïÊó∂ÊâßË°åËøô‰∫õÂëΩ‰ª§„ÄÇ 12345678on &lt;trigger&gt; &lt;command&gt; &lt;command&gt; &lt;command&gt; on early-init //Ëß¶ÂèëÂô® early-init write /proc/1/oom_score_adj -1000 //command write /proc/sys/kernel/sysrq 0 Services Áî±‰∏Ä‰∫õ option ÁªÑÊàêÔºåÂÖ∂Âú®ÂàùÂßãÂåñÁöÑÊó∂ÂÄôÂêØÂä®ÔºåÂπ∂ÂèØ‰ª•Âú®ÈÄÄÂá∫ÂêéÈáçÂêØÔºàÂèØÈÄâÔºâ„ÄÇ 12345678service &lt;name&gt; &lt;pathname&gt; [ &lt;argument&gt; ]* //ÊúçÂä°Âêç„ÄÅÊâßË°åË∑ØÂæÑ„ÄÅÂèÇÊï∞ &lt;option&gt; &lt;option&gt; service ueventd /sbin/ueventd class core critical seclabel u:r:ueventd:s0 Services ÂÆö‰πâ‰∫ÜËá™Ë∫´ÁöÑÊúçÂä°Âêç„ÄÅÊâßË°åË∑ØÂæÑ‰ª•ÂèäÊâßË°åÊó∂‰º†ÂÖ•ÁöÑÂèÇÊï∞Ôºåoption Áî®‰∫éÊåáÂÆö‰ΩïÊó∂ÂíåÊÄéÊ†∑ÂêØÂä® serviceÔºåÂÖ≥‰∫é‰ΩïÊó∂ÂêØÂä®ËøôÈáåËøõË°å‰∏Ä‰∏ãËØ¥ÊòéÔºåActions ‰∏≠Êúâ‰∏ÄÊù°ÂëΩ‰ª§ÊòØ class_start Áî®‰∫éÂêØÂä®ÊâÄÊúâÊú™ËøêË°åÁöÑÁõ∏ÂêåÁ±ªÂà´ÁöÑ serviceÔºåËÄå option ÂèØ‰ª•ÈÄöËøá class ÂØπ service ÁöÑÁ±ªÂà´ÂêçËøõË°åÊåáÂÆö„ÄÇÊâÄ‰ª• service ÁöÑÂêØÂä®‰∏ÄËà¨ÊòØÈÄöËøá action Ëß¶Âèë‰πãÂêéÊâßË°å class_start ÂëΩ‰ª§ËøõË°åÂêØÂä®ÁöÑ„ÄÇ AIL ÁöÑ‰ªãÁªçÂ∞±Âà∞Ëøô‰∫ÜÔºåÂ¶ÇÊûúÊÉ≥Ë¶ÅËØ¶ÁªÜ‰∫ÜËß£ËØ∑ÈòÖËØª system/core/init ‰∏ãÁöÑ readme.txt Êñá‰ª∂ init.rc Ëß£Êûê system/core/rootdir/init.rc Áé∞Âú®Êé•ÁùÄÂàÜÊûê init.rc Êñá‰ª∂ÔºåÂú®Êñá‰ª∂ÁöÑÈ¶ñÈÉ®ÂèØ‰ª•ÁúãÂà∞ 12345import /init.environ.rcimport /init.usb.rcimport /init.$&#123;ro.hardware&#125;.rcimport /init.usb.configfs.rcimport /init.$&#123;ro.zygote&#125;.rc Âú®ËøôÈáåÂèØ‰ª•ÁúãÂà∞ÈúÄË¶ÅÂêØÂä®ÁöÑ zygoteÔºå‰ΩÜÊòØ‰∏éÂÖ∂ÂÆÉÂºïÂÖ•ÁöÑ rc Êñá‰ª∂Áõ∏ÊØî zygote ÈÉ®ÂàÜÂπ∂Ê≤°Êúâ‰ΩøÁî®Á°ÆÂÆöÁöÑÂÄºÔºåËÄåÊòØ‰ΩøÁî® ${ro.zygote} ÂèòÈáèÂéªÊõø‰ª£ÔºåËøôÊòØÂõ†‰∏∫‰ªé Android Âú® 5.0 ‰ª•ÂêéÂºÄÂßãÊîØÊåÅ 64 ‰ΩçÁ®ãÂ∫èÔºåÊâÄ‰ª•ÈúÄË¶ÅÊ†πÊçÆÁ≥ªÁªü‰∏≠ ro.zygote Â±ûÊÄßÁöÑÂÄºÂä®ÊÄÅÂºïÂÖ•„ÄÇro.zygote ÁöÑÂÄºÂèØ‰ª•ÈÄöËøá adb shell getprop ËøõË°åÊü•ËØ¢ÔºåÊàëÁöÑÊâãÊú∫Êü•ËØ¢ÁªìÊûúÊòØÔºö ËøôËØ¥ÊòéÊâãÊú∫‰ºöÂêØÂä®‰∏§‰∏™ zygote ËøõÁ®ãÔºåÂØπÂ∫îÁöÑÊâßË°åÁ®ãÂ∫èÂàÜÂà´ÊòØ app_process64 (‰∏ªÊ®°Âºè)„ÄÅapp_process32ÔºåÈÄöËøá adb shell ps | grep zygote ÂèØ‰ª•ÁúãÂà∞Á°ÆÂÆûÂ≠òÂú®‰∏§‰∏™ zygote ËøõÁ®ã Êé•ÁùÄÊü•Áúã‰∏é init.rc Âêå‰∏ÄÁõÆÂΩï‰∏ãÁöÑ init.zygote64_32.rc Êñá‰ª∂ system/core/rootdir/init.zygote64_32.rc 12345678910111213141516service zygote /system/bin/app_process64 -Xzygote /system/bin --zygote --start-system-server --socket-name=zygote class main socket zygote stream 660 root system onrestart write /sys/android_power/request_state wake onrestart write /sys/power/state on onrestart restart audioserver onrestart restart cameraserver onrestart restart media onrestart restart netd writepid /dev/cpuset/foreground/tasks /sys/fs/cgroup/stune/foreground/tasksservice zygote_secondary /system/bin/app_process32 -Xzygote /system/bin --zygote --socket-name=zygote_secondary class main socket zygote_secondary stream 660 root system onrestart restart zygote writepid /dev/cpuset/foreground/tasks /dev/stune/foreground/tasks ÂâçÊñáËØ¥Ëøá service ÁöÑÂêØÂä®ÂíåÁ±ªÂà´ÂêçÁõ∏ÂÖ≥ÔºåËøôÈáå‰∏§‰∏™ zygote service ÁöÑÁ±ªÂà´ÂêçÈÉΩÊòØ mainÔºåÊâÄ‰ª•Ë¶ÅÊÉ≥Áü•ÈÅì zygote ÊÄé‰πàË¢´ÂêØÂä®ÁöÑÊàë‰ª¨ÂèØ‰ª•Âú® init.rc ‰∏≠ÊêúÁ¥¢ class_start mainÔºåÂèØ‰ª•ÂèëÁé∞ 12345on nonencrypted # A/B update verifier that marks a successful boot. exec - root -- /system/bin/update_verifier nonencrypted class_start main class_start late_start ‰ªéËøôÈáåÊàë‰ª¨ÂèØ‰ª•‰∫ÜËß£Âà∞ÂΩì nonencrypted Ëøô‰∏™Ëß¶ÂèëÂô®Ë¢´Ëß¶ÂèëÁöÑÊó∂ÂÄô zygote Â∞±‰ºöË¢´ÂêØÂä®ÔºåÊâÄ‰ª•ÂêØÂä® zygote ÁöÑÈóÆÈ¢òÂ∞±ËΩ¨Âèò‰∏∫Ëøô‰∏™Ëß¶ÂèëÂô®‰ªÄ‰πàÊó∂ÂÄôÊâßË°åÔºüclass_start ÂØπÂ∫îÁöÑÂ§ÑÁêÜÂáΩÊï∞ÊòØ‰ªÄ‰πàÔºüË¶ÅÊÉ≥Áü•ÈÅìÁ≠îÊ°àÔºåÂøÖÈ°ªÂõûÂà∞ init.cpp ÁöÑËß£ÊûêËøáÁ®ãÂΩì‰∏≠ 12345Parser&amp; parser = Parser::GetInstance();parser.AddSectionParser("service",std::make_unique&lt;ServiceParser&gt;());parser.AddSectionParser("on", std::make_unique&lt;ActionParser&gt;());parser.AddSectionParser("import", std::make_unique&lt;ImportParser&gt;());parser.ParseConfig("/init.rc"); init.rc ‰∫§Áî±‰∏Ä‰∏™ Parser ÂØπË±°ËøõË°åËß£ÊûêÔºåËÄå Parser ÁöÑÂÆûÁé∞Âú® system/core/init/init_parser.cpp Êñá‰ª∂‰∏≠ÔºåËÆ©Êàë‰ª¨ËøõÂÖ•Âà∞ init_parser.cpp ‰∏≠Êü•Áúã AddSectionParser ÁöÑÂÆûÁé∞ 1234567void Parser::AddSectionParser(const std::string&amp; name, std::unique_ptr&lt;SectionParser&gt; parser) &#123; section_parsers_[name] = std::move(parser);&#125;//init_parser.h ‰∏≠ section_parsers_ ÁöÑÂÆö‰πâstd::map&lt;std::string, std::unique_ptr&lt;SectionParser&gt;&gt; section_parsers_; ÂèØ‰ª•ÁúãÂà∞ÊØè‰∏Ä‰∏™ parser ÊúÄÁªàË¢´‰øùÂ≠òÂú® section_parsers_ ‰∏≠Ôºåsection_parsers_ ÊòØ‰ªÄ‰πàÔºüÊü•Áúã init_parser.h ‰∏≠ÁöÑÂÆö‰πâÂèØ‰ª•Áü•ÈÅìÔºåsection_parsers_ ÊòØ‰∏Ä‰∏™ map ÈõÜÂêàÔºåÊâÄ‰ª• section_parsers_ ÁöÑ‰ΩúÁî®ÊòØÂ∞Ü parser ‰∏éÂØπÂ∫îÁöÑ Section ËøõË°åÁªëÂÆö„ÄÇ Âú®Ê∑ªÂä†ÂÆåÊâÄÊúâÁöÑ parser ‰πãÂêéÂ∞±‰ºöË∞ÉÁî® Parser ÁöÑ ParseConfig ÊñπÊ≥ï 123456bool Parser::ParseConfig(const std::string&amp; path) &#123; if (is_dir(path.c_str())) &#123; return ParseConfigDir(path); &#125; return ParseConfigFile(path);&#125; ParseConfig ‰∏≠‰ºöÂØπ path ËøõË°åÂà§Êñ≠ÔºåÂ¶ÇÊûúÊòØÁõÆÂΩïÂàôË∞ÉÁî® ParseConfigDir ËøõË°åÈÄíÂΩíÁÑ∂ÂêéÂÜçÈÄöËøá ParseConfigFile ËøõË°åËß£Êûê„ÄÇ 1234567891011121314151617181920bool Parser::ParseConfigDir(const std::string&amp; path) &#123; INFO("Parsing directory %s...\n", path.c_str()); std::unique_ptr&lt;DIR, int(*)(DIR*)&gt; config_dir(opendir(path.c_str()), closedir); if (!config_dir) &#123; ERROR("Could not import directory '%s'\n", path.c_str()); return false; &#125; dirent* current_file; while ((current_file = readdir(config_dir.get()))) &#123; std::string current_path = android::base::StringPrintf("%s/%s", path.c_str(), current_file-&gt;d_name); // Ignore directories and only process regular files. if (current_file-&gt;d_type == DT_REG) &#123; if (!ParseConfigFile(current_path)) &#123; //Ë∞ÉÁî® ParseConfigFile ËøõË°åËß£Êûê ERROR("could not import file '%s'\n", current_path.c_str()); &#125; &#125; &#125; return true;&#125; ÊúÄÁªàÂú® ParseConfigFile ‰∏≠ÈÄöËøá ParseData ËøõË°åËß£Êûê 1234567891011121314bool Parser::ParseConfigFile(const std::string&amp; path) &#123; INFO("Parsing file %s...\n", path.c_str()); Timer t; std::string data; //‰ªé rc Êñá‰ª∂‰∏≠ËØªÂèñÂÜÖÂÆπ‰øùÂ≠òÂú® data ‰∏≠ if (!read_file(path.c_str(), &amp;data)) &#123; return false; &#125; data.push_back('\n'); // TODO: fix parse_config. ParseData(path, data); //Ë∞ÉÁî® ParseData ËøõË°åËß£Êûê ... return true;&#125; ParseData Ëß£ÊûêËøáÁ®ãÂ¶Ç‰∏ã 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657void Parser::ParseData(const std::string&amp; filename, const std::string&amp; data) &#123; //TODO: Use a parser with const input and remove this copy std::vector&lt;char&gt; data_copy(data.begin(), data.end()); //Â∞Ü rc ‰∏≠ÁöÑÂÜÖÂÆπ‰øùÂ≠òÂú® vector ‰∏≠‰æø‰∫éÈÄê‰∏™Â≠óÁ¨¶ËøõË°åËß£Êûê data_copy.push_back('\0'); parse_state state; state.filename = filename.c_str(); state.line = 0; state.ptr = &amp;data_copy[0]; state.nexttoken = 0; SectionParser* section_parser = nullptr; std::vector&lt;std::string&gt; args; //Â≠òÊîæÁöÑÊòØÊØèË°åÁöÑÂÜÖÂÆπ for (;;) &#123; switch (next_token(&amp;state)) &#123; case T_EOF: if (section_parser) &#123; section_parser-&gt;EndSection(); &#125; return; case T_NEWLINE: state.line++; //Â¶ÇÊûú args ‰∏∫Á©∫Âàô‰∏çËøõË°åËß£ÊûêÔºàrc Êñá‰ª∂‰∏≠Èó¥Â≠òÂú®Á©∫Ë°åÔºåÊâÄ‰ª•ÈúÄË¶ÅÂà§Êñ≠Ôºâ if (args.empty()) &#123; break; &#125; //Âà§Êñ≠ÊòØ‰∏çÊòØ‰∏Ä‰∏™ section ÁöÑËµ∑Âßã‰ΩçÁΩÆÔºàÈÄöËøáËÉΩ‰∏çËÉΩËé∑ÂæóËß£ÊûêÂô®ÔºåÂèØ‰ª•Âà§Êñ≠ args[0] ÊòØ‰∏çÊòØ service„ÄÅon„ÄÅimport ÂÖ∂‰∏≠‰∏Ä‰∏™Ôºâ if (section_parsers_.count(args[0])) &#123; if (section_parser) &#123; //Â¶ÇÊûú‰∏äÊ¨°Â≠òÂú®Ëß£ÊûêÂàôÁªìÊùüËß£Êûê section_parser-&gt;EndSection(); &#125; //ÂèñÂá∫ÂØπÂ∫îÁöÑËß£ÊûêÂô® section_parser = section_parsers_[args[0]].get(); std::string ret_err; //ËøõË°å Section Ëß£Êûê if (!section_parser-&gt;ParseSection(args, &amp;ret_err)) &#123; parse_error(&amp;state, "%s\n", ret_err.c_str()); section_parser = nullptr; &#125; &#125; else if (section_parser) &#123; //‰∏çÊòØÁöÑËØùËØ¥Êòé args ‰∏≠ÊòØ‰∏Ä‰∏™ section ÁöÑÂ≠êÂùóÔºåÂàôËøõË°å Line Ëß£Êûê std::string ret_err; if (!section_parser-&gt;ParseLineSection(args, state.filename, state.line, &amp;ret_err)) &#123; parse_error(&amp;state, "%s\n", ret_err.c_str()); &#125; &#125; //Ëß£ÊûêÂÆåÊàêÂêéÊ∏ÖÁ©∫ args.clear(); break; case T_TEXT: args.emplace_back(state.text); break; &#125; &#125;&#125; ParseData ‰∏≠ÈÄöËøáË∞ÉÁî® system/core/init/parser.cpp ‰∏≠ÁöÑ next_token ÂáΩÊï∞ÂØπ rc ÂÜÖÂÆπËøõË°åÂàÜÊûêÔºåÂ¶ÇÊûúÊòØ T_TEXT Âàô‰ºö‰øùÂ≠òÂú® args ‰∏≠ÔºåÂ¶ÇÊûúÊòØ T_NEWLINE Âàô‰ºö‰∫§Áî±ÂØπÂ∫îÁöÑËß£ÊûêÂô®ËøõË°åËß£Êûê„ÄÇinit.rc ÁöÑÂ§ßËá¥Ëß£ÊûêËøáÁ®ãÂ¶ÇÊ≠§Ôºå‰ΩÜÊòØÂà∞ËøôÈáåÊàë‰ª¨‰æùÊóßÊ≤°ËÉΩÊâæÂà∞ÊâÄÈúÄË¶ÅÁöÑÁ≠îÊ°àÔºåÊâÄ‰ª•ÈúÄË¶ÅÁªßÁª≠Êü•Áúã ActionParser Âíå ServiceParser ÁöÑËß£ÊûêËøáÁ®ã„ÄÇ ActionParser Ëß£ÊûêËøáÁ®ã ActionParser ‰Ωç‰∫é system/core/init/action.cpp ‰∏≠Ôºå‰ªéÂâçÈù¢ÁöÑËß£ÊûêËøáÁ®ãÊù•ÁúãÔºåÊúÄÂêéÁöÑËß£ÊûêÊÄªÊòØË∞ÉÁî®‰∫ÜÂØπÂ∫î parser ÁöÑ ParseSection„ÄÅParseLineSection ‰ª•Âèä EndSectionÔºåÊâÄ‰ª•Êàë‰ª¨‰∏ªË¶ÅÁúã‰∏ãËøô‰∏§‰∏™ÈÉ®ÂàÜ ParseSection ÁöÑ‰∏ªË¶ÅÂ∑•‰ΩúÊòØÂàõÂª∫ Action ÂØπË±°Ôºå‰∏∫ÂØπË±°Ê∑ªÂä†Ëß¶ÂèëÂô®ÔºåÂπ∂Â∞Ü action_ ÁßªÂä®Ëá≥ÂΩìÂâç Action ÂØπË±° 12345678910111213141516171819bool ActionParser::ParseSection(const std::vector&lt;std::string&gt;&amp; args, std::string* err) &#123; std::vector&lt;std::string&gt; triggers(args.begin() + 1, args.end()); ... auto action = std::make_unique&lt;Action&gt;(false); //‰∏∫ action Â¢ûÂä†Ëß¶ÂèëÂô® if (!action-&gt;InitTriggers(triggers, err)) &#123; return false; &#125; //Â∞Ü aciton_ ÊåáÈíàÁßªÂä®Âà∞ÂΩìÂâçÁöÑ action action_ = std::move(action); return true;&#125;//action_ Âú® action.h ‰∏≠ÁöÑÂÆö‰πâprivate: std::unique_ptr&lt;Action&gt; action_; ParseLineSection ÁöÑ‰∏ªË¶ÅÂ∑•‰Ωú‰∏∫Êü•ÊâæÂØπÂ∫î command ÁöÑÂ§ÑÁêÜÂáΩÊï∞ÔºåÂ∞ÜÂàõÂª∫ÁöÑ Command ÂØπË±°Ê∑ªÂä†Âà∞Âà∞commands_ÔºåÁî±‰∫é commands_ ÊòØ Action ÁöÑ‰∏Ä‰∏™ÂüüÔºåÊâÄ‰ª•ÂÆûÈôÖ‰∏ä ParseLineSection Âú®Â°´ÂÖÖÂΩìÂâç Action ÂØπË±°ÁöÑÂüü„ÄÇ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546bool ActionParser::ParseLineSection(const std::vector&lt;std::string&gt;&amp; args, const std::string&amp; filename, int line, std::string* err) const &#123; //Â∞ÜËß£ÊûêÁöÑ command Â¢ûÂä†Âà∞ÂΩìÂâç action ÁöÑ commands_ ‰∏≠ return action_ ? action_-&gt;AddCommand(args, filename, line, err) : false;&#125;bool Action::AddCommand(const std::vector&lt;std::string&gt;&amp; args, const std::string&amp; filename, int line, std::string* err) &#123; ... //Êü•ÊâæÂØπÂ∫îÁöÑ command ÁöÑÂ§ÑÁêÜÂáΩÊï∞ auto function = function_map_-&gt;FindFunction(args[0], args.size() - 1, err); if (!function) &#123; return false; &#125; AddCommand(function, args, filename, line); return true;&#125;void Action::AddCommand(BuiltinFunction f, const std::vector&lt;std::string&gt;&amp; args, const std::string&amp; filename, int line) &#123; //commands_ Â¢ûÂä† command ÂíåÂØπÂ∫îÁöÑÂ§ÑÁêÜÂáΩÊï∞ commands_.emplace_back(f, args, filename, line);&#125;//commands_ Âú® action.h ‰∏≠ÁöÑÂÆö‰πâstd::vector&lt;Command&gt; commands_;//Command Âú® action.h ‰∏≠ÁöÑÂÆö‰πâclass Command &#123;public: Command(BuiltinFunction f, const std::vector&lt;std::string&gt;&amp; args, const std::string&amp; filename, int line); int InvokeFunc() const; std::string BuildCommandString() const; std::string BuildSourceString() const;private: BuiltinFunction func_; std::vector&lt;std::string&gt; args_; std::string filename_; int line_;&#125;; EndSection ÁöÑ‰∏ªË¶ÅÂ∑•‰ΩúÊòØÂ∞ÜËß£ÊûêÂÆåÊàêÁöÑ action ÔºàÂüüÂ°´ÂÖÖÂÆåÊØïÁöÑ Action ÂØπË±°ÔºâÊ∑ªÂä†Âà∞ ActionManager ÁöÑ acitons_ ‰∏≠ 123456789101112131415161718192021222324252627282930313233343536373839404142void ActionParser::EndSection() &#123; if (action_ &amp;&amp; action_-&gt;NumCommands() &gt; 0) &#123; ActionManager::GetInstance().AddAction(std::move(action_)); &#125;&#125;void ActionManager::AddAction(std::unique_ptr&lt;Action&gt; action) &#123; ... if (old_action_it != actions_.end()) &#123; (*old_action_it)-&gt;CombineAction(*action); &#125; else &#123; //Â∞ÜËß£Êûê‰πãÂêéÁöÑ action ÂØπË±°Â¢ûÂä†Âà∞ actions_ ÈìæË°®‰∏≠ÔºåÁî®‰∫éÈÅçÂéÜÊâßË°å„ÄÇ actions_.emplace_back(std::move(action)); &#125;&#125;//ActionManager Âú® action.h ‰∏≠ÁöÑÂÆö‰πâclass ActionManager &#123;public: static ActionManager&amp; GetInstance(); void AddAction(std::unique_ptr&lt;Action&gt; action); void QueueEventTrigger(const std::string&amp; trigger); void QueuePropertyTrigger(const std::string&amp; name, const std::string&amp; value); void QueueAllPropertyTriggers(); void QueueBuiltinAction(BuiltinFunction func, const std::string&amp; name); void ExecuteOneCommand(); bool HasMoreCommands() const; void DumpState() const;private: ActionManager(); ActionManager(ActionManager const&amp;) = delete; void operator=(ActionManager const&amp;) = delete; std::vector&lt;std::unique_ptr&lt;Action&gt;&gt; actions_; //actions_ ÁöÑÂÆö‰πâ std::queue&lt;std::unique_ptr&lt;Trigger&gt;&gt; trigger_queue_; std::queue&lt;const Action*&gt; current_executing_actions_; std::size_t current_command_;&#125;; ÈÄöËøá‰ª•‰∏äÂàÜÊûêÊàë‰ª¨ËÉΩÂ§üÁü•ÈÅì class_start ÁöÑÂ§ÑÁêÜÂáΩÊï∞Âíå function_map_ Áõ∏ÂÖ≥ÔºåÊü•Áúã function_map_ Âú® action.h ‰∏≠ÁöÑÂÆö‰πâÂèØ‰ª•ÁúãÂà∞ 12345static const KeywordMap&lt;BuiltinFunction&gt;* function_map_;static void set_function_map(const KeywordMap&lt;BuiltinFunction&gt;* function_map) &#123; function_map_ = function_map;&#125; ÊâÄ‰ª•Ë¶ÅÊÉ≥Áü•ÈÅìÂ§ÑÁêÜÂáΩÊï∞ÊòØ‰ªÄ‰πàÂè™ÈúÄË¶ÅÁü•ÈÅì set_function_map Âú®Âì™ÈáåË∞ÉÁî®ÔºüËÆ©Êàë‰ª¨ÂÜçÊ¨°ÂõûÂà∞ init.cpp ‰∏≠ÔºåÂèØ‰ª•ÁúãÂà∞ 12const BuiltinFunctionMap function_map;Action::set_function_map(&amp;function_map); Êé•‰∏ãÊù•ÈúÄË¶ÅÊâæÂà∞ BuiltinFunctionMapÔºåBuiltinFunctionMap ÁöÑÂÆûÁé∞Êàë‰ª¨ÂèØ‰ª•Âú® builtins.cpp ‰∏≠ÊâæÂà∞ÔºåÂÖ∂ÂÖ∑‰ΩìÁöÑÂÆûÁé∞ system/core/init/builtins.cpp 12345678910BuiltinFunctionMap::Map&amp; BuiltinFunctionMap::map() const &#123; constexpr std::size_t kMax = std::numeric_limits&lt;std::size_t&gt;::max(); static const Map builtin_functions = &#123; ... &#123;"class_start", &#123;1, 1, do_class_start&#125;&#125;, &#123;"class_stop", &#123;1, 1, do_class_stop&#125;&#125;, ... &#125;; return builtin_functions;&#125; Âà∞ËøôÈáåÂ∞±ÂèØ‰ª•Á°ÆÂÆö class_start ÂØπÂ∫îÁöÑÂ§ÑÁêÜÂáΩÊï∞ÊòØ do_class_startÔºådo_class_start ‰πüÂèØÂú® builtins.cpp ‰∏≠ÊâæÂà∞„ÄÇ ÁÆÄÂçïÊÄªÁªì‰∏ãËß£Êûê Action ÁöÑËøáÁ®ãÔºåÂÆûÈôÖ‰∏äÊòØÂàõÂª∫‰∏Ä‰∏™ Action ÂØπË±°ÔºåÁÑ∂Âêé‰∏∫ Action ÂØπË±°Ê∑ªÂä† Trigger ‰ª•ÂèäÂØπÂ∫îÁöÑ CommandÔºåÂÖ∂‰∏≠Âú®Ê∑ªÂä† Command ÁöÑËøáÁ®ã‰∏≠Ëøò‰∏∫ Command ÊåáÂÆö‰∫ÜÂ§ÑÁêÜÂáΩÊï∞ÔºåÊúÄÂêéÂú®Â∞Ü Action ÂØπË±°Â¢ûÂä†Âà∞ ActionManager vector Á±ªÂûãÁöÑ actions_ ÈìæË°®ÂΩì‰∏≠Âéª„ÄÇ ServiceParser Ëß£ÊûêËøáÁ®ã ‰∏éÂâçÊñá‰∏ÄËá¥ÔºåÊé•ÁùÄÁúãÈÇ£‰∏â‰∏™ÂáΩÊï∞ ParseSection ÁöÑ‰∏ªË¶ÅÂ∑•‰ΩúÊòØÂàõÂª∫ Service ÂØπË±°ÔºåÂ∞Ü service_ ÁßªÂä®Ëá≥ÂΩìÂâç Service ÂØπË±° 123456789101112131415bool ServiceParser::ParseSection(const std::vector&lt;std::string&gt;&amp; args, std::string* err) &#123; ... //Ëé∑ÂèñÊúçÂä°Âêç const std::string&amp; name = args[1]; ... //‰øùÂ≠òÊúçÂä°ÂêçÂ§ñÁöÑÂèÇÊï∞ÔºàÂ¶ÇÊâßË°åË∑ØÂæÑÁ≠âÔºâ std::vector&lt;std::string&gt; str_args(args.begin() + 2, args.end()); //Â∞Ü service_ ÊåáÈíàÊåáÂêëÂΩìÂâç Service ÂØπË±° service_ = std::make_unique&lt;Service&gt;(name, "default", str_args); return true;&#125;//service_ Âú® service.h ‰∏≠ÁöÑÂÆö‰πâstd::unique_ptr&lt;Service&gt; service_; ParseLineSection ÁöÑ‰∏ªË¶ÅÂ∑•‰ΩúÊòØ‰∏∫ Service ‰∏≠ÊØè‰∏™ option ÊåáÂÆöÂ§ÑÁêÜÂáΩÊï∞ 123456789101112131415161718bool ServiceParser::ParseLineSection(const std::vector&lt;std::string&gt;&amp; args, const std::string&amp; filename, int line, std::string* err) const &#123; //‰∏∫ Service ‰∏≠ÁöÑÊØè‰∏Ä‰∏™ Option ÊåáÂÆöÂ§ÑÁêÜÂáΩÊï∞ return service_ ? service_-&gt;HandleLine(args, err) : false;&#125;bool Service::HandleLine(const std::vector&lt;std::string&gt;&amp; args, std::string* err) &#123; ... static const OptionHandlerMap handler_map; //ÂØªÊâæÂØπÂ∫î option ÁöÑÂ§ÑÁêÜÂáΩÊï∞ auto handler = handler_map.FindFunction(args[0], args.size() - 1, err); ... return (this-&gt;*handler)(args, err);&#125; EndSection ÁöÑ‰∏ªË¶ÅÂ∑•‰ΩúÊòØÂ∞ÜËß£ÊûêÂÆåÊàêÁöÑ service ÔºàÂüüÂ°´ÂÖÖÂÆåÊØïÁöÑ Service ÂØπË±°ÔºâÊ∑ªÂä†Âà∞ ServiceManager ÁöÑ services_ ‰∏≠ 123456789101112131415161718192021222324252627282930313233343536373839404142void ServiceParser::EndSection() &#123; if (service_) &#123; ServiceManager::GetInstance().AddService(std::move(service_)); &#125;&#125;void ServiceManager::AddService(std::unique_ptr&lt;Service&gt; service) &#123; Service* old_service = FindServiceByName(service-&gt;name()); if (old_service) &#123; ERROR("ignored duplicate definition of service '%s'", service-&gt;name().c_str()); return; &#125; //Â∞ÜËß£Êûê‰πãÂêé service ÂØπË±°Â¢ûÂä†Âà∞ services_ ÈìæË°®‰∏≠ services_.emplace_back(std::move(service));&#125;//ServiceManager Âú® service.h ‰∏≠ÁöÑÂÆö‰πâclass ServiceManager &#123;public: static ServiceManager&amp; GetInstance(); void AddService(std::unique_ptr&lt;Service&gt; service); Service* MakeExecOneshotService(const std::vector&lt;std::string&gt;&amp; args); Service* FindServiceByName(const std::string&amp; name) const; Service* FindServiceByPid(pid_t pid) const; Service* FindServiceByKeychord(int keychord_id) const; void ForEachService(std::function&lt;void(Service*)&gt; callback) const; void ForEachServiceInClass(const std::string&amp; classname, void (*func)(Service* svc)) const; void ForEachServiceWithFlags(unsigned matchflags, void (*func)(Service* svc)) const; void ReapAnyOutstandingChildren(); void RemoveService(const Service&amp; svc); void DumpState() const;private: ServiceManager(); bool ReapOneProcess(); static int exec_count_; // Every service needs a unique name. std::vector&lt;std::unique_ptr&lt;Service&gt;&gt; services_; //services_ ÁöÑÂÆö‰πâ&#125;; ÂØπÂ∫îÁöÑÂèØ‰ª•Áúã‰∏ã option ÁöÑÂ§ÑÁêÜÂáΩÊï∞ÔºåËôΩÁÑ∂ OptionHandlerMap ‰∏éÂêØÂä® zygote Êó†ÂÖ≥Ôºå‰ΩÜÊòØËøòÊòØÁúã‰∏ã 1234567891011121314151617181920Service::OptionHandlerMap::Map&amp; Service::OptionHandlerMap::map() const &#123; constexpr std::size_t kMax = std::numeric_limits&lt;std::size_t&gt;::max(); static const Map option_handlers = &#123; &#123;"class", &#123;1, 1, &amp;Service::HandleClass&#125;&#125;, &#123;"console", &#123;0, 0, &amp;Service::HandleConsole&#125;&#125;, &#123;"critical", &#123;0, 0, &amp;Service::HandleCritical&#125;&#125;, &#123;"disabled", &#123;0, 0, &amp;Service::HandleDisabled&#125;&#125;, &#123;"group", &#123;1, NR_SVC_SUPP_GIDS + 1, &amp;Service::HandleGroup&#125;&#125;, &#123;"ioprio", &#123;2, 2, &amp;Service::HandleIoprio&#125;&#125;, &#123;"keycodes", &#123;1, kMax, &amp;Service::HandleKeycodes&#125;&#125;, &#123;"oneshot", &#123;0, 0, &amp;Service::HandleOneshot&#125;&#125;, &#123;"onrestart", &#123;1, kMax, &amp;Service::HandleOnrestart&#125;&#125;, &#123;"seclabel", &#123;1, 1, &amp;Service::HandleSeclabel&#125;&#125;, &#123;"setenv", &#123;2, 2, &amp;Service::HandleSetenv&#125;&#125;, &#123;"socket", &#123;3, 6, &amp;Service::HandleSocket&#125;&#125;, &#123;"user", &#123;1, 1, &amp;Service::HandleUser&#125;&#125;, &#123;"writepid", &#123;1, kMax, &amp;Service::HandleWritepid&#125;&#125;, &#125;; return option_handlers;&#125; ‰∏éËß£Êûê Action Á±ª‰ººÔºåÂú®Êï¥‰∏™ËøáÁ®ã‰∏≠ÂÖàÂàõÂª∫ Service ÂØπË±°ÔºåËß£ÊûêÂá∫ Service ÁöÑÂêçÂ≠óÂíåÂØπÂ∫îÁöÑÂèÇÊï∞Ê∑ªÂä†Âà∞ÂØπË±°ÂΩì‰∏≠ÔºåÂπ∂‰∏îÁªôÊØè‰∏™ Option ÊåáÂÆö‰∫ÜÁõ∏Â∫îÁöÑÂ§ÑÁêÜÂáΩÊï∞ Âà∞ËøôÈáå rc Êñá‰ª∂ÁöÑËß£ÊûêÂ∞±ÁªìÊùü‰∫ÜÔºåÈÄöËøá rc Êñá‰ª∂ÁöÑËß£Êûê‰ΩøÂæóÊØè‰∏™ action ÈÉΩÊúâ‰∫ÜÂØπÂ∫îÁöÑÊâßË°åÂáΩÊï∞ÔºåÊâÄ‰ª•Êé•‰∏ãÊù•ÁöÑÈóÆÈ¢òÊòØËøô‰∫õ action ÊòØÂ¶Ç‰ΩïË¢´Ëß¶ÂèëÁöÑÔºà‰πüÂç≥ÊòØ command ÂëΩ‰ª§ÊòØÂ¶Ç‰ΩïË¢´ÊâßË°åÁöÑÔºâÔºü Actions ÁöÑËß¶Âèë ËÆ©Êàë‰ª¨ÁªßÁª≠ÂõûÂà∞ init.cpp ‰∏≠ 12345678910ActionManager&amp; am = ActionManager::GetInstance();....while (true) &#123; if (!waiting_for_exec) &#123; am.ExecuteOneCommand(); restart_processes(); &#125;...&#125; ÂèØ‰ª•ÁúãÂà∞ action ÁöÑ command ÁöÑÊâßË°åÊòØÈÄöËøá ActionManager ÁöÑ ExecuteOneCommand ÂáΩÊï∞ÔºåËÄåActionManager ÁöÑ ExecuteOneCommand ÊúÄÁªàË∞ÉÁî®‰∫Ü Action ÁöÑ ExecuteOneCommand system/core/init/action.cpp 123456789101112131415161718192021222324252627282930313233343536373839404142void ActionManager::ExecuteOneCommand() &#123; //Âæ™ÁéØÁ≠âÂæÖÔºåÁõ¥Âà∞ÈòüÂàó‰∏≠‰∏ç‰∏∫Á©∫ while (current_executing_actions_.empty() &amp;&amp; !trigger_queue_.empty()) &#123; //ÈÅçÂéÜ actions_ for (const auto&amp; action : actions_) &#123; if (trigger_queue_.front()-&gt;CheckTriggers(*action)) &#123; //Â∞Ü action Âä†ÂÖ•Âà∞ current_executing_actions_ ‰∏≠ current_executing_actions_.emplace(action.get()); &#125; &#125; trigger_queue_.pop(); &#125; ... //ÊØèÊ¨°Âè™ÊâßË°å‰∏Ä‰∏™ action auto action = current_executing_actions_.front(); if (current_command_ == 0) &#123; std::string trigger_name = action-&gt;BuildTriggersString(); INFO("processing action (%s)\n", trigger_name.c_str()); &#125; //ÊâßË°å action ÁöÑ command action-&gt;ExecuteOneCommand(current_command_); ++current_command_; ...&#125;void Action::ExecuteOneCommand(std::size_t command) const &#123; //ÊâßË°å action ÂØπË±°‰∏≠‰øùÂ≠òÁöÑ command ExecuteCommand(commands_[command]);&#125;void Action::ExecuteCommand(const Command&amp; command) const &#123; Timer t; //Ë∞ÉÁî® command ÂØπÂ∫îÁöÑÂ§ÑÁêÜÂáΩÊï∞ int result = command.InvokeFunc(); ...&#125; ÈÄöËøá‰∏äËø∞ÂàÜÊûêÂèØ‰ª•Áü•ÈÅìÔºåinit ËøõÁ®ãÊúÄÁªàËøõÂÖ•Âà∞Êó†ÈôêÂæ™ÁéØ‰∏≠ÔºåÁÑ∂ÂêéÊåâÁÖß ActionManager ‰∏≠ actions_ ‰øùÂ≠òÁöÑ action È°∫Â∫è‰æùÊ¨°ÂØπÊØè‰∏™ Action ËøõË°åÂ§ÑÁêÜÔºåËÄåÂú®Ëøô‰∏™ËøáÁ®ã‰∏≠ system/core/init/builtins.cpp ‰∏ãÁî®‰∫éÂêØÂä® zygote ÁöÑ do_class_start ÂáΩÊï∞Â∞Ü‰ºöË¢´ÊâßË°å 12345static int do_class_start(const std::vector&lt;std::string&gt;&amp; args) &#123; ServiceManager::GetInstance(). ForEachServiceInClass(args[1], [] (Service* s) &#123; s-&gt;StartIfNotDisabled(); &#125;); return 0;&#125; do_class_start ÂáΩÊï∞‰∏≠Ë∞ÉÁî® Service ÁöÑ StartIfNotDisabledÔºåStartIfNotDisabled Âú® service.cpp ÁöÑÂÆûÁé∞Â¶Ç‰∏ã 12345678bool Service::StartIfNotDisabled() &#123; if (!(flags_ &amp; SVC_DISABLED)) &#123; return Start(); &#125; else &#123; flags_ |= SVC_DISABLED_START; &#125; return true;&#125; StartIfNotDisabled ÊúÄÁªàË∞ÉÁî®‰∫Ü Service ÁöÑ Start ÂáΩÊï∞ÔºåStart ÂáΩÊï∞ÂàõÂª∫‰∫Ü zygote ÁöÑËøõÁ®ãÔºåÂπ∂‰∏îÊâßË°å‰∫Ü init.zygote64_32.rc ‰∏≠ÂÆö‰πâÁöÑÊâßË°åË∑ØÂæÑ‰∏ãÁöÑÊñá‰ª∂ 1234567891011121314151617bool Service::Start() &#123; .... //ÂàõÂª∫Â≠êËøõÁ®ã pid_t pid = fork(); if (pid == 0) &#123; ... //ÊâßË°åÂØπÂ∫î service ÂØπÂ∫îÁöÑÊâßË°åÊñá‰ª∂Ôºåargs_[0].c_str() Â∞±ÊòØÊâßË°åË∑ØÂæÑ if (execve(args_[0].c_str(), (char**) &amp;strs[0], (char**) ENV) &lt; 0) &#123; ERROR("cannot execve('%s'): %s\n", args_[0].c_str(), strerror(errno)); &#125; _exit(127); &#125; .... return true;&#125; Âú®ÂÆåÊàêËøô‰∏ÄÂàá‰πãÂêéÂ∞Ü‰ºöËøõÂÖ• frameworks/base/cmds/app_process/app_main.cpp ‰∏≠ 12345678910111213141516int main(int argc, char* const argv[])&#123; .... if (zygote) &#123; //ÂêØÂä® zygote runtime.start("com.android.internal.os.ZygoteInit", args, zygote); &#125; else if (className) &#123; runtime.start("com.android.internal.os.RuntimeInit", args, zygote); &#125; else &#123; fprintf(stderr, "Error: no class name or --zygote supplied.\n"); app_usage(); LOG_ALWAYS_FATAL("app_process: no class name or --zygote supplied."); return 10; &#125;&#125; ÂèØ‰ª•ÁúãÂà∞ zygote ÊúÄÁªàÂú® app_main ÁöÑ main ÂáΩÊï∞‰∏≠Ë¢´ÂêØÂä®„ÄÇ ÊÄªÁªì Âà∞ËøôÈáåÊàë‰ª¨Â∞±ËÉΩÂ§üÂõûÁ≠îÂØπ init ÈÉ®ÂàÜÁõ∏ÂÖ≥ÁöÑÈóÆÈ¢ò‰∫Ü 1. init ÁöÑ‰ΩúÁî® init ÊòØÁ≥ªÁªü‰∏≠ÁöÑÁ¨¨‰∏Ä‰∏™Áî®Êà∑ËøõÁ®ãÔºåÂÆÉÁöÑ‰∏ªË¶Å‰ΩúÁî®ÊòØÂàõÂª∫Áî®Êà∑Á©∫Èó¥Êñá‰ª∂Â§πÂπ∂ÊåÇËΩΩ„ÄÅÂêØÂä®Â±ûÊÄßÊúçÂä°„ÄÅËß£Êûê init.rc Êñá‰ª∂Âπ∂ÂêØÂä® zygote ËøõÁ®ã„ÄÇ 2. init ÂêØÂä® zygote ÁöÑËøáÁ®ã init ËøõÁ®ãÈÄöËøáËß£Êûê init.rc Êñá‰ª∂Â∞Ü action ‰øùÂ≠òÂú® ActionManager ÁöÑ actions_ ÈìæË°®‰∏≠ÔºåÁÑ∂ÂêéÈÄöËøáÈÅçÂéÜ actions_ ÈìæË°®ÔºåÊâßË°å action ÂëΩ‰ª§ÂØπÂ∫îÁöÑÂ§ÑÁêÜÂáΩÊï∞Ôºå‰ªéËÄåËΩ¨Ëá≥ builtins.cpp ÁöÑ do_class_start ÂáΩÊï∞Ôºå‰πãÂêéÈÄöËøá Service ÁöÑ StartIfNotDisabled Ë∞ÉÁî® Service ÁöÑ Start ÂáΩÊï∞ÔºåÊúÄÁªàÈÄöËøá Start ÂáΩÊï∞ÂàõÂª∫ zygote ËøõÁ®ãÔºåÊâßË°åÂØπÂ∫îÁöÑ app_main.cpp Êñá‰ª∂ÂêØÂä® zygote„ÄÇ Thanks Android7.0 initËøõÁ®ãÊ∫êÁ†ÅÂàÜÊûê Android Init Language(androidÂàùÂßãÂåñËØ≠Ë®Ä) AndroidÁ≥ªÁªüÂêØÂä®ÊµÅÁ®ãÔºà‰∏ÄÔºâËß£ÊûêinitËøõÁ®ãÂêØÂä®ËøáÁ®ã]]></content>
      <categories>
        <category>AndroidËøõÈò∂</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>Ê∫êÁ†ÅÂàÜÊûê</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Android Âü∫Á°Ä‰πã Selector ÁöÑÁî®Ê≥ï]]></title>
    <url>%2F2017%2F09%2F24%2FSelector%E7%9A%84%E7%94%A8%E6%B3%95%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä SelectorÔºàÈÄâÊã©Âô®ÔºâÂ∏∏Â∏∏Ë¢´Áî®‰ΩúÊéß‰ª∂ÁöÑËÉåÊôØÔºåÊòØ‰∏ÄÁßçÁä∂ÊÄÅÂàóË°®Ôºå‰∏ÄËà¨ÂàÜ‰∏∫ Drawable-selector Âíå Color-selectorÔºåÊé•‰∏ãÊù•ÂàÜÂà´ËØ¥ËØ¥Ëøô‰∏§ËÄÖÁöÑ‰ΩøÁî®ÊñπÊ≥ï„ÄÇ Drawable-selector È¶ñÂÖàÈúÄË¶ÅÂú® res/drawable Êñá‰ª∂Â§π‰∏ãÊñ∞Âª∫‰∏Ä‰∏™ Drawable Resource File Êñá‰ª∂ÔºåÂ°´ÂÖ•Êñá‰ª∂ÂêçÂç≥ÂèØÔºåÂàõÂª∫‰πãÂêéÁöÑÊñá‰ª∂ÂÜÖÂÆπÂ¶Ç‰∏ãÔºö 123&lt;?xml version="1.0" encoding="utf-8"?&gt;&lt;selector xmlns:android="http://schemas.android.com/apk/res/android"&gt;&lt;/selector&gt; Âú® selector Ê†áÁ≠æ‰∏ãÊñ∞Âª∫‰∏Ä‰∏™ item Ê†áÁ≠æÔºåitem Ê†áÁ≠æË°®Á§∫‰∏ÄÁßçÁä∂ÊÄÅÔºåÂ¶ÇÊûú‰∏çÊåáÊòéÁä∂ÊÄÅÔºåÈÇ£‰πàÊéß‰ª∂Âú®‰ªª‰ΩïÁä∂ÊÄÅ‰∏ãÈÉΩ‰ºöÂä†ËΩΩ item ÂÜÖÁöÑ Ê†∑ÂºèÔºåÂ∏∏Áî®ÁöÑÁä∂ÊÄÅËÆæÁΩÆÂ¶Ç‰∏ãÊâÄÁ§∫Ôºö android:state_pressed ËÆæÁΩÆ‰∏∫ true Êó∂‰ª£Ë°®ÊåâÂéãÊéß‰ª∂ÁöÑÊó∂ÂÄô‰ΩøÁî® item Ê†∑Âºè android:state_selected ËÆæÁΩÆ‰∏∫ true Êó∂‰ª£Ë°®Êéß‰ª∂Ë¢´ÈÄâ‰∏≠ÁöÑÊó∂ÂÄô‰ΩøÁî® item Ê†∑Âºè android:state_checked ËÆæÁΩÆ‰∏∫ true Êó∂‰ª£Ë°®Êéß‰ª∂Â§Ñ‰∫é checked Áä∂ÊÄÅÁöÑÊó∂ÂÄô‰ΩøÁî® item Ê†∑Âºè Êé•‰∏ãÊù•Âú® item ÂÜÖÈÉ®ÂàõÂª∫ shape Ê†áÁ≠æÁî®‰∫éÊåáÂÆöÁªòÂà∂ÁöÑÂõæÂΩ¢Á±ªÂà´ÔºåÊÄªÂÖ±ÊúâÂõõÁßçÂõæÂΩ¢ÂèØ‰ª•ÈÄâÊã©ÂàÜÂà´ÊòØÔºörectangle„ÄÅoval„ÄÅline„ÄÅring„ÄÇÂú®Á°ÆÂÆöÈúÄË¶ÅÁªòÂà∂ÁöÑ shape Á±ªÂûã‰πãÂêéÔºåÂ∞±ÂèØ‰ª•Âú® shape Ê†áÁ≠æÂÜÖÈÉ®ÂØπ shape ÁöÑÂêÑÈ°πÂ±ûÊÄßËøõË°åÈÖçÁΩÆÔºåÊÄªÂÖ±ÊúâÂÖ≠ÁßçÊ†áÁ≠æÂ±ûÊÄß„ÄÇ size Áî®Êù•ËÆæÁΩÆ shape ÁöÑÂ§ßÂ∞è solid Áî®Êù•ËÆæÁΩÆÂ°´ÂÖÖ shape ÁöÑÈ¢úËâ≤ corners Áî®Êù•ËÆæÁΩÆ shape ÁöÑËßíÂ∫¶ stroke Áî®Êù•Áªô shape ÊèèËæπÔºåÂèØ‰ª•ÊèèÊàêËôöÁ∫øÊàñÂÆûÁ∫ø padding ËÆæÁΩÆÂÜÖËæπË∑ù gradient ËÆæÁΩÆ shape ÁöÑÊ∏êÂèòÈ¢úËâ≤ ËÆæÁΩÆÂ•ΩÁõ∏Â∫îÁöÑÂ±ûÊÄß‰πãÂêéÂ∞±ÂèØ‰ª•ÈÄöËøáËÆæÁΩÆÊéß‰ª∂ÁöÑ android:drawble Â±ûÊÄßËøõË°å‰ΩøÁî®‰∫ÜÔºåËøôÈáåÁªôÂá∫‰∏Ä‰∏™‰æãÂ≠ê 12345678910111213141516171819202122&lt;?xml version="1.0" encoding="utf-8"?&gt;&lt;selector xmlns:android="http://schemas.android.com/apk/res/android"&gt; &lt;item android:state_pressed="true"&gt; &lt;shape android:shape="rectangle"&gt; &lt;corners android:radius="5dp" /&gt; &lt;stroke android:width="1dp" android:color="#00faff" android:dashGap="10dp" android:dashWidth="10dp" /&gt; &lt;size android:width="150dp" android:height="150dp" /&gt; &lt;solid android:color="#bcb7b7" /&gt; &lt;/shape&gt; &lt;/item&gt; &lt;item android:state_pressed="false"&gt; &lt;shape android:shape="oval"&gt; &lt;corners android:radius="360dp" /&gt; &lt;stroke android:width="1dp" android:color="#00fcb5" android:dashGap="10dp" android:dashWidth="10dp" /&gt; &lt;size android:width="300dp" android:height="300dp" /&gt; &lt;solid android:color="#ffff" /&gt; &lt;/shape&gt; &lt;/item&gt;&lt;/selector&gt; ‰∏äËø∞‰ª£Á†ÅÁªòÂà∂‰∫Ü‰∏§ÁßçÁä∂ÊÄÅÔºå‰∏ÄÁßçÊòØÈªòËÆ§Áä∂ÊÄÅ‰∏ãÁöÑÂúÜÔºåÁôΩËâ≤Â°´ÂÖÖ„ÄÅËôöÁ∫øÊèèËæπ„ÄÅÂçäÂæÑÊòØ 300dp„ÄÇÂè¶‰∏ÄÁßçÊòØË¢´Êåâ‰∏ãÁöÑÁä∂ÊÄÅÔºåÁÅ∞Ëâ≤Â°´ÂÖÖ„ÄÅËôöÁ∫øÊèèËæπ„ÄÅÈïøÂíåÂÆΩ‰∏éÂúÜ‰∏ÄËá¥„ÄÇÂÖ∑‰ΩìÊïàÊûúÂ¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö Color-selector Color-selector ÂÆö‰πâÂú® resÊñá‰ª∂Â§π‰∏ãÔºå‰ΩøÁî®ËøáÁ®ãÂü∫Êú¨‰∏é Drawable-selector ‰∏ÄËá¥Ôºå‰∏çÂêåÂú®‰∫é Color-selector Âè™ÊòØÁî®‰∫éÂÆö‰πâÊéß‰ª∂ÁöÑÈ¢úËâ≤ÔºåÊâÄ‰ª•Âè™ÈúÄË¶ÅÈÖçÁΩÆ item Ê†áÁ≠æÁöÑ color Â±ûÊÄßÂç≥ÂèØÔºåÂÖ∑‰ΩìÁöÑ‰æãÂ≠êÂ¶Ç‰∏ãÔºö 12345678&lt;?xml version="1.0" encoding="utf-8"?&gt;&lt;selector xmlns:android="http://schemas.android.com/apk/res/android"&gt; &lt;item android:color="#000000" android:state_pressed="false" /&gt; &lt;item android:color="#ffff" android:state_pressed="true" /&gt;&lt;/selector&gt; ÈÄöËøáÊåáÂÆö item ÁöÑÁä∂ÊÄÅÂíåÈ¢úËâ≤ÔºåÂç≥ÂèØÂÅöÂà∞ÊåâÂéãÂíåÊùæÂºÄÊó∂Êéß‰ª∂ÁöÑÈ¢úËâ≤ÂèòÂåñ„ÄÇ]]></content>
      <categories>
        <category>AndroidÂü∫Á°Ä</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>Drawble</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Èù¢ÂêëÂØπË±°ÁöÑÂÖ≠Â§ßÂéüÂàôÂèäÂçï‰æãÊ®°Âºè]]></title>
    <url>%2F2017%2F09%2F17%2F%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%85%AD%E5%A4%A7%E5%8E%9F%E5%88%99%E5%8F%8A%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[Èù¢ÂêëÂØπË±°ÁöÑÂÖ≠Â§ßÂéüÂàô Âçï‰∏ÄËÅåË¥£ÂéüÂàô Âçï‰∏ÄËÅåË¥£ÂéüÂàô (SRP) ÊòØÊåáÂ∞±‰∏Ä‰∏™Á±ªËÄåË®ÄÔºåÂ∫îËØ•‰ªÖÊúâ‰∏Ä‰∏™ÂºïËµ∑ÂÆÉÂèòÂåñÁöÑÂéüÂõ† ÁÆÄÂçïËÄåË®ÄÂ∞±ÊòØ‰∏Ä‰∏™Á±ªÂ∫îËØ•Âè™Êúâ‰∏ÄÈ°πËÅåË¥£ÔºåËÄå‰∏çÊòØÂÖ∑ÊúâÂ§öÈ°πËÅåË¥£ÔºåÊØîÂ¶Ç‰∏Ä‰∏™Á±ªÊó¢Ë¥üË¥£ÂõæÁâáÁºìÂ≠òÁöÑÂ§ÑÁêÜÂêåÊó∂ËøòË¥üË¥£ÊòæÁ§∫ÂõæÁâáÔºåÂÆûÈôÖ‰∏äÂ∫îËØ•ÊãÜÂàÜÊàê‰∏§‰∏™Á±ªÔºå‰∏Ä‰∏™Á±ªË¥üË¥£ÂõæÁâáÁöÑÁºìÂ≠òÔºåÂè¶Â§ñ‰∏Ä‰∏™Á±ªË¥üË¥£ÂõæÁâáÊòæÁ§∫„ÄÇÂ¶ÇÊûú‰∏Ä‰∏™Á±ªÂÖºÂÖ∑Â§™Â§öÁöÑËÅåË¥£‰∏ç‰ªÖÂØºËá¥‰∫ÜËÄ¶ÂêàÊÄßÔºåËÄå‰∏îÂú®‰∏Ä‰∏™ËÅåË¥£ÂèëÁîüÂèòÂåñÁöÑÊó∂ÂÄôËøòÂèØËÉΩÂâäÂº±ÂÖ∂ÂÆÉÁöÑËÅåË¥£ÂäüËÉΩ„ÄÇ ÂºÄÈó≠ÂéüÂàô ÂºÄÈó≠ÂéüÂàô (OCP) ÊòØÊåáËΩØ‰ª∂‰∏≠ÁöÑÂØπË±°ÂØπ‰∫é‰øÆÊîπÂ∫îËØ•ÊòØÂ∞ÅÈó≠ÁöÑÔºåÂØπ‰∫éÊâ©Â±ïÂ∫îËØ•ÊòØÂºÄÊîæÁöÑ„ÄÇ Â¶ÇÊûú‰∏Ä‰∏™Á±ª‰∏∫‰∫ÜÂÆûÁé∞Êñ∞ÁöÑÂäüËÉΩ‰∏çÊñ≠ÁöÑÂØπÁ±ª‰∏≠ÁöÑÂéüÊúâ‰ª£Á†ÅËøõË°å‰øÆÊîπÂíåÂ¢ûÂä†Ôºå‰∏ç‰ªÖÂèØËÉΩÂºïÂÖ• BugÔºåËøòÊúâÂèØËÉΩ‰ºöÂØºËá¥Á±ªË∂äÊù•Ë∂äÂ∫ûÂ§ßÔºåÊØîÂ¶Ç‰∏Ä‰∏™ÂõæÁâáÁöÑÁºìÂ≠òÁ±ªÈúÄË¶ÅÂÆûÁé∞ÂÜÖÂ≠òÁºìÂ≠ò„ÄÅSD Âç°ÁºìÂ≠ò„ÄÅ‰∏§ÁßçÊñπÂºèÊ∑∑ÂêàÁöÑÁºìÂ≠òÊñπÊ≥ïÔºåÂú®ÂõæÁâáÊòæÁ§∫Á±ª‰∏≠ÈúÄË¶ÅËá™Áî±ÈÄâÊã©‰ΩïÁßçÊñπÂºèËøõË°åÁºìÂ≠òÊòæÁ§∫„ÄÇÊØîËæÉÂ•ΩÁöÑ‰∏ÄÁßçÊñπÂºèÊòØÔºöÁî±‰∫é‰∏âÁßçÁºìÂ≠òÊñπÂºèÂÆûÈôÖ‰∏äÂü∫Êú¨ÂäüËÉΩ‰∏ÄËá¥ÔºåÊâÄ‰ª•ÂèØ‰ª•ÂÆö‰πâ‰∏Ä‰∏™Êé•Âè£ÔºåÁÑ∂ÂêéÂú®ÂõæÁâáÊòæÁ§∫Á±ª‰∏≠‰πâ‰∏Ä‰∏™Êé•Âè£Áî®‰∫éÊåáÂêë‰∏â‰∏™Á±ªÂÆû‰æãÂåñÁöÑÂØπË±°ÔºåÈÇ£‰πàÂΩìÈúÄË¶ÅÈááÁî®Âì™ÁßçÊñπÂºèÂéªËøõË°åÁºìÂ≠òÁöÑÊó∂ÂÄôÔºåÂè™ÈúÄË¶Å‰ΩøÁî® set ÊñπÊ≥ïËøõË°å‰æùËµñÊ≥®ÂÖ•Â∞ÜÊé•Âè£ÊåáÂêëÁõ∏Â∫îÊñπÂºèÁöÑÂØπË±°Âç≥ÂèØÔºåÂπ∂‰∏îÂ¶ÇÊûúË¶ÅÂÆûÁé∞ÂÖ∂ÂÆÉ‰∏çÂêåÁöÑÁºìÂ≠òÊñπÂºèÂè™ÈúÄË¶ÅÂØπÊé•Âè£ËøõË°åÂÆûÁé∞Âç≥ÂèØ„ÄÇËøôÊ†∑ÂÆûÁé∞ÁöÑ‰ª£Á†ÅËÄ¶ÂêàÊÄßÂº±Êâ©Â±ïÊÄßÂº∫„ÄÇ ÈáåÊ∞èÊõøÊç¢ÂéüÂàô ÈáåÊ∞èÊõøÊç¢ÂéüÂàôÊòØÊåáÊâÄÊúâÂºïÁî®Âü∫Á±ªÁöÑÂú∞ÊñπÂøÖÈ°ªËÉΩÈÄèÊòéÂú∞‰ΩøÁî®ÂÖ∂Â≠êÁ±ªÁöÑÂØπË±° ‰∏Ä‰∏™Âü∫Á±ªÁöÑÂ≠êÁ±ªÊã•ÊúâÂü∫Á±ªÁöÑÂ±ûÊÄßÂíåÊñπÊ≥ïÔºàÁßÅÊúâÁöÑÈô§Â§ñÔºâÔºåÊâÄ‰ª•Âú®Â§ßÂ§öÊï∞ÊÉÖÂÜµ‰∏ãÂü∫Á±ªËÉΩÂπ≤ÁöÑÂ≠êÁ±ªÈÉΩËÉΩÂÅöÔºåËøôÊ†∑ÂèØ‰ª•‰øùËØÅÂæàÂ•ΩÁöÑÊâ©Â±ïÊÄßÔºåÂõ†‰∏∫ÂèØ‰ª•Âú®Âü∫Á±ªÁöÑÂü∫Á°Ä‰∏äËøõË°åÊâ©Â±ïÂÆûÁé∞‰∏çÂêåÂäüËÉΩÁöÑÂ≠êÁ±ª„ÄÇÂõ†Ê≠§ÈáåÊ∞èÊõøÊç¢ÂéüÂàôÊúâÂà©‰∫éÊèêÈ´òÊâ©Â±ïÊÄßÔºåÂêåÊó∂‰∏∫ÂºÄÈó≠ÂéüÂàôÊèê‰æõ‰∫Ü‰øùÈöú„ÄÇ ‰æùËµñÂÄíÁΩÆÂéüÂàô ‰æùËµñÂÄíÁΩÆÂéüÂàôÊòØÁî®‰∫éËß£ËÄ¶ÁöÑ‰∏ÄÁßçÊñπÂºèÔºå‰∏ªË¶ÅÊúâ‰ª•‰∏ãÂá†‰∏™ÂÖ≥ÈîÆÁÇπÔºö È´òÂ±ÇÊ®°Âùó‰∏çÂ∫îËØ•‰æùËµñÂ∫ïÂ±ÇÊ®°ÂùóÔºå‰∏§ËÄÖÈÉΩÂ∫îËØ•‰æùËµñÂÖ∂ÊäΩË±° ÊäΩË±°‰∏çÂ∫îËØ•‰æùËµñÁªÜËäÇ ÁªÜËäÇÂ∫îËØ•‰æùËµñÊäΩË±° Á¨¨‰∏ÄÁÇπÊòØÊåáÂΩìÈ´òÂ±ÇÁöÑÊ®°Âùó‰ΩøÁî®Â∫ïÂ±ÇÁöÑÊ®°ÂùóÊó∂ÂÄôÔºå‰∏çÂ∫îËØ•Áõ¥Êé•‰ΩøÁî®Â∫ïÂ±ÇÊ®°ÂùóÁ±ªÁöÑÂÖ∑‰ΩìÂØπË±°ÔºåËÄåÂ∫îËØ•‰ΩøÁî®ÂÖ∂Êé•Âè£ÊàñËÄÖÊòØÊäΩË±°Á±ªÔºåËøôÊ†∑ÂèØ‰ª•‰øùËØÅÂÖ∂Êâ©Â±ïÊÄßÔºå‰πüÂ∞±ÊòØËØ¥È´òÂ±ÇÊ®°Âùó‰∏éÂ∫ïÂ±ÇÊ®°Âùó‰πãÈó¥Â∫îËØ•ÈÄöËøáÊé•Âè£ÂèëÁîüËÅîÁ≥ªÔºåËÄå‰∏çÂ∫îËØ•Â≠òÂú®Áõ¥Êé•ÂÖ≥ËÅî„ÄÇ Êé•Âè£ÈöîÁ¶ªÂéüÂàô Êé•Âè£ÈöîÁ¶ªÂéüÂàôÊòØÊåáÁ±ªÈó¥ÁöÑÂÖ≥Á≥ªÂ∫îËØ•Âª∫Á´ãÂú®ÊúÄÂ∞èÁöÑÊé•Âè£‰∏ä ÊúÄÂ∞èÁöÑÊé•Âè£ÂÆûÈôÖ‰∏äÂ∞±ÊòØÊäΩË±°ÁöÑ‰∏ÄÁßçË°®ËææÔºå‰∏Ä‰∏™Êé•Âè£‰∏ãÈù¢ÂèØËÉΩÂèØËÉΩ‰ºöÂÆûÁé∞ÂæàÂ§öÁßçÊé•Âè£ÔºåÊàñËÄÖÊòØÂæàÂ§öÂ±ÇÁ∫ßÊé•Âè£ÔºåË¶ÅÂØπËøô‰∫õÊé•Âè£Áõ∏ÂêåÁöÑÂäüËÉΩÈÉ®ÂàÜËøõË°åÊìç‰ΩúÁöÑÊó∂ÂÄôÂè™ÈúÄË¶ÅÂØπÊúÄÈ°∂Â±ÇÁöÑÊé•Âè£Êìç‰ΩúÂç≥ÂèØÔºåË≠¨Â¶ÇÂΩìÂÖ≥Èó≠ËæìÂÖ•ËæìÂá∫ÊµÅÁöÑÊó∂ÂÄôÔºåJava ‰∏≠ÊúâÂæàÂ§öÁßçÊµÅÔºåÂ≠óËäÇÊµÅ„ÄÅÂ≠óÁ¨¶ÊµÅ„ÄÅÁºìÂÜ≤ÊµÅ„ÄÇËøô‰∏™Êó∂ÂÄô‰∏∫‰∫ÜÂáèÂ∞ë‰æùËµñ„ÄÅËÄ¶ÂêàÊÄß‰ª•ÂèäÂ¢ûÂä†Êâ©Â±ïÊÄßÔºåÊàë‰ª¨Âè™ÈúÄË¶ÅÂà©Áî® Cloaseable Êé•Âè£ÊåáÂêëÂêÑÁßçÊµÅÁöÑÂØπË±°ËøõË°åÂÖ≥Èó≠Êìç‰ΩúÂç≥ÂèØ„ÄÇ Ëø™Á±≥ÁâπÂéüÂàô Ëø™Á±≥ÁâπÂéüÂàôÊòØÊåá‰∏Ä‰∏™ÂØπË±°Â∫îËØ•ÂØπÂÖ∂ÂÆÉÂØπË±°ÊúâÊúÄÂ∞ëÁöÑ‰∫ÜËß£ ‰∏Ä‰∏™Á±ªÂ∫îËØ•Â∞ΩÂèØËÉΩÂ∞ëÁöÑÂà©Áî®Âà∞ÂÖ∂ÂÆÉÁ±ªÂÆåÊàêÁõ∏ÂêåÁöÑ‰ªªÂä°ÔºåËøôÊ†∑ÂèØ‰ª•Èôç‰ΩéËÄ¶ÂêàÊÄß Âçï‰æãÊ®°Âºè ÂÆö‰πâ ÊâÄË∞ìÂçï‰æã‰πüÂ∞±ÊòØËØ¥Âú®‰∏Ä‰∏™Á±ªÂú®Á≥ªÁªü‰∏≠Âè™Â≠òÂú®‰∏Ä‰∏™ÂÆû‰æãÔºåÂπ∂‰∏îÂèØ‰ª•Ëá™Ë°åÂÆû‰æãÂåñÂêëÁ≥ªÁªüÊèê‰æõËøô‰∏™ÂÆû‰æã ‰ΩøÁî®Âú∫ÊôØ ÈÄÇÁî®‰∫éÊüê‰∏™Á±ªÊúâ‰∏î‰ªÖÊúâ‰∏Ä‰∏™ÂØπË±°ÁöÑÂú∫ÊôØÔºåÈÅøÂÖçÂàõÂª∫Â§ö‰∏™ÂØπË±°Ê∂àËÄóËøáÂ§öÁöÑËµÑÊ∫ê„ÄÇ ÊûÑÈÄ†ÂáΩÊï∞‰∏çÂØπÂ§ñÂºÄÊîæÔºå‰∏ÄËà¨‰∏∫ private ÈÄöËøá‰∏Ä‰∏™ÈùôÊÄÅÊñπÊ≥ïÊàñËÄÖÊûö‰∏æËøîÂõûÂçï‰æãÁ±ªÂØπË±° Á°Æ‰øùÂçï‰æãÁ±ªÂØπË±°Êúâ‰∏îÂè™Êúâ‰∏Ä‰∏™ÔºåÂ∞§ÂÖ∂ÊòØÂú®Â§öÁ∫øÁ®ãÁéØÂ¢É‰∏ã Á°Æ‰øùÂçï‰æãÁ±ªÂØπË±°Âú®ÂèçÂ∫èÂàóÂåñÊó∂‰∏ç‰ºöÈáçÊñ∞ÊûÑÂª∫ÂØπË±° ‰πüÂç≥ÊòØËØ¥Âçï‰æãÊ®°ÂºèÁöÑÂØπË±°ÂøÖÈ°ªÁî±ËØ•Á±ªÁöÑÈùôÊÄÅÊñπÊ≥ïËøõË°åÂÆû‰æãÂåñÂíåÊèê‰æõÔºåÂπ∂‰∏î‰∏çËÉΩÂá∫Áé∞Â§ö‰∏™ÂØπË±°„ÄÇ ‰ºòÁº∫ÁÇπ ‰ºòÁÇπ Âçï‰æãÊ®°ÂºèÂú®ÂÜÖÂ≠ò‰∏≠Âè™Â≠òÂú®‰∏Ä‰∏™ÂÆû‰æãÔºåÂáèÂ∞ë‰∫ÜÂÜÖÂ≠òÁöÑÂºÄÊîØ„ÄÇ ÂáèÂ∞ë‰∫ÜÁ≥ªÁªüÁöÑÊÄßËÉΩÂºÄÈîÄÔºåÂΩì‰∏Ä‰∏™ÂØπË±°ÁöÑ‰∫ßÁîüÈúÄË¶ÅËæÉÂ§öÁöÑËµÑÊ∫êÁöÑÊó∂ÂÄôÔºåËøô‰∏™Êó∂ÂÄôÂèØ‰ª•ÈÄöËøá‰∫ßÁîü‰∏Ä‰∏™Âçï‰æãÂØπË±°ÔºåÁÑ∂ÂêéÊ∞∏È©ªÂÜÖÂ≠òÊù•Ëß£ÂÜ≥„ÄÇ Âçï‰æãÊ®°ÂºèÂèØ‰ª•ÈÅøÂÖçÂØπËµÑÊ∫êÁöÑÂ§öÈáçÂç†Áî®„ÄÇ Âçï‰æãÊ®°ÂºèÂèØ‰ª•Âú®Á≥ªÁªüËÆæÁΩÆÂÖ®Â±ÄÁöÑËÆøÈóÆÁÇπÔºå‰ºòÂåñÂíåÂÖ±‰∫´ËµÑÊ∫êËÆøÈóÆ Áº∫ÁÇπ Âçï‰æãÊ®°Âºè‰∏ÄËà¨Ê≤°ÊúâÊé•Âè£ÔºåÊâ©Â±ïÂæàÂõ∞Èöæ„ÄÇ Âçï‰æãÂØπË±°Â¶ÇÊûúÊåÅÊúâ ContextÔºåÈÇ£‰πàÂæàÂÆπÊòìÂºïÂèëÂÜÖÂ≠òÊ≥ÑÊºèÔºåÊ≠§Êó∂‰º†ÈÄíÁªôÂçï‰æãÂØπË±°ÁöÑ Context ÊúÄÂ•ΩÊòØ Application Context Â∏∏Áî®ÁöÑÂÆûÁé∞ÊñπÂºè È•øÊ±âÊ®°Âºè 1234567891011public class CEO &#123; private static CEO sCeo = new CEO(); private CEO() &#123; super(); &#125; public static CEO newInstance() &#123; return sCeo; &#125;&#125; ËØ•ÁßçÊñπÂºèÂÆûÁé∞ÁöÑÂçï‰æãÊ®°ÂºèÂΩìÁ±ªË¢´Âä†ËΩΩÁöÑÊó∂ÂÄôÂ∞±‰ºöÂàùÂßãÂåñ‰∏Ä‰∏™ CEO ÂØπË±°ÔºåÁÑ∂ÂêéÂ§ñÈÉ®ÂèØ‰ª•ÈÄöËøá newInstance ÈùôÊÄÅÊñπÊ≥ïËøõË°åËé∑Âèñ„ÄÇ Áî±‰∫éÂçï‰æãÊ®°ÂºèÈúÄË¶ÅÁ±ªËÉΩÂ§üËá™Ë°åËøõË°åÂÆû‰æãÂåñÔºåÊâÄ‰ª•ËøîÂõûÂÄº‰∏ÄÂÆöÊòØÁ±ªÂèòÈáè‰ª•ÂèäÈÄöËøáÈùôÊÄÅÊñπÊ≥ïËøõË°åËøîÂõû„ÄÇ ÊáíÊ±âÊ®°Âºè 1234567891011121314public class SingleInstance &#123; private static SingleInstance sSingleInstance; private SingleInstance() &#123; super(); &#125; public static synchronized SingleInstance newInstance() &#123; if (sSingleInstance != null) &#123; sSingleInstance = new SingleInstance(); &#125; return sSingleInstance; &#125;&#125; ÈááÁî®ÊáíÊ±âÊ®°ÂºèÂÆûÁé∞ÁöÑÂçï‰æãÊ®°ÂºèÂèØ‰ª•Âú®‰ΩøÁî®ÁöÑÊó∂ÂÄôÊâçÂ∞ÜÂØπË±°ÂÆû‰æãÂåñÔºå‰ΩÜÊòØÁî±‰∫éÊØèÊ¨°Ë∞ÉÁî® newInstance ÊñπÊ≥ïÁöÑÊó∂ÂÄôÈÉΩ‰ºöËøõË°åÂêåÊ≠•ÔºàÊØî‰∏çÈúÄË¶ÅÂêåÊ≠•ÁöÑÊÖ¢ 100 ÂÄçÔºâÔºåÊâÄ‰ª•ÈÄ†Êàê‰∫Ü‰∏çÂøÖË¶ÅÁöÑÂêåÊ≠•ÂºÄÈîÄÔºå‰∏çÂª∫ËÆÆ‰ΩøÁî®„ÄÇ Double Check Lock 123456789101112131415161718public class SingleInstance &#123; private static SingleInstance sSingleInstance = null; private SingleInstance() &#123; super(); &#125; public static SingleInstance newInstance() &#123; if (sSingleInstance != null) &#123; synchronized (SingleInstance.class) &#123; if (sSingleInstance != null) &#123; sSingleInstance = new SingleInstance(); &#125; &#125; &#125; return sSingleInstance; &#125;&#125; Á¨¨‰∏ÄÊ¨°ÁöÑÂà§Êñ≠ÈÅøÂÖç‰∫ÜÂú®ÂØπË±°ÈùûÁ©∫ÊÉÖÂÜµ‰∏ãËøõË°åÂêåÊ≠•ÂØºËá¥‰∏çÂøÖË¶ÅÂºÄÈîÄÁöÑÈóÆÈ¢òÔºåÁ¨¨‰∫åÊ¨°Âà§Êñ≠ÊòØÁî±‰∫éÂèØËÉΩÂ≠òÂú®Á∫øÁ®ã AÔºåB ÂêåÊó∂Âà§Êñ≠‰∫ÜÂØπË±°‰∏∫Á©∫ÔºåÁÑ∂Âêé‰æùÊ¨°ËøõÂÖ•ÂêåÊ≠•Âùó‰∏≠ÔºåÂ¶ÇÊûúËøô‰∏™Êó∂ÂÄô‰∏çËøõË°åÂà§Êñ≠ÂàôÂèØËÉΩÂØºËá¥ÂàõÂª∫Âá∫‰∏§‰∏™ÂØπË±°Âá∫Êù•ÔºåÊâÄ‰ª•ÈúÄË¶ÅËøõË°åÁ¨¨‰∫åÊ¨°Âà§Êñ≠„ÄÇ Ëøô‰∏™Ê®°ÂºèÂ≠òÂú®ÁöÑ‰∏Ä‰∏™ÈóÆÈ¢òÊòØ mSingleInstance = new SingleInstance() ‰∏çÊòØÂéüÂ≠êÊìç‰ΩúÔºåÂÖ∂ÂàÜ‰∏∫‰∏â‰∏™ÈÉ®ÂàÜÔºöÁªôÂÆû‰æãÂØπË±°ÂàÜÈÖçÂÜÖÂ≠òÔºõË∞ÉÁî®ÊûÑÈÄ†ÂáΩÊï∞ÔºåÂàùÂßãÂåñÊàêÂëòÂ≠óÊÆµÔºõÂ∞ÜÂÆû‰æãÂØπË±°ÊåáÂêëÂàÜÈÖçÁöÑÂÜÖÂ≠òÁ©∫Èó¥„ÄÇÂπ∂‰∏îÂêé‰∏§Ê≠•ÁöÑÊâßË°åÈ°∫Â∫èÊòØ‰∏çÁ°ÆÂÆöÁöÑÔºåÊâÄ‰ª•ÂèØËÉΩÂá∫Áé∞ A Á∫øÁ®ãÊâßË°åÂÆåÁ¨¨‰∏âÊ≠•ÔºåÊ≤°ÊúâÊâßË°åÂÆåÁ¨¨‰∫åÊ≠•ÁöÑÊÉÖÂÜµ‰∏ãÔºåÁ®ãÂ∫èÂàáÊç¢Ëá≥ B Á∫øÁ®ãÔºåB Á∫øÁ®ãÂà§Êñ≠ÂΩìÂâçÂØπË±°ÈùûÁ©∫ÂèñËµ∞ÂØπË±°Ôºå‰ΩÜÁî±‰∫éÂØπË±°ÁöÑÊàêÂëòÂ≠óÊÆµÊ≤°ÊúâÂàùÂßãÂåñÂÆåÊàêÔºåÊâÄ‰ª•ÂèØËÉΩÂá∫Áé∞ÈîôËØØ„ÄÇ Ëß£ÂÜ≥ÂäûÊ≥ïÊòØÂú® sInstance ÂâçÂä†‰∏ä volatile ÂÖ≥ÈîÆÂ≠ó„ÄÇ ÈùôÊÄÅÂÜÖÈÉ®Á±ª 12345678910111213public class SingleInstance &#123; private SingleInstance() &#123; super(); &#125; public static SingleInstance newInstance() &#123; return SingleHolder.sSingleInstance; &#125; private static class SingleHolder &#123; private static final SingleInstance sSingleInstance = new SingleInstance(); &#125;&#125; ÈááÁî®ËøôÁßçÊñπÂºèÂÆûÁé∞ÁöÑÂçï‰æãÊ®°ÂºèÂæàÂ•ΩÁöÑÈÅøÂÖç‰∫Ü DCL ‰∏≠ÂèØËÉΩÂá∫Áé∞ÁöÑÈóÆÈ¢òÔºåÁî±‰∫éÂÜÖÈÉ®Á±ªÂè™ÊúâÂú®‰ΩøÁî®ÂÆÉÁöÑÊàêÂëò‰ª•ÂèäÊñπÊ≥ïÁöÑÊó∂ÂÄôÊâç‰ºöËøõË°åËΩΩÂÖ•ÔºåÊâÄ‰ª•ÂèØ‰ª•ÂÅöÂà∞‰ΩøÁî®ÁöÑÊó∂ÂÄôÊâçÂÆû‰æãÂåñÂØπË±°ÔºåËÄå‰∏îËÉΩÂ§üÁ°Æ‰øùÁ∫øÁ®ãÂÆâÂÖ®„ÄÇ Êûö‰∏æÂçï‰æã 1234567public enum SingletonEnum &#123; INSTANCE; public void doSomething() &#123; System.out.println("do sth."); &#125;&#125; Âú®‰ªª‰ΩïÊÉÖÂÜµ‰∏ãÊûö‰∏æÂÆû‰æãÈÉΩÊòØ‰∏Ä‰∏™Âçï‰æãÔºåËÄå‰∏îÂàõÂª∫ËøáÁ®ãÊòØÁ∫øÁ®ãÂÆâÂÖ®ÁöÑ„ÄÇ ÂÆπÂô®ÂÆûÁé∞Âçï‰æã 12345678910111213141516public class SingletonManager &#123; private static Map&lt;String, Object&gt; objectMap = new HashMap&lt;&gt;(); private SingletonManager() &#123; &#125; public static void registerService(String key, Object instance) &#123; if (!objectMap.containsKey(key)) &#123; objectMap.put(key, instance); &#125; &#125; public static Object getService(String key) &#123; return objectMap.get(key); &#125;&#125; ÈááÁî®ÂÆπÂô®ÂÆûÁé∞ÁöÑÂçï‰æãÊ®°ÂºèÂèØ‰ª•ÂØπÂ§öÁßçÂØπË±°ÁöÑÂçï‰æãËøõË°åÁÆ°ÁêÜÔºå‰æãÂ¶Ç Android ÂΩì‰∏≠ÁöÑ getSystemService Â∞±ÊòØËøôÊ†∑ÂÆûÁé∞ÁöÑÂçï‰æãÊ®°Âºè„ÄÇ ÊÄªÁªì ÂâçÂõõÁßçÊñπÂºèÂÆûÁé∞ÁöÑÂçï‰æãÊ®°ÂºèÂ≠òÂú®Âú®ÂèçÂ∫èÂàóÂåñÔºàÂèçÂ∞ÑÊâßË°åÊó†ÂèÇÊûÑÈÄ†ÂáΩÊï∞ÔºâÁöÑÊÉÖÂÜµ‰∏ãÂèØËÉΩ‰ºöÈáçÊñ∞ÂàõÂª∫‰∏Ä‰∏™ÂØπË±°Ôºå‰∏∫‰∫ÜÈÅøÂÖçËøôÁßçÊÉÖÂÜµÁöÑÂèëÁîüÔºåÊàë‰ª¨ÈúÄË¶ÅÈáçÂÜô readResolve ÊñπÊ≥ïÔºåËøôÊ†∑Âú®ËøõË°åÂèçÂ∫èÂàóÂåñÁöÑÊó∂ÂÄôÂ∞±‰ºöÊâßË°åËøô‰∏™ÊñπÊ≥ïËé∑ÂèñÂØπË±°ÂÆû‰æã„ÄÇ 123private Object readResolve()throws ObjectStreamException&#123; return sSingleInstance;&#125; Âçï‰æãÊ®°ÂºèÁöÑÊ†∏ÂøÉÂú®‰∫éÂ∞ÜÊûÑÈÄ†ÂáΩÊï∞ËøõË°åÁßÅÊúâÂåñÔºåÂπ∂‰∏îÈÄöËøá‰∏Ä‰∏™ÈùôÊÄÅÊñπÊ≥ïËøîÂõûÂîØ‰∏ÄÁöÑÂØπË±°ÂÆû‰æãÔºåÂú®Ëøô‰∏™Ëé∑ÂèñÁöÑËøáÁ®ãÂΩì‰∏≠ÈúÄË¶Å‰øùËØÅÁ∫øÁ®ãÂÆâÂÖ®„ÄÅÈò≤Ê≠¢ÂèçÂ∫èÂàóÂåñÂØºËá¥ÁîüÊàêÂÆû‰æãÂØπË±°Á≠âÈóÆÈ¢ò„ÄÇ]]></content>
      <categories>
        <category>ËØª‰π¶Á¨îËÆ∞</category>
      </categories>
      <tags>
        <tag>AndroidÊ∫êÁ†ÅËÆæËÆ°Ê®°ÂºèËß£Êûê‰∏éÂÆûÊàò</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Android Ëá™ÂÆö‰πâÊéß‰ª∂‰πãÁôæÂàÜÊØîÂúÜÁéØ]]></title>
    <url>%2F2017%2F09%2F10%2FAndroid%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8E%A7%E4%BB%B6%E4%B9%8B%E7%99%BE%E5%88%86%E6%AF%94%E5%9C%86%E7%8E%AF%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä ÊúÄËøëÂÅö‰∏Ä‰∏™ÁÆÄÂçïÁöÑÊµãËØï APP ÁöÑÊó∂ÂÄôÈúÄË¶ÅÂ∞ÜÊâãÊú∫ÁöÑÂ≠òÂÇ®Á©∫Èó¥‰ΩøÁî®ÊÉÖÂÜµÊòæÁ§∫Âá∫Êù•ÔºåÂàöÂ•ΩÁúãËßÅ 360 Ê∏ÖÁêÜÂ§ßÂ∏àÁöÑÂ≠òÂÇ®Á©∫Èó¥ÊòØ‰ª•ÁôæÂàÜÊØîÂúÜÁéØÁöÑÊñπÂºèÂÆûÁé∞ÁöÑÔºåÊâÄ‰ª•Â§ßËá¥Ê®°‰ªø‰∫Ü‰∏Ä‰∏ãÂÆÉÁöÑÂÆûÁé∞ËøáÁ®ã„ÄÇ ÊïàÊûúÂõæ È¶ñÂÖàÊîæ‰∏äÊïàÊûúÂõæÔºåÁÑ∂ÂêéÊàë‰ª¨ÂÜçÊ†πÊçÆÊïàÊûúÂõæËøõË°åÂàÜÊûê ÂÆûÁé∞ÊÄùË∑Ø ‰ªé‰∏äÂõæÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞ÔºåÁªòÂà∂‰∏Ä‰∏™ËøôÊ†∑ÁöÑÁôæÂàÜÊØîÂúÜÁéØ‰∏ªË¶ÅÊúâÊ∂âÂèäÂà∞‰∏â‰∏™ÂÖÉÁ¥†Ôºö ËÉåÊôØÁ©∫ÂøÉÂúÜÔºö‰ª£Ë°®ÁùÄÊÄªÁöÑËøõÂ∫¶ ÂúÜÂºßÔºö‰ª£Ë°®ÁùÄÂΩìÂâçËøõÂ∫¶ ÊñáÂ≠óÔºöÈúÄË¶ÅÂ±Ö‰∏≠ÔºåË°®Á§∫ÂÖ∑‰ΩìÁöÑËøõÂ∫¶ Âú®‰∫ÜËß£Âà∞Ê∂âÂèäÂà∞ÁöÑÂÖÉÁ¥†‰πãÂêéÔºåÊàë‰ª¨ËøòÈúÄË¶Å‰∫ÜËß£ÁªòÂà∂ÂêÑ‰∏™ÂÖÉÁ¥†ÈúÄË¶ÅÂì™‰∫õÂèÇÊï∞ÔºåÁî±‰∫éÁªòÂà∂ÈÉΩÈÄöËøá onDraw ÊñπÊ≥ï‰∏≠ÁöÑ canvas ÂØπË±°ÔºåÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•ÈÄöËøá canvas ÂØπË±°ÁöÑÊñπÊ≥ïÂéªÁ°ÆÂÆöÊâÄÈúÄË¶ÅÁöÑÂèÇÊï∞„ÄÇ ÁªòÂà∂ÂúÜÔºöÊü•Áúã drawCircle ÂèØ‰ª•Áü•ÈÅìÊÄªÂÖ±ÈúÄË¶ÅÂõõ‰∏™ÂèÇÊï∞ÔºöÂúÜÂøÉ X„ÄÅY ÂùêÊ†á„ÄÅÂçäÂæÑÈïøÂ∫¶‰ª•ÂèäÁîªÁ¨î PaintÔºõ ÁªòÂà∂ÂúÜÂºßÔºöÊü•Áúã drawArc ÂèØ‰ª•Áü•ÈÅìÊÄªÂÖ±ÈúÄË¶ÅÂõõ‰∏™ÂèÇÊï∞ÔºöRecf„ÄÅÂúÜÂºßÁöÑËµ∑ÂßãËßíÂ∫¶„ÄÅ‰ªéËµ∑ÂßãËßíÂ∫¶È°∫Êó∂ÈíàÊâ´ËøáÁöÑËßíÂ∫¶‰ª•ÂèäÂøÖÈ°ªÁöÑ PaintÔºåËøôÈáåÁöÑ Recf Á°ÆÂÆö‰∫Ü‰∏Ä‰∏™Áü©ÂΩ¢Âå∫ÂüüÔºåÁÑ∂ÂêéÁ°ÆÂÆö‰∫Ü‰∏Ä‰∏™ÂÜÖÊé•Ê§≠ÂúÜÔºåËÄåÂúÜÂºßÁöÑÁªòÂà∂ÂÆûÈôÖ‰∏äÊòØÂú®Ê§≠ÂúÜ‰∏äÈù¢ËøõË°åÊà™ÂèñÔºõ ÁªòÂà∂ÊñáÊú¨ÔºöÊü•Áúã drawText ÂèØ‰ª•Áü•ÈÅìÔºåÈúÄË¶ÅÂõõ‰∏™ÂèÇÊï∞ÔºöÊñáÊú¨ÂÜÖÂÆπ„ÄÅËøõË°åÁªòÂà∂ÁöÑ X„ÄÅY ÂùêÊ†áÁÇπ‰ª•ÂèäPaint„ÄÇ ÂÆûÁé∞ËøáÁ®ã Âú®‰∫ÜËß£‰∫ÜÁªòÂà∂ÂÖÉÁ¥†ÊâÄÈúÄË¶ÅÁöÑÂèÇÊï∞ÔºåËøô‰∏™Êó∂ÂÄôÂ∞±ÂèØ‰ª•‰∏ÄÊ≠•Ê≠•ËøõË°åÁªòÂà∂‰∫ÜÔºö È¶ñÂÖàÊòØÁªòÂà∂ÂúÜÔºåËøôÈáåÊàë‰ª¨ÂÆö‰πâ‰∫ÜÂõõ‰∏™ÂèÇÊï∞ÂàÜÂà´Ë°®Á§∫ÂúÜÂøÉ XÔºåY ÁöÑÂùêÊ†á„ÄÅÂçäÂæÑ‰ª•ÂèäÁªòÂà∂ÊâÄÈúÄË¶ÅÁöÑÁîªÁ¨îÔºåÁÑ∂ÂêéÂØπËøô‰∫õÂèÇÊï∞ËøõË°åÂàùÂßãÂåñÔºåÊúÄÁªàÂú® onDraw ËøõË°åÁªòÂà∂„ÄÇ 123456789101112131415161718192021222324252627282930public class RingPercentDemo extends View &#123; private int mCircleX; private int mCircleY; private int mRadius; private Paint mCirclePaint; public RingPercentDemo(Context context) &#123; super(context); &#125; public RingPercentDemo(Context context, @Nullable AttributeSet attrs) &#123; super(context, attrs); mCircleX = 300; mCircleY = 300; mRadius = 260; mCirclePaint = new Paint(); mCirclePaint.setColor(Color.BLUE); mCirclePaint.setStrokeWidth(10); mCirclePaint.setStyle(Style.STROKE); //ÁªòÂà∂Á©∫ÂøÉÂúÜÊâÄ‰ª•‰∏çÈúÄË¶ÅÂ°´ÂÖÖ &#125; @Override protected void onDraw(Canvas canvas) &#123; super.onDraw(canvas); canvas.drawCircle(mCircleX, mCircleY, mRadius, mCirclePaint); &#125;&#125; Êé•‰∏ãÊù•ÊòØÁªòÂà∂ÂúÜÁéØÔºå‰ªéÊïàÊûúÂõæ‰∏äÂèØ‰ª•ÁúãÂá∫Êù•ÔºåÂúÜÁéØÂÆûÈôÖ‰∏äÊòØÂú®ÂúÜ‰∏äÊà™Âèñ‰∏ÄÊÆµÂúÜÂºßË°®Á§∫ÔºåÊâÄ‰ª•ÁªòÂà∂ÂúÜÁéØÁöÑÁü©ÂΩ¢Âå∫ÂüüÂèØ‰ª•Á°ÆÂÆö‰∏ãÊù•ÔºåÂú®Á°ÆÂÆö‰∫ÜÁü©ÂΩ¢Âå∫Âüü‰πãÂêéÂè™ÈúÄË¶ÅËá™Â∑±ËÆæÂÆöËµ∑ÂßãÁöÑËßíÂ∫¶ÂíåÊâ´ËøáÁöÑËßíÂ∫¶Âç≥ÂèØ‰ª•ÁªòÂà∂Âá∫Âú®ÂúÜ‰∏äÁöÑÂúÜÂºß„ÄÇ 123456789101112131415161718192021222324252627282930313233343536public class RingPercentDemo extends View &#123; ... private RectF mRecF; private float mStartAngle; private float mSweepAngle; private Paint mRingPaint; public RingPercentDemo(Context context) &#123; super(context); &#125; public RingPercentDemo(Context context, @Nullable AttributeSet attrs) &#123; super(context, attrs); ... mRecF = new RectF(mCircleX - mRadius, mCircleY - mRadius, mCircleX + mRadius, mCircleY + mRadius); mStartAngle = -90f; mSweepAngle = 120f; mRingPaint = new Paint(); mRingPaint.setColor(Color.RED); mRingPaint.setStrokeWidth(20); mRingPaint.setStyle(Style.STROKE); &#125; @Override protected void onDraw(Canvas canvas) &#123; super.onDraw(canvas); ... canvas.drawArc(mRecF, mStartAngle, mSweepAngle, false, mRingPaint); //ËÆæÁΩÆ‰∏∫ false ‰∏ç‰∏é‰∏≠ÂøÉÁÇπËøõË°åËøûÊé• &#125;&#125; ÊúÄÂêéÊòØÁªòÂà∂ÊñáÊú¨ÔºåÁî±‰∫éË¶ÅÁªòÂà∂Âú®ÂúÜÁöÑ‰∏≠ÂøÉÔºåÊâÄ‰ª•ÊñáÊú¨ÁöÑÂùêÊ†áÊàë‰ª¨È¶ñÂÖàËÆæÁΩÆ‰∏∫ÂúÜÁöÑ‰∏≠ÂøÉÔºåÁÑ∂ÂêéÁªòÂà∂ÁöÑÈ£éÊ†ºÈÄâ‰∏∫ Align.CENTERÔºåËøôÊ†∑ÊñáÊú¨Â∞Ü‰ª•ËÆæÂÆöÁöÑÂùêÊ†áÁÇπÂêë‰∏§ËæπÂª∂‰º∏‰øùËØÅ‰∫Ü X Â§Ñ‰∫é‰∏≠ÂøÉ‰ΩçÁΩÆ„ÄÇ 123456789101112131415161718192021222324252627282930313233343536public class RingPercentDemo extends View &#123; ... private int mTextX; private int mTextY; private Paint mTextPaint; private String mTextStr; public RingPercentDemo(Context context) &#123; super(context); &#125; public RingPercentDemo(Context context, @Nullable AttributeSet attrs) &#123; super(context, attrs); ... mTextPaint = new Paint(); mTextPaint.setColor(Color.BLACK); mTextPaint.setStyle(Style.FILL); mTextPaint.setTextSize(40); mTextPaint.setTextAlign(Align.CENTER); mTextPaint.setTextSize(mRadius / 2); mTextX = mCircleX; mTextY = mCircleY; mTextStr = "33%"; &#125; @Override protected void onDraw(Canvas canvas) &#123; super.onDraw(canvas); ... canvas.drawText(mTextStr, mTextX, mTextY, mTextPaint); &#125;&#125; ÂÆûÈôÖÊïàÊûúÂõæÔºö Ëøô‰∏™Êó∂ÂÄôÊàë‰ª¨ËÉΩÂ§üÂèëÁé∞ÊñáÊú¨ÂÆûË¥®‰∏ä‰∏çÂú®‰∏≠ÂøÉ‰ΩçÁΩÆÔºåËøôÊòØ‰∏∫‰ªÄ‰πàÂë¢ÔºüÂõ†‰∏∫Êàë‰ª¨Âú®ËÆæÂÆöÁöÑÂùêÊ†áÊòØÁî®‰∫éÁ°ÆÂÆöÁªòÂà∂ÁöÑÂü∫ÂáÜÁ∫øËÄå‰∏çÊòØÁªòÂà∂ÁöÑ‰∏≠ÂøÉÁÇπÔºåÊâÄ‰ª•Ëá™ÁÑ∂ÊñáÊú¨‰∏çÂèØËÉΩÁªòÂà∂Âú®Ê≠£‰∏≠ÂøÉÔºåÂÖ∑‰ΩìÂèØ‰ª•ÂÄüÁî®‰∏ãÂõæÊù•ËøõË°åÊèèËø∞Ôºö ‰ªéËøôÂ∞±ÂèØ‰ª•ÂæàÊòéÊòæÁöÑÁúãÂà∞ÔºåÊñáÊú¨ÁöÑ‰∏≠ÂøÉÂíåËÆæÂÆöÁöÑÂùêÊ†á‰πãÈó¥ÊòØÂ≠òÂú®‰∏Ä‰∏™ÂÅèÁßªÈáèÁöÑÔºåÊâÄ‰ª•‰∏∫‰∫Ü‰ΩøÊñáÊú¨Â§Ñ‰∫éÁúüÊ≠£ÁöÑ‰∏≠ÂøÉÔºåÊàë‰ª¨ÈúÄË¶ÅËÆ°ÁÆóÂæóÂà∞Ëøô‰∏™ÂÅèÁßªÈáèÔºåÁÑ∂ÂêéÂ∞Ü‰πãÂâçËÆæÂÆöÁöÑÂü∫ÂáÜÁ∫ø‰∏ãÁßª„ÄÇÂú®ËÆ°ÁÆóÂÅèÁßªÈáè‰πãÂâçÈ¶ñÂÖàÈúÄË¶Å‰∫ÜËß£Â≠ó‰ΩìÊòØÂ¶Ç‰ΩïËøõË°åÊµãÈáèÁöÑÔºåÂÖ∑‰ΩìÂ¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö ÂÖ∂‰∏≠ Top Ë°®Á§∫Âü∫ÂáÜÁ∫ø‰ª•‰∏äÂèØÁªòÂà∂ÁöÑÊúÄÂ§ßË∑ùÁ¶ªÔºàË¥üÊï∞ÔºâÔºåBottom Ë°®Á§∫Âü∫ÂáÜÁ∫ø‰ª•‰∏ãÂèØÁªòÂà∂ÁöÑÊúÄÂ§ßË∑ùÁ¶ªÔºàÊ≠£Êï∞ÔºâÔºåAscent Ë°®Á§∫Âü∫ÂáÜÁ∫ø‰ª•‰∏äÊé®ËçêÁöÑÂèØÁªòÂà∂ÁöÑË∑ùÁ¶ªÔºåDescent Ë°®Á§∫Âü∫ÂáÜÁ∫ø‰ª•‰∏ãÊé®ËçêÁöÑÂèØÁªòÂà∂ÁöÑË∑ùÁ¶ª„ÄÇ ‰∫ÜËß£ÂÆåËøô‰∏ÄÂàá‰πãÂêéÂ¶Ç‰ΩïËÆ°ÁÆóÂÅèÁßªÈáèÂ∞±ÂæàÁÆÄÂçï‰∫ÜÔºåÈÄöËøá FontMetrics Ëé∑Âèñ Bottom Âíå TopÔºåÁÑ∂ÂêéÈÄöËøá ((Bottom - Top) / 2) - Bottom ÊúÄÁªàÂèñÂæóÂÅèÁßªÈáè„ÄÇ‰ª£Á†ÅÂÅöÂ¶Ç‰∏ã‰øÆÊîπÔºö 123456789101112131415161718192021public class RingPercentDemo extends View &#123; ... private int mTextX; private int mTextY; private Paint mTextPaint; private String mTextStr; public RingPercentDemo(Context context) &#123; super(context); &#125; public RingPercentDemo(Context context, @Nullable AttributeSet attrs) &#123; ... FontMetrics fontMetrics = mTextPaint.getFontMetrics(); float offsetY = ((fontMetrics.bottom - fontMetrics.top) / 2) - fontMetrics.bottom; mTextY = (int) (mCircleY + offsetY); ... &#125;&#125; ‰øÆÊîπ‰πãÂêéÁöÑÊïàÊûúÔºö ÊîπËøõ Ëá™ÂÆö‰πâÂ±ûÊÄß ÁªèËøá‰∏äËø∞ËøáÁ®ãÔºåËôΩÁÑ∂ÂúÜÁéØÁôæÂàÜÊØîÁöÑÊïàÊûúÂ∑≤ÁªèÂÆûÁé∞Ôºå‰ΩÜÊòØË∑üÊïàÊûúÂõæ‰∏≠ÁöÑËøòÊòØÂ∑ÆÁöÑÂæàËøúÔºåËÄå‰∏î‰πü‰∏çËÉΩÂ§üÁÅµÊ¥ªÔºåÊâÄ‰ª•Êàë‰ª¨ÈúÄË¶ÅÂÄüÂä©Ëá™ÂÆö‰πâÂ±ûÊÄßÂéªÊîπËøõÊàë‰ª¨ÁöÑÂúÜÁéØ„ÄÇ È¶ñÂÖàÈúÄË¶ÅÂú® values Êñá‰ª∂Â§π‰∏ãÂàõÂª∫ attrs.xml Êñá‰ª∂Âú®ÈáåÈù¢Â£∞ÊòéÊàë‰ª¨ÈúÄË¶ÅÂÆö‰πâÁöÑÂ±ûÊÄßÔºö 1234567891011121314&lt;?xml version="1.0" encoding="utf-8"?&gt;&lt;resources&gt; &lt;declare-styleable name="RingPercentDemo"&gt; &lt;attr format="integer" name="radius" /&gt; &lt;attr format="color" name="circleColor" /&gt; &lt;attr format="integer" name="circleStrokeWidth" /&gt; &lt;attr format="integer" name="circleStyle" /&gt; &lt;attr format="color" name="ringColor" /&gt; &lt;attr format="integer" name="ringStrokeWidth" /&gt; &lt;attr format="integer" name="startAngle" /&gt; &lt;attr format="integer" name="sweepAngle" /&gt; &lt;attr format="integer" name="rate" /&gt; &lt;/declare-styleable&gt;&lt;/resources&gt; ÁÑ∂ÂêéÂú®ÊûÑÈÄ†ÂáΩÊï∞Ëé∑ÂèñÂà∞Ëá™ÂÆö‰πâÁöÑÂ±ûÊÄßÁöÑÂ±ûÊÄßÂÄº 12345678910111213141516171819202122232425262728public RingPercentDemo(Context context, @Nullable AttributeSet attrs) &#123; super(context, attrs); TypedArray typedArray = context.obtainStyledAttributes( attrs, R.styleable.RingPercentDemo); mRadius = typedArray.getInteger(R.styleable.RingPercentDemo_radius, 60); mCircleColor = typedArray.getColor( R.styleable.RingPercentDemo_circleColor, Color.GREEN); mCircleStrokeWidth = typedArray.getInteger( R.styleable.RingPercentDemo_circleStrokeWidth, 5); mCircleStyle = typedArray.getInteger( R.styleable.RingPercentDemo_circleStyle, 0); mRingColor = typedArray.getColor( R.styleable.RingPercentDemo_ringColor, Color.RED); mRingStrokeWidth = typedArray.getColor( R.styleable.RingPercentDemo_ringStrokeWidth, 10); mStartAngle = typedArray.getInteger( R.styleable.RingPercentDemo_startAngle, -90); mSweepAngle = typedArray.getInteger( R.styleable.RingPercentDemo_sweepAngle, 90); mRate = typedArray.getInteger(R.styleable.RingPercentDemo_rate, 100); typedArray.recycle(); init(); &#125; Âú®Ëé∑ÂèñÂà∞Ëøô‰∫õÂ±ûÊÄßÂÄº‰πãÂêéÂè™ÈúÄË¶ÅÁªôÂØπÂ∫îÁöÑ Paint ÂíåÂèòÈáèËÆæÁΩÆÂØπÂ∫îÁöÑÂÄºÂç≥ÂèØ„ÄÇ Âõ∫ÂÆöÂúÜÂøÉÂíåÂä®ÊÄÅÂèòÂåñ ÂúÜÂøÉÁöÑ‰ΩçÁΩÆÊàë‰ª¨Â∏åÊúõËÉΩÂ§ü‰∏ÄÁõ¥Â§Ñ‰∫é View ÁöÑ‰∏≠ÂøÉÔºåÊâÄ‰ª•ÈúÄË¶ÅÈáçÂÜô onMeasure ÊñπÊ≥ïÔºåÂú® onMeasure ÊñπÊ≥ïÈÄöËøáËé∑Âèñ View ÁöÑÈ´òÂ∫¶ÂíåÂÆΩÂ∫¶ÂæóÂà∞‰∫Ü View ÁöÑ‰∏≠ÂøÉÁÇπÂùêÊ†áÔºå‰ªéËÄå‰ΩøÂæóÂúÜÂøÉ‰∏ÄÁõ¥Âú® View ÁöÑ‰∏≠ÂøÉ„ÄÇ 123456789101112131415161718192021222324@Overrideprotected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) &#123; setMeasuredDimension(measuse(widthMeasureSpec), measuse(heightMeasureSpec)); mCircleX = getMeasuredWidth() / 2; mCircleY = getMeasuredHeight() / 2; //Âà§Êñ≠ËÆæÂÆöÁöÑÂúÜÊòØÂê¶Ë∂ÖÂá∫ÊòæÁ§∫ËåÉÂõ¥ÔºåÂ¶ÇÊûúË∂ÖÂá∫ÈúÄË¶ÅÁº©Â∞è if (mCircleX &lt; mRadius) &#123; mRadius = mCircleX - mCircleStrokeWidth - mRingStrokeWidth; mTextPaint.setTextSize(mRadius / 2); &#125; else if (mCircleY &lt; mRadius) &#123; mRadius = mCircleY - mCircleStrokeWidth - mRingStrokeWidth; mTextPaint.setTextSize(mRadius / 2); &#125; FontMetrics fontMetrics = mTextPaint.getFontMetrics(); int offsetY = (int) (((fontMetrics.bottom - fontMetrics.top)) / 2 - fontMetrics.bottom); mTextX = mCircleX; mTextY = mCircleY + offsetY; mRecF = new RectF(mCircleX - mRadius, mCircleY - mRadius, mCircleX + mRadius, mCircleY + mRadius);&#125; Âú®Ëß£ÂÜ≥‰∫ÜÂúÜÂøÉÁöÑÈóÆÈ¢ò‰πãÂêéÔºåËøòÈúÄË¶Å‰∏∫ÂúÜÂºßÊèê‰æõÂä®ÊÄÅÂèòÂåñÁöÑÊïàÊûúÔºåËøôÈáåÂèØ‰ª•ÈÄöËøá‰∏çÊñ≠ÈáçÁªòËææÊàêÁõÆÊ†á„ÄÇ 1234567891011121314@Overrideprotected void onDraw(Canvas canvas) &#123; super.onDraw(canvas); canvas.drawCircle(mCircleX, mCircleY, mRadius, mCirclePaint); canvas.drawArc(mRecF, mStartAngle, mCurrentAngle, false, mRingPaint); canvas.drawText(mTextStr, mTextX, mTextY, mTextPaint); if (mCurrentAngle &lt; mSweepAngle) &#123; mCurrentAngle += 3.6; mTextStr = mCurrentAngle * 100 / 360 + "%"; postInvalidateDelayed(mRate); &#125;&#125; Áõ∏ÂÖ≥ÊµãËØïÂ∑•Á®ã ÊÄªÁªì Ê∂âÂèäÂà∞ View ÁöÑÁªòÂà∂ÈúÄË¶ÅÂØπÂÖÉÁ¥†ËøõË°åÊãÜÂàÜÔºåÁÑ∂ÂêéËøõË°åÂçïÁã¨Â§ÑÁêÜÔºåËøôÊ†∑ÊÄùË∑Ø‰ºöÊØîËæÉÊ∏ÖÊô∞ Thanks android canvas drawText()ÊñáÂ≠óÂ±Ö‰∏≠ AndroidËá™ÂÆö‰πâÊéß‰ª∂‰πãÁôæÂàÜÊØîÂúÜÁéØËøõÂ∫¶Êù°]]></content>
      <categories>
        <category>AndroidÂü∫Á°Ä</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>Ëá™ÂÆö‰πâÊéß‰ª∂</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Android ËøõÈò∂‰πã Binder ÊµÖËß£]]></title>
    <url>%2F2017%2F09%2F03%2FAndroid%E8%BF%9B%E9%98%B6%E4%B9%8BBinder%E6%B5%85%E8%A7%A3%2F</url>
    <content type="text"><![CDATA[‰ªÄ‰πàÊòØ Binder Binder ÊòØ Android ‰∏≠‰∏ÄÁßçË∑®ËøõÁ®ãÈÄö‰ø°ÔºàIPCÔºâÊñπÂºè„ÄÇ #### Binder ÁöÑÂéüÁêÜ BinderÈÄö‰ø°ÈááÁî®C/SÊû∂ÊûÑÔºå‰ªéÁªÑ‰ª∂ËßÜËßíÊù•ËØ¥ÔºåÂåÖÂê´ Client„ÄÅServer„ÄÅServiceManager ‰ª•Âèä binder È©±Âä®ÔºåÂÖ∂‰∏≠ ServiceManager Áî®‰∫éÁÆ°ÁêÜÁ≥ªÁªü‰∏≠ÁöÑÂêÑÁßçÊúçÂä°„ÄÇÊû∂ÊûÑÂõæÂ¶Ç‰∏ãÊâÄÁ§∫Ôºö Ê≠§Â§ÑÁöÑ Service Manager ÊòØÊåá Native Â±ÇÁöÑ ServiceManagerÔºàC++Ôºâ Ê≥®ÂÜåÊúçÂä°(addService)ÔºöServer ËøõÁ®ãË¶ÅÂÖàÊ≥®ÂÜå Service Âà∞ ServiceManager„ÄÇËØ•ËøáÁ®ãÔºöServer ÊòØÂÆ¢Êà∑Á´ØÔºåServiceManager ÊòØÊúçÂä°Á´Ø„ÄÇ Ëé∑ÂèñÊúçÂä°(getService)ÔºöClient ËøõÁ®ã‰ΩøÁî®Êüê‰∏™ Service ÂâçÔºåÈ°ªÂÖàÂêë ServiceManager ‰∏≠Ëé∑ÂèñÁõ∏Â∫îÁöÑ Service„ÄÇËØ•ËøáÁ®ãÔºöClient ÊòØÂÆ¢Êà∑Á´ØÔºåServiceManager ÊòØÊúçÂä°Á´Ø„ÄÇ ‰ΩøÁî®ÊúçÂä°ÔºöClient Ê†πÊçÆÂæóÂà∞ÁöÑ Service ‰ø°ÊÅØÂª∫Á´ã‰∏é Service ÊâÄÂú®ÁöÑ Server ËøõÁ®ãÈÄö‰ø°ÁöÑÈÄöË∑ØÔºåÁÑ∂ÂêéÂ∞±ÂèØ‰ª•Áõ¥Êé•‰∏é Service ‰∫§‰∫í„ÄÇËØ•ËøáÁ®ãÔºöClient ÊòØÂÆ¢Êà∑Á´ØÔºåServer ÊòØÊúçÂä°Á´Ø„ÄÇ Binder ÁöÑÁªìÊûÑ Âú®Â≠¶‰π† Binder ÁöÑÁªìÊûÑÁöÑÊó∂ÂÄôÔºåÂèØ‰ª•Âà©Áî® AIDL ÂéªÁîüÊàê BinderÔºåËøôÈáåÊàë‰ª¨È¶ñÂÖàÈúÄË¶ÅÂàõÂª∫‰∏Ä‰∏™ÂÆûÁé∞‰∫Ü Parcelable Êé•Âè£ÁöÑ Book Á±ªÔºåÁÑ∂ÂêéÂú® main Êñá‰ª∂Â§π‰∏ãÂàõÂª∫ AIDL Êñá‰ª∂Â§πÔºåÂàÜÂà´ÂàõÂª∫ Book.aidl„ÄÅIBookManager.aidl„ÄÇ‰∏â‰∏™Êñá‰ª∂ÁöÑ‰ª£Á†ÅÂàÜÂà´Â¶Ç‰∏ãÔºö 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768//Book.javapackage com.rookieyang.aidltest;import android.os.Parcel;import android.os.Parcelable;/** * Created by firstdream on 2017/9/4. */public class Book implements Parcelable &#123; private int mBookId; private String mBookName; public Book(int mBookId, String mBookName) &#123; this.mBookId = mBookId; this.mBookName = mBookName; &#125; @Override public void writeToParcel(Parcel parcel, int i) &#123; parcel.writeInt(mBookId); parcel.writeString(mBookName); &#125; @Override public int describeContents() &#123; return 0; &#125; public static final Parcelable.Creator&lt;Book&gt; CREATOR = new Creator&lt;Book&gt;() &#123; @Override public Book createFromParcel(Parcel parcel) &#123; Book book = new Book(parcel.readInt(), parcel.readString()); return book; &#125; @Override public Book[] newArray(int size) &#123; return new Book[size]; &#125; &#125;;&#125;// Book.aidlpackage com.rookieyang.aidltest;// Declare any non-default types here with import statementsparcelable Book;// IBookManager.aidlpackage com.rookieyang.aidltest;//ÈúÄË¶ÅÂØºÂÖ• Book Á±ªimport com.rookieyang.aidltest.Book;// Declare any non-default types here with import statementsinterface IBookManager &#123; /** * Demonstrates some basic types that you can use as parameters * and return values in AIDL. */ List&lt;Book&gt; getBookList(); void addBook(in Book book);&#125; Âú®ÁªèËøá‰∏äËø∞ÁöÑËøáÁ®ã‰πãÂêéÔºåÁÇπÂáªÁºñËØëÂç≥ÂèØÁîüÊàê Binder Êñá‰ª∂Ôºå‰ª• IBookManager.aidl ÁîüÊàêÁöÑ IBookManager.java ‰∏∫‰æãÔºå IBookManager.java ‰∏≠ÂÆö‰πâ‰∫Ü‰∏Ä‰∏™ÁªßÊâøËá™ IInterface ÁöÑ IBookManager Êé•Âè£ÔºåÂú® IBookManager ÂÜÖÂåÖÂê´‰∫ÜÁªßÊâøËá™ Binder ÂÆûÁé∞‰∫Ü IBookManager Êé•Âè£ÁöÑÂÜÖÈÉ®Á±ª Stub Âíå ÂÆûÁé∞‰∫Ü IBookManager Êé•Âè£ÁöÑ Stub ÁöÑÂÜÖÈÉ®Á±ª Proxy„ÄÇÊï¥‰ΩìÁªìÊûÑÂ¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö ‰∏ãÈù¢ÈíàÂØπ IBookManager.java ËøõË°åÂÖ∑‰ΩìÁöÑÂàÜÊûêÔºö IBookManager Êé•Âè£ÔºåËøô‰∏™Êé•Âè£‰∏éÂú® IBookManager.aidl ‰∏≠‰∏ÄËá¥ getBookList() addBook(Book book) 12345678910public interface IBookManager extends IInterface &#123; /** * Demonstrates some basic types that you can use as parameters * and return values in AIDL. */ public List&lt;Book&gt; getBookList() throws RemoteException; public void addBook(Book book) throws RemoteException;&#125; Stub Á±ª DESCRIPTOR Binder ÁöÑÂîØ‰∏ÄÊ†áËØÜÔºå‰∏ÄËà¨Áî®ÂΩìÂâç Binder ÁöÑÁ±ªÂêçË°®Á§∫ TRANSACTION_getBookList Âíå TRANSACTION_addBook ‰∏§‰∏™idÁî®‰∫éÊ†áËØÜÂú®transactËøáÁ®ã‰∏≠ÂÆ¢Êà∑Á´ØÊâÄËØ∑Ê±ÇÁöÑÂà∞Â∫ïÊòØÂì™‰∏™ÊñπÊ≥ï asInterface(IBinder obj) Áî®‰∫éÂ∞ÜÊúçÂä°Á´ØÁöÑ Binder ÂØπË±°ËΩ¨Êç¢ÊàêÂÆ¢Êà∑Á´ØÊâÄÈúÄÁöÑ AIDL Êé•Âè£Á±ªÂûãÁöÑÂØπË±°ÔºåËøôÁßçËΩ¨Êç¢ËøáÁ®ãÊòØÂå∫ÂàÜËøõÁ®ãÁöÑÔºåÂ¶ÇÊûúÂÆ¢Êà∑Á´ØÂíåÊúçÂä°Á´Ø‰Ωç‰∫éÂêå‰∏ÄËøõÁ®ãÔºåÈÇ£‰πàÊ≠§ÊñπÊ≥ïËøîÂõûÁöÑÂ∞±ÊòØÊúçÂä°Á´ØÁöÑ Stub ÂØπË±°Êú¨Ë∫´ÔºåÂê¶ÂàôËøîÂõûÁöÑÊòØÁ≥ªÁªüÂ∞ÅË£ÖÂêéÁöÑ Stub.proxy ÂØπË±°„ÄÇ asBinder Ê≠§ÊñπÊ≥ïÁî®‰∫éËøîÂõûÂΩìÂâç Binder ÂØπË±°„ÄÇ onTransact Ëøô‰∏™ÊñπÊ≥ïËøêË°åÂú®ÊúçÂä°Á´Ø‰∏≠ÁöÑ Binder Á∫øÁ®ãÊ±†‰∏≠ÔºåÂΩìÂÆ¢Êà∑Á´ØÂèëËµ∑Ë∑®ËøõÁ®ãËØ∑Ê±ÇÊó∂ÔºåËøúÁ®ãËØ∑Ê±Ç‰ºöÈÄöËøáÁ≥ªÁªüÂ∫ïÂ±ÇÂ∞ÅË£ÖÂêé‰∫§Áî±Ê≠§ÊñπÊ≥ïÊù•Â§ÑÁêÜ„ÄÇ ÊúçÂä°Á´ØÈÄöËøá code ÂèØ‰ª•Á°ÆÂÆöÂÆ¢Êà∑Á´ØÊâÄËØ∑Ê±ÇÁöÑÁõÆÊ†áÊñπÊ≥ïÊòØ‰ªÄ‰πàÔºåÊé•ÁùÄ‰ªé data ‰∏≠ÂèñÂá∫ÁõÆÊ†áÊñπÊ≥ïÊâÄÈúÄÁöÑÂèÇÊï∞ÔºàÂ¶ÇÊûúÁõÆÊ†áÊñπÊ≥ïÊúâÂèÇÊï∞ÁöÑËØùÔºâÔºåÁÑ∂ÂêéÊâßË°åÁõÆÊ†áÊñπÊ≥ï„ÄÇÂΩìÁõÆÊ†áÊñπÊ≥ïÊâßË°åÂÆåÊØïÂêéÔºåÂ∞±Âêë reply ‰∏≠ÂÜôÂÖ•ËøîÂõûÂÄºÔºàÂ¶ÇÊûúÁõÆÊ†áÊñπÊ≥ïÊúâËøîÂõûÂÄºÁöÑËØùÔºâÔºåonTransact ÊñπÊ≥ïÁöÑÊâßË°åËøáÁ®ãÂ∞±ÊòØËøôÊ†∑ÁöÑ„ÄÇ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566public static abstract class Stub extends Binder implements IBookManager &#123; private static final String DESCRIPTOR = "com.rookieyang.binderdemo.IBookManager"; /** * Construct the stub at attach it to the interface. */ public Stub() &#123; this.attachInterface(this, DESCRIPTOR); &#125; /** * Cast an IBinder object into an IBookManager interface, * generating a proxy if needed. */ public static IBookManager asInterface(IBinder obj) &#123; if ((obj == null)) &#123; return null; &#125; IInterface iin = obj.queryLocalInterface(DESCRIPTOR); if (((iin != null) &amp;&amp; (iin instanceof IBookManager))) &#123; return ((IBookManager) iin); &#125; return new IBookManager.Stub.Proxy(obj); &#125; @Override public IBinder asBinder() &#123; return this; &#125; @Override public boolean onTransact(int code, Parcel data, Parcel reply, int flags) throws RemoteException &#123; switch (code) &#123; case INTERFACE_TRANSACTION: &#123; reply.writeString(DESCRIPTOR); return true; &#125; case TRANSACTION_getBookList: &#123; data.enforceInterface(DESCRIPTOR); List&lt;Book&gt; _result = this.getBookList(); reply.writeNoException(); reply.writeTypedList(_result); return true; &#125; case TRANSACTION_addBook: &#123; data.enforceInterface(DESCRIPTOR); Book _arg0; if ((0 != data.readInt())) &#123; //ÂèçÂ∫èÂàóÂåñ _arg0 = Book.CREATOR.createFromParcel(data); &#125; else &#123; _arg0 = null; &#125; this.addBook(_arg0); reply.writeNoException(); return true; &#125; &#125; return super.onTransact(code, data, reply, flags); &#125; static final int TRANSACTION_getBookList = (IBinder.FIRST_CALL_TRANSACTION + 0); static final int TRANSACTION_addBook = (IBinder.FIRST_CALL_TRANSACTION + 1);&#125; Proxy Á±ª getBookList Ëøô‰∏™ÊñπÊ≥ïËøêË°åÂú®ÂÆ¢Êà∑Á´ØÔºåÂΩìÂÆ¢Êà∑Á´ØËøúÁ®ãË∞ÉÁî®Ê≠§ÊñπÊ≥ïÊó∂ÔºåÂÆÉÁöÑÂÜÖÈÉ®ÂÆûÁé∞ÊòØËøôÊ†∑ÁöÑÔºöÈ¶ñÂÖàÂàõÂª∫ËØ•ÊñπÊ≥ïÊâÄÈúÄË¶ÅÁöÑËæìÂÖ•Âûã Parcel ÂØπË±° _data „ÄÅËæìÂá∫Âûã Parcel ÂØπË±° _reply ÂíåËøîÂõûÂÄºÂØπË±° ListÔºõÁÑ∂ÂêéÊääËØ•ÊñπÊ≥ïÁöÑÂèÇÊï∞‰ø°ÊÅØÂÜôÂÖ• _data ‰∏≠ÔºàÂ¶ÇÊûúÊúâÂèÇÊï∞ÁöÑËØùÔºâÔºõÊé•ÁùÄË∞ÉÁî® transact ÊñπÊ≥ïÊù•ÂèëËµ∑ RPCÔºàËøúÁ®ãËøáÁ®ãË∞ÉÁî®ÔºâËØ∑Ê±ÇÔºåÂêåÊó∂ÂΩìÂâçÁ∫øÁ®ãÊåÇËµ∑ÔºõÁÑ∂ÂêéÊúçÂä°Á´ØÁöÑ onTransact ÊñπÊ≥ï‰ºöË¢´Ë∞ÉÁî®ÔºåÁõ¥Âà∞ RPC ËøáÁ®ãËøîÂõûÂêéÔºåÂΩìÂâçÁ∫øÁ®ãÁªßÁª≠ÊâßË°åÔºåÂπ∂‰ªé _reply ‰∏≠ÂèñÂá∫ RPC ËøáÁ®ãÁöÑËøîÂõûÁªìÊûúÔºõÊúÄÂêéËøîÂõû _reply ‰∏≠ÁöÑÊï∞ÊçÆ„ÄÇ addBook Ëøô‰∏™ÊñπÊ≥ïËøêË°åÂú®ÂÆ¢Êà∑Á´ØÔºåÂÆÉÁöÑÊâßË°åËøáÁ®ãÂíå getBookList ÊòØ‰∏ÄÊ†∑ÁöÑÔºåaddBook Ê≤°ÊúâËøîÂõûÂÄºÔºåÊâÄ‰ª•ÂÆÉ‰∏çÈúÄË¶Å‰ªé _reply ‰∏≠ÂèñÂá∫ËøîÂõûÂÄº„ÄÇ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960private static class Proxy implements IBookManager &#123; private IBinder mRemote; Proxy(IBinder remote) &#123; mRemote = remote; &#125; @Override public IBinder asBinder() &#123; return mRemote; &#125; public String getInterfaceDescriptor() &#123; return DESCRIPTOR; &#125; /** * Demonstrates some basic types that you can use as parameters * and return values in AIDL. */ @Override public List&lt;Book&gt; getBookList() throws RemoteException &#123; Parcel _data = Parcel.obtain(); Parcel _reply = Parcel.obtain(); java.util.List&lt;Book&gt; _result; try &#123; _data.writeInterfaceToken(DESCRIPTOR); mRemote.transact(Stub.TRANSACTION_getBookList, _data, _reply, 0); _reply.readException(); _result = _reply.createTypedArrayList(Book.CREATOR); &#125; finally &#123; _reply.recycle(); _data.recycle(); &#125; return _result; &#125; @Override public void addBook(Book book) throws RemoteException &#123; Parcel _data = Parcel.obtain(); Parcel _reply = Parcel.obtain(); try &#123; _data.writeInterfaceToken(DESCRIPTOR); if ((book != null)) &#123; _data.writeInt(1); book.writeToParcel(_data, 0); &#125; else &#123; _data.writeInt(0); &#125; mRemote.transact(Stub.TRANSACTION_addBook, _data, _reply, 0); _reply.readException(); &#125; finally &#123; _reply.recycle(); _data.recycle(); &#125; &#125;&#125; Binder ÁöÑÂ∑•‰ΩúÊú∫Âà∂ &gt; ‰ª•‰∏äËø∞‰∏∫‰æãÔºåÂÆ¢Êà∑Á´ØË∞ÉÁî® getBookList ÊñπÊ≥ïÊó∂ÔºåÂú®ÊñπÊ≥ïÂÜÖÈÉ®ÂÆö‰πâ‰∫Ü Parcel ÂØπË±°ÔºåÁÑ∂ÂêéÈÄöËøáË∞ÉÁî® transact ÂèëËµ∑ËøúÁ®ãËØ∑Ê±ÇÔºåÊúçÂä°Âô®Á´ØÊé•Êî∂Âà∞ÂêéË∞ÉÁî® onTransact ÊñπÊ≥ïÔºåÊ†πÊçÆ‰º†ÈÄíËøáÊù•ÁöÑ Code ËøõË°åÁõ∏Â∫îÁöÑÂ§ÑÁêÜÔºåÂ∞ÜÁªìÊûúÂÜôÂÖ• Parcel ÂØπË±°ÂΩì‰∏≠ÔºåÂ§ÑÁêÜÂÆåÊàê‰πãÂêéÂú® ÂÆ¢Êà∑Á´ØÁöÑ transact Â∞ÜÁªìÊûúÂèñÂá∫Êù•Âπ∂ËøîÂõû„ÄÇ Binder ‰ΩøÁî®ÁöÑ‰∏Ä‰∫õÊ≥®ÊÑèÁÇπ Binder ‰∏ÄËà¨Âíå Service ÈÖçÂêà‰ΩøÁî®Ôºå‰Ωú‰∏∫ bindService ÊâßË°åÊó∂ÁöÑËøîÂõûÔºåÊúÄÂêéÂú® ServiceConnect ÂΩì‰∏≠Ëé∑ÂèñËøîÂõûÁöÑ BinderÔºö 1234567891011private ServiceConnection serviceConnection = new ServiceConnection() &#123; @Override public void onServiceConnected(ComponentName componentName, IBinder iBinder) &#123; mCalcAidl = ICalcAIDL.Stub.asInterface(iBinder); &#125; @Override public void onServiceDisconnected(ComponentName componentName) &#123; mCalcAidl = null; &#125;&#125;; ‰∏çÂêåËøõÁ®ãÊó∂ËøîÂõûÁöÑ iBinder ÊòØ ICalcAIDL.Stub.ProxyÔºåËÄåÁõ∏ÂêåËøõÁ®ã‰∏≠ÂàôÊòØ ICalcAIDL.Stub„ÄÇÊòØËøîÂõû Stub ËøòÊòØËøîÂõû Proxy Âú®Â∫ïÂ±ÇÂ∑≤ÁªèÂÅö‰∫ÜÂà§Êñ≠Ôºå‰∏çÊòØÂú® onServiceConnected ÊñπÊ≥ï‰∏≠ËøõË°åÁöÑÂà§Êñ≠ Âú®ÊúçÂä°‰∏≠‰ΩøÁî®Êó∂ÔºåÂÆö‰πâÁöÑ AIDL Êñá‰ª∂ÂåÖÂêçÂøÖÈ°ªÁõ∏ÂêåÔºå‰∏çÁÑ∂Â∞ÜÊó†Ê≥ïÊâæÂà∞ÂØπÂ∫îÁöÑ AIDLÔºå‰ªéËÄåÂØºËá¥Êó†Ê≥ïËøõË°åÈÄö‰ø°ÔºåÂπ∂‰∏î‰ΩøÁî®Êó∂ÈúÄË¶ÅÈÄöËøá ICalcAIDL.Stub ÂÆûÁé∞Âú® AIDL ‰∏≠ÂÆö‰πâÁöÑÊé•Âè£Ôºå‰ªéËÄå‰∏∫ÂÆ¢Êà∑Á´ØÊèê‰æõÊúçÂä°„ÄÇ 1234567891011private final ICalcAIDL.Stub mBinder = new Stub() &#123; @Override public int add(int x, int y) throws RemoteException &#123; return x + y; &#125; @Override public int min(int x, int y) throws RemoteException &#123; return x - y; &#125;&#125;; ÊÄªÁªì Á≤óÁï•ÁöÑËØ¥ÔºåClient ÈÄöËøá Binder ÂΩì‰∏≠ÁöÑ Proxy ËøõË°å‰∫Ü IPC ÁöÑËØ∑Ê±ÇÔºåËÄå Server ÂàôÈÄöËøá Stub ÂΩì‰∏≠ÁöÑ onTransact ÂØπË∑®ËøõÁ®ãËØ∑Ê±ÇËøõË°åÂ§ÑÁêÜÔºå‰πãÊâÄ‰ª•ËÉΩËøõË°åË∑®ËøõÁ®ãËØ∑Ê±ÇÁöÑÂéüÂõ†Âú®‰∫éÂ∫ïÂ±ÇËÉΩÂ§üÈÄöËøáÂèØÂ∫èÂàóÂåñÁöÑÊï∞ÊçÆÔºå‰∏äËø∞ÁöÑ Book Á±ªÂÆûÁé∞‰∫Ü Parcelable Êé•Âè£ÔºåËÄåÂü∫Êú¨Á±ªÂûãÊòØË¢´Áúã‰ΩúÂèØÂ∫èÂàóÂåñÁöÑÔºåÊâÄ‰ª•Ëøô‰∫õÊï∞ÊçÆÂú®Â∫ïÂ±ÇËÉΩÂ§üËøõË°å‰º†ËæìÔºåËá™ÁÑ∂Â∞±ÂèØ‰ª•ÈÄöËøá Binder ÂÆåÊàê IPC„ÄÇ ÂèÇËÄÉ Android ÂºÄÂèëËâ∫ÊúØÊé¢Á¥¢-IPC Êú∫Âà∂ Android aidl BinderÊ°ÜÊû∂ÊµÖÊûê BinderÂ≠¶‰π†ÊåáÂçó]]></content>
      <categories>
        <category>AndroidËøõÈò∂</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>IPC</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Android Âü∫Á°Ä‰πã Service]]></title>
    <url>%2F2017%2F08%2F27%2FAndroid%E5%9F%BA%E7%A1%80%E4%B9%8BService%2F</url>
    <content type="text"><![CDATA[Service ÁöÑÂê´‰πâÂèä‰ΩúÁî® Service ÊòØ‰∏Ä‰∏™ÂèØ‰ª•Âú®ÂêéÂè∞ÊâßË°åÈïøÊó∂Èó¥ËøêË°åÊìç‰ΩúËÄå‰∏çÈúÄË¶ÅÊèê‰æõÁî®Êà∑ÁïåÈù¢ÁöÑÂ∫îÁî®ÁªÑ‰ª∂Ôºå‰πüÂ∞±ÊòØËØ¥ Service ÊòØ‰∏∫‰∫ÜÂéªÂ§ÑÁêÜÈÇ£‰∫õ‰∏çÈúÄË¶ÅÂíåÁî®Êà∑‰∫§‰∫í‰ΩÜÂèàËÄóÊó∂ÁöÑÊìç‰Ωú„ÄÇ‰ΩÜÊòØÂ¶ÇÊûú Service Âè™ÊòØ‰∏∫‰∫ÜÊâßË°åÈÇ£‰∫õËÄóÊó∂ÁöÑÊìç‰ΩúÁöÑËØùÔºåÂÖ∂ÂÆûÂè™Áî®Á∫øÁ®ã‰πüÂèØ‰ª•ËææÂà∞ÂêåÊ†∑ÁöÑÁõÆÁöÑÔºå‰πãÊâÄ‰ª•ÈúÄË¶ÅÂçïÁã¨Áî® Service Êù•ËøõË°åÂÆûÁé∞ÁöÑÂéüÂõ†Âú®‰∫é Service Áõ∏ËæÉ‰πãÁ∫øÁ®ãËÄåË®Ä‰ºòÂÖàÁ∫ßÊØîËæÉÈ´òÔºåÂπ∂‰∏î Service ÈÄöËøáÁªëÂÆöÂêØÂä®ÁöÑÊó∂ÂÄôÊòØÂèØÊéßÁöÑÔºåÂ¶ÇÊûúÁ≥ªÁªü‰∏çÊòØÊûÅÁ´Ø‰∏çÂ§üÁî®Ôºå‰∏ÄËà¨ËÄåË®ÄÊòØ‰∏ç‰ºöÊùÄÊ≠ª ServiceÔºå‰ΩÜÊòØÁ∫øÁ®ãÂèØËÉΩÂ≠òÂú®Ë¢´Á≥ªÁªüÂõûÊî∂ÁöÑÂèØËÉΩÊÄßÔºåÊâÄ‰ª• Service ÁöÑÂèØÈù†ÊÄßË¶ÅÊØîÁ∫øÁ®ãÈ´ò„ÄÇ Âè¶Â§ñÂÖ≥‰∫é ServiceÔºåÂÆòÁΩë‰∏äËøòÊúâÂ¶Ç‰∏ãÁöÑÊèêÁ§∫Ôºö &gt; ÊúçÂä°Âú®ÂÖ∂ÊâòÁÆ°ËøõÁ®ãÁöÑ‰∏ªÁ∫øÁ®ã‰∏≠ËøêË°åÔºåÂÆÉÊó¢‰∏çÂàõÂª∫Ëá™Â∑±ÁöÑÁ∫øÁ®ãÔºå‰πü‰∏çÂú®ÂçïÁã¨ÁöÑËøõÁ®ã‰∏≠ËøêË°åÔºàÈô§ÈùûÂè¶Ë°åÊåáÂÆöÔºâ„ÄÇ ËøôÊÑèÂë≥ÁùÄÔºåÂ¶ÇÊûúÊúçÂä°Â∞ÜÊâßË°å‰ªª‰Ωï CPU ÂØÜÈõÜÂûãÂ∑•‰ΩúÊàñÈòªÊ≠¢ÊÄßÊìç‰ΩúÔºà‰æãÂ¶Ç MP3 Êí≠ÊîæÊàñËÅîÁΩëÔºâÔºåÂàôÂ∫îÂú®ÊúçÂä°ÂÜÖÂàõÂª∫Êñ∞Á∫øÁ®ãÊù•ÂÆåÊàêËøôÈ°πÂ∑•‰Ωú„ÄÇÈÄöËøá‰ΩøÁî®ÂçïÁã¨ÁöÑÁ∫øÁ®ãÔºåÂèØ‰ª•Èôç‰ΩéÂèëÁîü‚ÄúÂ∫îÁî®Êó†ÂìçÂ∫î‚Äù(ANR) ÈîôËØØÁöÑÈ£éÈô©ÔºåËÄåÂ∫îÁî®ÁöÑ‰∏ªÁ∫øÁ®ã‰ªçÂèØÁªßÁª≠‰∏ìÊ≥®‰∫éËøêË°åÁî®Êà∑‰∏é Activity ‰πãÈó¥ÁöÑ‰∫§‰∫í Service ÁöÑÁîüÂëΩÂë®Êúü Service ÁöÑÁîüÂëΩÂë®Êúü‰∏ªË¶ÅÂíåÊúçÂä°ÁöÑ‰ΩøÁî®ÊñπÂºèÊúâÂÖ≥Ôºå‰ΩøÁî®ÊúçÂä°‰∏ªË¶ÅÂàÜ‰∏∫ÂêØÂä®ÂíåÁªëÂÆö‰∏§ÁßçÊñπÂºèÔºåÂÖ∂ÁîüÂëΩÂë®ÊúüÂ¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö Service ÁöÑÂü∫Êú¨‰ΩøÁî® ÂàõÂª∫ÊúçÂä° Á≥ªÁªüÊèê‰æõ‰∫Ü‰∏Ä‰∏™ Service ÊäΩË±°Á±ªÔºåÊâÄ‰ª•Êàë‰ª¨Ëá™Â∑±ÂÆûÁé∞‰∏Ä‰∏™ÁªßÊâøËá™ Service ÁöÑÁ±ªÔºåÁÑ∂ÂêéÂú® AndroidManifest.xml Ê≥®ÂÜåÂç≥ÂèØ„ÄÇ ËøêË°åÊúçÂä° ËøêË°åÊúçÂä°‰∏ªË¶ÅÊñπÊ≥ïÊúâ‰∏§ÁßçÔºå‰∏ÄÁßçÊòØË∞ÉÁî® startService()ÔºåÁ¨¨‰∫åÁßçÂàôÊòØ bindService()„ÄÇÂÆûÈôÖ‰∏äËøô‰∏§‰∏™ÊñπÊ≥ïÂèØ‰ª•ÂêåÊó∂Ë∞ÉÁî®„ÄÇ ÊúçÂä°‰∏≠Â§ÑÁêÜ‰∫ã‰ª∂ startService ÂêØÂä®ÊúçÂä°Ôºå‰∫ã‰ª∂ÁöÑÂ§ÑÁêÜ‰∏ÄËà¨Âú®ÊúçÂä°ÁöÑ onStartCommand ÊñπÊ≥ïËøõË°åÁöÑÔºåbindService ÁªëÂÆöÊúçÂä°‰πãÂêéÔºåÂ∞Ü‰ºöÂú® ServiceConnection ÁöÑ onServiceConnected ‰∏≠ËøîÂõû‰∏Ä‰∏™ Binder ÂØπË±°ÔºåÂà©Áî®ËøîÂõûÁöÑ Binder ÂØπË±°ÂèØ‰ª•Ë∞ÉÁî®Áõ∏ÂÖ≥ÁöÑ‰∫ã‰ª∂Â§ÑÁêÜÊñπÊ≥ï„ÄÇ ÂÅúÊ≠¢ÊúçÂä° ÊúçÂä°ÁöÑËøêË°åÊù°‰ª∂ÊòØÊúçÂä°Ë¢´ÁªëÂÆöÊàñËÄÖË¢´ÂêØÂä®ÔºåÊâÄ‰ª•ÊÉ≥ËÆ©ÊúçÂä°‰∏çËøêË°åÂàôÈúÄË¶ÅÁ†¥ÂùèËøô‰∏§‰∏™Êù°‰ª∂ÔºåÂèØ‰ª•ÈÄöËøáË∞ÉÁî® stopService Âíå unbindService ÂÆûÁé∞„ÄÇ]]></content>
      <categories>
        <category>AndroidÂü∫Á°Ä</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>Service</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Android Âü∫Á°Ä‰πã BroastCasts]]></title>
    <url>%2F2017%2F08%2F26%2FAndroid%E4%B9%8BBroastCastReceiver%2F</url>
    <content type="text"><![CDATA[BroadCasts ÂÆö‰πâÂèäÂÖ∂‰ΩúÁî® BroadCasts ÊòØ‰∏ÄÁßçÂπøÊí≠Êú∫Âà∂ÔºåÁ±ª‰ºº‰∫éÂèëÂ∏É-ËÆ¢ÈòÖËøôÁßçÊú∫Âà∂ÔºåÂΩìÂèëÁîü‰∏Ä‰∫õ‰∫ã‰ª∂ÁöÑÊó∂ÂÄôÔºåÁ≥ªÁªüÊàñÁ®ãÂ∫èÂ∞±‰ºöÂèëÈÄÅÔºàÂèëÂ∏ÉÔºâ‰∏Ä‰∫õÁõ∏ÂÖ≥ÁöÑÂπøÊí≠ÔºåËÄåÊ≥®ÂÜåÔºàËÆ¢ÈòÖÔºâ‰∫ÜËøô‰∫õÂπøÊí≠ÁöÑÁ®ãÂ∫èÂ∞±‰ºöÈÄöËøáÂπøÊí≠Êé•Êî∂Âô®ÂéªÂìçÂ∫îËøô‰∫õÂπøÊí≠„ÄÇ #### BroadCasts ÁöÑÂàÜÁ±ª 1. Êåâ‰ΩúÁî®ËåÉÂõ¥Êù•ÂàÜÔºö * ÂÖ®Â±ÄÂπøÊí≠ * Êú¨Âú∞ÂπøÊí≠ Êú¨Âú∞‰∏ªË¶Å‰∏∫‰∫ÜËß£ÂÜ≥ÂÖ®Â±ÄÂπøÊí≠ÁöÑÂÆâÂÖ®ÊÄßÈóÆÈ¢òÔºåÁî±‰∫éÂÖ®Â±ÄÂπøÊí≠ÊòØÈù¢ÂêëÁ≥ªÁªü‰∏≠ÊâÄÊúâÂ∫îÁî®ÁöÑÔºåÊâÄ‰ª•ÂΩìÊê∫Â∏¶‰∏Ä‰∫õÂÖ≥ÈîÆÊï∞ÊçÆÊó∂ÂèØËÉΩ‰ºöÂØºËá¥Êï∞ÊçÆÁöÑÊ≥ÑÊºè„ÄÇ 2. ÊåâÊé•Êî∂È°∫Â∫èÊù•ÂàÜÔºö * Ê†áÂáÜÂπøÊí≠ Ê†áÂáÜÂπøÊí≠Âú®ÂèëÂá∫‰πãÂêéÔºåÊâÄÊúâÁõ∏ÂÖ≥ÁöÑÂπøÊí≠Êé•Êî∂Âô®Âá†‰πéËÉΩÂ§ü‰∏ÄÊ¨°ÊÄßÊé•Êî∂Âà∞ËØ•Êù°ÂπøÊí≠„ÄÇ * ÊúâÂ∫èÂπøÊí≠ ÊúâÂ∫èÂπøÊí≠ÂèëÂá∫ÂêéÔºåÂêå‰∏ÄÊó∂Èó¥Âè™Êúâ‰∏Ä‰∏™ÂπøÊí≠Êé•Êî∂Âô®ËÉΩÂ§üÊé•Êî∂Âà∞ËøôÊù°ÂπøÊí≠Ê∂àÊÅØÔºåÂè™ÊúâÂΩìËØ•ÂπøÊí≠Êé•Êî∂Âô®ÂΩì‰∏≠ÁöÑÂ§ÑÁêÜÈÄªËæëÂ§ÑÁêÜÂÆåÊàê‰πãÂêéÔºåÂπøÊí≠ÊâçËÉΩÂêë‰∏ã‰º†ÈÄíÔºåÂπ∂‰∏î‰ºòÂÖàÁ∫ßÈ´òÁöÑÂπøÊí≠ËÉΩÂ§üÊà™Êñ≠Ê≠£Âú®‰º†ÈÄíÁöÑÂπøÊí≠„ÄÇÂ¶ÇÊûúÂ§ö‰∏™Â∫îÁî®Á®ãÂ∫èËÆæÁΩÆÁöÑ‰ºòÂÖàÁ∫ßÂà´Áõ∏ÂêåÔºåÂàôË∞ÅÂÖàÊ≥®ÂÜåÁöÑÂπøÊí≠ÔºåË∞ÅÂ∞±ÂèØ‰ª•‰ºòÂÖàÊé•Êî∂Âà∞ÂπøÊí≠„ÄÇ BroadCasts ÁöÑ‰ΩøÁî® ÂπøÊí≠Êú∫Âà∂ÁöÑ‰ΩøÁî®ÊñπÊ≥ïÂ§ß‰ΩìÊåâÁÖßÂ¶Ç‰∏ãÊ≠•È™§Ôºö ÂàõÂª∫ÂπøÊí≠Êé•Êî∂Âô® Android Á≥ªÁªüÊèê‰æõ‰∫Ü‰∏Ä‰∏™ BroadCastReciver ÁöÑÊäΩË±°Á±ªÔºåÊâÄ‰ª•ÈúÄË¶ÅÂàõÂª∫Ëá™Â∑±ÁöÑÂπøÊí≠Êé•Êî∂Âô®ÔºåÁÑ∂ÂêéÈáçÂÜôÂΩì‰∏≠ÁöÑ onReceive ÊñπÊ≥ïÔºåÂú®ÂΩì‰∏≠ÁºñÂÜô‰∫ã‰ª∂ÁöÑÂ§ÑÁêÜÈÄªËæë„ÄÇ 123456789101112131415161718class ForceReceiver extends BroadcastReceiver &#123; @Override public void onReceive(final Context context, Intent intent) &#123; AlertDialog.Builder builder = new AlertDialog.Builder(context); builder.setTitle("ÊèêÁ§∫"); builder.setMessage("Â∑≤ÁªèË¢´ÈÄÄÂá∫"); builder.setCancelable(false); builder.setPositiveButton("OK", new DialogInterface.OnClickListener() &#123; @Override public void onClick(DialogInterface dialogInterface, int i) &#123; ActivityCollector.finishActivities(); Intent intent = new Intent(context, LoginActivity.class); context.startActivity(intent); &#125; &#125;).show(); &#125;&#125; Ê≥®ÂÜåÂπøÊí≠ ‰∏∫‰∫ÜËøõË°åÂπøÊí≠ÁöÑÊé•Êî∂ËøòÈúÄË¶ÅÂØπÈúÄË¶ÅÊé•Êî∂ÁöÑÂπøÊí≠ËøõË°åÊ≥®ÂÜåÔºåÊ≥®ÂÜåÊñπÂºèÂèØ‰ª•ÂàÜ‰∏∫‰∏§ÁßçÔºö Á¨¨‰∏ÄÁßçÊòØÂä®ÊÄÅÊ≥®ÂÜåÔºåÂ¶ÇÊûúÊòØÂÖ®Â±ÄÂπøÊí≠ÂàôÂú® Activity ‰∏≠Áõ¥Êé•Ë∞ÉÁî® registerReceiver ÊñπÊ≥ïÂç≥ÂèØÔºåËØ•ÊñπÊ≥ï‰∏ªË¶ÅÊé•Êî∂‰∏§‰∏™ÂèÇÊï∞Ôºå‰∏Ä‰∏™ÊòØ BroadCastReceiverÔºåÁ¨¨‰∫å‰∏™ÂàôÊòØ IntentFilter„ÄÇÂ¶ÇÊûúÊòØÊú¨Âú∞ÂπøÊí≠ÂàôÈúÄË¶ÅÂÄüÂä©Á≥ªÁªüÊèê‰æõÁöÑ LocalBroadCastManager ÂéªËøõË°åÊ≥®ÂÜåÔºåÊñπÊ≥ïÂêç‰∏éÊ≥®ÂÜåÂÖ®Â±ÄÂπøÊí≠ÁöÑÊñπÊ≥ïÂêç‰∏ÄËá¥„ÄÇ ÂÖ®Â±ÄÂπøÊí≠Ôºö 123IntentFilter intentFilter = new IntentFilter("com.rookieyang.forcelogin");forceReceiver = new ForceReceiver();registerReceiver(forceReceiver, intentFilter); Êú¨Âú∞ÂπøÊí≠Ôºö 1234IntentFilter intentFilter = new IntentFilter("com.rookieyang.forcelogin");forceReceiver = new ForceReceiver();LocalBroadcastManager localBroadcastManager = LocalBroadcastManager.getInstance(this);localBroadcastManager.registerReceiver(forceReceiver, intentFilter); Á¨¨‰∫åÁßçÊòØÈùôÊÄÅÊ≥®ÂÜåÔºåÈùôÊÄÅÊ≥®ÂÜåÂèØ‰ª•ÂÆûÁé∞Âú®Á®ãÂ∫èÊú™ÂêØÂä®ÁöÑÊÉÖÂÜµ‰∏ãÊé•Êî∂Âà∞ÂπøÊí≠ÔºåÈùôÊÄÅÊ≥®ÂÜåÁöÑÂπøÊí≠ÊòØÂÖ®Â±ÄÂπøÊí≠„ÄÇ 123456789&lt;uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED"/&gt;&lt;receiver android:name=".BootCompleteReceiver" android:enabled="true" android:exported="true"&gt; &lt;intent-filter&gt; &lt;action android:name="android.intent.action.BOOT_COMPLETED" /&gt; &lt;/intent-filter&gt;&lt;/receiver&gt; ÁõëÂê¨Á≥ªÁªüÁöÑÂºÄÊú∫ÂπøÊí≠ÊòØÈúÄË¶ÅÊ∑ªÂä†ÊùÉÈôêÁöÑÔºåÂä®ÊÄÅÊ≥®ÂÜåÁõ∏ÊØîËæÉ‰∫éÈùôÊÄÅÊ≥®ÂÜåËÄåË®ÄÊõ¥‰∏∫ÁÅµÊ¥ªÔºå‰ΩÜÊòØÈùôÊÄÅÊ≥®ÂÜåËÉΩÂ§üÂÆûÁé∞Âú®Â∫îÁî®Êú™ÂêØÂä®ÁöÑÊÉÖÂÜµ‰∏ãÊé•Êî∂ÂπøÊí≠„ÄÇËÄå‰∏îÂä®ÊÄÅÊ≥®ÂÜåÁöÑÂπøÊí≠ÊúÄÂêéÂøÖÈ°ªË¶ÅÂèñÊ∂àÊ≥®ÂÜå„ÄÇ ÂèëÈÄÅÂπøÊí≠ ÂèëÈÄÅÂπøÊí≠ÈúÄË¶Å‰∏ªË¶ÅÈÄöËøá Intent ‰º†ÈÄí‰ø°ÊÅØÔºåÂ¶ÇÊûúÊòØÊòØÁ≥ªÁªüÂπøÊí≠Âàô‰∏çÈúÄË¶ÅÊàë‰ª¨ÂéªÁºñÁ†ÅÂéªÂèëÈÄÅÂπøÊí≠ÔºåÂ¶ÇÊûúÊòØËá™ÂÆö‰πâÁöÑÂπøÊí≠ÔºåÂèëÈÄÅÊ†áÂáÜÂπøÊí≠ÂàôË∞ÉÁî® sendBroadCast ÊñπÊ≥ïÔºåÂèëÈÄÅÊúâÂ∫èÂπøÊí≠ÂàôË∞ÉÁî® sendOrderedBroadcast ÊñπÊ≥ï„ÄÇÂ¶ÇÊûúÊòØÊú¨Âú∞ÂπøÊí≠ÂàôÂíå‰∏äÊñá‰∏ÄËá¥ÈúÄË¶ÅÂÄüÂä© LocalBroadCastManager ËøõË°åÂèëÈÄÅÔºåÊú¨Âú∞ÂπøÊí≠Ê≤°ÊúâÊúâÂ∫èÂπøÊí≠„ÄÇ 1234Intent intent = new Intent("com.rookieyang.forcelogin");sendBroadcast(intent);//sendOrderedBroadcast(intent);localBroadcastManager.sendBroadcast(); Êé•Êî∂Â§ÑÁêÜ Êé•Êî∂Â§ÑÁêÜÂú®ÂπøÊí≠Êé•Êî∂Âô®ÁöÑ onReceive ÊñπÊ≥ï‰∏≠ËøõË°åÔºåÂàõÂª∫ÂπøÊí≠Êé•Êî∂Âô®‰∏≠Â∑≤ÁªèËØ¥ÊòéÔºåÂú®Ê≠§‰∏çÂÜçËµòËø∞„ÄÇ ÂèñÊ∂àÊ≥®ÂÜå ÈùôÊÄÅÊ≥®ÂÜåÁöÑ‰∏çÈúÄË¶ÅÊàë‰ª¨ÁºñÁ†ÅÂéªÂèñÊ∂àÊ≥®ÂÜåÔºåÂØπ‰∫éÂä®ÊÄÅÊ≥®ÂÜåÁöÑÂàôÈúÄË¶ÅÁºñÁ†ÅÂéªÂèñÊ∂àÊ≥®ÂÜåÔºåÂ¶ÇÊûúÊòØÂÖ®Â±ÄÂπøÊí≠ÂàôË∞ÉÁî® unregisterReceiver ÊñπÊ≥ïÂç≥ÂèØÔºåÂ¶ÇÊûúÊòØÊú¨Âú∞ÂπøÊí≠ÂàôË∞ÉÁî® LocalBroadCastManager ÂØπË±°ÁöÑËØ•ÊñπÊ≥ïÂç≥ÂèØ„ÄÇ 12unregisterReceiver(forceReceiver);localBroadcastManager.unregisterReceiver(forceReceiver);]]></content>
      <categories>
        <category>AndroidÂü∫Á°Ä</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>BroatCasts</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Ubuntu 14.04‰∏ãAVDÁöÑÂàõÂª∫‰ª•ÂèäÈó™ÈÄÄÈóÆÈ¢ò]]></title>
    <url>%2F2017%2F08%2F24%2FAndroid%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95%E4%B9%8BAVD%E7%9A%84%E5%88%9B%E5%BB%BA%E4%BB%A5%E5%8F%8A%E9%97%AA%E9%80%80%2F</url>
    <content type="text"><![CDATA[Âú® Ubuntu 14.04 ‰∏ãÂàõÂª∫ Android ËôöÊãüÊú∫Êó∂ÂèØËÉΩ‰ºöÂá∫Áé∞‰∏ãÂàóÈîôËØØÔºö An error occurred while creating the AVD. See idea.log for details Âú®ÁΩë‰∏äÊü•Êâæ‰πãÂêéÂæàÂ§ö‰∫∫Âª∫ËÆÆ‰ΩøÁî® sudo apt-get install lib32stdc++6 ËøôÊù°ÂëΩ‰ª§Ôºå‰ΩÜÊòØÂÆûÈôÖ‰∏äÈááÁî®ËøôÊù°ÂëΩ‰ª§ÂéªÂÆâË£Ö‰ºöÂá∫Áé∞‰æùËµñÂÜ≤Á™ÅÁöÑÈóÆÈ¢òÔºåÊâÄ‰ª•ÈúÄË¶ÅÂÄüÂä© sudo aptitude -f install lib32stdc++6 ÂéªËß£ÂÜ≥‰æùËµñÈóÆÈ¢òÔºåËøôÊù°ËØ≠Âè•‰ΩøÁî®‰∏ÄÊ¨°ÂèØËÉΩÂπ∂‰∏çËÉΩËß£ÂÜ≥ÈóÆÈ¢òÔºåÂÆûÈôÖÂΩì‰∏≠ÊàëËøêË°å‰∫Ü‰∏âÊ¨°ÊâçËß£ÂÜ≥‰∫Ü‰æùËµñÁöÑÂÜ≤Á™ÅÁöÑÈóÆÈ¢òÔºåÊØè‰∏ÄÊ¨°ËøêË°åÁöÑÊó∂ÂÄô‰æùÊ¨°ÈÄâÊã© no-&gt;yes-&gt;yes„ÄÇÂÖ∑‰ΩìË¶ÅËøêË°åÂá†Ê¨°ÔºåÂøÖÈ°ªÁúã lib32stdc++6 Â∫ìÊòØÂê¶ÂÆâË£ÖÊàêÂäü„ÄÇ Âú®ÁªèËøá‰∏äËø∞ÁöÑÊìç‰Ωú‰πãÂêéÔºåËôΩÁÑ∂ AVD ÂèØËÉΩËÉΩÊàêÂäüÂàõÂª∫Ôºå‰ΩÜÂÆûÈôÖÂèØËÉΩËøòÊòØÊó†Ê≥ïÂêØÂä®ÔºåÊó†Ê≥ïÂêØÂä®ÁöÑÂéüÂõ†ÂèØËÉΩÊòØÈúÄË¶ÅÂÆâË£Ö Intel's KVMÔºåÂÖ∑‰ΩìÊ≠•È™§ÂèØ‰ª•ÂèÇËÄÉSetting Up Android Studio on UbuntuÂΩì‰∏≠ÁöÑ Install Intel's KVM for Better AVD Performance ÈÉ®ÂàÜÔºåÂú®ËøôÈÉ®ÂàÜÂΩì‰∏≠Âè™ÈúÄÂÅöÂà∞Á¨¨‰∏ÉÊ≠•Âç≥ÂèØÔºåÁî±‰∫éÊàë‰ΩøÁî®ÁöÑ AndroidStudio 2.3ÔºåÊó†Ê≥ïÊâæÂà∞Á¨¨ÂÖ´Ê≠•ÊâÄËØ¥ÁöÑÈÄâÈ°π„ÄÇ Âú®ÂÆâË£ÖÂ•ΩÊâÄÈúÄË¶ÅÁöÑ‰∏ÄÂàáÂ∫ì‰πãÂêéÔºåÊé•‰∏ãÊù•ÁöÑÊ≠•È™§Â¶Ç‰∏ãÔºö 1. ÂàõÂª∫ËôöÊãüÊú∫ÔºåËÆ∞‰∏ãËôöÊãüÊú∫ÂêçÁß∞ 2. ËøõÂÖ•Âà∞ Sdk Ë∑ØÂæÑ‰∏ãÁöÑ tools ÁõÆÂΩïÔºåÊâßË°å‰ª•‰∏ãÊåá‰ª§ &gt; sudo chmod +x emulator &gt; ./emulator -avd ËôöÊãüÊú∫ÂêçÁß∞ -qemu -m 2047 -enable-kvm Âú®ÁªèËøá‰∏äËø∞ÁöÑ‰∏§‰∏™Ê≠•È™§‰πãÂêéÂü∫Êú¨‰∏äÊòØËÉΩÂ§üÊàêÂäüÂêØÂä®‰∫ÜÁöÑ„ÄÇ]]></content>
      <categories>
        <category>AndroidÈóÆÈ¢òËÆ∞ÂΩï</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>Â∑•ÂÖ∑ÈóÆÈ¢ò</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Java Á∫øÁ®ãÁÆÄËø∞]]></title>
    <url>%2F2017%2F08%2F22%2FJava%E5%9F%BA%E7%A1%80%E4%B9%8B%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%AE%80%E8%BF%B0%2F</url>
    <content type="text"><![CDATA[Á∫øÁ®ãÁöÑ‰ΩúÁî® Á∫øÁ®ãÔºàËã±ËØ≠ÔºöThreadÔºâÊòØÊìç‰ΩúÁ≥ªÁªüËÉΩÂ§üËøõË°åËøêÁÆóË∞ÉÂ∫¶ÁöÑÊúÄÂ∞èÂçï‰Ωç„ÄÇÂÆÉË¢´ÂåÖÂê´Âú®ËøõÁ®ã‰πã‰∏≠ÔºåÊòØËøõÁ®ã‰∏≠ÁöÑÂÆûÈôÖËøê‰ΩúÂçï‰Ωç„ÄÇ‰∏ÄÊù°Á∫øÁ®ãÊåáÁöÑÊòØËøõÁ®ã‰∏≠‰∏Ä‰∏™Âçï‰∏ÄÈ°∫Â∫èÁöÑÊéßÂà∂ÊµÅÔºå‰∏Ä‰∏™ËøõÁ®ã‰∏≠ÂèØ‰ª•Âπ∂ÂèëÂ§ö‰∏™Á∫øÁ®ãÔºåÊØèÊù°Á∫øÁ®ãÂπ∂Ë°åÊâßË°å‰∏çÂêåÁöÑ‰ªªÂä°„ÄÇ ÁÆÄËÄåË®Ä‰πãÔºåÁ∫øÁ®ãÁöÑÂ≠òÂú®ÊòØ‰∏∫‰∫ÜÂÆûÁé∞Á®ãÂ∫èÁöÑÂπ∂ÂèëÊìç‰ΩúÔºåÊèêÈ´òÊâßË°åÊïàÁéá„ÄÇ Á∫øÁ®ãÁöÑÁîüÂëΩÂë®Êúü Á∫øÁ®ãÁöÑ‰∏ªË¶ÅÁîüÂëΩÂë®ÊúüÂ¶Ç‰∏äÂõæÊâÄÁ§∫Ôºå‰∏ªË¶ÅÂàÜ‰∏∫‰∫î‰∏™Áä∂ÊÄÅÔºö Êñ∞Âª∫ÊÄÅÔºàNewÔºâÔºöJava ‰∏≠‰ΩøÁî® new ÂÖ≥ÈîÆÂ≠óÂàõÂª∫Á∫øÁ®ã‰πãÂêéÔºåËøôÊó∂Á∫øÁ®ãÂç≥Â§Ñ‰∫éÊñ∞Âª∫ÊÄÅ„ÄÇ Â∞±Áª™ÊÄÅÔºàRunnableÔºâÔºöÂú®Á∫øÁ®ãË∞ÉÁî® start() ÊñπÊ≥ï‰πãÂêéÔºåÁ∫øÁ®ãÂç≥Â§Ñ‰∫éÂ∞±Áª™ÊÄÅ„ÄÇ ËøêË°åÊÄÅÔºàRunningÔºâÔºöÂΩìÂ∞±Áª™ÊÄÅÁöÑÁ∫øÁ®ãËé∑Âæó CPU Âπ∂‰∏îÂºÄÂßãÊâßË°å run() ÊñπÊ≥ï‰πãÂêéÔºåÁ∫øÁ®ãÂ∞±‰ºöÂ§Ñ‰∫éËøêË°åÁä∂ÊÄÅ„ÄÇ ÈòªÂ°ûÊÄÅÔºàBlockedÔºâÔºöÂú®Â§Ñ‰∫éËøêË°åÊÄÅÁöÑÁ∫øÁ®ãË∞ÉÁî®‰∫Ü sleep() Êàñ wait() ÂèàÊàñËÄÖÊòØË∞ÉÁî®‰∫Ü‰∏Ä‰∏™ÈòªÂ°ûÂºèÁöÑ IO ÊñπÊ≥ï‰πãÂêéÔºåÁ∫øÁ®ãÂ∞Ü‰ºöÂ§Ñ‰∫éÈòªÂ°ûÁä∂ÊÄÅ„ÄÇ Ê≠ª‰∫°ÊÄÅÔºàDeadÔºâÔºöÂú®Á∫øÁ®ã‰∏≠ÁöÑ run() ÊñπÊ≥ïÊâßË°åÂÆåÊØï„ÄÅÁ∫øÁ®ãÊäõÂá∫ÂºÇÂ∏∏„ÄÅË∞ÉÁî®Á∫øÁ®ãÁöÑ stop() ËøôÂá†ÁßçÊÉÖÂΩ¢‰∏ãÁ∫øÁ®ãÂ∞Ü‰ºöËøõÂÖ•Ê≠ª‰∫°ÊÄÅ„ÄÇ Á∫øÁ®ãÁöÑÂÆûÁé∞ÊñπÊ≥ï Java ‰∏≠Á∫øÁ®ãÁöÑÂÆûÁé∞‰∏ªË¶ÅÊòØÈÄöËøá Thread Á±ªÂíå Runnable Êé•Âè£„ÄÇ ÈÄöËøá Thread Á±ªÂÆûÁé∞Ôºö 123456Thread thread = new Thread(new Runnable() &#123; @Override public void run() &#123; /** do some things **/ &#125;&#125;); ÈÄöËøá Runnable Êé•Âè£ÂÆûÁé∞Ôºö 12345678public class MyThread implements Runnable &#123; @Override public void run() &#123; /** do some things **/ &#125;&#125;MyThread myThread = new MyThread();Thread thread = new Thread(myThread); Áõ∏ÂØπËÄåË®ÄÁ¨¨‰∫åÁßçÊñπÂºèÊõ¥‰∏∫ÂêàÁêÜ‰∏Ä‰∫õÔºåÁ¨¨‰∫åÁßçÊñπÂºèÂàõÂª∫ÁöÑÁ∫øÁ®ãÁ±ªÂè™ÂÆûÁé∞‰∫Ü Runnable Êé•Âè£ÔºåËøòÂèØ‰ª•ÂÜçÁªßÊâøÂÖ∂ÂÆÉÁöÑÁà∂Á±ª„ÄÇ ÂèÇËÄÉËµÑÊñô „ÄêJavaÂπ∂ÂèëÁºñÁ®ã„Äë‰πãÂÖ≠ÔºöRunnableÂíåThreadÂÆûÁé∞Â§öÁ∫øÁ®ãÁöÑÂå∫Âà´ÔºàÂê´‰ª£Á†ÅÔºâ]]></content>
      <categories>
        <category>JavaÂü∫Á°Ä</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>Thread</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Android Âü∫Á°Ä‰πã LayoutInflater ÊÄªÁªì]]></title>
    <url>%2F2017%2F07%2F22%2FAndroid%E5%9F%BA%E7%A1%80%E4%B9%8BLayoutInflater%E6%80%BB%E7%BB%93%2F</url>
    <content type="text"><![CDATA[LayoutInflater ÁöÑËé∑Âèñ Ëé∑Âèñ LayoutInflater ÁöÑÊñπÂºè‰∏ÄËà¨Êúâ‰∏âÁßçÔºö getLayoutInflater() LayoutInflater.from(Context context) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE) Ëøô‰∏âÁßçËé∑ÂèñÊñπÂºèÊú¨Ë¥®‰∏äÈÉΩÊòØ‰∏ÄÊ†∑ÁöÑ getLayoutInflater() ÈÄöËøá getWindow().getLayoutInflater() ËøõË°åËé∑ÂèñÔºågetWindow() Ëé∑ÂèñÁöÑÊòØ PhoneWindowÔºåÁÑ∂Âêé PhoneWindow ÈÄöËøá mLayoutInflater = LayoutInflater.from(context) Ëé∑Âèñ LayoutInflater„ÄÇ LayoutInflater.from(Context context) ÂÜÖÈÉ®ÈÄöËøá‰ª•‰∏ã‰ª£Á†ÅËé∑Âèñ LayoutInflater„ÄÇ 12345678public static LayoutInflater from(Context context) &#123; LayoutInflater LayoutInflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE); if (LayoutInflater == null) &#123; throw new AssertionError("LayoutInflater not found."); &#125; return LayoutInflater;&#125; ÁªìËÆ∫ÔºöÊâÄ‰ª•Ëøô‰∏âÁßçÊñπÂºèÊúÄÁªàÈÉΩË∞ÉÁî®‰∫Ü Context.getSystemService() LayoutInflater ÁöÑ inflater ÊñπÊ≥ï inflater ‰Ωú‰∏∫ LayoutInflater ‰∏≠ÊúÄÂ∏∏Áî®ÁöÑÊñπÊ≥ïÔºåÁî®‰∫é‰ªé xml ÁöÑÂ∏ÉÂ±ÄÊñá‰ª∂ÂæóÂà∞‰∏Ä‰∏™ View ÂØπË±°ÔºåÂä†ËΩΩÂà∞ Activity Áî®‰∫éÂä®ÊÄÅÂàõÂª∫Â∏ÉÂ±Ä„ÄÇinflater ÊÄªÂÖ±ÈáçËΩΩ‰∫Ü 4 ÁßçË∞ÉÁî®ÊñπÂºèÔºö 1. public View inflate(@LayoutRes int resource, @Nullable ViewGroup root) 2. public View inflate(@LayoutRes int resource, @Nullable ViewGroup root, boolean attachToRoot) 3. public View inflate(XmlPullParser parser, @Nullable ViewGroup root) 4. public View inflate(XmlPullParser parser, @Nullable ViewGroup root, boolean attachToRoot) ÂØπ‰∫éÊûÑÈÄ†ÂáΩÊï∞ÁöÑ‰ΩøÁî®ËÄåË®ÄÔºåÊúâÂ¶Ç‰∏ãÊ≥®ÊÑè‰∫ãÈ°πÔºö root Â°´ÂÖÖÁöÑÊ†πËßÜÂõæ attachToRoot ÂÜ≥ÂÆöÊòØÂê¶Â∞ÜËΩΩÂÖ•ÁöÑËßÜÂõæÈôÑÂä†Âà∞Ê†πËßÜÂõæ‰∏äÔºåÂ¶ÇÊûú‰∏∫ false Âàô‰ªÖÁî®‰∫é‰∏∫ XML ‰∏≠ÁöÑÊ†πËßÜÂõæÂàõÂª∫Ê≠£Á°ÆÁöÑ LayoutParams ÁöÑÂ≠êÁ±ª Ââç‰∏â‰∏™ inflater ÊñπÊ≥ïÊúÄÁªàÈÉΩ‰ºöË∞ÉÁî®Á¨¨Âõõ‰∏™ inflater ÊñπÊ≥ïÔºåÈááÁî®‰∫Ü pull Ëß£Êûê ÈÅøÂÖçÂ∞Ü null ‰Ωú‰∏∫ ViewGroup ‰º†ÂÖ• ÂΩì‰∏çÈúÄË¶ÅÂ∞ÜËøîÂõûÁöÑ View Ê∑ªÂä†ÂÖ• ViewGroup Êó∂Â∫îËØ•ËÆæÁΩÆattachToRoot ‰∏∫ false ÈÅøÂÖçÂú® View Â∑≤ÁªèË¢´Ê∑ªÂä†ÂÖ• ViewGroup Êó∂Â∞Ü attachToRoot ËÆæÁΩÆ‰∏∫ True Ëá™ÂÆö‰πâ View Êó∂ÈùûÂ∏∏ÈÄÇÂêàÂ∞Ü attachToRoot ËÆæÁΩÆ‰∏∫ True LayoutInflater Âü∫Êú¨‰ΩøÁî® Áî±‰∫é LayoutInflater ‰∏ªË¶ÅÁî®‰∫éÂ∏ÉÂ±ÄÂ°´ÂÖÖÔºåÊâÄ‰ª•‰∏ªË¶ÅÊ∂âÂèäÂà∞ÁöÑÊòØ inflater ÊñπÊ≥ïÔºåinflater ËøîÂõû‰∫Ü‰∏Ä‰∏™ ViewÔºåÂÖ∂Ë∞ÉÁî®ÊñπÂºèÊòØÔºö 12LayoutInflater inflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);View view = inflater.inflate(R.layout.first_fragment, container, false); ÂèÇËÄÉËµÑÊñô Ê∑±ÂÖ•ÁêÜËß£ LayoutInflater.inflate() Android LayoutInflater ÂéüÁêÜÂàÜÊûêÔºåÂ∏¶‰Ω†‰∏ÄÊ≠•Ê≠•Ê∑±ÂÖ•‰∫ÜËß£ View (‰∏Ä) LayoutInflater‚Äî‚Äî80%ÁöÑAndroidÁ®ãÂ∫èÂëòÂØπÂÆÉÂπ∂‰∏ç‰∫ÜËß£ÁîöËá≥ÈîôËØØ‰ΩøÁî®]]></content>
      <categories>
        <category>AndroidÂü∫Á°Ä</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>LayoutInflater</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[AsyncTask ÊÄªÁªì]]></title>
    <url>%2F2017%2F07%2F11%2FAndroid%E5%9F%BA%E7%A1%80%E4%B9%8BAsyncTask%E6%80%BB%E7%BB%93%2F</url>
    <content type="text"><![CDATA[AsyncTask ÁöÑ‰ΩúÁî® AsyncTask ÂÖÅËÆ∏ÂØπÁî®Êà∑ÁïåÈù¢ÊâßË°åÂºÇÊ≠•Êìç‰Ωú„ÄÇ ÂÆÉ‰ºöÂÖàÈòªÂ°ûÂ∑•‰ΩúÁ∫øÁ®ã‰∏≠ÁöÑÊìç‰ΩúÔºåÁÑ∂ÂêéÂú® UI Á∫øÁ®ã‰∏≠ÂèëÂ∏ÉÁªìÊûúÔºåËÄåÊó†ÈúÄÊÇ®‰∫≤Ëá™Â§ÑÁêÜÁ∫øÁ®ãÂíå/ÊàñÂ§ÑÁêÜÁ®ãÂ∫è„ÄÇ AsyncTask Âü∫‰∫éÂºÇÊ≠•Ê∂àÊÅØÂ§ÑÁêÜÊú∫Âà∂ËøõË°åÂÆûÁé∞ÔºåÈÄöËøá AsyncTask ËÉΩÂ§üÂæàÁÆÄÂçïÁöÑ‰ªéÂ≠êÁ∫øÁ®ãÂàáÊç¢Ëá≥‰∏ªÁ∫øÁ®ã„ÄÇ AsyncTask ÁöÑÂü∫Êú¨‰ΩøÁî® Áî±‰∫é AsyncTask ÊòØÊäΩË±°Á±ªÔºåÊâÄ‰ª•È¶ñÂÖàÈúÄË¶ÅÂàõÂª∫‰∏Ä‰∏™ÁªßÊâøÂÆÉÁöÑÂ≠êÁ±ª„ÄÇ 1public class MyAsyncTask extends AsyncTask&lt;Void, Integer, Boolean&gt; ÂÖ∂‰∏≠ÂèØ‰ª•‰∏∫ AsyncTask ÊåáÂÆö‰∏â‰∏™Ê≥õÂûãÂèÇÊï∞ ParamsÔºöÊâßË°å Task Êó∂‰º†ÈÄíÁöÑÂèÇÊï∞ÔºåÂú®ÂêéÂè∞‰ªªÂä°‰∏≠‰ΩøÁî®ÔºåËøôÈáåÊåáÂÆö‰∏∫ Void ProgressÔºöÊåáÂÆöËøõÂ∫¶Âçï‰ΩçÔºåËøôÈáåÊåáÂÆö‰∏∫ Integer ResultÔºöÊâßË°åÂÆå‰ªªÂä°ÂêéËøîÂõûÁöÑÁ±ªÂûãÔºåËøôÈáåÊåáÂÆö‰∏∫ Boolean ÈáçÂÜô AsyncTask ÁöÑ‰∏Ä‰∫õÊñπÊ≥ïÔºå‰∏ªË¶ÅÊòØ‰∏ãÈù¢Âõõ‰∏™Ôºö 12345678910111213141516171819202122232425262728293031323334353637383940@Overrideprotected void onPreExecute() &#123; progressDialog.show();&#125;@Overrideprotected Boolean doInBackground(Void... voids) &#123; while (true) &#123; int percent = doDownload(); publishProgress(percent); try &#123; Thread.sleep(1000); &#125; catch (InterruptedException e) &#123; return false; &#125; if (percent &gt;= 100) &#123; break; &#125; &#125; return true;&#125;@Overrideprotected void onProgressUpdate(Integer... values) &#123; progressDialog.setMessage("Downloaded " + values[0] + "%");&#125;@Overrideprotected void onPostExecute(Boolean result) &#123; progressDialog.dismiss(); if (result) &#123; Toast.makeText(MainActivity.getCurrentContext(), "Download Succeeded", Toast.LENGTH_LONG).show(); &#125; else &#123; Toast.makeText(MainActivity.getCurrentContext(), "Download Failed", Toast.LENGTH_LONG).show(); &#125;&#125; onPreExecute()Ôºö‰ªªÂä°ÊâßË°å‰πãÂâçÂú® UI Á∫øÁ®ãÂΩì‰∏≠ËøõË°åË∞ÉÁî®ÔºåÈÄöÂ∏∏Áî®‰∫éËøõË°å‰∏Ä‰∫õÁïåÈù¢ÁöÑÂàùÂßãÂåñÂ∑•‰ΩúÔºåË≠¨Â¶ÇÊòæÁ§∫‰∏Ä‰∏™ËøõÂ∫¶Êù°„ÄÇ doInBackground(Params...)ÔºöÂøÖÈ°ªÂÆûÁé∞ÁöÑÊñπÊ≥ïÔºåÂú® onPreExecute() ÊñπÊ≥ïÊâßË°åÂÆåÊØï‰πãÂêéËøêË°åÂú®Â≠êÁ∫øÁ®ã‰∏äÔºåÈÄöÂ∏∏Áî®‰∫éÊâßË°åËÄóÊó∂‰ªªÂä°ÔºåParams ÂèÇÊï∞Â∞Ü‰ºö‰º†ÈÄíËá≥ËØ•ÊñπÊ≥ï„ÄÇÊâßË°åÂÆå‰ªªÂä°‰πãÂêéÂ∞Ü‰ºöÈÄöËøá return ËØ≠Âè•ËøîÂõûÊâßË°åÁªìÊûúÔºåÂ¶ÇÊûú Result ËÆæÂÆö‰∏∫ Void ÂàôÂèØ‰ª•‰∏çËøõË°åËøîÂõû„ÄÇÂêåÊó∂Âú®ËØ•ÊñπÊ≥ï‰∏≠ÂèØ‰ª•ÈÄöËøá publishProgress(Progress...) ÊñπÊ≥ïÂØπ‰ªªÂä°ÊâßË°åËøõÂ∫¶ËøõË°åÂèçÈ¶à„ÄÇ onProgressUpdate(Progress...)ÔºöpublishProgress(Progress...) Ë¢´Ë∞ÉÁî®‰πãÂêéÊâßË°åÂú® UI Á∫øÁ®ãÂΩì‰∏≠ÔºåÂú®ËØ•ÊñπÊ≥ï‰∏≠ÂèØ‰ª•Â±ïÁ§∫‰ªªÂä°ÊâßË°åÁöÑËøõÂ∫¶ÂèäÂØπËøõÂ∫¶ËøõË°åÊõ¥Êñ∞ÔºåË≠¨Â¶ÇÂèØ‰ª•ÂØπËøõÂ∫¶Êù°ËøõË°åÂä®ÁîªÂ§ÑÁêÜ„ÄÇ onPostExecute(Result)Ôºö‰ªªÂä°ÊâßË°åÂÆå‰πãÂêéÁöÑËøîÂõûÁªìÊûúÂ∞Ü‰ºö‰º†ÈÄíËá≥ËØ•ÊñπÊ≥ïÔºåÂèØ‰ª•Âà©Áî®ËøîÂõûÁöÑÁªìÊûúËøõË°å‰∏Ä‰∫õ UI Êìç‰ΩúÔºåË≠¨Â¶ÇÊèêÈÜí‰ªªÂä°ÊâßË°åÁöÑÁªìÊûúÔºåËØ•ÊñπÊ≥ïËøêË°åÂú® UI Á∫øÁ®ã‰∏≠„ÄÇ AsyncTask Ê∫êÁ†ÅÊµÖËß£ ÊâßË°åËøáÁ®ãÂõæ ÊâßË°åËøáÁ®ã È¶ñÂÖàÈÄöËøáË∞ÉÁî® execute(Params... params) ÊñπÊ≥ïÊâßË°å‰ªªÂä° ÂÜÖÈÉ®ÊâßË°å‰∫Ü executeOnExecutor(sDefaultExecutor, params)ÔºåsDefaultExecutor ÊòØÂÜÖÈÉ®ÂÆö‰πâÁöÑ SerialExecutor Á±ªÁöÑÂØπË±°Ôºå‰∏ªË¶ÅÁöÑÊñπÊ≥ïÊòØ execute(final Runnable r) Áî®‰∫éÂêØÂä®‰∏Ä‰∏™Á∫øÁ®ã„ÄÇ executeOnExecutor(Executor exec, Params... params) ‰Ωú‰∏∫Á¨¨‰∏ÄÊ≠•‰∏≠ÊâßË°åÁöÑÊñπÊ≥ïÔºåÈ¶ñÂÖà‰ºöÂà§Êñ≠‰ªªÂä°ÁöÑËøêË°åÁä∂ÊÄÅÔºåÂ¶ÇÊûúÊòØ PENDING ÂàôË°®ÊòéÊ≤°ÊúâËøêË°åÔºåÁÑ∂Âêé‰æø‰ºöÊâßË°å onPreExecute() ÊñπÊ≥ïÔºå‰πãÂêéÂ∞Ü params ‰º†ÈÄíÁªô mWorker ÂØπË±°ÔºåmWorker ÊòØ‰∏Ä‰∏™ÂÆûÁé∞‰∫Ü Callable Êé•Âè£ÁöÑ WorkerRunnable ÂØπË±°ÔºåÊúÄÂêéË∞ÉÁî® exec.execute(mFuture) ÂéªÂêØÂä®Á∫øÁ®ã„ÄÇÂÖ∂‰∏≠ mWorker Âíå mFuture ÂØπË±°Âú®ÊûÑÈÄ†ÂáΩÊï∞‰∏≠ÂÆåÊàê‰∫ÜÂàùÂßãÂåñËøáÁ®ã„ÄÇmFuture ÊòØ‰∏Ä‰∏™ÂÆûÁé∞‰∫Ü RunnableFuture Êé•Âè£ÁöÑ FutureTask ÂØπË±°ÔºåFutureTask ÁöÑ run() ÊñπÊ≥ïÂ∞Ü‰ºöË∞ÉÁî® Callable Êé•Âè£ÁöÑ call() ÊñπÊ≥ï„ÄÇ‰πüÂç≥ÊòØËØ¥ exec.execute(mFuture) Ë∞ÉÁî®‰∫Ü mFuture ÁöÑ run() ÊñπÊ≥ï‰ªéËÄåË∞ÉÁî®‰∫Ü mWorker ÁöÑ call() ÊñπÊ≥ï„ÄÇ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071//execute ÁöÑÊâßË°åËøáÁ®ãexec.execute(mFuture);private static class SerialExecutor implements Executor &#123; final ArrayDeque&lt;Runnable&gt; mTasks = new ArrayDeque&lt;Runnable&gt;(); Runnable mActive; public synchronized void execute(final Runnable r) &#123; mTasks.offer(new Runnable() &#123; public void run() &#123; try &#123; r.run(); &#125; finally &#123; scheduleNext(); &#125; &#125; &#125;); if (mActive == null) &#123; scheduleNext(); &#125; &#125; protected synchronized void scheduleNext() &#123; if ((mActive = mTasks.poll()) != null) &#123; THREAD_POOL_EXECUTOR.execute(mActive); &#125; &#125;&#125;//mFuture Ë∞ÉÁî® mWorker.call() ÁöÑËøáÁ®ãmFuture = new FutureTask&lt;Result&gt;(mWorker)//Â∞Ü mWorker ‰øùÂ≠òËá≥ mFuture ÁöÑ callablepublic FutureTask(Callable&lt;V&gt; callable) &#123; if (callable == null) throw new NullPointerException(); this.callable = callable; this.state = NEW; // ensure visibility of callable&#125;public void run() &#123; if (state != NEW || !U.compareAndSwapObject(this, RUNNER, null, Thread.currentThread())) return; try &#123; //callable ËµãÂÄºÁªô c Callable&lt;V&gt; c = callable; if (c != null &amp;&amp; state == NEW) &#123; V result; boolean ran; try &#123; //Áõ∏ÂΩì‰∫éË∞ÉÁî® mWorker ÁöÑ call ÊñπÊ≥ï result = c.call(); ran = true; &#125; catch (Throwable ex) &#123; result = null; ran = false; setException(ex); &#125; if (ran) set(result); &#125; &#125; finally &#123; // runner must be non-null until state is settled to // prevent concurrent calls to run() runner = null; // state must be re-read after nulling runner to prevent // leaked interrupts int s = state; if (s &gt;= INTERRUPTING) handlePossibleCancellationInterrupt(s); &#125;&#125; ÊâßË°åÂÆå‰∏äËø∞‰∏§Ê≠•‰πãÂêé mWorker.call() ÂæóÂà∞‰∫ÜË∞ÉÁî®Ôºå‰ªªÂä°ÂºÄÂßãÂêØÂä®„ÄÇ Âú® call() ÊñπÊ≥ï‰∏≠Ë∞ÉÁî®‰∫Ü doInBackground(mParams) Âπ∂Â∞ÜÁªìÊûú‰øùÂ≠òÂú® result ÂèòÈáèÂΩì‰∏≠ÔºåÁÑ∂ÂêéÂú® postResult(result) ‰∏≠ÈÄöËøá getHandler() Ëé∑ÂèñÂà∞ InternalHandler ÂØπË±°ÔºåÈÄöËøá obtainMessage() ÊñπÊ≥ïÂ∞ÜÁªìÊûúÂèëÈÄÅÂá∫ÂéªÔºå‰πãÂêéÂú® handleMessage(Message msg) ‰∏≠Ë∞ÉÁî®‰∫Ü finish() ÊñπÊ≥ï„ÄÇfinish() ÊñπÊ≥ï‰∏≠ÊúÄÁªàË∞ÉÁî®‰∫Ü onPostExecute(result) ÊñπÊ≥ï„ÄÇ Â¶ÇÊûúÂú® doInBackground(mParams) Ë∞ÉÁî®‰∫Ü publishProgress(Progress... values)ÔºåÂàôÂú® publishProgress(Progress... values) ‰∏≠‰πü‰ºöÈÄöËøá getHandler() ÂèëÈÄÅ MessageÔºåÁÑ∂ÂêéÂú® handleMessage(Message msg) ‰∏≠Ë∞ÉÁî® onProgressUpdate(Progress... values) ÊñπÊ≥ï„ÄÇ 12345678910111213141516171819202122232425262728293031323334353637private Result postResult(Result result) &#123; @SuppressWarnings("unchecked") Message message = getHandler().obtainMessage(MESSAGE_POST_RESULT, new AsyncTaskResult&lt;Result&gt;(this, result)); message.sendToTarget(); return result;&#125;@WorkerThreadprotected final void publishProgress(Progress... values) &#123; if (!isCancelled()) &#123; getHandler().obtainMessage(MESSAGE_POST_PROGRESS, new AsyncTaskResult&lt;Progress&gt;(this, values)).sendToTarget(); &#125;&#125;public void handleMessage(Message msg) &#123; AsyncTaskResult&lt;?&gt; result = (AsyncTaskResult&lt;?&gt;) msg.obj; switch (msg.what) &#123; case MESSAGE_POST_RESULT: // There is only one result result.mTask.finish(result.mData[0]); break; case MESSAGE_POST_PROGRESS: result.mTask.onProgressUpdate(result.mData); break; &#125;&#125;private void finish(Result result) &#123; if (isCancelled()) &#123; onCancelled(result); &#125; else &#123; onPostExecute(result); &#125; mStatus = Status.FINISHED;&#125; ‚Äã]]></content>
      <categories>
        <category>AndroidËøõÈò∂</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>Ê∫êÁ†ÅÂàÜÊûê</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Gallery ÁöÑ‰∏âÁßçÂÆûÁé∞ÊñπÂºè]]></title>
    <url>%2F2017%2F05%2F08%2FAndroid%E4%B9%8BGallery%E5%AE%9E%E7%8E%B0%2F</url>
    <content type="text"><![CDATA[Gallery ‰∏ªË¶ÅÂÜÖÂÆπÔºö ÁõÆÊ†áÊïàÊûúÔºö ÈúÄÊ±ÇÂàÜÊûê ‰ªéÁõÆÊ†áÊïàÊûú‰∏äÊù•Áúã‰∏ªË¶ÅËÄÉËôë‰ª•‰∏ãÂá†‰∏™ÁÇπÔºö ÂõæÁâáÂ¶Ç‰ΩïÂàáÊç¢ÂíåÂàáÊç¢Âä®Áîª ImageSwitcher Êèê‰æõ‰∫Ü setImageResource (int resid) ÊñπÊ≥ïÂØπ‰∏ã‰∏Ä‰∏™ ImageView ËøõË°åÂõæÁâáÂä†ËΩΩÂíåÂàáÊç¢ÔºåÂàáÊç¢ÁöÑÂä®ÁîªÊïàÊûúÈúÄË¶ÅËá™ÂÆö‰πâ ViewPager ÁöÑÂàáÊç¢ÂíåÂàáÊç¢Âä®ÁîªÂÜÖÈÉ®Â§ÑÁêÜ HorizontalScrollView ÂèØ‰ª•ÈÄöËøá smoothScrollBy (int dx, int dy) ÊñπÊ≥ïËøõË°åÂπ≥ÊªëÂàáÊç¢ ÂõæÁâáÁöÑÂàáÊç¢ÊñπÂêë ImageSwitcher ÁöÑÂàáÊç¢ÊñπÂêëÈúÄË¶ÅËá™Â∑±Âà§Êñ≠ HorizontalScrollView ÁöÑÂàáÊç¢ÊñπÂêëËôΩÁÑ∂‰∏çÁî®Âà§Êñ≠Ôºå‰ΩÜÊòØÊªëÂä®Ë∑ùÁ¶ªÈúÄË¶ÅËá™Â∑±ÊéßÂà∂ ViewPager ÁöÑÂàáÊç¢ÊñπÂêëÊó†ÈúÄÂ§ÑÁêÜ Á°ÆÂÆöÂàáÊç¢Êó∂Â∫îËØ•Âä†ËΩΩÁöÑÂõæÁâá ImageSwitcher Âíå HorizontalScrollView Âä†ËΩΩÂõæÁâáÈúÄË¶ÅËá™Â∑±Âà§Êñ≠ ViewPager ÁöÑÂä†ËΩΩÂõæÁâáÊó†ÈúÄÂ§ÑÁêÜ ÂõæÁâá‰∏ãÊñπÁöÑÂúÜÁÇπÊïàÊûúÔºå‰∏éÂõæÁâáÊï∞Èáè‰∏ÄËá¥ ÂúÜÁÇπÂíåÂõæÁâáÁöÑÂêåÊ≠•ÂàáÊç¢ ImageSwitcher ÂÆûÁé∞ ImageSwitcher ÁöÑÁâπÁÇπ È¶ñÂÖàÊü•Áúã ImageSwitcher Âíå ViewSwitcher ÁöÑÂÆòÊñπ APIÔºö ViewSwitcher that switches between two ImageViews when a new image is set on it. The views added to an ImageSwitcher must all be ImageViews. ViewAnimator that switches between two views, and has a factory from which these views are created. You can either use the factory to create the views, or add them yourself. A ViewSwitcher can only have two child views, of which only one is shown at a time. ÂÆòÊñπÁªôÂá∫ÁöÑ API ËØ¥Êòé‰∫ÜÔºåImageSwitcher ÈáåÊúÄÂ§öÂè™ËÉΩÁî±‰∏§‰∏™ ImageViewÔºåÂêå‰∏ÄÊó∂Èó¥Âè™ËÉΩÊòæÁ§∫‰∏Ä‰∏™ÔºåÂú®‰∏§‰∏™ ImageView ‰πãÈó¥ËÉΩÂ§üËÆæÁΩÆËßÜÂõæÂàáÊç¢Âä®ÁîªÔºåÂπ∂‰∏îÊèê‰æõ‰∫Ü factory Áî®‰∫éÂàõÂª∫‰∏§‰∏™ ImageViewÔºàÂΩìÁÑ∂‰πüÂèØ‰ª•ÈÄâÊã©Ëá™Ë°åÊ∑ªÂä†Ôºâ„ÄÇ ÂÆûÁé∞ËøáÁ®ã È¶ñÂÖàÊàë‰ª¨ÈúÄË¶ÅÂú®Â∏ÉÂ±ÄÊñá‰ª∂‰∏≠Ê∑ªÂä† ImageSwitcher Êéß‰ª∂Ôºö 1234567891011121314151617181920212223242526&lt;?xml version="1.0" encoding="utf-8"?&gt;&lt;FrameLayout xmlns:android="http://schemas.android.com/apk/res/android" xmlns:app="http://schemas.android.com/apk/res-auto" xmlns:tools="http://schemas.android.com/tools" android:layout_width="match_parent" android:layout_height="match_parent" tools:context="com.rookieyang.gallerytest.ImageSwitcherTest"&gt; &lt;ImageSwitcher android:id="@+id/imageSwitcher" android:layout_width="match_parent" android:layout_height="match_parent" /&gt; &lt;RelativeLayout android:layout_width="match_parent" android:layout_height="match_parent" android:layout_marginBottom="30dp"&gt; &lt;LinearLayout android:id="@+id/tipsLayout" android:layout_width="match_parent" android:layout_height="wrap_content" android:layout_alignParentBottom="true" android:gravity="center_horizontal" android:orientation="horizontal"/&gt; &lt;/RelativeLayout&gt;&lt;/FrameLayout&gt; ÈááÁî® FrameLayout Â∞ÜÂúÜÁÇπÈÉ®ÂàÜÁΩÆ‰∫éÂõæÁâáÁöÑ‰∏äÊñπÔºåRelativeLayout Áî®‰∫éÊéßÂà∂ÂéüÁÇπÈÉ®ÂàÜÂú®Â∫ïÈÉ®ÔºåLinearLayout ‰∏≠ÁöÑÂ±ûÊÄßËÆæÁΩÆÁî®‰∫éÂ∞ÜÂúÜÁÇπÊ∞¥Âπ≥Â±Ö‰∏≠ÊîæÁΩÆ„ÄÇ Âú®Ê∑ªÂä†ÂÆå ImageSwiter ‰πãÂêéÔºåÈÄöËøá setFactory(ViewFactory factory) ÂáΩÊï∞‰∏∫ ImageSwiter Ê∑ªÂä† ImageViewÔºö 1234567891011mImageSwitcher.setFactory(new ViewFactory() &#123; @Override public View makeView() &#123; ImageView imageView = new ImageView(ImageSwitcherTest.this); ImageSwitcher.LayoutParams layoutParams = new ImageSwitcher.LayoutParams( ViewGroup.LayoutParams.MATCH_PARENT, ViewGroup.LayoutParams.MATCH_PARENT); imageView.setScaleType(ScaleType.CENTER_CROP); imageView.setLayoutParams(layoutParams); return imageView; &#125;&#125;); ËøôÈáå‰∏∫ ImageSwitcher ËÆæÁΩÆ‰∫Ü‰∏Ä‰∏™ factoryÔºåÂú® setFactory(ViewFactory factory) ÂÜÖÈÉ®‰ºöÊâßË°å‰∏§Ê¨° obtainView() ÂÆåÊàê View ÁöÑÂ¢ûÂä†„ÄÇ ‰∏äËø∞ËøáÁ®ãÂè™ÊòØÂÆåÊàê‰∫Ü ImageView ÁöÑÊ∑ªÂä†ÔºåÂÆûÈôÖÁöÑÂõæÁâáËøòÊ≤°ÊúâË¢´Âä†ËΩΩÔºåÁî±‰∫é ImageSwitcher ÁöÑÈôêÂà∂ÔºåÊâÄ‰ª•Êàë‰ª¨‰∏çËÉΩÁõ¥Êé•Â∞Ü ImageView ‰∏ÄÊ¨°ÊÄßÊ∑ªÂä†ËøõÂéªÔºàËøôÊ†∑ÊÄßËÉΩ‰πü‰∏çÈ´òÔºâÔºåÂèØ‰ª•ÈÄâÊã©Áî®‰∏Ä‰∏™Êï∞ÁªÑÂØπÂõæÁâáËµÑÊ∫êËøõË°å‰øùÂ≠òÔºåÂú®Ë∞ÉÁî® setImageResource() Êó∂ËøõË°åÂä†ËΩΩÔºö 12private int[] mImageId = new int[]&#123;R.drawable.pic1, R.drawable.pic2, R.drawable.pic3&#125;;mImageSwitcher.setImageResource(mImageId[0]); Âú®Ëß£ÂÜ≥‰∫ÜÂ¶Ç‰ΩïÂä†ËΩΩÂõæÁâá‰πãÂêéÔºåËøòÈúÄË¶Å‰∏∫ÂõæÁâá‰∏ãÊñπÊ∑ªÂä†ÂúÜÁÇπÊïàÊûúÔºåÂúÜÁÇπÁöÑ‰∏™Êï∞Áî±ÂõæÁâáÁöÑ‰∏™Êï∞ÂÜ≥ÂÆöÔºå‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 12345678910111213141516171819202122232425private ImageView[] mTips;mTips = new ImageView[mImageId.length];LinearLayout tipsLinearLayout = (LinearLayout) findViewById(R.id.tipsLayout);for (int i = 0; i &lt; mImageId.length; i++) &#123; mTips[i] = new ImageView(this); LinearLayout.LayoutParams layoutParams = new LayoutParams( new ViewGroup.LayoutParams(ViewGroup.LayoutParams.WRAP_CONTENT, ViewGroup.LayoutParams.WRAP_CONTENT)); layoutParams.leftMargin = 5; layoutParams.rightMargin = 5; tipsLinearLayout.addView(mTips[i], layoutParams);&#125;setTipsImage(0);private void setTipsImage(int position) &#123; for (int i = 0; i &lt; mImageId.length; i++) &#123; if (i == position) &#123; mTips[i].setImageResource(R.drawable.page_indicator_focused); &#125; else &#123; mTips[i].setImageResource(R.drawable.page_indicator_unfocused); &#125; &#125;&#125; Âú®ÂÆåÊàê‰∏äËø∞Ê≠•È™§‰πãÂêéÊàë‰ª¨ËøòÈúÄË¶ÅÂÆåÊàêÁöÑÊòØËÆ©ÂõæÁâáÂíåÂúÜÁÇπÂêåÊó∂ËøõË°åÂàáÊç¢„ÄÅÁ°ÆÂÆöÂàáÊç¢ÊñπÂêëÂíåÂ∫îËØ•Âä†ËΩΩÁöÑÂõæÁâá‰ª•ÂèäÂàáÊç¢ÁöÑÂä®ÁîªÔºåÂØπ‰∫éÂõæÁâáÁöÑÂàáÊç¢ÊñπÂêëÂèØ‰ª•‰æùÊçÆÁ¨¨‰∏ÄÊ¨°Êåâ‰ΩèÂ±èÂπïÂíåÁ¶ªÂºÄÂ±èÂπïËøô‰∏§ÁÇπÁöÑ‰ΩçÁΩÆËøõË°åÂà§Êñ≠ÔºåËÄåÂàáÊç¢Êó∂Âä†ËΩΩÁöÑÂõæÁâáÂàôÂèØ‰ª•Áî®‰∏Ä‰∏™ÂèòÈáèÂØπÂΩìÂâçÂõæÁâáÂ∫èÂè∑ËøõË°å‰øùÂ≠òÔºåÂä®ÁîªÊïàÊûúÂàôÂèØ‰ª•ÂÆö‰πâÂõõ‰∏™Âä®ÁîªÔºàÂ∑¶ËøõÔºåÂ∑¶Âá∫ÔºåÂè≥Ëøõ„ÄÅÂè≥Âá∫ÔºâÊñá‰ª∂Ôºö 1234567891011121314151617181920212223242526272829303132&lt;!--left_in--&gt;&lt;?xml version="1.0" encoding="utf-8"?&gt;&lt;set xmlns:android="http://schemas.android.com/apk/res/android"&gt; &lt;translate android:fromXDelta="-100%p" android:toXDelta="0" android:duration="500"/&gt;&lt;/set&gt;&lt;!--left_out--&gt;&lt;?xml version="1.0" encoding="utf-8"?&gt;&lt;set xmlns:android="http://schemas.android.com/apk/res/android"&gt; &lt;translate android:fromXDelta="0" android:toXDelta="-100%p" android:duration="500"/&gt;&lt;/set&gt;&lt;!--right_in--&gt;&lt;?xml version="1.0" encoding="utf-8"?&gt;&lt;set xmlns:android="http://schemas.android.com/apk/res/android"&gt; &lt;translate android:fromXDelta="100%p" android:toXDelta="0" android:duration="500"/&gt;&lt;/set&gt;&lt;!--right_out--&gt;&lt;?xml version="1.0" encoding="utf-8"?&gt;&lt;set xmlns:android="http://schemas.android.com/apk/res/android"&gt; &lt;translate android:fromXDelta="0" android:toXDelta="100%p" android:duration="500"/&gt;&lt;/set&gt; 123456789101112131415161718192021222324252627282930313233343536373839private int mDownX;private int mCurrentPosition = 0;mImageSwitcher.setOnTouchListener(new OnTouchListener() &#123; @Override public boolean onTouch(View v, MotionEvent event) &#123; switch (event.getAction()) &#123; case MotionEvent.ACTION_DOWN: mDownX = (int) event.getX(); break; case MotionEvent.ACTION_UP: int upX = (int) event.getX(); if (upX &gt; mDownX) &#123; if (mCurrentPosition &gt; 0) &#123; mImageSwitcher.setInAnimation(ImageSwitcherTest.this, R.anim.left_in); mImageSwitcher.setOutAnimation(ImageSwitcherTest.this, R.anim.right_out); mCurrentPosition--; mImageSwitcher.setImageResource(mImageId[mCurrentPosition]); setTipsImage(mCurrentPosition); &#125; &#125; else if (upX &lt; mDownX) &#123; if (mCurrentPosition &lt; mImageId.length - 1) &#123; mImageSwitcher.setInAnimation(ImageSwitcherTest.this, R.anim.right_in); mImageSwitcher.setOutAnimation(ImageSwitcherTest.this, R.anim.left_out); mCurrentPosition++; mImageSwitcher.setImageResource(mImageId[mCurrentPosition]); setTipsImage(mCurrentPosition); &#125; &#125; break; &#125; return true; &#125;&#125;);‚Äã ViewPager ÂÆûÁé∞ ViewPager ÁöÑÁâπÁÇπ ViewPager is most often used in conjunction with Fragment, which is a convenient way to supply and manage the lifecycle of each page. There are standard adapters implemented for using fragments with the ViewPager, which cover the most common use cases. These are FragmentPagerAdapter and FragmentStatePagerAdapter; each of these classes have simple code showing how to build a full user interface with them. ViewPager ‰∏ÄËà¨ÁªìÂêà Fragment ‰ΩøÁî®ÔºåÊØè‰∏™È°µÈù¢Â∞±ÊòØ‰∏Ä‰∏™ FragmentÔºåÁ≥ªÁªüÊèê‰æõ‰∫Ü FragmentPagerAdapter Âíå FragmentStatePagerAdapter Áî®‰∫éÂ°´ÂÖÖ ViewPager„ÄÇ ÂÆûÁé∞ËøáÁ®ã È¶ñÂÖàÂêëÂ∏ÉÂ±ÄÊñá‰ª∂‰∏≠Ê∑ªÂä† ViewPager Êéß‰ª∂Ôºö 1234567891011121314151617181920212223242526&lt;?xml version="1.0" encoding="utf-8"?&gt;&lt;FrameLayout xmlns:android="http://schemas.android.com/apk/res/android" xmlns:tools="http://schemas.android.com/tools" android:layout_width="match_parent" android:layout_height="match_parent" tools:context="com.rookieyang.gallerytest.ViewPagerTest"&gt; &lt;android.support.v4.view.ViewPager android:id="@+id/viewPager" android:layout_width="match_parent" android:layout_height="match_parent" /&gt; &lt;RelativeLayout android:layout_width="match_parent" android:layout_height="match_parent" android:layout_marginBottom="30dp"&gt; &lt;LinearLayout android:id="@+id/tipsFragmentLayout" android:layout_width="match_parent" android:layout_height="wrap_content" android:layout_alignParentBottom="true" android:gravity="center_horizontal" android:orientation="horizontal"/&gt; &lt;/RelativeLayout&gt;&lt;/FrameLayout&gt; Â∏ÉÂ±ÄÂü∫Êú¨‰∏é ImageSwitcher ‰∏ÄËá¥ÔºåÂè™ÊòØÂ∞Ü ImageSwitcher Êéß‰ª∂ÊõøÊç¢‰∏∫ ViewPager„ÄÇ Êé•‰∏ãÊù•ÈúÄË¶ÅÂ∞ÜÂõæÁâáÂä†ËΩΩÂà∞ ViewPager ‰∏≠ÂéªÔºåÂèØ‰ª•Âà©Áî® FragmentPagerAdapter ËææÂà∞Ëøô‰∏ÄÁõÆÁöÑÔºåÁî±‰∫é FragmentPagerAdapter ËøîÂõûÁöÑÊòØ FragmentÔºåÊâÄ‰ª•ÂàõÂª∫‰∫Ü ImageFragment Á±ªÔºåÁî®‰∫éÂ∞Ü Image ÊîæÁΩÆÂà∞ Fragment‰∏≠Ôºå‰ª£Á†ÅÂ∏ÉÂ±ÄÂ¶Ç‰∏ãÔºö 12345678910111213141516171819202122232425public class ImageFragment extends Fragment &#123;private View view;private int imageViewRes;@Overridepublic View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) &#123; // Inflate the layout for this fragment view = inflater.inflate(R.layout.fragment_image, container, false); return view;&#125;@Overridepublic void onActivityCreated(@Nullable Bundle savedInstanceState) &#123; super.onActivityCreated(savedInstanceState); ImageView imageView = (ImageView) view.findViewById(R.id.viewPageImage); imageView.setScaleType(ScaleType.CENTER_CROP); imageView.setImageResource(imageViewRes);&#125;public void setImageView(int imageViewRes) &#123; this.imageViewRes = imageViewRes;&#125;&#125; 12345678910&lt;FrameLayout xmlns:android="http://schemas.android.com/apk/res/android" xmlns:tools="http://schemas.android.com/tools" android:layout_width="match_parent" android:layout_height="match_parent" tools:context="com.rookieyang.gallerytest.ImageFragment"&gt; &lt;ImageView android:id="@+id/viewPageImage" android:layout_width="match_parent" android:layout_height="match_parent" /&gt;&lt;/FrameLayout&gt; Êé•‰∏ãÊù•ÂÆûÁé∞ÁªßÊâøËá™ FragmentPagerAdapter ÁöÑ ImagePagerAdapter Á±ªÔºå‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 1234567891011121314151617181920public class ImagePagerAdapter extends FragmentPagerAdapter &#123; private List&lt;ImageFragment&gt; mFragments; public ImagePagerAdapter(FragmentManager fm, List&lt;ImageFragment&gt; fragments) &#123; super(fm); mFragments = fragments; &#125; @Override public ImageFragment getItem(int position) &#123; Log.i("getItem", "getItem: " + mFragments.get(position).getId()); return mFragments.get(position); &#125; @Override public int getCount() &#123; return mFragments.size(); &#125;&#125; Âú®ÂÆåÊàê‰∏äËø∞ÁöÑÊ≠•È™§‰πãÂêéÔºåÂà©Áî®‰øùÂ≠òÂõæÁâáËµÑÊ∫êÁöÑÊï∞ÁªÑÂàõÂª∫ÂØπÂ∫î‰∏™Êï∞ÁöÑ ImageFragment Âπ∂‰øùÂ≠òÂà∞ List ‰∏≠ÔºåÁÑ∂ÂêéÂàõÂª∫‰∏Ä‰∏™ ImagePagerAdapter ÂØπË±°ÔºåÊõø ViewPager ËÆæÁΩÆÈÄÇÈÖçÂô®Âç≥ÂèØÂÆûÁé∞ÂõæÁâáÁöÑÂä†ËΩΩÂíåÊªëÂä®„ÄÇÁî±‰∫é ViewPager ÂÜÖÈÉ®Â§ÑÁêÜ‰∫ÜÊªëÂä®ÊñπÂêëÂíå‰∏ã‰∏ÄÂº†ÂõæÁâáÂä†ËΩΩÂà§Êñ≠ÁöÑÈóÆÈ¢òÔºåÊâÄ‰ª•Âè™Ââ©‰∏ãÂõæÁâá‰∏éÂúÜÁÇπÁöÑÂêåÊ≠•ÂàáÊç¢ÈúÄË¶ÅËøõË°åÂ§ÑÁêÜÔºå‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748mImageIds = new int[]&#123;R.drawable.pic1, R.drawable.pic2, R.drawable.pic3&#125;;mTips = new ImageView[mImageIds.length];mViewPager = (ViewPager) findViewById(R.id.viewPager);ViewGroup viewGroup = (ViewGroup) findViewById(R.id.tipsFragmentLayout);LinearLayout.LayoutParams layoutParams = new LinearLayout.LayoutParams( new ViewGroup.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));layoutParams.rightMargin = 5;layoutParams.leftMargin = 5;for (int i = 0; i &lt; mImageIds.length; i++) &#123; ImageFragment imageFragment = new ImageFragment(); imageFragment.setImageView(mImageIds[i]); mImageFragments.add(imageFragment); if (mImageIds.length &gt; 1) &#123; mTips[i] = new ImageView(this); mTips[i].setImageResource(R.drawable.page_indicator_unfocused); viewGroup.addView(mTips[i], layoutParams); mTips[mCurrentPosition].setImageResource(R.drawable.page_indicator_focused); &#125;&#125;ImagePagerAdapter imagePagerAdapter = new ImagePagerAdapter( getSupportFragmentManager(), mImageFragments);mViewPager.setAdapter(imagePagerAdapter);mViewPager.addOnPageChangeListener(new OnPageChangeListener() &#123; @Override public void onPageScrolled(int position, float positionOffset, int positionOffsetPixels) &#123; &#125; @Override public void onPageSelected(int position) &#123; if (mImageIds.length &gt; 1) &#123; for (int i = 0; i &lt; mImageIds.length; i++) &#123; if (i == position) &#123; mTips[i].setImageResource(R.drawable.page_indicator_focused); &#125; else &#123; mTips[i].setImageResource(R.drawable.page_indicator_unfocused); &#125; &#125; &#125; &#125; @Override public void onPageScrollStateChanged(int state) &#123; &#125;&#125;); HorizontalScrollView ÂÆûÁé∞ HorizontalScrollView ÁâπÁÇπ A HorizontalScrollView is a FrameLayout, meaning you should place one child in it containing the entire contents to scroll; this child may itself be a layout manager with a complex hierarchy of objects. A child that is often used is a LinearLayout in a horizontal orientation, presenting a horizontal array of top-level items that the user can scroll through. ‰ªéËøôÈáåÂèØ‰ª•‰∫ÜËß£Âà∞Â¶ÇÊûúË¶ÅÂÆûÁé∞‰∏äÈù¢ÁöÑÊïàÊûúÔºåÈÇ£‰πàÂ∫îËØ•Âú® HorizontalScrollView ÊîæÁΩÆ‰∏Ä‰∏™ LinearLayoutÔºåÁÑ∂Âêé LinearLayout ÂÜÖÂä†ËΩΩÁöÑÊòØË¶ÅÊòæÁ§∫ÁöÑÂõæÁâáÔºåÁî±‰∫éÊòØÊ∞¥Âπ≥ÊªëÂä®ÔºåÊâÄ‰ª• LinearLayout ÁöÑÊñπÂêë‰πüË¶ÅÊòØÊ∞¥Âπ≥ÁöÑ„ÄÇ ÂÆûÁé∞ËøáÁ®ã ‰æùÊóßÊòØÊ∑ªÂä†‰∫Ü HorizontalScrollView Êéß‰ª∂ÔºåÊääÊîæÁΩÆ ImageSwwitcher ÁöÑÈÉ®ÂàÜÊõøÊç¢‰∏∫Ôºö 1234567891011&lt;HorizontalScrollView android:id="@+id/horizontalScrollView" android:layout_width="match_parent" android:layout_height="match_parent" android:scrollbars="none"&gt; &lt;LinearLayout android:id="@+id/imageLayout" android:layout_width="wrap_content" android:layout_height="match_parent" android:orientation="horizontal" /&gt; &lt;/HorizontalScrollView&gt; ‰∏∫‰∫ÜÊïàÊûú‰∏ÄËá¥ÂéªÊéâ‰∫ÜÊªöÂä®Êù°„ÄÇ Ê∑ªÂä†ÂÆåÊéß‰ª∂‰πãÂêéÔºåÂ∞±ÈúÄË¶ÅÂ°´ÂÖÖ HorizontalScrollView Ôºå‰∏∫‰∫ÜÊâ©Â±ïÊÄßÔºåÊâÄ‰ª•ÂàõÂª∫‰∫Ü‰∏Ä‰∏™ HorizontalViewAdapter Á±ªÔºå‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 1234567891011121314151617181920212223242526272829303132333435public class HorizontalViewAdapter&#123; private int[] mImageResIdList; private Context mContext; public HorizontalViewAdapter(Context context, int[] imageResIdList) &#123; mContext = context; mImageResIdList = imageResIdList; &#125; public int getCount() &#123; return mImageResIdList.length; &#125; public ImageView getItem(int position) &#123; ImageView imageView = new ImageView(mContext); WindowManager wm = (WindowManager) mContext. getSystemService(Context.WINDOW_SERVICE); DisplayMetrics displayMetrics = new DisplayMetrics(); wm.getDefaultDisplay().getMetrics(displayMetrics); int width = displayMetrics.widthPixels; int height = displayMetrics.heightPixels; Log.i("Adpter: ", String.valueOf(width)); LinearLayout.LayoutParams layoutParams = new LayoutParams( new ViewGroup.LayoutParams(LayoutParams.MATCH_PARENT,LayoutParams.MATCH_PARENT)); layoutParams.width = width; layoutParams.height = height; imageView.setLayoutParams(layoutParams); imageView.setScaleType(ScaleType.CENTER_CROP); imageView.setImageResource(mImageResIdList[position]); return imageView; &#125;&#125; ËøôÈáåÂõæÁâáÁöÑÈïøÂíåÂÆΩ‰ºöÊ†πÊçÆËÆæÂ§áÁöÑÂàÜËæ®ÁéáËøõË°åÊåáÂÆöÔºå‰πãÊâÄ‰ª•‰∏çÁî® match_parent ÁöÑÂéüÂõ†ÊòØËøôÊ†∑‰ºöÂØºËá¥ÊòæÁ§∫ÊïàÊûúÂá∫ÈóÆÈ¢ò„ÄÇ Âú®ÂàõÂª∫ÂÆåÈÄÇÈÖçÂô®‰πãÂêéÔºåÁî±‰∫é HorizontalScrollView Ê≤°ÊúâËÆæÁΩÆÈÄÇÈÖçÂô®ÁöÑÊñπÊ≥ïÔºåÊâÄ‰ª•ÈúÄË¶ÅÂÆûÁé∞ setAdapter() ÊñπÊ≥ïÔºå‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 123456789101112131415161718public void setAdapter(HorizontalViewAdapter horizontalViewAdapter) &#123; mTips = new ImageView[mImageId.length]; LinearLayout imageLayout = (LinearLayout) findViewById(R.id.imageLayout); LinearLayout tipsLinearLayout = (LinearLayout) findViewById(R.id.horizontalTipsLayout); int size = horizontalViewAdapter.getCount(); for (int i = 0; i &lt; size; i++) &#123; ImageView imageView = horizontalViewAdapter.getItem(i); imageLayout.addView(imageView); mTips[i] = new ImageView(this); LinearLayout.LayoutParams layoutParams = new LayoutParams( new ViewGroup.LayoutParams(ViewGroup.LayoutParams.WRAP_CONTENT, ViewGroup.LayoutParams.WRAP_CONTENT)); layoutParams.leftMargin = 5; layoutParams.rightMargin = 5; tipsLinearLayout.addView(mTips[i], layoutParams); &#125;&#125; ÂÆûÁé∞ setAdapter() ÊñπÊ≥ï‰πãÂêéÔºåÂ∞±ÂèØ‰ª•Âú® onCreate() ÊñπÊ≥ï‰∏≠Ë∞ÉÁî®‰∫ÜÔºåË∞ÉÁî®‰πãÂêéÂõæÁâá‰ºöË¢´Âä†ËΩΩÂà∞Â∏ÉÂ±Ä‰∏≠ÔºåËøôÊó∂ÂÄô‰πüÂèØ‰ª•ÊªëÂä®Ôºå‰ΩÜÊòØÁî±‰∫éÊªëÂä®Ë∑ùÁ¶ªÊ≤°ÊúâÊéßÂà∂ÔºåÊâÄ‰ª•Âπ∂Ê≤°ÊúâËææÂà∞ÊÉ≥Ë¶ÅÁöÑÊïàÊûúÔºåÁî±‰∫éÂõæÁâáÁöÑÈïøÂ∫¶ÂèñÂÜ≥‰∫éËÆæÂ§áÁöÑÂàÜËæ®ÁéáÔºåÊâÄ‰ª•ÂèØ‰ª•Ëé∑ÂèñËÆæÂ§áÁöÑÈïøÂ∫¶‰Ωú‰∏∫ÊªëÂä®Ë∑ùÁ¶ªÔºå‰∏∫ HorizontalScrollView ËÆæÁΩÆÁõëÂê¨‰∫ã‰ª∂ÔºåÂΩìËß¶Êë∏Â±èÂπï‰πãÂêéËøõË°åÂà§Êñ≠ÔºåÁ°ÆÂÆöÂÆûÈôÖÊªëÂä®ÁöÑÊñπÂêëÔºåÂÖ∑‰Ωì‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 12345678910111213141516171819202122232425262728293031323334353637//Ëé∑ÂèñÂõæÁâáÊªëÂä®Ë∑ùÁ¶ªWindowManager wm = (WindowManager) getApplicationContext(). getSystemService(Context.WINDOW_SERVICE);DisplayMetrics displayMetrics = new DisplayMetrics();wm.getDefaultDisplay().getMetrics(displayMetrics);mScrollX = displayMetrics.widthPixels;//Á°ÆÂÆöÁöÑÊªëÂä®ÊñπÂêëfinal HorizontalScrollView horizontalScrollView = (HorizontalScrollView) findViewById( R.id.horizontalScrollView);horizontalScrollView.setOnTouchListener(new OnTouchListener() &#123; @Override public boolean onTouch(View v, MotionEvent event) &#123; switch (event.getAction()) &#123; case MotionEvent.ACTION_DOWN: mDownX = (int) event.getX(); break; case MotionEvent.ACTION_UP: int upX = (int) event.getX(); if (upX &gt; mDownX) &#123; if (mCurrentPosition &gt; 0) &#123; mCurrentPosition--; horizontalScrollView.smoothScrollBy(-mScrollX, 0); setTipsImage(mCurrentPosition); &#125; &#125; else if (upX &lt; mDownX) &#123; if (mCurrentPosition &lt; mImageId.length - 1) &#123; mCurrentPosition++; Log.i("onTouch: ", "onTouch: " + mCurrentPosition); horizontalScrollView.smoothScrollBy(mScrollX, 0); setTipsImage(mCurrentPosition); &#125; &#125; break; &#125; return true; &#125;&#125;); ÊÄªÁªì HorizontalScrollView ÁöÑÂÆûÁé∞ÂÆûÈôÖ‰∏äÂπ∂‰∏çÂÆåÂñÑÔºåÂõ†‰∏∫ ImageView ÊòØ‰∏ÄÊ¨°ÊÄßÂÖ®ÈÉ®Ê∑ªÂä†ËøõÂéªÁöÑÔºåÂπ∂Ê≤°ÊúâÂÅö‰ºòÂåñÂ§ÑÁêÜÔºåÂú®ËôöÊãüÊú∫‰∏äËøêË°åÊó∂ÔºåÁî±‰∫éË∂ÖËøá‰∫ÜÂ†ÜÂÜÖÂ≠ò‰ºöÂØºËá¥Êä•Èîô„ÄÇ]]></content>
      <categories>
        <category>AndroidÂü∫Á°Ä</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>Ëá™ÂÆö‰πâÊéß‰ª∂</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[onOptionsItemSelected() ËøîÂõûÂÄºÁöÑÁêÜËß£]]></title>
    <url>%2F2017%2F05%2F03%2FAndroid%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95onOptionsItemSelected%E8%BF%94%E5%9B%9E%E5%80%BC%E7%9A%84%E7%90%86%E8%A7%A3%2F</url>
    <content type="text"><![CDATA[È¶ñÂÖàÊü•ÁúãÂÆòÊñπ API ÁöÑËß£ÈáäÔºö This hook is called whenever an item in your options menu is selected. The default implementation simply returns false to have the normal processing happen (calling the item's Runnable or sending a message to its Handler as appropriate). You can use this method for any items for which you would like to do processing without those other facilities. ‰πüÂ∞±ÊòØËØ¥ÂΩìÁÇπÂáª OptionsMenu ‰∏≠ÁöÑ Item Êó∂ÔºåÈªòËÆ§‰ºöËøîÂõû falseÔºåËøô‰∏™Êó∂ÂÄôÂ∞Ü‰ºöÂ§ÑÁêÜ item ÂÖ≥ËÅîÁöÑ Runnable ÊàñÂèëÈÄÅ‰∏ÄÊù° message ÁªôÂÆÉÁöÑ Handler„ÄÇ ‰∏∫‰∫ÜÂºÑÊ∏ÖÊ•öËøîÂõû false Êó∂ÂèØËÉΩ‰ºöÂèëÁîü‰ªÄ‰πàÂÅö‰∫ÜÂ¶Ç‰∏ãÊµãËØïÔºö ÊµãËØï‰∏Ä 123456789101112131415161718@Overridepublic boolean onOptionsItemSelected(MenuItem item) &#123; switch (item.getItemId()) &#123; case R.id.add_item: Toast.makeText(MainActivity.this, "Add", Toast.LENGTH_LONG).show(); break; case R.id.remove_item: Toast.makeText(MainActivity.this, "Remove", Toast.LENGTH_LONG).show(); item.setActionView(R.layout.progress); Intent intent = new Intent(MainActivity.this, SecondActivity.class); item.setIntent(intent); Log.i(TAG, "onOptionsItemSelected: Remove"); break; default: Toast.makeText(MainActivity.this, "re", Toast.LENGTH_LONG).show(); &#125; return true;&#125; ‰∏äËø∞‰ª£Á†Å‰∏≠Áªô item ÂÖ≥ËÅî‰∫Ü‰∏Ä‰∏™ Intent Áî®‰∫éË∑≥ËΩ¨Âà∞ SecondActivityÔºåÂ¶ÇÊûúËøîÂõû‰∏∫ true ÂàôÁÇπÂáª item Êó∂‰∏ç‰ºöË∑≥ËΩ¨Âà∞ SecondActivityÔºåÂ¶ÇÊûúËøîÂõû false Âàô‰ºöË∑≥ËΩ¨Âà∞ SecondActivity„ÄÇ ÊµãËØï‰∫å ÂàõÂª∫‰∏Ä‰∏™ Fragment 12345678910111213141516171819202122232425262728public class MyFragment extends Fragment &#123; @Override public void onCreateOptionsMenu(Menu menu, MenuInflater inflater) &#123; inflater.inflate(R.menu.main, menu); super.onCreateOptionsMenu(menu, inflater); &#125; @Override public boolean onOptionsItemSelected(MenuItem item) &#123; switch (item.getItemId()) &#123; case R.id.remove_item: Toast.makeText(getContext(), "Fragment Remove", Toast.LENGTH_LONG).show(); break; default: Toast.makeText(getContext(), "Fragment", Toast.LENGTH_LONG).show(); &#125; return false; &#125; @Nullable @Override public View onCreateView(LayoutInflater inflater, @Nullable ViewGroup container, Bundle savedInstanceState) &#123; setHasOptionsMenu(true); return inflater.inflate(fragment_layout, container, false); &#125;&#125; ‰∏äËø∞ÂàõÂª∫‰∫Ü‰∏Ä‰∏™Ëá™ÂÆö‰πâÁöÑ Fragment Á±ªÔºåÂπ∂Ê∑ªÂä†‰∫Ü OptionMenu ÁöÑÁÇπÂáª‰∫ã‰ª∂„ÄÇ Âú®‰πãÂâçÁöÑ Activity ÁöÑÂ∏ÉÂ±ÄÊñá‰ª∂‰∏≠Ê∑ªÂä† Fragment 1234567891011121314&lt;LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" xmlns:tools="http://schemas.android.com/tools" android:layout_width="match_parent" android:layout_height="match_parent" android:orientation="vertical"&gt; &lt;fragment android:id="@+id/fragment" android:layout_width="match_parent" android:layout_height="match_parent" android:name="com.rookieyang.demo.MyFragment" tools:layout="@layout/fragment_layout" /&gt;&lt;/LinearLayout&gt; Âú®ÂÆåÊàê‰∏äËø∞Ê≠•È™§‰πãÂêéÁÇπÂáª remove ÁöÑ itemÔºåÁî±‰∫é Activity ‰∏≠ÁöÑ onOptionsItemSelected() ËøîÂõû‰∫ÜfalseÔºåÂØºËá¥‰∫ã‰ª∂Ê≤°ÊúâË¢´Ê∂àË¥πÂ∞±‰ºöÂêë‰∏ã‰º†ÈÄíÁªô FragmentÔºåËøõËÄåÊâßË°å Fragment ‰∏≠ÁöÑ item ÁöÑÁÇπÂáª‰∫ã‰ª∂ÔºåÊâÄ‰ª•ËÉΩÂ§üÁúãÂà∞Â±èÂπï‰∏äÂ∞Ü‰ºöÊòæÁ§∫ Fragment Remove ËÄå‰∏çÊòØ Remove„ÄÇ Ë°•ÔºöOptionMenu ÁöÑ Item Ëá™ÂÆö‰πâÁöÑÁÇπÂáª‰∫ã‰ª∂‰ºòÂÖàÁ∫ßË¶ÅÈ´ò‰∫é onOptionsItemSelected()„ÄÇ]]></content>
      <categories>
        <category>AndroidÈóÆÈ¢òËÆ∞ÂΩï</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[AndroidÂü∫Á°Ä‰πãActivity]]></title>
    <url>%2F2017%2F05%2F02%2FAndroid%E5%9F%BA%E7%A1%80%E4%B9%8BActivity%2F</url>
    <content type="text"><![CDATA[ActivityÂØºÂõæ ‰∏ªË¶ÅÂÜÖÂÆπÔºö Activity Âü∫Êú¨‰ΩøÁî® ÂàõÂª∫Ê¥ªÂä® AndroidManifest.xml ÁöÑ application Ê†áÁ≠æÂÜÖËøõË°åÂ£∞Êòé ËΩΩÂÖ•Â∏ÉÂ±Ä setContentView(R.layout.second_layout) Activity Ë∑≥ËΩ¨ ÊòæÂºè Intent 123//Intent(Context packageContext, Class&lt;?&gt; cls)Intent intent = new Intent(MainActivity.this, SecondActivity.class);startActivity(intent); ËøôÁßçÊåáÂÆö‰∏ä‰∏ãÊñáÂíåÁõÆÊ†áÊ¥ªÂä®Á±ªÂêçÁöÑ Intent Áß∞‰πã‰∏∫ÊòæÂºè Intent„ÄÇ ÈöêÂºè Intent 12345678&lt;activity android:name=".SecondActivity"&gt; &lt;intent-filter&gt; &lt;action android:name="com.rookieyang.demo.ACTION_START" /&gt; &lt;category android:name="android.intent.category.DEFAULT" /&gt; &lt;category android:name="com.rookieyang.demo.MY_CATEGORY" /&gt; &lt;/intent-filter&gt;&lt;/activity&gt; 123Intent implieIntent = new Intent("com.rookieyang.demo.ACTION_START");implieIntent.addCategory("com.rookieyang.demo.MY_CATEGORY");startActivity(implieIntent); ÈöêÂºè Intent ÈÄöËøáÊåáÂÆö‰∏ÄÁ≥ªÂàóÊõ¥‰∏∫ÊäΩË±°ÁöÑ action Âíå category Á≠â‰ø°ÊÅØÔºåÁÑ∂Âêé‰∫§Áî±Á≥ªÁªüÂéªÂàÜÊûêËøô‰∏™ IntentÔºåÂπ∂Â∏ÆÊàë‰ª¨ÊâæÂá∫ÂêàÈÄÇÁöÑÊ¥ªÂä®ÂéªÂêØÂä®„ÄÇÂè™ÊúâÊ¥ªÂä®‰∏≠ÁöÑ &lt;action&gt; Âíå &lt;category&gt; Ê†áÁ≠æÂÆåÂÖ®ÂåπÈÖç Intent ‰∏≠ÁöÑ action Âíå category Êó∂ÔºåÊ¥ªÂä®ÊâçËÉΩÂìçÂ∫î Intent„ÄÇ Âú®Ë∞ÉÁî® startActivity() ÊñπÊ≥ïÊó∂‰ºöËá™Âä®Â∞Ü android.intent.category.DEFAULT Âä†ÂÖ•Âà∞ Intent ‰∏≠ÔºåÊâÄ‰ª•Âú®Áªô Activity ÊåáÂÆö category ÁöÑÊó∂ÂÄô‰∏çËÉΩÂ§üÂéªÊéâÈªòËÆ§ÁöÑ android.intent.category.DEFAULTÔºåÂéªÊéâ‰πãÂêéÈÄöËøáÈöêÂºè Intent Â∞ÜÊó†Ê≥ïÂåπÈÖçÂà∞ËØ• Activity„ÄÇ ÈöêÂºè Intent Èô§‰∫ÜÂèØ‰ª•ÂêØÂä®Ëá™Â∑±Á®ãÂ∫èÂÜÖÁöÑÊ¥ªÂä®ÔºåËøòÂèØ‰ª•ÂêØÂä®ÂÖ∂‰ªñÁ®ãÂ∫èÁöÑÊ¥ªÂä®Ôºö 12345678btn.setOnClickListener(new OnClickListener() &#123; @Override public void onClick(View v) &#123; Intent intent = new Intent(Intent.ACTION_VIEW); intent.setData(Uri.parse("http://www.baidu.com")); startActivity(intent); &#125;&#125;); ÈöêÂºè Intent ÊåáÂÆö‰∫Ü‰∏Ä‰∏™Á≥ªÁªüÂÜÖÁΩÆÁöÑ actionÔºåÈÄöËøá setData() ËÆæÁΩÆ Intent Êìç‰ΩúÁöÑÊï∞ÊçÆÁî®‰ª•Ë∞ÉÁî®Á≥ªÁªüÊµèËßàÂô®ÔºåÂÖ∂‰∏≠ setData() ÂØπÂ∫î &lt;intent-filter&gt; Ê†áÁ≠æÂÜÖÁöÑ &lt;data&gt; Ê†áÁ≠æÔºåÁî®‰∫éÊåáÂÆöÂΩìÂâçÊ¥ªÂä®ËÉΩÂ§üÂìçÂ∫î‰ªÄ‰πàÁ±ªÂûãÁöÑÊï∞ÊçÆ„ÄÇ&lt;data&gt; Ê†áÁ≠æ‰∏≠‰∏ªË¶ÅÂèØ‰ª•ÈÖçÁΩÆ‰ª•‰∏ãÂÜÖÂÆπÔºö android:schemeÔºöÁî®‰∫éÊåáÂÆöÊï∞ÊçÆÁöÑÂçèËÆÆÈÉ®ÂàÜÔºåÂ¶Ç‰∏ä‰æãÁöÑ http ÈÉ®ÂàÜ„ÄÇ android:hostÔºöÁî®‰∫éÊåáÂÆöÊï∞ÊçÆÁöÑ‰∏ªÊú∫ÂêçÈÉ®ÂàÜÔºåÂ¶Ç‰∏ä‰æãÁöÑ www.baidu.com ÈÉ®ÂàÜ„ÄÇ android:portÔºöÁî®‰∫éÊåáÂÆöÊï∞ÊçÆÁöÑÁ´ØÂè£ÈÉ®ÂàÜÔºå‰∏ÄËà¨Á¥ßÈöè‰∏ªÊú∫Âêç‰πãÂêé„ÄÇ android:pathÔºöÁî®‰∫éÊåáÂÆö‰∏ªÊú∫ÂêçÂíåÁ´ØÂè£‰πãÂêéÁöÑÈÉ®ÂàÜÔºåÂ¶Ç‰∏ÄÊÆµÁΩëÂùÄ‰∏≠Ë∑üÂú®ÂüüÂêç‰πãÂêéÁöÑÂÜÖÂÆπ„ÄÇ android:mimeTypeÔºöÁî®‰∫éÊåáÂÆöÂèØ‰ª•Â§ÑÁêÜÁöÑÊï∞ÊçÆÁ±ªÂûãÔºåÂÖÅËÆ∏‰ΩøÁî®ÈÄöÈÖçÁ¨¶ÊñπÂºèËøõË°åÊåáÂÆö„ÄÇ Activity Èó¥Êï∞ÊçÆ‰º†ÈÄí Âêë‰∏ã‰∏Ä‰∏™Ê¥ªÂä®‰º†ÈÄíÊï∞ÊçÆ 1234567//MainActivityIntent intent = new Intent(MainActivity.this, SecondActivity.class);intent.putExtra("data", "data");startActivity(intent);//SecondActivityIntent intent = getIntent();Toast.makeText(this, intent.getStringExtra("data"), Toast.LENGTH_LONG).show(); MainActivity ‰∏≠ÈÄöËøá Intent ÁöÑ putExtra() ÊñπÊ≥ïÂ∞ÜÊï∞ÊçÆÊöÇÂ≠òÂú® Intent ‰∏≠ÔºåÁÑ∂ÂêéÂú® SecondActivity ‰∏≠ÈÄöËøágetIntent() Ëé∑ÂèñÂà∞ÂêØÂä® SecondActivity ÁöÑ IntentÔºå‰πãÂêéÈÄöËøá getStringExtra() ÊñπÊ≥ïËé∑ÂèñÂà∞‰º†ÈÄíÁöÑÊï∞ÊçÆ„ÄÇÂ¶ÇÊûú‰º†ÈÄíÁöÑÊòØÊï¥ÂûãÊï∞ÊçÆÂàô‰ΩøÁî® getIntExtra() ÊñπÊ≥ï„ÄÇ ËøîÂõûÊï∞ÊçÆÁªô‰∏ä‰∏Ä‰∏™Ê¥ªÂä® 123456789101112131415161718192021222324252627282930//MainActivitybtn.setOnClickListener(new OnClickListener() &#123; @Override public void onClick(View v) &#123; Intent intent = new Intent(MainActivity.this, SecondActivity.class); startActivityForResult(intent, 1); &#125;&#125;);@Overrideprotected void onActivityResult(int requestCode, int resultCode, Intent data) &#123; switch (requestCode) &#123; case 1: if (resultCode == RESULT_OK) &#123; Log.i("onActivityResult", data.getStringExtra("data")); &#125; break; default: &#125;&#125;//SecondActivitybtn.setOnClickListener(new OnClickListener() &#123; @Override public void onClick(View v) &#123; Intent intent = new Intent(); intent.putExtra("data", "data"); setResult(RESULT_OK, intent); finish(); &#125;&#125;); startActivityForResult(Intent intent, int requestCode)ÔºöÊúüÊúõÂú®Ê¥ªÂä®ÈîÄÊØÅÁöÑÊó∂ÂÄôËÉΩÂ§üËøîÂõû‰∏Ä‰∏™ÁªìÊûúÁªô‰∏ä‰∏Ä‰∏™Ê¥ªÂä®„ÄÇ setResult(int resultCode, Intent data)Ôºö‰∏ìÈó®Áî®‰∫éÂêë‰∏ä‰∏Ä‰∏™Ê¥ªÂä®ËøîÂõûÊï∞ÊçÆÔºåÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞Áî®‰∫éÂêë‰∏ä‰∏Ä‰∏™Ê¥ªÂä®ËøîÂõûÂ§ÑÁêÜÁªìÊûúÔºå‰∏ÄËà¨Âè™‰ΩøÁî® RESULT_OK Âíå RESULT_CANCELED„ÄÇÁ¨¨‰∫å‰∏™ÂèÇÊï∞ÂàôÊòØÊääÂ∏¶ÊúâÊï∞ÊçÆÁöÑ Intent ‰º†ÈÄíÂõûÂéªÔºåÁÑ∂ÂêéË∞ÉÁî® finish() ÊñπÊ≥ïÊù•ÈîÄÊØÅÂΩìÂâçÊ¥ªÂä®„ÄÇ onActivityResult(int requestCode, int resultCode, Intent data)ÔºöÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞ÊòØÊàë‰ª¨ÂêØÂä®Ê¥ªÂä®‰º†ÂÖ•ÁöÑËØ∑Ê±ÇÁ†ÅÔºåÁ¨¨‰∫å‰∏™ÂèÇÊï∞ÊòØËøîÂõûÊï∞ÊçÆ‰º†ÂÖ•ÁöÑËøîÂõûÁªìÊûúÔºåÁ¨¨‰∏â‰∏™ÂèÇÊï∞ÊòØËøîÂõûÁöÑÊê∫Â∏¶Êï∞ÊçÆÁöÑ IntentÔºåÁî±‰∫é‰∏Ä‰∏™Ê¥ªÂä®ÂèØËÉΩË∞ÉÁî® startActivityForResult() ÂêØÂä®Â§ö‰∏™Ê¥ªÂä®ÔºåÊâÄ‰ª•È¶ñÂÖàÈúÄË¶ÅÊ£ÄÊü• requestCode Êù•Âà§Êñ≠Êï∞ÊçÆÊù•Ê∫êÔºåÁÑ∂ÂêéÂú®ÈÄöËøá resultCode Êù•Âà§Êñ≠Â§ÑÁêÜÁªìÊûúÊòØÂê¶ÊàêÂäü„ÄÇ Activity ÁöÑÁîüÂëΩÂë®Êúü onCreate()ÔºöÊ¥ªÂä®Á¨¨‰∏ÄÊ¨°Ë¢´ÂàõÂª∫ÁöÑÊó∂ÂÄôË∞ÉÁî®Ôºå‰∏ÄËà¨Âú®ËØ•ÊñπÊ≥ï‰∏≠ÂÆåÊàêÊ¥ªÂä®ÁöÑÂàùÂßãÂåñÊìç‰ΩúÔºåÊØîÂ¶ÇÂä†ËΩΩÂ∏ÉÂ±Ä„ÄÅÁªëÂÆö‰∫ã‰ª∂Á≠â„ÄÇ onStart()ÔºöÂú®Ê¥ªÂä®Áî±‰∏çÂèØËßÅÂèò‰∏∫ÂèØËßÅÁöÑÊó∂ÂÄôË∞ÉÁî®„ÄÇ onResume()ÔºöÂú®Ê¥ªÂä®ÂáÜÂ§áÂ•ΩÂíåÁî®Êà∑ËøõË°å‰∫§‰∫íÁöÑÊó∂ÂÄôË∞ÉÁî®„ÄÇÊ≠§Êó∂Ê¥ªÂä®‰∏ÄÂÆö‰Ωç‰∫éÊ†àÈ°∂ÔºåÂπ∂‰∏îÂ§Ñ‰∫éËøêË°åÁä∂ÊÄÅ„ÄÇ onPause()ÔºöÂú®Á≥ªÁªüÂáÜÂ§áÂéªÂêØÂä®ÊàñËÄÖÊÅ¢Â§çÂè¶‰∏Ä‰∏™Ê¥ªÂä®ÁöÑÊó∂ÂÄôË∞ÉÁî®„ÄÇÊàë‰ª¨ÈÄöÂ∏∏‰ºöÂú®Ëøô‰∏™ÊñπÊ≥ï‰∏≠Â∞Ü‰∏Ä‰∫õÊ∂àËÄó CPU ÁöÑËµÑÊ∫êÈáäÊîæÊéâÔºå‰ª•Âèä‰øùÂ≠ò‰∏Ä‰∫õÂÖ≥ÈîÆÊï∞ÊçÆÔºå‰ΩÜËøô‰∏™ÊñπÊ≥ïÁöÑÊâßË°åÈÄüÂ∫¶‰∏ÄÂÆöË¶ÅÂø´Ôºå‰∏çÁÑ∂‰ºöÂΩ±ÂìçÂà∞Êñ∞ÁöÑÊ†àÈ°∂Ê¥ªÂä®ÁöÑ‰ΩøÁî®„ÄÇ onStop()ÔºöÂú®Ê¥ªÂä®ÂÆåÂÖ®‰∏çÂèØËßÅÁöÑÊó∂ÂÄôË∞ÉÁî®„ÄÇÂ¶ÇÊûúÂêØÂä®ÁöÑÊñ∞Ê¥ªÂä®ÊòØ‰∏Ä‰∏™ÂØπËØùÊ°ÜÂºèÁöÑÊ¥ªÂä®ÔºåÂàô onPause() ‰ºöÊâßË°åÔºåËÄå onStop() ‰∏ç‰ºöÊâßË°å„ÄÇ onDestroy()ÔºöÂú®Ê¥ªÂä®Ë¢´ÈîÄÊØÅ‰πãÂâçË∞ÉÁî®„ÄÇ onRestart()ÔºöÂú®Ê¥ªÂä®Áî±ÂÅúÊ≠¢Áä∂ÊÄÅÂèò‰∏∫Ê¥ªÂä®Áä∂ÊÄÅ‰πãÂâçË∞ÉÁî®„ÄÇ &gt; ‰ª•‰∏ä‰∏ÉÁßçÊñπÊ≥ï‰∏≠Èô§‰∫Ü onRestart( ) ÊñπÊ≥ïÔºåÂÖ∂‰ªñÈÉΩÊòØ‰∏§‰∏§Áõ∏ÂØπÁöÑÔºå‰ªéËÄåÂèØ‰ª•ÂàÜ‰∏∫‰∏âÁßçÁîüÂ≠òÊúüÔºöonCreate( ) Âíå onDestory( ) ‰∏∫ÂÆåÊï¥ÁîüÂ≠òÊúü„ÄÅonStart( ) Âíå onStop( ) ‰∏∫ÂèØËßÅÁîüÂ≠òÊúü„ÄÅonResume( ) Âíå onPause( ) ‰∏∫ÂâçÂè∞ÁîüÂ≠òÊúü„ÄÇ &gt; Activity ÊúÄÂ§öÂèØËÉΩÊúâÂõõÁßçÁä∂ÊÄÅÔºåÂàÜÂà´‰∏∫ÔºöËøêË°åÁä∂ÊÄÅ„ÄÅÊöÇÂÅúÁä∂ÊÄÅ„ÄÅÂÅúÊ≠¢Áä∂ÊÄÅ„ÄÅÈîÄÊØÅÁä∂ÊÄÅ„ÄÇÁ≥ªÁªü‰∏ÄËà¨ÂÄæÂêë‰∫éÂõûÊî∂Â§Ñ‰∫éÂêé‰∏§ÁßçÁä∂ÊÄÅÁöÑ Activity„ÄÇ Activity ÁöÑÊï∞ÊçÆ‰øùÂ≠ò Áî±‰∫é Activity Â§Ñ‰∫éÂÅúÊ≠¢Áä∂ÊÄÅÁöÑÊó∂ÂÄôÂèØËÉΩË¢´Á≥ªÁªüÂõûÊî∂ÔºåÈÇ£‰πàÂΩìÁî®Êà∑ËøîÂõûË¢´ÂõûÊî∂ÁöÑ Activity ‰πãÊó∂‰ºöÈù¢ÂØπ‰∏Ä‰∏™Á©∫Êï∞ÊçÆÁöÑ Activity„ÄÇ‰∏∫‰∫ÜÈÅøÂÖçËøôÁßçÊÉÖÂÜµÁöÑÂèëÁîüÔºåÊàë‰ª¨ÂèØ‰ª•Âà©Áî® onSaveInstanceState() ËøõË°åÊï∞ÊçÆÁöÑ‰øùÂ≠òÂ∑•‰ΩúÔºö 123456789101112131415 //‰øùÂ≠ò @Override protected void onSaveInstanceState(Bundle outState) &#123; outState.putString("data", "outState"); Log.i(TAG, "onSaveInstanceState: "); super.onSaveInstanceState(outState); &#125; //ÊÅ¢Â§ç protected void onCreate(Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); setContentView(R.layout.activity_first); if (savedInstanceState != null) &#123; Log.i(TAG, "onCreate: " + savedInstanceState.getString("data")); &#125;&#125; ‰∏ªÂä®ÈîÄÊØÅ Acitivity ‰∏ç‰ºöËß¶Âèë onSaveInstanceState()ÔºåBundle ‰πüÂèØ‰ª•Âíå Intent ÁªìÂêàËµ∑Êù•‰º†ÈÄíÊï∞ÊçÆ„ÄÇ Activity ÂêØÂä®Ê®°Âºè Activity Êúâ‰∏ãÂàóÂõõÁßçÂêØÂä®Ê®°ÂºèÔºö ÂêØÂä®Ê®°Âºè ‰ΩúÁî® standard ÊØèÊ¨°ÂêØÂä®Ê¥ªÂä®ÈÉΩ‰ºöÂàõÂª∫‰∏Ä‰∏™Ê¥ªÂä®ÁöÑÂÆû‰æã singleTop Âú®ÂêØÂä®Ê¥ªÂä®ÁöÑÊó∂ÂÄôÂ¶ÇÊûúÂèëÁé∞ËøîÂõûÊ†àÁöÑÊ†àÈ°∂Â∑≤ÁªèÊòØËØ•Ê¥ªÂä®ÔºåÂàô‰ºöÁõ¥Êé•‰ΩøÁî®ÂÆÉÔºå‰∏ç‰ºöÂÜçÂàõÂª∫Êñ∞ÁöÑÊ¥ªÂä®ÂÆû‰æã singleTask Âú®ÂêØÂä®Ê¥ªÂä®ÁöÑÊó∂ÂÄôÂ¶ÇÊûúÂèëÁé∞ËøîÂõûÊ†à‰∏≠Â∑≤ÁªèÂ≠òÂú®ËØ•Ê¥ªÂä®ÔºåÂàôÁõ¥Êé•‰ΩøÁî®ÂÆÉÔºåÂπ∂ÊääËØ•Ê¥ªÂä®‰πã‰∏äÁöÑÊâÄÊúâÊ¥ªÂä®ÁªüÁªüÂá∫Ê†à singleInstance Âú®ÂêØÂä®Ê¥ªÂä®ÁöÑÊó∂ÂÄôÔºåÂêØÂä®‰∏Ä‰∏™ÂçïÁã¨ÁöÑËøîÂõûÊ†àÊù•ÁÆ°ÁêÜËØ•Ê¥ªÂä® singleInstance ÁöÑÊÑè‰πâÔºöÂÅáËÆæÁ®ãÂ∫è‰∏≠Êúâ‰∏Ä‰∏™Ê¥ªÂä®ÂÖÅËÆ∏ÂÖ∂‰ªñÁ®ãÂ∫èË∞ÉÁî®ÔºåÂ¶ÇÊûúÊàë‰ª¨ÊÉ≥ÂÆûÁé∞ÂÖ∂‰ªñÁ®ãÂ∫èÂíåÊàë‰ª¨ÁöÑÁ®ãÂ∫èÂèØ‰ª•ÂÖ±‰∫´Ëøô‰∏™Ê¥ªÂä®ÁöÑÂÆû‰æãÔºåÂ∞±ÈúÄË¶Å‰ΩøÁî® singleInstance Ê®°ÂºèÔºåÂõ†‰∏∫Âú®ËøôÁßçÊ®°Âºè‰∏ã‰ºöÊúâ‰∏Ä‰∏™ÂçïÁã¨ÁöÑËøîÂõûÊ†àÊù•ÁÆ°ÁêÜËøô‰∏™Ê¥ªÂä®Ôºå‰∏çÁÆ°ÊòØÂì™‰∏™Â∫îÁî®Á®ãÂ∫èÊù•ËÆøÈóÆËøô‰∏™Ê¥ªÂä®ÔºåÈÉΩÂÖ±Áî®Âêå‰∏Ä‰∏™ËøîÂõûÊ†à„ÄÇ Intent ÁöÑ Flags Â±ûÊÄß Flags ÁöÑ‰ΩúÁî®ÊúâÂæàÂ§öÔºåÊúâÁöÑ Flags ‰∏∫ÂèØ‰ª•ËÆæÂÆö Activity ÁöÑÂêØÂä®Ê®°ÂºèÔºåËøòÊúâÁöÑ Flags ÂèØ‰ª•ÂΩ±Âìç Activity ÁöÑËøêË°åÁä∂ÊÄÅÔºåÊØîÂ¶Ç FLAG_ACTIVITY_SINGLE_TOP Âíå FLAG_ACTIVITY_CLEAR_TOP„ÄÇ Â∏∏Áî®ÁöÑ Flags Â¶Ç‰∏ãÔºö Flags ‰ΩúÁî® FLAG_ACTIVITY_NEW_TASK When using this flag, if a task is already running for the activity you are now starting, then a new activity will not be started; instead, the current task will simply be brought to the front of the screen with the state it was last in. FLAG_ACTIVITY_CLEAR_TOP ËÆæÁΩÆËØ•Ê†áÂøó‰πãÂêéÁöÑ ActivityÔºåÂΩìÂêØÂä® Activity Êó∂ÔºåÂ¶ÇÊûúËØ• Activity Â∑≤ÁªèÂ≠òÂú®‰ªªÂä°Ê†à‰∏≠ÔºåÂàô‰∏çÂú®ÂàõÂª∫Êñ∞ÁöÑÂÆû‰æãÔºåÂπ∂‰∏î‰Ωç‰∫éËØ• Activity ‰πã‰∏äÁöÑ ActivityÈÉΩÈúÄË¶ÅÂá∫Ê†à‰∏ÄËà¨ÈÖçÂêà FLAG_ACTIVITY_NEW_TASK ËøõË°å‰ΩøÁî® FLAG_ACTIVITY_SINGLE_TOP ËÆæÁΩÆ Activity ÁöÑÂêØÂä®Ê®°Âºè‰∏∫ singleTop FLAG_ACTIVITY_EXCLUDE_FROM_RECENTS ÂÖ∑ÊúâËØ•Ê†áÂøóÁöÑ Activity ‰∏ç‰ºöÂá∫Áé∞Âú®ÂéÜÂè≤ Activity ÁöÑÂàóË°®‰∏≠ FLAG_ACTIVITY_LAUNCH_ADJACENT Ê≠§Ê†áÂøó‰ªÖÁî®‰∫éÂàÜÂ±èÂ§öÁ™óÂè£Ê®°ÂºèÔºåÊñ∞ÁöÑÊ¥ªÂä®Â∞ÜÊòæÁ§∫Âú®‰∏ä‰∏Ä‰∏™ Activity ÁöÑÈôÑËøëÈúÄË¶Å‰∏é FLAG_ACTIVITY_NEW_TASK ÁªìÂêà‰ΩøÁî®„ÄÇ Âè¶Â§ñÔºåÂ¶ÇÊûúË¶ÅÂàõÂª∫Áé∞ÊúâÊ¥ªÂä®ÁöÑÊñ∞ÂÆû‰æãÔºåÂàôÂ∫îÂêåÊó∂ËÆæÁΩÆ FLAG_ACTIVITY_MULTIPLE_TASK FLAG_ACTIVITY_NEW_DOCUMENT ËØ•Ê†áÂøóÁî®‰∫éÂú®‰∏Ä‰∏™‰ª•ÁõÆÊ†á Activity ‰∏∫Ê†àÈ°∂ÁöÑÊñ∞‰ªªÂä°Ê†à‰∏≠ÊâìÂºÄÊñáÊ°£ FLAG_ACTIVITY_NEW_TASKÔºöËÆæÁΩÆÊ≠§Áä∂ÊÄÅÔºåËÆ∞‰Ωè‰ª•‰∏ãÂéüÂàôÔºåÈ¶ñÂÖà‰ºöÊü•ÊâæÊòØÂê¶Â≠òÂú®ÂíåË¢´ÂêØÂä®ÁöÑ Activity ÂÖ∑ÊúâÁõ∏ÂêåÁöÑ‰∫≤ÂíåÊÄßÁöÑ‰ªªÂä°Ê†àÔºàÂç≥ taskAffinityÔºåÊ≥®ÊÑèÂêå‰∏Ä‰∏™Â∫îÁî®Á®ãÂ∫è‰∏≠ÁöÑ activity ÁöÑ‰∫≤ÂíåÊÄßÂú®Ê≤°Êúâ‰øÆÊîπÁöÑÊÉÖÂÜµ‰∏ãÊòØ‰∏ÄÊ†∑ÁöÑÔºâÔºåÂ¶ÇÊûúÊúâÔºåÂàôÁõ¥Êé•ÊääËøô‰∏™Ê†àÊï¥‰ΩìÁßªÂä®Âà∞ÂâçÂè∞ÔºåÂπ∂‰øùÊåÅÊ†à‰∏≠ÁöÑÁä∂ÊÄÅ‰∏çÂèòÔºåÂç≥Ê†à‰∏≠ÁöÑ activity È°∫Â∫è‰∏çÂèòÔºåÂ¶ÇÊûúÊ≤°ÊúâÔºåÂàôÊñ∞Âª∫‰∏Ä‰∏™Ê†àÊù•Â≠òÊîæË¢´ÂêØÂä®ÁöÑ activity„ÄÇ FLAG_ACTIVITY_LAUNCH_ADJACENTÔºöÊµãËØïÂèëÁé∞Âú®ÂàÜÂ±èÊ®°Âºè‰∏ãÂú®ÂêØÂä®ÁõÆÊ†á Activity Êó∂ÔºåÂ¶ÇÊûúÊ≤°ÊúâËÆæÁΩÆ FLAG_ACTIVITY_MULTIPLE_TASK ÔºåÈÇ£‰πàÂΩìÁõÆÊ†á Activity Â∑≤ÁªèÂ≠òÂú®‰∫é‰ªªÂä°Ê†à‰∏≠ÔºåÂ∞Ü‰∏ç‰ºöËøõÂÖ•ÂàÜÂ±èÊ®°Âºè„ÄÇ FLAG_ACTIVITY_NEW_DOCUMENTÔºö ÂΩìÂçïÁã¨‰ΩøÁî®Êó∂ÔºåÂÆÉÁõ∏ÂΩì‰∫éÊåáÂÆö documentLaunchMode =‚ÄúintoExisting‚Äù„ÄÇÂΩì‰∏é FLAG_ACTIVITY_MULTIPLE_TASK ‰∏ÄËµ∑‰ΩøÁî®Êó∂ÔºåÂÆÉÁ≠âÂêå‰∫éÊåáÂÆö documentLaunchMode =‚Äúalways‚Äù„ÄÇ Â∫èÂàóÂåñ ÁõÆÁöÑ Intent ÁöÑ putExtra() ÊñπÊ≥ï‰∏≠ÊâÄÊîØÊåÅÁöÑÊï∞ÊçÆÁ±ªÂûãÊòØÊúâÈôêÁöÑÔºåÂΩìÈúÄË¶Å‰º†ÈÄí‰∏Ä‰∫õËá™ÂÆö‰πâÂØπË±°ÁöÑÊó∂ÂÄôÔºåÂ∞±ÈúÄË¶ÅÁî®Âà∞Â∫èÂàóÂåñ‰∫Ü„ÄÇ ÊñπÊ≥ï ‰ΩøÁî® Intent Êù•‰º†ÈÄíÂØπË±°ÈÄöÂ∏∏Êúâ‰∏§ÁßçÂÆûÁé∞ÊñπÂºèÔºö Parcelable 123456789101112131415161718192021222324252627282930public class Person implements Parcelable &#123; ... @Override public int describeContents() &#123; return 0; &#125; @Override public void writeToParcel(Parcel dest, int flags) &#123; dest.writeString(name); dest.writeInt(age); &#125; public static final Parcelable.Creator&lt;Person&gt; CREATOR = new Creator&lt;Person&gt;() &#123; @Override public Person createFromParcel(Parcel source) &#123; Person person = new Person(); person.name = source.readString(); person.age = source.readInt(); return person; &#125; @Override public Person[] newArray(int size) &#123; return new Person[size]; &#125; &#125;;&#125; Person Á±ªÂÆûÁé∞‰∫Ü Parcelable Êé•Âè£Áî®‰∫éÂ∫èÂàóÂåñÔºåÊèê‰æõ‰∫Ü‰∏Ä‰∏™Âêç‰∏∫ CREATOR ÁöÑÂ∏∏ÈáèÁî®‰∫éÂèçÂ∫èÂàóÂåñ„ÄÇcreateFromParcel() Âíå writeToParcel() ÁöÑÈ°∫Â∫èÈúÄË¶Å‰∏ÄËá¥„ÄÇÈááÁî® Parcelable ÊñπÂºèËøõË°åÂ∫èÂàóÂåñÔºåËé∑ÂèñÂØπË±°ÁöÑÊñπÊ≥ïÂèò‰∏∫ getParcelableExtra()„ÄÇ Serializable 12345678910111213141516171819202122232425262728293031public class Person implements Serializable &#123; private String name; private int age; public String getName() &#123; return name; &#125; public int getAge() &#123; return age; &#125; public void setName(String name) &#123; this.name = name; &#125; public void setAge(int age) &#123; this.age = age; &#125;&#125;//MainActivity ‰∏≠Person person = new Person();person.setAge(13);person.setName("data");Intent intent = new Intent(MainActivity.this, SecondActivity.class);intent.putExtra("data_person", person);startActivity(intent);//SecondActivity ‰∏≠Person person = (Person) getIntent().getParcelableExtra("data_person");Log.i("SecondActivity", "onCreate: " + person.getName()); È¶ñÂÖàÂàõÂª∫‰∫Ü‰∏Ä‰∏™ Person Á±ªÂéªÂÆûÁé∞ Serializable Êé•Âè£ÔºåËøôÊ†∑ÊâÄÊúâÁöÑ Person ÂØπË±°Â∞±ÈÉΩÊòØÂèØÂ∫èÂàóÂåñÁöÑ‰∫ÜÔºåÁÑ∂ÂêéÂú® MainActivity ‰∏≠ÂàõÂª∫‰∫Ü‰∏Ä‰∏™ Person ÂØπË±°ÔºåÁÑ∂ÂêéÂ∞ÜÂØπË±°‰º†ÂÖ• SecondActivity ‰∏≠ÂéªÔºåÂú® SecondActivity ‰∏≠Áî® getParcelableExtra() Êù•Ëé∑ÂèñÂØπË±°„ÄÇ ÂÆûÁî®ÊäÄÂ∑ß Áü•ÊôìÂΩìÂâçÊòØÂú®Âì™‰∏Ä‰∏™Ê¥ªÂä® 12345678public class BaseActivity extends AppCompatActivity &#123; @Override protected void onCreate(@Nullable Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); Log.d("onCreate: ", getClass().getSimpleName()); &#125;&#125; ÂàõÂª∫‰∏Ä‰∏™ BaseActivityÔºåÁÑ∂ÂêéËÆ©ÂÖ∂‰ªñ Activity ÁªßÊâø BaseAcitivtyÔºåÈÇ£‰πàÂΩìÂêØÂä®Ê¥ªÂä®Êó∂Â∞±‰ºö logcat ‰∏≠ÊâìÂç∞Âá∫Áõ∏Â∫îÁöÑ‰ø°ÊÅØ„ÄÇ ÈöèÊó∂ÈöèÂú∞ÈÄÄÂá∫Á®ãÂ∫è 1234567891011121314151617181920public class ActivityCollector &#123; private static List&lt;Activity&gt; activities = new ArrayList&lt;&gt;(); public static void addActivity(Activity activity) &#123; activities.add(activity); &#125; public static void removeActivity(Activity activity) &#123; activities.remove(activity); &#125; public static void finishAll() &#123; for (Activity activity : activities) &#123; if (!activity.isFinishing()) &#123; activity.finish(); &#125; &#125; &#125;&#125; ÂàõÂª∫‰∏Ä‰∏™Ê¥ªÂä®ÁöÑÁÆ°ÁêÜÁ±ªÔºåÂú®Ê¥ªÂä®ÁöÑ onCreate() ‰∏≠Ë∞ÉÁî® addActivity() ÊñπÊ≥ï‰øùÂ≠òÂàõÂª∫ÁöÑÊ¥ªÂä®ÔºåÂú® onDestroy() ‰∏≠Ë∞ÉÁî® removeActivity() ÊñπÊ≥ïÁßªÈô§È©¨‰∏äË¶ÅÈîÄÊØÅÁöÑÊ¥ªÂä®„ÄÇÂ¶ÇÊûúÈúÄË¶ÅÈöèÊó∂ÈöèÂú∞ÈÄÄÂá∫Á®ãÂ∫èÂàôÂè™ÈúÄË¶ÅË∞ÉÁî® finishAll()„ÄÇ ÂêØÂä®Ê¥ªÂä®ÁöÑÊúÄ‰Ω≥ÂÜôÊ≥ï 123456public static void actionStart(Context context, String param1, String param2) &#123; Intent intent = new Intent(context, SecondActivity.class); intent.putExtra("param1", param1); intent.putExtra("param2", param2); context.startActivity(intent);&#125; ÂΩìÊ¥ªÂä®‰∏≠ÈúÄË¶ÅÁî®Âà∞‰∏Ä‰∫õÂèÇÊï∞‰πãÊó∂ÔºåÂèØ‰ª•ÈááÁî®Â¶Ç‰∏äÊñπÂºèÂéªÂêØÂä®Ê¥ªÂä®„ÄÇÈÇ£‰πàÂΩìÂÖ∂‰ªñ‰∫∫Êù•ÂêØÂä®Ê¥ªÂä®ÁöÑÊó∂ÂÄôÂ∞Ü‰ºöÈùûÂ∏∏Êñπ‰æø„ÄÇ]]></content>
      <categories>
        <category>AndroidÂü∫Á°Ä</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>Activity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python ‰∏ã json Ê®°Âùó]]></title>
    <url>%2F2017%2F04%2F20%2FPython%E4%B8%8BJson%E6%A8%A1%E5%9D%97%2F</url>
    <content type="text"><![CDATA[Python ‰∏ãÁöÑ json Ê®°Âùó‰∏ªË¶ÅÊúâ 4 ‰∏™ÂáΩÊï∞Ôºö 12345678#dict ËΩ¨Êàê str json.dump()#Â∞Ü json Êï∞ÊçÆ‰øùÂ≠òÂà∞Êñá‰ª∂json.dumps()#str ËΩ¨Êàê dict json.load()#‰ªéÊñá‰ª∂‰∏≠ËØªÂèñ json Êï∞ÊçÆjson.loads() Â∞Ü Json Êï∞ÊçÆÂÜôÂÖ•Êñá‰ª∂Ôºö 1234567try: data_result_file = "data_result.json" with open(data_result_file, 'w') as f: data_json = json.loads(results.data) json.dump(data_json, f, indent=4)except IOError: print("Êñá‰ª∂‰∏çÂ≠òÂú®") Áî±‰∫é json.dump() ‰∫ßÁîüÁöÑÊòØ str ÂØπË±°Ôºå‰∏çÊòØ bytes ÂØπË±°ÔºåÊâÄ‰ª•ÂÜôÂÖ•Êó∂Êñá‰ª∂ÊùÉÈôê‰∏çËÉΩËÆæÁΩÆ‰∏∫ wbÔºåÂê¶Âàô‰ºöÂá∫Áé∞ TypeError: a bytes-like object is required, not ‚Äòstr'„ÄÇ]]></content>
      <categories>
        <category>PythonÂü∫Á°Ä</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Json</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[BootStrap-FileInput ÁöÑÂü∫Êú¨‰ΩøÁî®]]></title>
    <url>%2F2017%2F04%2F20%2Fbootstrap-fileinput%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8%2F</url>
    <content type="text"><![CDATA[ÂÆâË£Ö‰∏éÂºïÂÖ• Âú®ÂºïÂÖ• File Input ‰πãÂâçÈ¶ñÂÖàÈúÄË¶Å‰∏ãËΩΩ‰∏ãÂàóÊñá‰ª∂Ôºö 123bootstrap-fileinput/css/fileinput.min.cssbootstrap-fileinput/js/fileinput_locale_zh.jsbootstrap-fileinput/js/fileinput.min.js ‰∏äËø∞Êñá‰ª∂ÂèØ‰ª•Âú® File Input ÁöÑÈ°πÁõÆÂú∞ÂùÄÊâæÂà∞„ÄÇ Âú®‰∏ãËΩΩÂ•Ω‰πãÂêéÂ∞±ÈúÄË¶ÅÊ∑ªÂä†Â¶Ç‰∏ã‰ª£Á†ÅËøõË°åÂºïÂÖ•Ôºö 123&lt;link href="/static/css/fileinput.min.css" rel="stylesheet"&gt;&lt;script src="/static/js/fileinput.min.js" type="text/javascript"&gt;&lt;/script&gt;&lt;script src="/static/js/fileinput-zh.js" type="text/javascript"&gt;&lt;/script&gt; File Input ÁöÑ‰ΩøÁî® È¶ñÂÖàÈúÄË¶ÅÂú®È°µÈù¢Ê∑ªÂä†‰∏Ä‰∏™ File Input Êéß‰ª∂Ôºö 1234&lt;div class="form-group"&gt; &lt;input id="import_file" type="file" multiple class="file" name="userfile" data-overwrite-initial="false" data-min-file-count="1"&gt;&lt;/div&gt; data-min-file-count ÂèØ‰ª•ËÆæÂÆöÊúÄÂ∞ë‰∏ä‰º†ÁöÑÊñá‰ª∂Êï∞ Âú®Ê∑ªÂä†ÂÆå‰πãÂêéÂ∞±ÈúÄË¶ÅÂØπÊéß‰ª∂ËøõË°åÂàùÂßãÂåñÔºö 12345678910111213141516171819202122$("#import_file").fileinput(&#123; uploadUrl: "/upload_file", //ËÆæÁΩÆ‰∏ä‰º†ÁöÑÂú∞ÂùÄ allowedFileExtensions: ['xls', 'xlsx'], //ËÆæÁΩÆÂÖÅËÆ∏‰∏ä‰º†ÁöÑÊñá‰ª∂Ê†ºÂºè overwriteInitial: false, language: 'zh', //ËÆæÁΩÆËØ≠Ë®Ä maxFileSize: 6000, maxFilesNum: 10, //ÂÖÅËÆ∏‰∏ä‰º†ÁöÑÊúÄÂ§ßÊñá‰ª∂Êï∞ uploadAsync: true, //ÈªòËÆ§ÂºÇÊ≠•‰∏ä‰º† //allowedFileTypes: ['image', 'video', 'flash'], allowedPreviewTypes: null, previewFileIconSettings: &#123; 'xls': '&lt;i class="fa fa-file-excel-o text-success"&gt;&lt;/i&gt;' &#125;, //È¢ÑËßàÊñá‰ª∂ÁöÑÂõæÊ†áËÆæÁΩÆ previewFileExtSettings: &#123; 'xls': function (ext) &#123; return ext.match(/(xls|xlsx)$/i); &#125; &#125;, //xls Âíå xlsx ‰ΩøÁî®Âêå‰∏ÄÈ¢ÑËßà slugCallback: function (filename) &#123; return filename.replace('(', '_').replace(']', '_'); &#125; //‰ΩøÁî®ÂõûË∞ÉÂäüËÉΩÂ∞ÜÊñá‰ª∂ÂêçËΩ¨Êç¢ÊàêÂ§ÑÁêÜ‰πãÂêéÁöÑÊñá‰ª∂Âêç„ÄÇ&#125;); ÂêéÂè∞Â§ÑÁêÜÔºö 12345678910@app.route('/upload_file', methods=['POST'])def upload_file(): try: file = request.files.get('userfile') save_file_name = file.filename file.save(save_file_name) except KeyError: return [] else: return jsonify(&#123;'info': "‰∏ä‰º†ÊàêÂäü"&#125;) ËøôÈáåÂØπ‰∏ä‰º†ÁöÑ Excel Êñá‰ª∂ËøõË°å‰∫Ü‰øùÂ≠òÔºåËøîÂõû‰∏ä‰º†ÊàêÂäüÁöÑ‰ø°ÊÅØ„ÄÇ ÈóÆÈ¢ò Âú®ÂØπ Excel Êñá‰ª∂ËøõË°åÈ¢ÑËßàÂõæÊ†áËÆæÁΩÆ‰πãÂâçÔºåÂ¶ÇÊûúÈÄöËøáÊåâÈíÆÈÄâÊã©Êñá‰ª∂ËÄå‰∏çÊòØÊãñÊãΩÔºåÂàô‰ºöÂá∫Áé∞Áî±È¢ÑËßàÊñá‰ª∂ÊâÄÂØºËá¥Âç°È°øÔºåÂú®Â∞Ü Excel Êñá‰ª∂ÁöÑÈ¢ÑËßàËÆæÁΩÆ‰∏∫ÂõæÊ†á‰πãÂêéËß£ÂÜ≥„ÄÇ ‰ªéÂêéÁ´ØÁõ¥Êé•ËøîÂõûÂ≠óÁ¨¶‰∏≤Âá∫Áé∞ÈîôËØØÔºåÊîπ‰∏∫ËøîÂõû Json Ê†ºÂºèÊï∞ÊçÆÂêéËß£ÂÜ≥„ÄÇ ÂèÇËÄÉËµÑÊñô File Input ÂºÄÂèëÊñáÊ°£ File Input Demo]]></content>
      <categories>
        <category>ÊùÇËÆ∞</category>
      </categories>
      <tags>
        <tag>BootStrap</tag>
        <tag>Web</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Android Ëá™ÂÆö‰πâ View Âíå ViewGroup ÁÆÄË¶ÅÊÄªÁªì]]></title>
    <url>%2F2017%2F04%2F17%2FAndroid%E8%87%AA%E5%AE%9A%E4%B9%89View%E5%92%8CViewGroup%E7%AE%80%E8%A6%81%E6%80%BB%E7%BB%93%2F</url>
    <content type="text"><![CDATA[‰∏ªË¶ÅÊñπÊ≥ïÂèä‰ΩúÁî® Ëá™ÂÆö‰πâ ViewGroup ‰∏ªË¶ÅÊ∂âÂèäÁöÑÊñπÊ≥ïÂ¶Ç‰∏ãÔºö onMeasure() ËÆ°ÁÆó childView ÁöÑÊµãÈáèÂÄº‰ª•ÂèäÊ®°ÂºèÔºå‰ª•ÂèäËÆæÁΩÆËá™Â∑±ÁöÑÂÆΩÂíåÈ´ò„ÄÇ onLayout() ÂØπÊâÄÊúâ childView ËøõË°åÂÆö‰Ωç„ÄÇ Ëá™ÂÆö‰πâ View ‰∏ªË¶ÅÊ∂âÂèäÁöÑÊñπÊ≥ïÂ¶Ç‰∏ãÔºö onMeasure() ÊµãÈáè View ÁöÑÂÆΩÂíåÈ´ò„ÄÇ onDraw() Â∞Ü View ÁªòÂà∂Âà∞Â±èÂπï‰∏ä„ÄÇ ÊµãÈáèÊ®°Âºè onMeasure() ËøáÁ®ãÂíåÊµãÈáèÊ®°ÂºèÁõ∏ÂÖ≥ÔºåËÄåÊµãÈáèÊ®°ÂºèÂàÜ‰∏∫‰∏âÁßçÔºö UNSPECIFIEDÔºöÁà∂ÂÆπÂô®‰∏çÂØπ View Êúâ‰ªª‰ΩïÈôêÂà∂ÔºåË¶ÅÂ§öÂ§ßÁªôÂ§öÂ§ß„ÄÇËøôÁßçÊÉÖÂÜµ‰∏ÄËà¨Áî®‰∫éÁ≥ªÁªüÂÜÖÈÉ®„ÄÇ EXACTLYÔºöÁà∂ÂÆπÂô®Â∑≤ÁªèÊ£ÄÊµãÂá∫ View ÊâÄÈúÄË¶ÅÁöÑÁ≤æÁ°ÆÂ§ßÂ∞èÔºåËøô‰∏™Êó∂ÂÄô View ÁöÑÊúÄÁªàÂ§ßÂ∞èÂ∞±ÊòØ SpecSize ÊâÄÊåáÂÆöÁöÑÂÄº„ÄÇÂÆÉÂØπÂ∫î LayoutParams ‰∏≠ÁöÑ mactch_parent ÂíåÂÖ∑‰ΩìÊï∞ÂÄºËøô‰∏§ÁßçÊ®°Âºè„ÄÇ AT_MOST Áà∂ÂÆπÂô®ÊåáÂÆö‰∫Ü‰∏Ä‰∏™ÂèØÁî®Â§ßÂ∞èÂç≥ SpecSizeÔºåView ÁöÑÂ§ßÂ∞è‰∏çËÉΩÂ§ß‰∫éËøô‰∏™ÂÄºÔºåÂÖ∑‰ΩìÂÄºÁúã‰∏çÂêå View ÁöÑÂÖ∑‰ΩìÂÆûÁé∞„ÄÇÂÆÉÂØπÂ∫î‰∫é LayoutParams ‰∏≠ÁöÑ wrap_content„ÄÇ LayoutParams Âíå generateLayoutParams LayoutParamsÁöÑÂÆòÊñπÊñáÊ°£Ëß£ÈáäÂ¶Ç‰∏ãÔºö 1.LayoutParams are used by views to tell their parents how they want to be laid out. -- LayoutParams ÊòØ View Áî®Êù•ÂëäËØâÂÆÉÁöÑÁà∂Êéß‰ª∂Â¶Ç‰ΩïÊîæÁΩÆËá™Â∑±ÁöÑ„ÄÇ 2.The base LayoutParams class just describes how big the view wants to be for both width and height. -- Âü∫Á±ª LayoutParamsÔºà‰πüÂ∞±ÊòØ ViewGroup.LayoutParamsÔºâ‰ªÖ‰ªÖÊèèËø∞‰∫ÜËøô‰∏™ View ÊÉ≥Ë¶ÅÁöÑÂÆΩÂ∫¶ÂíåÈ´òÂ∫¶„ÄÇ 3.There are subclasses of LayoutParams for different subclasses of ViewGroup. -- ‰∏çÂêå ViewGroup ÁöÑÁªßÊâøÁ±ªÂØπÂ∫îÁùÄ‰∏çÂêåÁöÑ ViewGroup.LayoutParams ÁöÑÂ≠êÁ±ª„ÄÇ generateLayoutParamsÂÆòÊñπÊñáÊ°£Ëß£ÈáäÂ¶Ç‰∏ãÔºö Returns a new set of layout parameters based on the supplied attributes set. -- Ê†πÊçÆÊèê‰æõÁöÑÂ±ûÊÄßÈõÜËøîÂõû‰∏ÄÁªÑÊñ∞ÁöÑÂ∏ÉÂ±ÄÂèÇÊï∞„ÄÇ Âú® addView() ÁöÑÊâßË°åËøáÁ®ãÂΩì‰∏≠ÔºåÂ¶ÇÊûú checkLayoutParams() Ê£ÄÊµãÂà∞‰º†ÈÄíËøáÊù•ÁöÑ LayoutParams ‰∏çÊòØÂØπÂ∫îÂ∏ÉÂ±ÄÁöÑ LayoutParamÔºåÂàô‰ºöÈÄöËøá generateLayoutParams() Ê†πÊçÆ‰Ω†‰º†ÈÄíÁöÑ LayoutParams ÁöÑÂ±ûÊÄßÊûÑÈÄ†‰∏Ä‰∏™ÂØπÂ∫îÂ∏ÉÂ±ÄÁöÑ LayoutParams„ÄÇ ÂèÇËÄÉËµÑÊñô Android ÊâãÊääÊâãÊïôÊÇ®Ëá™ÂÆö‰πâViewGroupÔºà‰∏ÄÔºâ Ëá™ÂÆö‰πâÊéß‰ª∂Áü•ËØÜÂÇ®Â§á-LayoutParamsÁöÑÈÇ£‰∫õ‰∫ã]]></content>
      <categories>
        <category>AndroidÂü∫Á°Ä</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>Ëá™ÂÆö‰πâÊéß‰ª∂</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Android ‰∏≠ View ÁöÑÊûÑÈÄ†ÂáΩÊï∞ÊµÖËß£]]></title>
    <url>%2F2017%2F04%2F17%2FAndroid%E4%B8%ADView%E7%9A%84%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E6%B5%85%E8%A7%A3%2F</url>
    <content type="text"><![CDATA[ÊûÑÈÄ†ÂáΩÊï∞ÁöÑË∞ÉÁî®Êó∂Êú∫ Âú®Ëá™ÂÆö‰πâ View ÁöÑËøáÁ®ãÂΩì‰∏≠Ôºå‰∏çÂèØÈÅøÂÖçÁöÑÈúÄË¶ÅÊé•Ëß¶Âà∞ View ÁöÑÊûÑÈÄ†ÂáΩÊï∞ÔºåÁõÆÂâç View ÂÖ∑ÊúâÂõõ‰∏™ÊûÑÈÄ†ÂáΩÊï∞ÔºåÂàÜÂà´Â¶Ç‰∏ãÔºö 12345678910111213141516public View(Context context) &#123; /...../&#125; public View(Context context, @Nullable AttributeSet attrs) &#123; this(context, attrs, 0);&#125; public View(Context context, @Nullable AttributeSet attrs, int defStyleAttr) &#123; this(context, attrs, defStyleAttr, 0);&#125; public View(Context context, @Nullable AttributeSet attrs, int defStyleAttr, int defStyleRes) &#123; this(context); /...../&#125; defStyleAttr ÂΩìÂâç‰∏ªÈ¢ò‰∏≠ÁöÑ‰∏Ä‰∏™Â±ûÊÄßÔºåÂÖ∂‰∏≠ÂåÖÂê´ÂØπ‰∏∫ËßÜÂõæÊèê‰æõÈªòËÆ§ÂÄºÁöÑÊ†∑ÂºèËµÑÊ∫êÁöÑÂºïÁî®„ÄÇ ÂèØ‰ª•‰∏∫0Ôºå‰∏çÂØªÊâæÈªòËÆ§ÂÄº„ÄÇ defStyleRes ‰∏∫ËßÜÂõæÊèê‰æõÈªòËÆ§ÂÄºÁöÑÊ†∑ÂºèËµÑÊ∫êÁöÑËµÑÊ∫êÊ†áËØÜÁ¨¶Ôºå‰ªÖÂú® defStyleAttr ‰∏∫0ÊàñÂú®‰∏ªÈ¢ò‰∏≠Êâæ‰∏çÂà∞Êó∂‰ΩøÁî®„ÄÇÂèØ‰ª•‰∏∫0Ôºå‰∏çÂØªÊâæÈªòËÆ§ÂÄº„ÄÇ Á¨¨‰∏Ä‰∏™ÊûÑÈÄ†ÂáΩÊï∞Ê∫êÁ†ÅÁöÑËß£ÈáäÂ¶Ç‰∏ãÔºö &gt; Simple constructor to use when creating a view from code. ‰πüÂ∞±ÊòØËØ¥ÂΩìÂú®‰ª£Á†Å‰∏≠ÂàõÂª∫ View ÁöÑÊó∂ÂÄô‰ºöË∞ÉÁî®Á¨¨‰∏Ä‰∏™ÊûÑÈÄ†ÂáΩÊï∞„ÄÇ Á¨¨‰∫å‰∏™ÊûÑÈÄ†ÂáΩÊï∞ÁöÑÊ∫êÁ†ÅËß£ÈáäÂ¶Ç‰∏ãÔºö &gt; Constructor that is called when inflating a view from XML. This is called when a view is being constructed from an XML file, supplying attributes that were specified in the XML file. This version uses a default style of 0, so the only attribute values applied are those in the Context's Theme and the given AttributeSet. ‰πüÂ∞±ÊòØËØ¥ÂΩìÂú® XML Êñá‰ª∂‰∏≠ÊèíÂÖ• View ÁöÑÊó∂ÂÄô‰ºöË∞ÉÁî®Á¨¨‰∫å‰∏™ÊûÑÈÄ†ÂáΩÊï∞ÔºåÂπ∂‰∏î‰ºöÂ∫îÁî® Context ÁöÑ‰∏ªÈ¢ò‰ª•ÂèäÂú® XML ‰∏≠ÁªôÂÆöÁöÑÂ±ûÊÄßÂÄº„ÄÇ Á¨¨‰∏â‰∏™ÂíåÁ¨¨Âõõ‰∏™ÊûÑÈÄ†ÂáΩÊï∞ÁöÑÊ∫êÁ†ÅËß£ÈáäÂàÜÂà´Â¶Ç‰∏ãÔºö &gt; Perform inflation from XML and apply a class-specific base style from a theme attribute. &gt; &gt;This constructor of View allows subclasses to use their own base style when they are inflating. For example, a Button class's constructor would call this version of the super class constructor and supply R.attr.buttonStyle for defStyleAttr; this (in particular its background) as well as the Button class's attributes. Perform inflation from XML and apply a class-specific base style from a theme attribute or style resource. &gt; This constructor of View allows subclasses to use their own base style when they are inflating. ‰πüÂ∞±ÊòØËØ¥‰∏§‰∏™ÊûÑÈÄ†ÂáΩÊï∞ÂÖ±ÂêåÁöÑ‰ΩúÁî®ÊòØÂÖÅËÆ∏ View Â∫îÁî®Ëá™Â∑±ÁöÑÂü∫Á°Ä styleÔºåÈÇ£‰πàÂΩìÊàë‰ª¨ÈúÄË¶Å‰∏∫ View ËÆæÁΩÆ style ÁöÑÊó∂ÂÄôÂ∞±ÂèØ‰ª•ÈÄâÊã©ÂéªË∞ÉÁî®Ëøô‰∏§‰∏™ÊûÑÈÄ†ÂáΩÊï∞ÂΩì‰∏≠ÁöÑ‰∏Ä‰∏™ÔºåË∞ÉÁî®ÊñπÂºè‰∏ÄËà¨Â¶Ç‰∏ãÔºö 1234567public Button(Context context, AttributeSet attrs) &#123; this(context, attrs, com.android.internal.R.attr.buttonStyle);&#125;public Button(Context context, AttributeSet attrs, int defStyleAttr) &#123; this(context, attrs, defStyleAttr, 0);&#125; defStyleAttr Âíå defStyleRes ÁöÑËÅîÁ≥ª Êé•‰∏ãÊù•ÁöÑÈóÆÈ¢òÊòØËøô‰∏§ËÄÖÁöÑÂå∫Âà´Âú®Âì™ÈáåÔºüÁî±‰∫éËøô‰∏§ËÄÖÈÉΩÁî®‰∫éËÆæÁΩÆ styleÔºåËÄå style ÈáåÈù¢ÊòØÂ±ûÊÄßÁöÑÈõÜÂêàÔºåÊâÄ‰ª•ËøôÈáåÈúÄË¶ÅÂÖà‰∫ÜËß£ View ËÆæÁΩÆÂ±ûÊÄßÁöÑÊñπÂºèÔºå‰∏ÄËà¨Êù•ËØ¥ÊúâÂ¶Ç‰∏ã‰∫îÁßçÊñπÂºèÔºö 1. XML ‰∏≠Áõ¥Êé•Â£∞ÊòéÁõ∏ÂÖ≥Â±ûÊÄßÂÄº 2. XML ‰∏≠ ÂºïÂÖ• style 3. defStyleAttr 4. defStyleRes 5. theme‰∏≠Áõ¥Êé•ÊåáÂÆö Êó¢ÁÑ∂Êúâ‰∫îÁßçÊñπÂºèÔºåÈÇ£‰πàÂΩìÂêåÊó∂Â∫îÁî®ÁöÑÊó∂ÂÄôÂ∞±Ê∂âÂèäÂà∞‰∫Ü‰ºòÂÖàÁ∫ßÁöÑÈóÆÈ¢ò„ÄÇ‰∏∫‰∫Ü‰∫ÜËß£‰ºòÂÖàÁ∫ßÁöÑÈóÆÈ¢òÔºåÈ¶ñÂÖàÊàë‰ª¨ÈúÄË¶ÅÂú® attrs.xml Êñá‰ª∂‰∏≠ÂÜôÂÖ•Â¶Ç‰∏ã‰ª£Á†ÅÔºö 1234567891011&lt;?xml version="1.0" encoding="utf-8"?&gt;&lt;resources&gt; &lt;declare-styleable name="DefAttrs"&gt; &lt;attr name="attr_1" format="string" /&gt; &lt;attr name="attr_2" format="string" /&gt; &lt;attr name="attr_3" format="string" /&gt; &lt;attr name="attr_4" format="string" /&gt; &lt;/declare-styleable&gt; &lt;attr name="defStyleAttr" format="reference" /&gt;&lt;/resources&gt; ËøôÈáåÂÆö‰πâ‰∫ÜÂõõ‰∏™Ê†ºÂºè‰∏∫ string ÁöÑÂ±ûÊÄßÁî®‰∫éÊµãËØïÔºåÂÆö‰πâ‰∫Ü‰∏Ä‰∏™Âêç‰∏∫ defStyleAttr ÂºïÁî®„ÄÇ ÈÄöËøá declare-styleable ÂèØ‰ª•‰∏∫ÊØè‰∏™Â±ûÊÄßÂú® R Êñá‰ª∂ÈáåËá™Âä®ÁîüÊàê‰∏Ä‰∏™ int[]ÔºåËøôÊ†∑Â∞±ÂèØ‰ª•ÂæàÊñπ‰æøÁöÑÁî® R.styleable.* Êù•ËøõË°å‰ΩøÁî®ÔºåÂΩìÁÑ∂ÂÆö‰πâÁöÑÂ±ûÊÄß‰πüÂèØ‰ª•‰∏çÊîæÂú® declare-styleable ‰∏≠Ôºå‰ΩÜÊòØ‰ΩøÁî®ÁöÑÊó∂ÂÄôÂ∞±ÈúÄË¶ÅÈÄöËøáÂ¶Ç‰∏ã‰ª£Á†ÅÔºö 12int[] attrs = &#123;R.attr.attr_1,R.attr_2&#125;;TypedArray typedArray = context.obtainStyledAttributes(set,attrs); Âú®ÂàõÂª∫‰∫ÜËá™ÂÆö‰πâÁöÑÂ±ûÊÄß‰πãÂêéÔºåËøòÈúÄË¶ÅÂàõÂª∫‰∏Ä‰∫õ styleÔºåÂú® style.xml Êñá‰ª∂‰∏≠ÂÜôÂÖ•Â¶Ç‰∏ã‰ª£Á†ÅÔºö 123456789101112131415161718192021222324252627282930313233343536373839&lt;resources&gt; &lt;!-- Base application theme. --&gt; &lt;style name="AppTheme" parent="Theme.AppCompat.Light.DarkActionBar"&gt; &lt;!-- Customize your theme here. --&gt; &lt;item name="colorPrimary"&gt;@color/colorPrimary&lt;/item&gt; &lt;item name="colorPrimaryDark"&gt;@color/colorPrimaryDark&lt;/item&gt; &lt;item name="colorAccent"&gt;@color/colorAccent&lt;/item&gt; &lt;!--Theme Áõ¥Êé•ÊåáÂÆö--&gt; &lt;item name="attr_1"&gt;theme_one&lt;/item&gt; &lt;item name="attr_2"&gt;theme_two&lt;/item&gt; &lt;item name="attr_3"&gt;theme_three&lt;/item&gt; &lt;item name="attr_4"&gt;theme_four&lt;/item&gt; &lt;!--defStyleAttr--&gt; &lt;item name="defStyleAttr"&gt;@style/def_style_attr&lt;/item&gt; &lt;/style&gt; &lt;!--xml ‰∏≠ÂºïÂÖ•ÁöÑ style --&gt; &lt;style name="xml_style"&gt; &lt;item name="attr_1"&gt;xml_style_one&lt;/item&gt; &lt;item name="attr_2"&gt;xml_style_two&lt;/item&gt; &lt;/style&gt; &lt;!--defStyleAttr ÂºïÁî®ÁöÑ style--&gt; &lt;style name="def_style_attr"&gt; &lt;item name="attr_1"&gt;def_style_one&lt;/item&gt; &lt;item name="attr_2"&gt;def_style_two&lt;/item&gt; &lt;item name="attr_3"&gt;def_style_three&lt;/item&gt; &lt;/style&gt; &lt;!--defStyleRes--&gt; &lt;style name="def_style_res"&gt; &lt;item name="attr_1"&gt;def_style_res_one&lt;/item&gt; &lt;item name="attr_2"&gt;def_style_res_two&lt;/item&gt; &lt;item name="attr_3"&gt;def_style_res_three&lt;/item&gt; &lt;item name="attr_4"&gt;def_style_res_four&lt;/item&gt; &lt;/style&gt;&lt;/resources&gt; ‰∏äËø∞‰ª£Á†ÅÊ∑ªÂä†‰∫ÜÂõõÁßç styleÔºåÂØπÂ∫î‰∏∫ View ËÆæÁΩÆÂ±ûÊÄßÁöÑÊñπÂºè‰∏≠ÁöÑÂêéÂõõÁßçÔºåÂú®Ê∑ªÂä†‰∫Ü style ‰πãÂêéÔºåÊàë‰ª¨ËøòÈúÄË¶ÅÂ∫îÁî® styleÔºåÊâÄ‰ª•ÈúÄË¶ÅÂÖàÂàõÂª∫‰∏Ä‰∏™Â¶Ç‰∏ãÁöÑËá™ÂÆö‰πâ ViewÔºö 123456789101112131415161718192021222324252627282930313233343536373839public class MyView extends TextView&#123; public MyView(Context context) &#123; super(context); &#125; public MyView(Context context, @Nullable AttributeSet attrs) &#123; this(context, attrs, R.attr.defStyleAttr); &#125; public MyView(Context context, @Nullable AttributeSet attrs, int defStyleAttr) &#123; this(context, attrs, defStyleAttr,R.attr.defStyleAttr); parse(context, attrs, defStyleAttr); &#125; @TargetApi(VERSION_CODES.LOLLIPOP) public MyView(Context context, @Nullable AttributeSet attrs, int defStyleAttr, int defStyleRes) &#123; super(context, attrs, defStyleAttr, defStyleRes); &#125; private void parse(Context context, AttributeSet attrs, int defStyleAttr) &#123; TypedArray typedArray = context.obtainStyledAttributes(attrs, R.styleable.DefAttrs, defStyleAttr, R.style.def_style_res); String one = typedArray.getString(R.styleable.DefAttrs_attr_1); String two = typedArray.getString(R.styleable.DefAttrs_attr_2); String three = typedArray.getString(R.styleable.DefAttrs_attr_3); String four = typedArray.getString(R.styleable.DefAttrs_attr_4); log("one = " + one); log("two = " + two); log("three = " + three); log("four = " + four); typedArray.recycle(); &#125; private void log(String msg) &#123; Log.i("MyView", msg); &#125;&#125; Á¨¨‰∫å‰∏™ÊûÑÈÄ†ÂáΩÊï∞‰∏≠ÊòæÂºèË∞ÉÁî®‰∫ÜÁ¨¨‰∏â‰∏™ÊûÑÈÄ†ÂáΩÊï∞ÔºåÂπ∂ËÆæÁΩÆ defStyleAttr ÂèÇÊï∞ÂÄº‰∏∫ R.attr.defStyleAttr„ÄÇ parse() Ëé∑ÂèñÂõõ‰∏™Â±ûÊÄßÂÄºÂπ∂ËøõË°åÊâìÂç∞„ÄÇ ÂàõÂª∫ÂÆåËá™ÂÆö‰πâ View ‰πãÂêéÔºåÁé∞Âú®ÈúÄË¶ÅÂú® XML Êñá‰ª∂‰∏≠Ê∑ªÂä†Ëá™ÂÆö‰πâÁöÑViewÔºö 12345678910111213141516&lt;?xml version="1.0" encoding="utf-8"?&gt;&lt;android.support.constraint.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android" xmlns:tools="http://schemas.android.com/tools" xmlns:test="http://schemas.android.com/apk/res-auto" android:layout_width="match_parent" android:layout_height="match_parent" tools:context="com.rookieyang.test.MainActivity"&gt; &lt;com.rookieyang.test.MyView test:attr_1="xml_attr_attr1" style="@style/xml_style" android:layout_width="wrap_content" android:layout_height="wrap_content" /&gt;&lt;/android.support.constraint.ConstraintLayout&gt; test:attr_1=&quot;xml_attr_attr1&quot; XML ‰∏≠Áõ¥Êé•ÊåáÂÆö attr_1 Â±ûÊÄßÂÄº„ÄÇ style=&quot;@style/xml_style&quot; XML ‰∏≠ÂºïÂÖ• style„ÄÇ ËøêË°åÁªìÊûú Âú®ÂÆåÊàê‰∏äËø∞Ê≠•È™§‰πãÂêéÂ∞±ÂèØ‰ª•ËøêË°åÔºåËøêË°å‰πãÂêéÁöÑËæìÂá∫Â¶Ç‰∏ãÔºö ‰∏äËø∞‰ª£Á†Å‰∏≠ÔºåXML ‰∏≠Áõ¥Êé•Â£∞Êòé attr_1 Â±ûÊÄßÂÄº‰∏∫ xml_attr_attr1ÔºåXML ‰∏≠ ÂºïÂÖ•ÁöÑ style ‰∏≠Áªô attr_1Ôºåattr_2 ËµãÂÄº‰∏∫ xml_style_oneÔºåxml_style_twoÔºådefStyleAttr Áªô attr_1Ôºåattr_2Ôºåattr_3 ËµãÂÄº‰∏∫ def_style_oneÔºådef_style_twoÔºådef_style_threeÔºådefStyleRes Âíå Theme ‰πüÂàÜÂà´‰∏∫Âõõ‰∏™Â±ûÊÄßËøõË°å‰∫ÜËµãÂÄºÔºåËÄåÊ†πÊçÆËæìÂá∫ÁöÑÁªìÊûúÂú®‰ºòÂÖàÁ∫ß‰∏äÊàë‰ª¨ÂæàÂÆπÊòìÂæóÂà∞‰ª•‰∏ãÁªìËÆ∫Ôºö &gt; XML ‰∏≠Áõ¥Êé•Â£∞ÊòéÁõ∏ÂÖ≥Â±ûÊÄßÂÄº &gt; XML ‰∏≠ ÂºïÂÖ• style &gt; defStyleAttr &gt; theme‰∏≠Áõ¥Êé•ÊåáÂÆö &gt; &gt; defStyleAttr &gt; defStyleRes ‰ªéÁ¨¨‰∏ÄÈÉ®ÂàÜÂèØ‰ª•Áü•ÈÅìÁî±‰∫é defStyleAttr ÁöÑÂ≠òÂú®ÔºådefStyleRes Ê≤°ÊúâÁîüÊïàÔºåÊâÄ‰ª• defStyleRes Âíå theme‰∏≠Áõ¥Êé•ÊåáÂÆöÁöÑ‰ºòÂÖàÁ∫ßËøò‰∏çËÉΩËøõË°åÂà§Êñ≠ÔºåËøô‰∏™Êó∂ÂÄôÈúÄË¶ÅÂ∞Ü style.xml Êñá‰ª∂‰∏≠ÁöÑ‰∏ãÂàó‰ª£Á†ÅËøõË°åÊ≥®ÈáäÔºö 1&lt;item name="defStyleAttr"&gt;@style/def_style_attr&lt;/item&gt; ÊàñËÄÖÂ∞ÜËá™ÂÆö‰πâ View ‰∏≠Ë∞ÉÁî®Á¨¨‰∏â‰∏™ÊûÑÈÄ†ÂáΩÊï∞ÁöÑ‰ª£Á†ÅÂÅöÂ¶Ç‰∏ã‰øÆÊîπÔºö 12//Â∞ÜÁ¨¨‰∏â‰∏™ÂèÇÊï∞Êõ¥Êîπ‰∏∫ 0this(context, attrs, defStyleAttr,0); ‰øÆÊîπ‰πãÂêéËøêË°åËÉΩÂæóÂà∞Â¶Ç‰∏ãËæìÂá∫Ôºö ÂèØ‰ª•ÁúãÂà∞ÂΩì defStyleAttr ‰∏çÂ≠òÂú®Âêé defStyleRes ÂºÄÂßãÁîüÊïàÔºåÂπ∂‰∏î‰ºòÂÖàÁ∫ßË¶ÅÈ´ò‰∫étheme‰∏≠Áõ¥Êé•ÊåáÂÆö„ÄÇ ÊâÄ‰ª•ÊúÄÁªàÁªìËÆ∫Â¶Ç‰∏ãÔºö &gt; XML ‰∏≠Áõ¥Êé•Â£∞ÊòéÁõ∏ÂÖ≥Â±ûÊÄßÂÄº &gt; XML ‰∏≠ ÂºïÂÖ• style &gt; defStyleAttr &gt; defStyleRes &gt; theme‰∏≠Áõ¥Êé•ÊåáÂÆö &gt; ‰ªÖÂú® defStyleAttr ‰∏∫0ÊàñÂú®‰∏ªÈ¢ò‰∏≠Êâæ‰∏çÂà∞Êó∂ÔºådefStyleRes ÁîüÊïà„ÄÇ ÂèÇËÄÉËµÑÊñô Ê∑±Â∫¶Ëß£ÊûêViewÊûÑÈÄ†ÂáΩÊï∞‰∏≠ÁöÑÂèÇÊï∞defStyleAttr Android View Âõõ‰∏™ÊûÑÈÄ†ÂáΩÊï∞ËØ¶Ëß£ Ê∑±ÂÖ•ÁêÜËß£Android Ëá™ÂÆö‰πâattr Style styleable‰ª•ÂèäÂÖ∂Â∫îÁî®]]></content>
      <categories>
        <category>AndroidÂü∫Á°Ä</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>View</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[getWidth() ÊñπÊ≥ïÂíå getMeasureWidth() ÊñπÊ≥ïÁöÑÂå∫Âà´]]></title>
    <url>%2F2017%2F04%2F16%2FgetWidth()%E6%96%B9%E6%B3%95%E5%92%8CgetMeasureWidth()%E6%96%B9%E6%B3%95%E7%9A%84%E5%8C%BA%E5%88%AB%2F</url>
    <content type="text"><![CDATA[È¶ñÂÖà getMeasureWidth() ÊñπÊ≥ïÂú® measure() ËøáÁ®ãÁªìÊùüÂêéÂ∞±ÂèØ‰ª•Ëé∑ÂèñÂà∞‰∫ÜÔºåËÄå getWidth() ÊñπÊ≥ïË¶ÅÂú® layout() ËøáÁ®ãÁªìÊùüÂêéÊâçËÉΩËé∑ÂèñÂà∞„ÄÇÂè¶Â§ñ getMeasureWidth() ÊñπÊ≥ï‰∏≠ÁöÑÂÄºÊòØÈÄöËøá setMeasuredDimension() ÊñπÊ≥ïÊù•ËøõË°åËÆæÁΩÆÁöÑÔºåËÄå getWidth() ÊñπÊ≥ï‰∏≠ÁöÑÂÄºÂàôÊòØÈÄöËøáËßÜÂõæÂè≥ËæπÁöÑÂùêÊ†áÂáèÂéªÂ∑¶ËæπÁöÑÂùêÊ†áËÆ°ÁÆóÂá∫Êù•ÁöÑ„ÄÇ ËßÇÂØü SimpleLayout ‰∏≠ onLayout() ÊñπÊ≥ïÁöÑ‰ª£Á†ÅÔºåËøôÈáåÁªôÂ≠êËßÜÂõæÁöÑ layout() ÊñπÊ≥ï‰º†ÂÖ•ÁöÑÂõõ‰∏™ÂèÇÊï∞ÂàÜÂà´ÊòØ 0Ôºå0ÔºåchildView.getMeasuredWidth() Âíå childView.getMeasuredHeight() ÔºåÂõ†Ê≠§ getWidth() ÊñπÊ≥ïÂæóÂà∞ÁöÑÂÄºÂ∞±ÊòØ childView.getMeasuredWidth() - 0 = childView.getMeasuredWidth()ÔºåÊâÄ‰ª•Ê≠§Êó∂ getWidth() ÊñπÊ≥ïÂíå getMeasuredWidth() ÂæóÂà∞ÁöÑÂÄºÂ∞±ÊòØÁõ∏ÂêåÁöÑ„ÄÇ 1234567@Override protected void onLayout(boolean changed, int l, int t, int r, int b) &#123; if (getChildCount() &gt; 0) &#123; View childView = getChildAt(0); childView.layout(0, 0, childView.getMeasuredWidth(), childView.getMeasuredHeight()); &#125; &#125; ‰ΩÜÂ¶ÇÊûú‰Ω†Â∞Ü onLayout() ÊñπÊ≥ï‰∏≠ÁöÑ‰ª£Á†ÅËøõË°åÂ¶Ç‰∏ã‰øÆÊîπÔºö 1234567@Override protected void onLayout(boolean changed, int l, int t, int r, int b) &#123; if (getChildCount() &gt; 0) &#123; View childView = getChildAt(0); childView.layout(0, 0, 200, 200); &#125; &#125; ËøôÊ†∑ getWidth() ÊñπÊ≥ïÂæóÂà∞ÁöÑÂÄºÂ∞±ÊòØ 200 - 0 = 200Ôºå‰∏ç‰ºöÂÜçÂíå getMeasuredWidth() ÁöÑÂÄºÁõ∏Âêå‰∫Ü„ÄÇÂΩìÁÑ∂ËøôÁßçÂÅöÊ≥ïÂÖÖÂàÜ‰∏çÂ∞äÈáç measure() ËøáÁ®ãËÆ°ÁÆóÂá∫ÁöÑÁªìÊûúÔºåÈÄöÂ∏∏ÊÉÖÂÜµ‰∏ãÊòØ‰∏çÊé®ËçêËøô‰πàÂÜôÁöÑ„ÄÇ getHeight() ‰∏é getMeasureHeight() ÊñπÊ≥ï‰πãÈó¥ÁöÑÂÖ≥Á≥ªÂêå‰∏äÔºåÂ∞±‰∏çÂÜçÈáçÂ§çÂàÜÊûê‰∫Ü„ÄÇ ÂèÇËÄÉËµÑÊñô AndroidËßÜÂõæÁªòÂà∂ÊµÅÁ®ãÂÆåÂÖ®Ëß£ÊûêÔºåÂ∏¶‰Ω†‰∏ÄÊ≠•Ê≠•Ê∑±ÂÖ•‰∫ÜËß£View(‰∫å)]]></content>
      <categories>
        <category>AndroidÂü∫Á°Ä</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[d3.js ÁªòÂà∂Êü±ÂΩ¢Âõæ]]></title>
    <url>%2F2017%2F04%2F14%2Fd3-js%E7%BB%98%E5%88%B6%E6%9F%B1%E5%BD%A2%E5%9B%BE%2F</url>
    <content type="text"><![CDATA[Âú®d3.js ÁªòÂà∂ÂäõÂØºÂêëÂõæ‰∏≠Â∑≤ÁªèËØ¥Êòé‰∫ÜÂ¶Ç‰ΩïÁªòÂà∂ÂäõÂØºÂêëÂõæ‰ª•ÂèäÊï∞ÊçÆÊõ¥Êñ∞„ÄÇÊú¨Ê¨°Â∞ÜËØ¥ÊòéÂ¶Ç‰ΩïÁªòÂà∂Â∏¶ÂùêÊ†áËΩ¥ÁöÑÊü±ÂΩ¢Âõæ„ÄÇ Á°ÆÂÆöÂàùÂßãÊï∞ÊçÆ ÂàùÂßãÊï∞ÊçÆÂ¶Ç‰∏ãÔºö 12345678910111213141516171819202122232425262728293031323334var nodes = [&#123;'label': 'Sort', 'title': 'lslamic'&#125;, &#123; 'label': 'GOODS', 'title': 'VINTAGE OLD HAND MADE BEAUTY SILVER BROOCH PIN RED ENAMEL LEAF SIAM STERLING' &#125;, &#123;'label': 'Website', 'title': 'ebay'&#125;, &#123;'label': 'Sort', 'title': 'Antiques'&#125;, &#123; 'label': 'Sort', 'title': 'Baby' &#125;, &#123;'label': 'Sort', 'title': 'Books'&#125;, &#123;'label': 'Sort', 'title': 'Business &amp; Industrial'&#125;, &#123; 'label': 'Sort', 'title': 'Cameras &amp; Photo' &#125;, &#123;'label': 'Sort', 'title': 'Cell Phones &amp; Accessories'&#125;, &#123; 'label': 'Sort', 'title': 'Clothing, Shoes &amp; Accessories' &#125;, &#123;'label': 'Sort', 'title': 'Coins &amp; Paper Money'&#125;, &#123;'label': 'Sort', 'title': 'Collectibles'&#125;, &#123; 'label': 'Sort', 'title': 'Computers Tablets &amp; Networking' &#125;, &#123;'label': 'Sort', 'title': 'Consumer Electronics'&#125;, &#123;'label': 'Sort', 'title': 'Crafts'&#125;, &#123; 'label': 'Sort', 'title': 'eBay Motors' &#125;, &#123;'label': 'Sort', 'title': 'Everything Else'&#125;, &#123;'label': 'Sort', 'title': 'Health &amp; Beauty'&#125;, &#123; 'label': 'Sort', 'title': 'Home &amp; Garden' &#125;, &#123;'label': 'Sort', 'title': 'Jewelry &amp; Watches'&#125;, &#123; 'label': 'Sort', 'title': 'Musical Instruments &amp; Gear' &#125;, &#123;'label': 'Sort', 'title': 'Sporting Goods'&#125;, &#123;'label': 'Sort', 'title': 'Antiquities'&#125;, &#123; 'label': 'Sort', 'title': 'Architectural &amp; Garden' &#125;, &#123;'label': 'Sort', 'title': 'Asian Antiques'&#125;, &#123;'label': 'Sort', 'title': 'Decorative Arts'&#125;, &#123; 'label': 'Sort', 'title': 'Linens &amp; Textiles (Pre-1930)' &#125;, &#123;'label': 'Sort', 'title': 'Maritime'&#125;, &#123;'label': 'Sort', 'title': 'Periods &amp; Styles'&#125;, &#123; 'label': 'Sort', 'title': 'Primitives' &#125;, &#123;'label': 'Sort', 'title': 'Science &amp; Medicine (Pre-1930)'&#125;, &#123;'label': 'Sort', 'title': 'Silver'&#125;]; ÂàùÂßãÊï∞ÊçÆ‰∏≠ÊØè‰∏™Êï∞ÊçÆÂÖ∑Êúâ‰∏çÂêåÁöÑÁ±ªÂà´ÔºåÊú¨Ê¨°ÁöÑÁõÆÁöÑÊòØÁªüËÆ°‰∏çÂêåÁ±ªÂà´ÁöÑÊï∞ÊçÆÂá∫Áé∞Ê¨°Êï∞Âπ∂ËøõË°åÁªòÂà∂ÔºåÊï∞ÊçÆÂ§ÑÁêÜ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 123456789101112131415var dataset = &#123;&#125;;for (var i = 0; i &lt; nodes.length; i++) &#123; var node = nodes[i]; dataset[node['label']] = 0; for (var j = 0; j &lt; nodes.length; j++) &#123; if (nodes[j]['label'] == node['label']) dataset[node['label']] += 1; &#125;&#125;var data = [];var labels = [];for (var key in dataset) &#123; data.push(dataset[key]); labels.push(key);&#125; dataset Áî®‰∫éÂ∞ÜÊï∞ÊçÆËøõË°åÂàÜÁ±ªÁªüËÆ°„ÄÇ data ‰øùÂ≠òÊØè‰∏™ÂàÜÁ±ªÂá∫Áé∞Ê¨°Êï∞„ÄÇ labels ‰øùÂ≠òÂàÜÁ±ªÂêçÁß∞Ôºå‰Ωú‰∏∫ x ËΩ¥ÁöÑÂàªÂ∫¶„ÄÇ ÂàõÂª∫ SVG 1234var width = 420, height = 420;var svg = d3.select("#graph").append("svg") .attr("width", width) .attr("height", height); ÁªòÂà∂ÂùêÊ†áËΩ¥ 123456789101112131415161718192021222324252627282930313233var padding = &#123;top: 20, right: 20, bottom: 20, left: 30&#125;;var xAxisWidth = width - 2 * padding.left;var yAxiWidth = height - 2 * padding.bottom;var xAxisScale = d3.scale.ordinal() .domain(d3.range(labels.length)) .rangeRoundBands([0, xAxisWidth]);var yAxisScale = d3.scale.linear() .domain([0, d3.max(data)]) .range([yAxiWidth, 0]);var xAxis = d3.svg.axis() .scale(xAxisScale) .orient("bottom") .tickFormat(function (d) &#123; return labels[d]; &#125;);var yAxis = d3.svg.axis() .scale(yAxisScale) .orient("left");svg.append("g") .attr("class", "axis") .attr("transform", "translate(" + padding.left + "," + (height - padding.bottom) + ")") .call(xAxis);svg.append("g") .attr("class", "axis") .attr("transform", "translate(" + padding.left + "," + (height - yAxiWidth - padding.bottom) + ")") .call(yAxis); xAxisWidthÔºåyAxiWidth ‰ª£Ë°® x ËΩ¥Âíå y ËΩ¥ÁöÑÈïøÂ∫¶„ÄÇ padding x ËΩ¥Âíå y ËΩ¥ÁöÑÂ§ñËæπË∑ù„ÄÇ xAxisScaleÔºåyAxisScale x ËΩ¥Âíå y ËΩ¥ÁöÑÊØî‰æãÂ∞∫„ÄÇ ordinal().domain() ËÆæÂÆöÊàñËé∑ÂèñÂÆö‰πâÂüü„ÄÇ ordinal.rangeRoundBands(interval[, padding[, outerPadding]]) Êé•Êî∂‰∏Ä‰∏™ËøûÁª≠ÁöÑÂå∫Èó¥ÔºåÁÑ∂ÂêéÊ†πÊçÆÂÆö‰πâÂüü‰∏≠Á¶ªÊï£ÂÄºÁöÑÊï∞ÈáèÂ∞ÜÂÖ∂ÂàÜÊÆµÔºåÂàÜÊÆµÁªìÊûú‰ºöÂèñÊï¥„ÄÇ tickFormat() Áî®‰∫éËÆæÂÆöÊñáÂ≠óÊ†ºÂºèÁöÑÂàªÂ∫¶„ÄÇ ËøôÊ†∑Ê∑ªÂä†‰πãÂêéÁöÑÂùêÊ†áËΩ¥ÔºåÊ†∑Âºè‰ºöÊØîËæÉ‰∏ëÔºåÊâÄ‰ª•ËøòÈúÄË¶ÅÁªôÂùêÊ†áËΩ¥Â¢ûÂä†Â¶Ç‰∏ãÊ†∑ÂºèÔºö 12345678910111213&lt;style&gt; .axis path, .axis line &#123; fill: none; stroke: black; shape-rendering: crispEdges; &#125; .axis text &#123; font-family: sans-serif; font-size: 11px; &#125;&lt;/style&gt; ÁªòÂà∂Áü©ÂΩ¢ 123456789101112131415161718192021222324252627//0.05 Áî®‰∫éËÆæÁΩÆÁü©ÂΩ¢‰πãÈó¥ÁöÑÈó¥ÈöîÔºåÁî±‰∫é rangeRoundBands ÈÄâÂèñÁöÑËåÉÂõ¥ËøúÂ∞è‰∫é xAxisWidthÔºåÊâÄ‰ª•Áü©ÂΩ¢‰πãÈó¥ÁöÑÈó¥ÈöîËøúÂ§ß‰∫é 0.05ÔºåËØ•ÂèÇÊï∞Êú™Ëµ∑‰ΩúÁî®„ÄÇvar xScale = d3.scale.ordinal() .domain(d3.range(labels.length)) .rangeRoundBands([0, 100], 0.05);var yScale = d3.scale.linear() .domain([0, d3.max(data)]) .range([0, yAxiWidth]);var rect = svg.selectAll("rect") .data(data);rect.enter() .append("rect") .attr("x", function (d, i) &#123; x = xAxisWidth / (2 * labels.length) * (2 * i + 1) - xScale.rangeBand() / 2 + padding.left; return x; &#125;) .attr("y", function (d, i) &#123; return height - padding.bottom - yScale(d); &#125;) .attr("width", function (d, i) &#123; return xScale.rangeBand(); &#125;) .attr("height", yScale) .attr("fill", "steelblue"); xScale Áî®‰∫éÊéßÂà∂Áü©ÂΩ¢ÂÆΩÂ∫¶Ôºå yScale Áî®‰∫éÊéßÂà∂Áü©ÂΩ¢È´òÂ∫¶„ÄÇËøôÊ†∑ÂÅöÂèØ‰ª•‰ΩøÂæóÁü©ÂΩ¢ÁöÑÂÆΩÂ∫¶ÂíåÈ´òÂ∫¶Ëá™Áî±‰º∏Áº©„ÄÇ ÁªôÁü©ÂΩ¢Â¢ûÂä†ÊñáÂ≠óÊèèËø∞ 123456789101112131415161718192021var text = svg.selectAll("text") .data(data);text.enter().append("text") .attr("x", function (d, i) &#123; x = xAxisWidth / (2 * labels.length) * (2 * i + 1) - xScale.rangeBand() / 2 + padding.left; return x; &#125;) .attr("y", function (d, i) &#123; return height - padding.bottom - yScale(d); &#125;) .attr("dx", function (d, i) &#123; return xScale.rangeBand() / 4; &#125;) .attr("dy", -2) .attr("text-anchor", "begin") .attr("font-size", 14) .attr("fill", "#000000") .text(function (d, i) &#123; return d; &#125;); text ÂÖÉÁ¥†ÁöÑÂùêÊ†áÊòØÁü©ÂΩ¢ÁöÑÂùêÊ†áÔºådxÔºådy ËÆæÂÆö‰∫ÜÊñπÂêë‰∏äÁöÑÂÅèÁßªÈáè„ÄÇÊâÄ‰ª•ÊúÄÁªàÊñáÂ≠ó‰Ωç‰∫éÁü©ÂΩ¢Ê≠£‰∏äÊñπ„ÄÇ Êü±ÂΩ¢ÂõæÂä®Áîª ÁªôÊü±ÂΩ¢ÂõæÂ¢ûÂä†Âä®ÁîªÔºåÈúÄË¶ÅÂ∞Ü‰ª£Á†Å‰øÆÊîπ‰∏∫Ôºö 12345678910111213141516171819202122232425262728var rect = svg.selectAll("rect") .data(data);rect.enter() .append("rect") .attr("y", function (d, i) &#123; return height - padding.bottom; &#125;) .attr("height", 0) .attr("fill", "red") .transition() .duration(3000) .ease("bounce") .delay(function (d, i) &#123; return 200 * i; &#125;) .attr("x", function (d, i) &#123; x = xAxisWidth / (2 * labels.length) * (2 * i + 1) - xScale.rangeBand() / 2 + padding.left; return x; &#125;) .attr("y", function (d, i) &#123; return height - padding.bottom - yScale(d); &#125;) .attr("width", function (d, i) &#123; return xScale.rangeBand(); &#125;) .attr("height", yScale) .attr("fill", "steelblue"); ‰∏äËø∞‰ª£Á†ÅËÆæÁΩÆ‰∫Ü‰∏§‰∏™ fill Â±ûÊÄßÔºåÂú®Ê∑ªÂä†‰∫Ü transition() ‰πãÂêéÔºåD3 ‰ºöËá™Âä®ÂØπÈ¢úËâ≤‰πãÈó¥ÁöÑÂÄºËøõË°åÁ∫øÊÄßÊèíÂÄºÔºåÊúÄÁªàÂú®Âä®Áîª‰∏≠‰ºöÁúãÂà∞Âπ≥ÊªëÁöÑÈ¢úËâ≤ÂèòÂåñ„ÄÇ duration() Âä®ÁîªÊåÅÁª≠Êó∂Èó¥„ÄÇ ease() ÊåáÂÆöËΩ¨ÂèòÊñπÂºèÔºåÂ∏∏Áî®ÁöÑËΩ¨ÂèòÊñπÂºèÊúâÔºö linear ÊôÆÈÄöÁöÑÁ∫øÊÄßÂèòÂåñ„ÄÇ circle ÊÖ¢ÊÖ¢Âú∞Âà∞ËææÂèòÊç¢ÁöÑÊúÄÁªàÁä∂ÊÄÅ„ÄÇ elastic Â∏¶ÊúâÂºπË∑≥ÁöÑÂà∞ËææÊúÄÁªàÁä∂ÊÄÅ„ÄÇ bounce Âú®ÊúÄÁªàÁä∂ÊÄÅÂ§ÑÂºπË∑≥Âá†Ê¨°„ÄÇ delay() ÊåáÂÆöÂª∂Êó∂„ÄÇ ÊúÄÁªàÊïàÊûú ÂèÇËÄÉËµÑÊñô Â¶Ç‰ΩïËÆ©ÂõæË°®Âä®Ëµ∑Êù• d3-3.x-api-reference]]></content>
      <categories>
        <category>ÊùÇËÆ∞</category>
      </categories>
      <tags>
        <tag>Web</tag>
        <tag>d3.js</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[d3.js ÁªòÂà∂ÂäõÂØºÂêëÂõæ]]></title>
    <url>%2F2017%2F04%2F13%2Fd3-js%E7%BB%98%E5%88%B6%E5%8A%9B%E5%AF%BC%E5%90%91%E5%9B%BE%2F</url>
    <content type="text"><![CDATA[ÁÆÄ‰ªã D3.jsÊòØ‰∏Ä‰∏™JavaScriptÂ∫ìÔºåÂÆÉÂèØ‰ª•ÈÄöËøáÊï∞ÊçÆÊù•Êìç‰ΩúÊñáÊ°£„ÄÇD3ÂèØ‰ª•ÈÄöËøá‰ΩøÁî®HTML„ÄÅSVGÂíåCSSÊääÊï∞ÊçÆÈ≤úÊ¥ªÂΩ¢Ë±°Âú∞Â±ïÁé∞Âá∫Êù•„ÄÇD3‰∏•Ê†ºÈÅµÂæ™WebÊ†áÂáÜÔºåÂõ†ËÄåÂèØ‰ª•ËÆ©‰Ω†ÁöÑÁ®ãÂ∫èËΩªÊùæÂÖºÂÆπÁé∞‰ª£‰∏ªÊµÅÊµèËßàÂô®Âπ∂ÈÅøÂÖçÂØπÁâπÂÆöÊ°ÜÊû∂ÁöÑ‰æùËµñ„ÄÇÂêåÊó∂ÔºåÂÆÉÊèê‰æõ‰∫ÜÂº∫Â§ßÁöÑÂèØËßÜÂåñÁªÑ‰ª∂ÔºåÂèØ‰ª•ËÆ©‰ΩøÁî®ËÄÖ‰ª•Êï∞ÊçÆÈ©±Âä®ÁöÑÊñπÂºèÂéªÊìç‰ΩúDOM„ÄÇ ‰ΩøÁî® Âú® HTML Êñá‰ª∂‰∏≠ÂºïÂÖ•Ôºö &lt;script src=&quot;http://d3js.org/d3.v3.min.js&quot; charset=&quot;utf-8&quot;&gt;&lt;/script&gt; Á°ÆÂÆöÂàùÂßãÊï∞ÊçÆ ÂàùÂßãÊï∞ÊçÆ‰∏∫ËäÇÁÇπÊï∞ÊçÆ nodes Âíå ËøûÁ∫øÊï∞ÁªÑ linksÔºåÂ¶Ç‰∏ãÔºö 1234567891011121314151617181920212223242526272829303132333435var nodes = [&#123;'label': 'Website', 'title': 'ebay'&#125;, &#123;'label': 'Sort', 'title': 'Antiques'&#125;, &#123; 'label': 'Sort', 'title': 'Baby' &#125;, &#123;'label': 'Sort', 'title': 'Books'&#125;, &#123;'label': 'Sort', 'title': 'Business &amp; Industrial'&#125;, &#123; 'label': 'Sort', 'title': 'Cameras &amp; Photo' &#125;, &#123;'label': 'Sort', 'title': 'Cell Phones &amp; Accessories'&#125;, &#123; 'label': 'Sort', 'title': 'Clothing, Shoes &amp; Accessories' &#125;, &#123;'label': 'Sort', 'title': 'Coins &amp; Paper Money'&#125;, &#123;'label': 'Sort', 'title': 'Collectibles'&#125;, &#123; 'label': 'Sort', 'title': 'Computers Tablets &amp; Networking' &#125;, &#123;'label': 'Sort', 'title': 'Consumer Electronics'&#125;, &#123;'label': 'Sort', 'title': 'Crafts'&#125;, &#123; 'label': 'Sort', 'title': 'eBay Motors' &#125;, &#123;'label': 'Sort', 'title': 'Everything Else'&#125;, &#123;'label': 'Sort', 'title': 'Health &amp; Beauty'&#125;, &#123; 'label': 'Sort', 'title': 'Home &amp; Garden' &#125;, &#123;'label': 'Sort', 'title': 'Jewelry &amp; Watches'&#125;, &#123; 'label': 'Sort', 'title': 'Musical Instruments &amp; Gear' &#125;, &#123;'label': 'Sort', 'title': 'Sporting Goods'&#125;]; var links = [&#123;'source': 1, 'target': 0&#125;, &#123;'source': 2, 'target': 0&#125;, &#123;'source': 3, 'target': 0&#125;, &#123; 'source': 4, 'target': 0 &#125;, &#123;'source': 5, 'target': 0&#125;, &#123;'source': 6, 'target': 0&#125;, &#123;'source': 7, 'target': 0&#125;, &#123; 'source': 8, 'target': 0 &#125;, &#123;'source': 9, 'target': 0&#125;, &#123;'source': 10, 'target': 0&#125;, &#123;'source': 11, 'target': 0&#125;, &#123; 'source': 12, 'target': 0 &#125;, &#123;'source': 13, 'target': 0&#125;, &#123;'source': 14, 'target': 0&#125;, &#123;'source': 15, 'target': 0&#125;, &#123; 'source': 16, 'target': 0 &#125;, &#123;'source': 17, 'target': 0&#125;, &#123;'source': 18, 'target': 0&#125;, &#123;'source': 19, 'target': 0&#125;]; ÂàõÂª∫Â∏ÉÂ±Ä 12var force = d3.layout.force() .charge(-300).linkDistance(130).size([width, height]); d3.layout.force() ÂàõÂª∫‰∏Ä‰∏™ÂäõÂØºÂêëÂõæÂ∏ÉÂ±Ä„ÄÇ charge() ËÆæÂÆöËäÇÁÇπÁöÑÁîµËç∑Êï∞ÔºåË¥üÊï∞ÂàôÊéíÊñ•ÔºåÊ≠£Êï∞ÂàôÂê∏Âºï„ÄÇ linkDistance() ËÆæÁΩÆËøûÁ∫øÁöÑË∑ùÁ¶ª„ÄÇ size([x, y]) ËÆæÁΩÆÂäõÂØºÂêëÂõæÁöÑ‰ΩúÁî®ËåÉÂõ¥ÔºåÁî®‰∫éÊåáÂÆöÈáçÂäõ‰∏≠ÂøÉ‰∏∫Ôºàx/2Ôºåy/2ÔºâÔºåÊâÄÊúâËäÇÁÇπÁöÑÂàùÂßã‰ΩçÁΩÆÈôêÂÆö‰∏∫ [0,x] Âíå [0,y] ‰πãÈó¥„ÄÇ ÂàõÂª∫ SVG 12var svg = d3.select("#graph").append("svg") .attr("width", "100%").attr("height", "380px"); append() Áî®‰∫éÊ∑ªÂä†ÂÖÉÁ¥† ËÆæÁΩÆ svg ÁöÑÈïøÂÆΩ ËΩ¨Êç¢Êï∞ÊçÆÂíåÁªòÂà∂ ËÆæÂÆöËäÇÁÇπÊï∞ÁªÑÂíåËøûÁ∫øÊï∞ÁªÑ‰πãÂêéÂºÄÂêØÂ∏ÉÂ±ÄËÆ°ÁÆó 1force.nodes(nodes).links(links).start(); ÁªòÂà∂ ÁªëÂÆöÊï∞ÁªÑ nodes Âíå linksÔºåÂàÜÂà´Ê∑ªÂä†ËäÇÁÇπÁöÑÂÖÉÁ¥† &lt;circle&gt; ÂíåËøûÁ∫øÁöÑÂÖÉÁ¥†&lt;line&gt;„ÄÇÂè¶Â§ñÔºåËøòË¶ÅÊ∑ªÂä†ÊñáÂ≠óÂÖÉÁ¥† &lt;text&gt;„ÄÇÂêÑÂÖÉÁ¥†ÁöÑ CSS Ê†∑ÂºèÂàÜÂà´‰∏∫ÔºönodeÔºålinkÔºånodeText„ÄÇ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 12345678910111213141516171819202122232425262728293031323334353637var link = svg.selectAll(".link") .data(links);link.enter() .insert("line", ".link") .attr("class", "link");var node = svg.selectAll(".node") .data(nodes);node.enter() .append("circle") .attr("class", function (d) &#123; return "node " + d.label &#125;) .attr("r", 25) .call(force.drag);var text = svg.selectAll(".nodeText").data(nodes);text.enter() .append("text") .attr("class", "nodeText") .attr("x", function (d) &#123; return d.x; &#125;) .attr("font-size", "10px") .attr("text-anchor", "middle") .attr("dy", ".3em") .attr("y", function (d) &#123; return d.y; &#125;).text(function (d) &#123; var act_title; if (d.title.length &gt; 8) &#123; act_title = d.title.substring(0, 8) + "..."; return act_title; &#125; else &#123; return d.title; &#125;&#125;); ËäÇÁÇπÁöÑÈÄâÊã©ÈõÜË∞ÉÁî®‰∫Ü call(force.drag)ÔºåÂèØ‰ª•ËÆ©ËäÇÁÇπÊîØÊåÅÈº†Ê†áÊãñÊãΩ„ÄÇ ËøûÁ∫øÁöÑÈÄâÊã©ÈõÜË∞ÉÁî®‰∫Ü insert(&quot;line&quot;, &quot;.link&quot;)ÔºåÂèØ‰ª•Á°Æ‰øùÂäõÂØºÂêëÂõæËøõË°åÊõ¥Êñ∞ÔºàÁßªÈô§ËäÇÁÇπÂêéÂ¢ûÂä†ËäÇÁÇπÔºâ‰πãÂêéËøûÁ∫ø‰∏ç‰ºöË¶ÜÁõñÂú®ËäÇÁÇπ‰∏ä„ÄÇ Âú®ÊãñÂä®ËäÇÁÇπ‰πãÂêéÔºåÂõæÂΩ¢ÂÖÉÁ¥†ÁöÑÂùêÊ†á‰ºöÂèëÁîüÂèòÂåñÔºåÊâÄ‰ª•ÈúÄË¶ÅËÆæÁΩÆ‰∏Ä‰∏™ÁõëÂê¨Âô®ËøõË°åÊõ¥Êñ∞Ôºå‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 123456789101112131415161718192021222324force.on("tick", function () &#123; link.attr("x1", function (d) &#123; return d.source.x; &#125;) .attr("y1", function (d) &#123; return d.source.y; &#125;) .attr("x2", function (d) &#123; return d.target.x; &#125;) .attr("y2", function (d) &#123; return d.target.y; &#125;); node.attr("transform", function (d) &#123; return "translate(" + d.x + "," + d.y + ")"; &#125;); text.attr("x", function (d) &#123; return d.x; &#125;) .attr("y", function (d) &#123; return d.y; &#125;);&#125;); * `force.on()` ÂèØ‰∏∫‰∏âÁßç‰∫ã‰ª∂ËÆæÂÆöÁõëÂê¨Âô®ÔºåstartÔºåtickÔºåend„ÄÇÂÖ∂‰∏≠Ôºåstart ÊòØÂàöÂºÄÂßãËøêÂä®Ôºåend ÊòØËøêÂä®ÂÅúÊ≠¢Ôºåtick ÊòØË°®Á§∫ËøêÂä®ÁöÑÊØè‰∏ÄÊ≠•„ÄÇ * ÈÄâÊã©ÈõÜ nodeÔºålinkÔºåtext ‰∏äÈÉΩÁªëÂÆö‰∫ÜÊï∞ÊçÆÔºåÂΩìÊØè‰∏ÄÊ¨° tick ‰∫ã‰ª∂ÂèëÁîüÊó∂ÔºåË¢´ÁªëÂÆöÁöÑÊï∞ÊçÆË¢´Êõ¥Êñ∞Ôºå`function(d)` ‰∏≠ÁöÑ d ‰πüÈÉΩÊõ¥Êñ∞‰∫Ü„ÄÇ Â¢ûÂä†Ê†∑ÂºèÔºö 123456789101112131415161718192021222324 &lt;style type="text/css"&gt; .node &#123; stroke: #222; stroke-width: 1.5px; &#125; .link &#123; stroke: #707071; stroke-opacity: .6; stroke-width: 1px; &#125; .node.Website &#123; fill: #ff756e; &#125; .node.Sort &#123; fill: #de9bf9; &#125; .nodeText &#123; fill: #ffffff &#125;&lt;/style&gt; ÊïàÊûú ÁªòÂà∂ÁÆ≠Â§¥ÂíåÊ∑ªÂä†ÊñáÂ≠ó ÁªòÂà∂ÁÆ≠Â§¥ÈúÄË¶ÅÁî®Âà∞ SVG ‰∏≠ÁöÑÊ†áËÆ∞ÔºàmarkerÔºâ„ÄÇÊ†áËÆ∞ ÂÜôÂú® ‰∏≠Ôºådefs Áî®‰∫éÂÆö‰πâÂèØÈáçÂ§çÂà©Áî®ÁöÑÂÖÉÁ¥†„ÄÇÂÆö‰πâÁÆ≠Â§¥‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 12345678910111213141516var defs = svg.append("defs");var arrowMarker = defs.append("marker") .attr("id", "arrow") .attr("markerUnits", "strokeWidth") .attr("markerWidth", "10") .attr("markerHeight", "10") .attr("viewBox", "-0 -5 10 10") .attr("refX", "35") .attr("refY", "0") .attr("orient", "auto");var arrow_path = 'M 0,-5 L 10 ,0 L 0,5 L5,0 L0,-5';arrowMarker.append("path") .attr("d", arrow_path) .attr("fill", "#a6a6a6"); refX, refY ÊåáÁöÑÊòØÂõæÂΩ¢ÂÖÉÁ¥†Âíå marker ËøûÊé•ÁöÑ‰ΩçÁΩÆÂùêÊ†áÔºåËøôÈáåÂúÜÁöÑÂçäÂæÑËÆæÁΩÆ‰∏∫ 25ÔºåÁÆ≠Â§¥ÁöÑÈ°∂ÁÇπÂà∞Â∫ïÈÉ®ÂûÇÁõ¥Ë∑ùÁ¶ª‰∏∫ 10ÔºåÊâÄ‰ª•ËÆæÁΩÆ‰∏∫Ôºà35Ôºå0ÔºâÂàôÁÆ≠Â§¥ÁöÑÈ°∂Á´ØÂàöÂ•ΩÂú®ÂúÜ‰∏ä„ÄÇ markerUnits Ê†áËÆ∞Â§ßÂ∞èÁöÑÂü∫ÂáÜÔºåÊúâ‰∏§‰∏™ÂÄºÔºåÂç≥ strokeWidthÔºàÁ∫øÁöÑÂÆΩÂ∫¶ÔºâÂíå userSpaceOnUseÔºàÁ∫øÂâçÁ´ØÁöÑÂ§ßÂ∞èÔºâ„ÄÇ markerWidthÔºåmarkerHeight Ê†áËØÜÁöÑÂ§ßÂ∞è„ÄÇ orient ÁªòÂà∂ÊñπÂêëÔºåÂèØËÆæÂÆö‰∏∫ autoÔºàËá™Âä®Á°ÆËÆ§ÊñπÂêëÂíåËßíÂ∫¶ÂÄºÔºâ„ÄÇ id Ê†áËØÜÁöÑ id Âè∑„ÄÇ Á≤âÁ∫¢Ëâ≤Ê°ÜÊòØ viewBox ËåÉÂõ¥ÔºåÈªëËâ≤‰∏∫ arrow_path ÁöÑËΩ®ËøπÔºö link.attr('marker-end', 'url(#arrow)');ÂèØ‰ª•‰∏∫ËøûÊé•Á∫øÊ∑ªÂä†ÁÆ≠Â§¥„ÄÇ ‰∏∫ËøûÊé•Á∫øÂ¢ûÂä†ÊñáÂ≠óÔºåÈ¶ñÂÖàÈúÄË¶ÅÂÆö‰πâ &lt;path&gt; Á°ÆÂÆöÊñáÂ≠óÊîæÂú®ËøûÊé•Á∫øË∑ØÂæÑ‰∏äÔºåÂÜçÂÆö‰πâ &lt;text&gt;Ôºå‰πãÂêéÂú® &lt;text&gt; Ê∑ªÂä† &lt;textPath&gt; ÂºïÁî®Ë∑ØÂæÑÔºå‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 1234567891011121314151617181920212223242526272829303132333435363738394041//ÂÆö‰πâÊñáÂ≠óË∑ØÂæÑvar linkpaths = svg.selectAll(".linkpath") .data(links_data);linkpaths.enter() .append('path') .attr('d', function (d) &#123; return 'M ' + d.source.x + ' ' + d.source.y + ' L ' + d.target.x + ' ' + d.target.y &#125;) .attr('class', 'linkpath') .attr('fill-opacity', 0) .attr('stroke-opacity', 0) .attr('fill', '#ffffff') .attr('stroke', 'red') .attr('id', function (d, i) &#123; return 'linkpath' + i; &#125;) .style("pointer-events", "none");//ÂÆö‰πâ &lt;text&gt; var linklabels = svg.selectAll(".linklabel") .data(links_data);linklabels.enter() .append('text') .style("pointer-events", "none") .attr('class', 'linklabel') .attr('id', function (d, i) &#123; return 'linklabel' + i; &#125;) .attr('dx', 50) .attr('dy', 0) .attr('font-size', 5) .attr('fill', '#aaa');//Â¢ûÂä† &lt;textPath&gt; ÂºïÁî® pathlinklabels.append('textPath') .attr('xlink:href', function (d, i) &#123; return '#linkpath' + i &#125;) .style("pointer-events", "none") .text(function (d, i) &#123; return 'BELONG'; &#125;); pointer-events ËÆæÁΩÆ‰∏∫ none Âàô‰∏çÂú®Êé•Êî∂Èº†Ê†á‰∫ã‰ª∂ÔºåËÆæÁΩÆ‰∏∫ all ÂàôÂú®ÊåáÈíàÂú®ÂÖÉÁ¥†‰∏≠ÊàñËæπÁºòÊó∂Êé•Êî∂Èº†Ê†á‰∫ã‰ª∂„ÄÇ ‰∏äËø∞‰ª£Á†ÅÂè™ÊòØÁ°Æ‰øù‰∫ÜÂàùÂßãÊó∂ÊñáÂ≠óÂú®ËøûÊé•Á∫øË∑ØÂæÑ‰∏äÔºåÊâÄ‰ª•ËøòÈúÄË¶ÅËÆæÁΩÆÂØπ‰∏äËø∞ÂÖÉÁ¥†ÁöÑÂùêÊ†áÊõ¥Êñ∞„ÄÇÂú® force.on() ‰∏≠Â¢ûÂä†Â¶Ç‰∏ã‰ª£Á†ÅÔºö 1234567891011121314151617linkpaths.attr('d', function (d) &#123; var path = 'M ' + d.source.x + ' ' + d.source.y + ' L ' + d.target.x + ' ' + d.target.y; return path&#125;); linklabels.attr('transform', function (d, i) &#123; if (d.target.x &lt; d.source.x) &#123; bbox = this.getBBox(); //Á°Æ‰øùÊñáÂ≠ó‰∏ç‰ºöÂÄíÁΩÆ rx = bbox.x + bbox.width / 2; ry = bbox.y + bbox.height / 2; return 'rotate(180 ' + rx + ' ' + ry + ')'; &#125; else &#123; return 'rotate(0)'; &#125;&#125;); Áº©ÊîæÂíåÊãñÂä® Ë¶ÅÂêåÊó∂ÊîØÊåÅÈº†Ê†áÁº©Êîæ‰ª•ÂèäÊãñÂä®ÔºåÂøÖÈ°ªÂ§ÑÁêÜËøô‰∏§ËÄÖÁöÑ‰∫ã‰ª∂ÂÜ≤Á™ÅÔºå‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 123456789101112131415161718192021var zoom = d3.behavior.zoom() .scaleExtent([1, 10]) .on("zoom", function zoomed() &#123; d3.select(this).attr("transform", "translate(" + d3.event.translate + ")scale(" + d3.event.scale + ")"); &#125;);svg.call(d3.behavior.zoom().on("zoom", redraw)) .append('g');force.drag() .on("dragstart", function (d) &#123; //Âú®ÊãñÂä®ËäÇÁÇπÁöÑÊó∂ÂÄôÈòªÊ≠¢‰∫ã‰ª∂ÂÜíÊ≥° d3.event.sourceEvent.stopPropagation(); &#125;);// Áº©Êîæ‰πãÂêéÈáçÁªòfunction redraw() &#123; svg.attr("transform", "translate(" + d3.event.translate + ")" + " scale(" + d3.event.scale + ")");&#125;function dragstart(d) &#123; d3.select(this).classed("fixed", d.fixed = true);&#125; g ÂÖÉÁ¥† ÊòØÁî®Êù•ÂàÜÁªÑÁî®ÁöÑÔºåÂÆÉËÉΩÊääÂ§ö‰∏™ÂÖÉÁ¥†ÊîæÂú®‰∏ÄÁªÑÈáåÔºåÂØπ Ê†áËÆ∞ÂÆûÊñΩÁöÑÊ†∑ÂºèÂíåÊ∏≤Êüì‰ºö‰ΩúÁî®Âà∞Ëøô‰∏™ÂàÜÁªÑÂÜÖÁöÑÊâÄÊúâÂÖÉÁ¥†‰∏ä„ÄÇÁªÑÂÜÖÁöÑÊâÄÊúâÂÖÉÁ¥†ÈÉΩ‰ºöÁªßÊâø Ê†áËÆ∞‰∏äÁöÑÊâÄÊúâÂ±ûÊÄß„ÄÇ fixed ËÆæÁΩÆ‰∏∫ true Êó∂ÔºåÈ°∂ÁÇπÂõ∫ÂÆö‰∏çÂä®„ÄÇ Êõ¥Êñ∞Êï∞ÊçÆ ÊúâÊó∂ÂÄôÈúÄË¶ÅÊõ¥Êñ∞Êï∞ÊçÆÔºåÊõ¥Êñ∞ÂêéÂäõÂØºÂêëÂõæ‰πü‰ºöË∑üÁùÄÂèòÂåñ„ÄÇÁî±‰∫é‰∏äËø∞ÁöÑÈÄâÊã©ÈõÜÈÄöËøá data() Â∞ÜÊï∞ÊçÆ‰∏éÂÖÉÁ¥†ËøõË°åÁªëÂÆöÔºåËÄåÁªëÂÆöÁöÑÊÉÖÂÜµÂàÜ‰∏∫‰ª•‰∏ã‰∏âÁßçÔºö * updateÔºöÊï∞ÁªÑÈïøÂ∫¶ = ÂÖÉÁ¥†Êï∞Èáè * enterÔºöÊï∞ÁªÑÈïøÂ∫¶ &gt; ÂÖÉÁ¥†Êï∞Èáè * exitÔºöÊï∞ÁªÑÈïøÂ∫¶ &lt; ÂÖÉÁ¥†Êï∞Èáè ÊâÄ‰ª•Âú®Êõ¥Êñ∞Êï∞ÊçÆÁöÑÊó∂ÂÄôÈúÄË¶ÅÂàÜÂà´ÂØπËøô‰∏âÁßçÊÉÖÂÜµËøõË°åÂ§ÑÁêÜÔºåÂØπ‰∫é enter ËøôÁßçÊ≤°ÊúâË∂≥Â§üÁöÑÂÖÉÁ¥†ÁöÑÂ§ÑÁêÜÂäûÊ≥ïÊòØÊ∑ªÂä†ÂÖÉÁ¥†ÔºåÂØπ‰∫é exit ËøôÁßçÂ≠òÂú®Â§ö‰ΩôÂÖÉÁ¥†ÁöÑÂ§ÑÁêÜÂäûÊ≥ïÊòØÂà†Èô§ÂÖÉÁ¥†ÔºåËÄåÂØπ‰∫é update ÂàôÊòØËøõË°åÂÜÖÂÆπ‰øÆÊîπ„ÄÇ ‰ª•ËäÇÁÇπÁöÑÊõ¥Êñ∞Êï∞ÊçÆ‰∏∫‰æãÔºö 1234567891011121314151617181920212223242526272829303132333435363738394041424344var node = svg.selectAll(".node") .data(nodes_data);//ËäÇÁÇπÊï∞ÊçÆÂÜÖÂÆπ‰øÆÊîπnode.attr("class", function (d) &#123; return "node " + d.label&#125;) .on("dblclick", dblclick) .attr("r", 25) .call(force.drag) .on("click", function (d) &#123; keys = d3.keys(d); delete_key = ["x", "y", "index", "weight", "px", "py", "fixed"]; info = []; for (var i = 0; i &lt; delete_key.length; i++) &#123; keys.removeByValue(delete_key[i]); &#125; for (var j = 0; j &lt; keys.length; j++) &#123; info.push(d[keys[j]]) &#125; showinfo(d.label, keys, info); &#125;);//Â¢ûÂä†‰∏çË∂≥ÁöÑÂÖÉÁ¥†node.enter() .append("circle") .attr("class", function (d) &#123; return "node " + d.label &#125;) .on("dblclick", dblclick) .attr("r", 25) .call(force.drag) .on("click", function (d) &#123; keys = d3.keys(d); delete_key = ["x", "y", "index", "weight", "px", "py", "fixed"]; info = []; for (var i = 0; i &lt; delete_key.length; i++) &#123; keys.removeByValue(delete_key[i]); &#125; for (var j = 0; j &lt; keys.length; j++) &#123; info.push(d[keys[j]]) &#125; showinfo(d.label, keys, info); &#125;);//Âà†Èô§Â§ö‰ΩôÂÖÉÁ¥†node.exit().remove(); ÂèÇËÄÉËµÑÊñô ÁêÜËß£ update, enter, exit ÁöÑ‰ΩøÁî®]]></content>
      <categories>
        <category>ÊùÇËÆ∞</category>
      </categories>
      <tags>
        <tag>Web</tag>
        <tag>d3.js</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python ‰∏ã Flask ÁªìÂêà Neo4j ÊûÑÂª∫ÁÆ°ÁêÜÁ≥ªÁªüÔºàÂõõÔºâ]]></title>
    <url>%2F2017%2F04%2F13%2FPython%E4%B8%8BFlask%E7%BB%93%E5%90%88Neo4j%E6%9E%84%E5%BB%BA%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%EF%BC%88%E5%9B%9B%EF%BC%89%2F</url>
    <content type="text"><![CDATA[Êï∞ÊçÆÁöÑÂ¢ûÂà†ÊîπÂäüËÉΩÂºïÂÖ•‰∫Ü bootstrap table Êèí‰ª∂ËøõË°åÊìç‰Ωú„ÄÇ #### bootstrap table ‰ΩøÁî® ÂºïÂÖ• Bootstrap Â∫ìÔºàÂÅáÂ¶Ç‰Ω†ÁöÑÈ°πÁõÆËøòÊ≤°Êúâ‰ΩøÁî®ÔºâÂíå bootstrap-table.css Âà∞ head Ê†áÁ≠æ‰∏ã„ÄÇ 12&lt;link rel="stylesheet" href="bootstrap.min.css"&gt;&lt;link rel="stylesheet" href="bootstrap-table.css"&gt; ÂºïÂÖ• jQuery Â∫ìÔºåbootstrap Â∫ìÔºàÂÅáÂ¶Ç‰Ω†ÁöÑÈ°πÁõÆËøòÊ≤°Êúâ‰ΩøÁî®ÔºâÂíå bootstrap-table.js Âà∞ head Ê†áÁ≠æ‰∏ãÊàñËÄÖÂú® body Ê†áÁ≠æÂÖ≥Èó≠‰πãÂâçÔºà‰∏ÄËà¨Âª∫ËÆÆËøô‰πàÂÅöÔºâ„ÄÇ 12345&lt;script src="jquery.min.js"&gt;&lt;/script&gt;&lt;script src="bootstrap.min.js"&gt;&lt;/script&gt;&lt;script src="bootstrap-table.js"&gt;&lt;/script&gt;&lt;-- put your locale files after bootstrap-table.js --&gt;&lt;script src="bootstrap-table-zh-CN.js"&gt;&lt;/script&gt; Ë°®Ê†ºÂàùÂßãÂåñ ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354var TableInit = function () &#123; var oTableInit = new Object(); //ÂàùÂßãÂåñTable oTableInit.Init = function () &#123; $('#ta_info').bootstrapTable(&#123; url: $SCRIPT_ROOT + "/search_table", //ËØ∑Ê±ÇÂêéÂè∞ÁöÑURLÔºà*Ôºâ method: 'get', //ËØ∑Ê±ÇÊñπÂºèÔºà*Ôºâ toolbar: '#toolbar', //Â∑•ÂÖ∑ÊåâÈíÆÁî®Âì™‰∏™ÂÆπÂô® striped: true, //ÊòØÂê¶ÊòæÁ§∫Ë°åÈó¥ÈöîËâ≤ cache: false, //ÊòØÂê¶‰ΩøÁî®ÁºìÂ≠òÔºåÈªòËÆ§‰∏∫trueÔºåÊâÄ‰ª•‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÈúÄË¶ÅËÆæÁΩÆ‰∏Ä‰∏ãËøô‰∏™Â±ûÊÄßÔºà*Ôºâ pagination: true, //ÊòØÂê¶ÊòæÁ§∫ÂàÜÈ°µÔºà*Ôºâ sortable: false, //ÊòØÂê¶ÂêØÁî®ÊéíÂ∫è sortOrder: "asc", //ÊéíÂ∫èÊñπÂºè queryParams: oTableInit.queryParams,//‰º†ÈÄíÂèÇÊï∞Ôºà*Ôºâ sidePagination: "server", //ÂàÜÈ°µÊñπÂºèÔºöclientÂÆ¢Êà∑Á´ØÂàÜÈ°µÔºåserverÊúçÂä°Á´ØÂàÜÈ°µÔºà*Ôºâ pageNumber: 1, //ÂàùÂßãÂåñÂä†ËΩΩÁ¨¨‰∏ÄÈ°µÔºåÈªòËÆ§Á¨¨‰∏ÄÈ°µ pageSize: 10, //ÊØèÈ°µÁöÑËÆ∞ÂΩïË°åÊï∞Ôºà*Ôºâ pageList: [10, 25, 50, 100], //ÂèØ‰æõÈÄâÊã©ÁöÑÊØèÈ°µÁöÑË°åÊï∞Ôºà*Ôºâ search: false, //ÊòØÂê¶ÊòæÁ§∫Ë°®Ê†ºÊêúÁ¥¢ÔºåÊ≠§ÊêúÁ¥¢ÊòØÂÆ¢Êà∑Á´ØÊêúÁ¥¢Ôºå‰∏ç‰ºöËøõÊúçÂä°Á´ØÔºåÊâÄ‰ª•Ôºå‰∏™‰∫∫ÊÑüËßâÊÑè‰πâ‰∏çÂ§ß strictSearch: false, showColumns: true, //ÊòØÂê¶ÊòæÁ§∫ÊâÄÊúâÁöÑÂàó showRefresh: true, //ÊòØÂê¶ÊòæÁ§∫Âà∑Êñ∞ÊåâÈíÆ minimumCountColumns: 2, //ÊúÄÂ∞ëÂÖÅËÆ∏ÁöÑÂàóÊï∞ clickToSelect: true, //ÊòØÂê¶ÂêØÁî®ÁÇπÂáªÈÄâ‰∏≠Ë°å height: 500, //Ë°åÈ´òÔºåÂ¶ÇÊûúÊ≤°ÊúâËÆæÁΩÆheightÂ±ûÊÄßÔºåË°®Ê†ºËá™Âä®Ê†πÊçÆËÆ∞ÂΩïÊù°Êï∞ËßâÂæóË°®Ê†ºÈ´òÂ∫¶ uniqueId: "ID", //ÊØè‰∏ÄË°åÁöÑÂîØ‰∏ÄÊ†áËØÜÔºå‰∏ÄËà¨‰∏∫‰∏ªÈîÆÂàó showToggle: true, //ÊòØÂê¶ÊòæÁ§∫ËØ¶ÁªÜËßÜÂõæÂíåÂàóË°®ËßÜÂõæÁöÑÂàáÊç¢ÊåâÈíÆ cardView: false, //ÊòØÂê¶ÊòæÁ§∫ËØ¶ÁªÜËßÜÂõæ detailView: false, //ÊòØÂê¶ÊòæÁ§∫Áà∂Â≠êË°® columns: [&#123; checkbox: true &#125;, &#123; field: 'name', title: '‰ø°ÊÅØÂêç' &#125;, &#123; field: 'label', title: 'Á±ªÂà´' &#125;] &#125;); &#125;; //ÂæóÂà∞Êü•ËØ¢ÁöÑÂèÇÊï∞ oTableInit.queryParams = function (params) &#123; var temp = &#123; //ËøôÈáåÁöÑÈîÆÁöÑÂêçÂ≠óÂíåÊéßÂà∂Âô®ÁöÑÂèòÈáèÂêçÂøÖÈ°ª‰∏ÄÁõ¥ÔºåËøôËæπÊîπÂä®ÔºåÊéßÂà∂Âô®‰πüÈúÄË¶ÅÊîπÊàê‰∏ÄÊ†∑ÁöÑ limit: params.limit, //È°µÈù¢Â§ßÂ∞è offset: params.offset, //È°µÁ†Å q: $("#search_table").find("input[name=condition]").val() &#125;; return temp; &#125;; return oTableInit;&#125;; ÊúçÂä°Âô®ÂàÜÈ°µ ÂêéÁ´Ø‰ª£Á†ÅÔºö 123456789101112@app.route('/search_table')def search_table(): try: q = request.args.get('q', 0) limit = request.args.get('limit', 1) offset = request.args.get('offset', 2) except KeyError: return [] else: user = User(session.get("username")) results = user.search_table(q, limit, offset) return results 1234567891011121314151617def search_table(self, condition, limit, offset): nodes = [] act_nodes = [] query = "MATCH (m) WHERE m.name CONTAINS \'" + condition + \ "\' and (labels(m)='Sort' or labels(m)='GOODS' or labels(m)='Website') RETURN m, labels(m)" results = graph.run(query) for result, label in results: node = &#123;&#125; node["name"] = result.get("name") node["label"] = label[0] nodes.append(node) total = len(nodes) for i in range(int(offset), int(offset) + int(limit)): if i &gt;= len(nodes): break act_nodes.append(nodes[i]) return jsonify(&#123;'total': total, 'rows': act_nodes&#125;) ÊúçÂä°Âô®ÂàÜÈ°µÂøÖÈ°ªËøîÂõû total Âíå rows ‰∏§‰∏™ÂèÇÊï∞ÔºåÂâçËÄÖ‰ª£Ë°®Êü•ËØ¢Êï∞ÊçÆÁöÑÊÄªÈïøÂ∫¶ÔºåÂêéËÄÖËøîÂõûËØ•È°µÂ∫îËØ•ÊòæÁ§∫ÁöÑÊï∞ÊçÆ„ÄÇ Â¢ûÂà†Êîπ ‰ª•Â¢ûÂä†Êï∞ÊçÆ‰∏∫‰æãÔºö Áî±‰∫é Neo4j ‰∏≠ÁöÑÊï∞ÊçÆ‰∏çÊòØÁªìÊûÑÊÄßÊï∞ÊçÆÔºåÊâÄ‰ª•Â¢ûÂä†Êï∞ÊçÆÁöÑÂü∫Êú¨ÊÄùË∑ØÊòØÁî±Áî®Êà∑ÈÄâÊã©Áà∂ËäÇÁÇπÔºåÁÑ∂ÂêéÂêëÁà∂ËäÇÁÇπÂ¢ûÂä†Â≠êËäÇÁÇπÔºåÂ¢ûÂä†Â≠êËäÇÁÇπÁöÑËøáÁ®ã‰∏≠ÂøÖÈ°ªÂ°´ÂÖ•Â≠êËäÇÁÇπÁöÑ ÂêçÂ≠óÔºåÁ±ªÂà´‰ª•ÂèäÂíåÁà∂ËäÇÁÇπÁöÑÂÖ≥Á≥ªÂ±ûÊÄßÔºåÂ¶ÇÊûúÂ≠êËäÇÁÇπËøòÊúâÂÖ∂ÂÆÉÂ±ûÊÄßÔºåÂàôÂèØ‰ª•ÁÇπÂáªÂ¢ûÂä†Ë°åËøõË°åÈ¢ùÂ§ñÂ±ûÊÄßÁöÑÂ¢ûÂä†„ÄÇ ÂâçÁ´Ø‰ª£Á†ÅÔºö 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980$('#btn_add').click(function () &#123; var father_node = $("#ta_info").bootstrapTable('getSelections'); if (father_node == "") &#123; alert("ËØ∑ÈÄâÊã©ÊèíÂÖ•ÂÖÉÁ¥†ÁöÑÁà∂ËäÇÁÇπ") &#125; else if (father_node.length &gt; 1) &#123; alert("Áà∂ËäÇÁÇπÂè™ÂÖÅËÆ∏‰∏Ä‰∏™") &#125; else &#123; if ($('.added-row').length &gt; 0) $('.added-row').remove(); $('#insertModal_body').find("input[name=name]").val(""); $('#insertModal_body').find("input[name=label]").val(""); $('#insertModal_body').find("input[name=relation]").val(""); $('#insertModal').modal() &#125; return false&#125;);$('#add_row').click(function () &#123; var modal_body = document.getElementById("insertModal_body"); var row_div = document.createElement("div"); var row_label = document.createElement("input"); var row_text = document.createElement("input"); row_div.setAttribute("class", "input-data form-inline added-row"); row_label.setAttribute("class", "extra-label form-control"); row_label.setAttribute("type", "text"); row_label.setAttribute("placeholder", "Â±ûÊÄßÂêç"); row_label.setAttribute("name", "attr"); row_text.setAttribute("class", "extra-text form-control"); row_text.setAttribute("placeholder", "Â±ûÊÄß"); row_text.setAttribute("type", "text"); row_div.appendChild(row_label); row_div.appendChild(row_text); modal_body.appendChild(row_div);&#125;);$('#insert_btn').click(function () &#123; var data = &#123;&#125;; var father_node = $("#ta_info").bootstrapTable('getSelections'); var insertModal = $('#insertModal_body'); var fa_name = father_node[0]["name"]; var fa_label = father_node[0]['label']; var child_name = insertModal.find("input[name=name]").val(); var child_label = insertModal.find("input[name=label]").val(); var relation = insertModal.find("input[name=relation]").val(); var child_attrs_label = $('.extra-label'); var child_attrs = $('.extra-text'); data['fa_name'] = fa_name; data['fa_label'] = fa_label; data['name'] = child_name; data['label'] = child_label; data['relation'] = relation; if (child_name == "" || child_label == "" || relation == "") &#123; alert("ËØ∑Â°´ÂÜôÂøÖË¶Å‰ø°ÊÅØ"); return false; &#125; else if (fa_name == child_name) &#123; alert("‰∏çÂèØ‰∏éÁà∂ËäÇÁÇπÂêçÁß∞Áõ∏Âêå"); return false; &#125; if (child_attrs.length &gt; 0) &#123; console.log(1); for (var i = 0; i &lt; child_attrs.length; i++) &#123; data[child_attrs_label[i].value] = child_attrs[i].value; &#125; &#125; data = JSON.stringify(data); $.ajax(&#123; url: "/insert", type: 'POST', data: data, contentType: 'application/json; charset=UTF-8', success: function (msg) &#123; if (msg == "ÊèíÂÖ•ÊàêÂäü") &#123; $('#insertModal').modal('hide'); $("#ta_info").bootstrapTable('refresh'); &#125; alert(msg); &#125; &#125;)&#125;); ÂêéÁ´Ø‰ª£Á†ÅÔºö 1234567891011121314151617181920@app.route('/insert', methods=['POST'])def get_insert(): try: data = request.get_json() except KeyError: return [] else: user = User(session.get("username")) start_node = &#123;&#125; end_node = &#123;&#125; start_node['name'] = data['fa_name'] start_node['label'] = data['fa_label'] relation = data['relation'] data.pop('fa_name') data.pop('fa_label') data.pop('relation') for key in data.keys(): end_node[key] = data[key] results = user.insert_table(start_node, relation, end_node) return results 123456789101112131415161718192021def insert_table(self, start_node, relation, end_node): end_node_label = end_node['label'] end_node.pop("label") data = "" for key in end_node.keys(): data += key + ":" + "\'" + end_node[key] + "\'" + "," data = data.strip(",") check_query = "MATCH (m) WHERE m.username=\'" + end_node['name'] \ + "\' and labels(m)=\'" + end_node_label + "\' RETURN m" insert_query = "MATCH (m) WHERE m.name=\'" + start_node['name'] \ + "\' and labels(m)=\'" + start_node['label'] + \ "\' CREATE (n:" + end_node_label + "" + "&#123;" + data + "&#125;)&lt;-" + \ "[:" + relation + "]-(m) RETURN n" check_result = graph.run(check_query) if check_result.forward(): return "Â∑≤ÁªèÂ≠òÂú®Ê≠§ËäÇÁÇπ" print(insert_query) insert_result = graph.run(insert_query) if insert_result.forward(): return "ÊèíÂÖ•ÊàêÂäü" return "ÊèíÂÖ•Â§±Ë¥•" ÊÄªÁªì Âà©Áî® Neo4j ÁªìÂêà Flask ÊûÑÂª∫ Web Â∫îÁî®ÁöÑÂÖ≥ÈîÆÂú®‰∫éÂ¶Ç‰ΩïÂâçÁ´ØÂíåÂêéÁ´ØÂ¶Ç‰ΩïËøõË°åÊï∞ÊçÆ‰∫§‰∫íÔºåFlask ÂèØ‰ª•ÂæàÊñπ‰æøÁöÑÈÄöËøá jsonify() ÊñπÊ≥ïËøîÂõû Json Êï∞ÊçÆÔºåÊâÄ‰ª•Âú®ÊûÑÂª∫Â∫îÁî®ÁöÑËøáÁ®ã‰∏≠ÂèØ‰ª•Â∞ΩÂèØËÉΩ‰ΩøÁî® ajax ÂêëÂêéÁ´ØÂèëÈÄÅ JsonÊ†ºÂºèÊï∞ÊçÆ„ÄÇ ÂèÇËÄÉËµÑÊñô Bootstrap Table]]></content>
      <categories>
        <category>PythonÂÆûÊàò</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Flask</tag>
        <tag>Neo4j</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python ‰∏ã Flask ÁªìÂêà Neo4j ÊûÑÂª∫ÁÆ°ÁêÜÁ≥ªÁªüÔºà‰∏âÔºâ]]></title>
    <url>%2F2017%2F04%2F13%2FPython%E4%B8%8BFlask%E7%BB%93%E5%90%88Neo4j%E6%9E%84%E5%BB%BA%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%EF%BC%88%E4%B8%89%EF%BC%89%2F</url>
    <content type="text"><![CDATA[ÈúÄÊ±Ç Ê†∏ÂøÉÈúÄÊ±ÇÂ¶Ç‰∏ãÔºö * ÁÆ°ÁêÜÁ≥ªÁªüÁôªÂΩï * ‰ªé Neo4j ‰∏≠Ëé∑ÂèñÊï∞ÊçÆ‰ø°ÊÅØÂõæÂΩ¢ÂåñÊòæÁ§∫Âá∫Êù• * ËäÇÁÇπÁöÑÂÖ≥Á≥ªÊü•ËØ¢ÂèäÊ∫ØÊ∫êÊü•ËØ¢ * ÂØπ Neo4j ËøõË°åËäÇÁÇπÁöÑÂ¢ûÂà†Êîπ ÁÆ°ÁêÜÁ≥ªÁªüÁôªÂΩï È¶ñÂÖàÈúÄË¶ÅÂú®Â∑•Á®ãÁõÆÂΩï‰∏ãÂàõÂª∫ login.html Âíå models.pyÔºåÂâçËÄÖ‰∏∫ÁôªÂΩïÁïåÈù¢Áî®‰∫éÊµãËØï‰∏é Neo4j ÁöÑËøûÊé•ÔºåÂêéËÄÖÊòØ‰∏Ä‰∏™Áî®Êà∑Á±ªÁî®‰∫éÂ§ÑÁêÜÁî®Êà∑ÁöÑÂêÑÈ°πÊìç‰Ωú„ÄÇ Êú¨Ê¨°ËøûÊé•ÈááÁî®‰∫Ü Py2neo v3 Â∫ìÔºåÂÆâË£ÖÂèØ‰ª•ÈÄöËøá pip ÂÆâË£ÖÔºöpip install py2neo ÂÆâË£ÖÊàêÂäü‰πãÂêéÂú® models.py Êñá‰ª∂ËæìÂÖ•Â¶Ç‰∏ã‰ª£Á†ÅÔºö 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152from passlib.handlers import bcryptfrom py2neo import authenticate, Graph, Nodeauthenticate("localhost:7474", "neo4j", "yy0758jyl")graph = Graph()class User: def __init__(self, username): self.username = username user_data = self.find() #Ëé∑ÂèñÁôªÂΩïÁî®Êà∑Ê†áÁ≠æ if user_data: self.label = user_data['label'] else: self.label = "User" def find(self): user = &#123;&#125; data_user = graph.find_one("User", "username", self.username) if not data_user: data_admin = graph.find_one("Admin", "username", self.username) if not data_admin: return False else: print(user) user['username'] = data_admin['username'] user['password'] = data_admin['password'] user['label'] = 'Admin' else: user['username'] = data_user['username'] user['password'] = data_user['password'] user['label'] = 'User' return user def register(self, password): if not self.find(): user = Node("User", username=self.username, password=bcrypt.encrypt(password)) graph.create(user) cypher = 'MATCH (admin:Admin) MATCH(user:User &#123;username:\'' + self.username + '\'&#125;) CREATE (admin)-[manage:Manage]-&gt;(user)' graph.run( 'MATCH (admin:Admin) MATCH(user:User &#123;username:\'' + self.username + '\'&#125;) CREATE (admin)-[manage:Manage]-&gt;(user)') return True else: return False def verify_pass(self, password): user = self.find() if not user: return False else: return bcrypt.verify(password, user["password"]) authenticate() Áî®‰∫éËøûÊé• Neo4j Êï∞ÊçÆÂ∫ìÔºå‰∏â‰∏™ÂèÇÊï∞‰æùÊ¨°ÊòØÂú∞ÂùÄÔºåÁî®Êà∑ÂêçÔºåÂØÜÁ†Å„ÄÇ find(self) Áî®Êà∑Êü•ÊâæÁî®Êà∑„ÄÇ register(self, password) Ê≥®ÂÜåÁî®Êà∑„ÄÇ verify_pass(self, password) ÁôªÂΩïÈ™åËØÅ„ÄÇ app.py ‰ª£Á†ÅÔºö 1234567891011121314151617181920212223242526272829303132app = Flask(__name__)app.secret_key = 'sugarsugar'@app.route('/', methods=["GET", "POST"])def index(): if request.method == "POST": if "registeruser" in request.form: username = request.form['registeruser'] password = request.form['password'] if not username or not password: flash('ËØ∑ËæìÂÖ•Áî®Êà∑ÂêçÂíåÂØÜÁ†Å') else: user = User(username) print(user) if not user.register(password): flash('‰∏Ä‰∏™Áî®Êà∑Â∑≤ÁªèÂ≠òÂú®') else: flash('Ê≥®ÂÜåÊàêÂäü') else: username = request.form['username'] password = request.form['password'] user = User(username) if not username or not password: flash('ËØ∑ËæìÂÖ•Áî®Êà∑ÂêçÂíåÂØÜÁ†Å') elif not user.verify_pass(password): flash('Êó†ÊïàÁôªÂΩï') else: session["username"] = user.username session['label'] = user.label return redirect(url_for("main_view")) return render_template('login.html') app.secret_key Áî±‰∫é‰ΩøÁî®‰∫Ü Session ÊâÄ‰ª•ÂøÖÈ°ªË¶ÅËÆæÁΩÆËØ•È°πÂÄº„ÄÇ flash() Áî®‰∫éÂêëÁΩëÈ°µÂèëÈÄÅ‰ø°ÊÅØ„ÄÇ Êï∞ÊçÆÊü•ËØ¢ Âú®ÊµãËØïÂÆåÁôªÂΩïÂäüËÉΩ‰πãÂêéÔºåÈ¶ñÂÖàÂú® templates Êñá‰ª∂Â§π‰∏ãÂàõÂª∫ view.html Êñá‰ª∂Ôºå‰Ωú‰∏∫ÁôªÂΩïÂêéË∑≥ËΩ¨ÁöÑÈ°µÈù¢Ôºö ÊâßË°åÊü•ËØ¢ÂêéÁõ∏Â∫îÁöÑÂâçÁ´Ø‰ª£Á†ÅÔºö 1234567891011121314151617181920212223$(document).ready(function () &#123; function search() &#123; var query = $("#search").find("input[name=condition]").val(); var flag = $("#search").find("input[name=trace]").prop('checked'); if(flag == true &amp;&amp; query == "ebay") &#123; alert("‰∏çÂèØ‰∏∫Ê†πËäÇÁÇπ"); return false; &#125; $.get("/search" , &#123;q: query, f : flag&#125;, function (data) &#123; if(data.nodes.length &gt; 0)&#123; update(data.nodes, data.links); update_static(data.nodes); &#125; else alert("Êü•ËØ¢ÁªìÊûú‰∏∫Á©∫"); &#125;, "json"); return false; &#125; $("#search").submit(search); search();&#125;); ÂêéÂè∞Â§ÑÁêÜ‰ª£Á†ÅÔºö app.py ‰ª£Á†ÅÔºö 1234567891011@app.route('/search')def get_search(): try: q = request.args.get('q', 0) f = request.args.get('f', 1) except KeyError: return [] else: user = User(session.get("username")) results = user.search_graph(q, f) return results models.py ‰ª£Á†ÅÔºö 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667def search_graph(self, condition, flag=False): nodes = [] rels = [] i = 0 #ÂÖ≥Á≥ªÊü•ËØ¢ query = "MATCH (m)&lt;-[:BELONG]-(a) WHERE m.name CONTAINS \'" + condition + "\' or a.name CONTAINS \'" + condition + \ "\' RETURN properties(m) as start_node, labels(m) as labels, " \ "collect(properties(a)) as cast,collect(labels(a)) as cast_labels" #Ê∫ØÊ∫êÊü•ËØ¢ query_trace = "Match (n) WHERE n.name contains \'" + condition + \ "\' MATCH path = shortestPath( (m:Website)-[:BELONG*..5]-(n) )" \ " where labels(n)='Sort' or labels(n)='GOODS'" \ " RETURN nodes(path) AS nodes, EXTRACT(node IN nodes(path) | ID(node)) AS ids " \ ",EXTRACT(node IN nodes(path) | labels(node)) AS labels" results = graph.run(query) if flag == "true" and condition: nodes_act = [] rels_act = [] for node_trace, id_trace, label_trace in graph.run(query_trace): j = 0 for node_ori in node_trace: node_act = &#123;&#125; node_keys = list(node_ori.keys()) for key in node_keys: node_act[key] = node_ori.get(key) node_act['label'] = label_trace[j][0] try: target_act = nodes_act.index(node_act) j += 1 except ValueError: target_act = len(nodes_act) nodes_act.append(node_act) j += 1 if j &lt; len(node_trace): try: source_act = nodes_act.index(self.get_node(node_trace[j], label_trace[j])) except ValueError: source_act = len(nodes_act) rels_act.append(&#123;"source": source_act, "target": target_act&#125;) return jsonify(&#123;"nodes": nodes_act, "links": rels_act&#125;) for start_nodes, start_labels, end_nodes, end_labels in results: keys = list(start_nodes.keys()) node = &#123;&#125; for key in keys: node[key] = start_nodes.get(key) node['label'] = start_labels[0] try: target = nodes.index(node) except ValueError: nodes.append(node) target = i i += 1 for end_node, label in zip(end_nodes, end_labels): end_keys = list(end_node.keys()) end = &#123;&#125; for key in end_keys: end[key] = end_node.get(key) end['label'] = label[0] try: source = nodes.index(end) except ValueError: nodes.append(end) source = i i += 1 rels.append(&#123;"source": source, "target": target&#125;) return jsonify(&#123;"nodes": nodes, "links": rels&#125;) Êï∞ÊçÆÁöÑÂèØËßÜÂåñÈááÁî® d3.jsÔºåÂÖ∑‰ΩìËøáÁ®ãÂèÇËÄÉd3.js ÁªòÂà∂ÂäõÂØºÂêëÂõæÔºåËøîÂõûÁöÑÊï∞ÊçÆÊ†ºÂºèÈôêÂÆö‰∏∫ Json Ê†ºÂºèÔºånodes ‰øùÂ≠òËäÇÁÇπ‰ø°ÊÅØÔºålinks ‰øùÂ≠òËäÇÁÇπÂÖ≥Á≥ªÔºö 12&#123;&quot;nodes&quot;: [&#123;&apos;label&apos;: &apos;Website&apos;, &apos;name&apos;: &apos;ebay&apos;&#125;, &#123;&apos;label&apos;: &apos;Sort&apos;, &apos;name&apos;: &apos;Health &amp; Beauty&apos;&#125;, &#123;&apos;label&apos;: &apos;Sort&apos;, &apos;name&apos;: &apos;Musical Instruments &amp; Gear&apos;&#125;], &quot;links&quot;:[&#123;&apos;target&apos;: 0, &apos;source&apos;: 1&#125;, &#123;&apos;target&apos;: 0, &apos;source&apos;: 2&#125;]&#125; Êü•ËØ¢ÊïàÊûúÔºö ÂèÇËÄÉËµÑÊñô Py2neo v3 Handbook]]></content>
      <categories>
        <category>PythonÂÆûÊàò</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Flask</tag>
        <tag>Neo4j</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python ‰∏ã Flask ÁªìÂêà Neo4j ÊûÑÂª∫ÁÆ°ÁêÜÁ≥ªÁªüÔºà‰∫åÔºâ]]></title>
    <url>%2F2017%2F04%2F12%2FPython%E4%B8%8BFlask%E7%BB%93%E5%90%88Neo4j%E6%9E%84%E5%BB%BA%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%EF%BC%88%E4%BA%8C%EF%BC%89%2F</url>
    <content type="text"><![CDATA[Neo4j ÁÆÄ‰ªã Neo4j ÊòØ‰∏Ä‰∏™È´òÊÄßËÉΩÁöÑÔºåNOSQL ÂõæÂΩ¢Êï∞ÊçÆÂ∫ìÔºåÂÆÉÂ∞ÜÁªìÊûÑÂåñÊï∞ÊçÆÂ≠òÂÇ®Âú®ÁΩëÁªú‰∏äËÄå‰∏çÊòØË°®‰∏≠„ÄÇÂÆÉÊòØ‰∏Ä‰∏™ÂµåÂÖ•ÂºèÁöÑ„ÄÅÂü∫‰∫éÁ£ÅÁõòÁöÑ„ÄÅÂÖ∑Â§áÂÆåÂÖ®ÁöÑ‰∫ãÂä°ÁâπÊÄßÁöÑ Java ÊåÅ‰πÖÂåñÂºïÊìéÔºå‰ΩÜÊòØÂÆÉÂ∞ÜÁªìÊûÑÂåñÊï∞ÊçÆÂ≠òÂÇ®Âú®ÁΩëÁªú(‰ªéÊï∞Â≠¶ËßíÂ∫¶Âè´ÂÅöÂõæ)‰∏äËÄå‰∏çÊòØË°®‰∏≠„ÄÇ ÂÆâË£Ö ËøõÂÖ•Neo4j ‰∏ãËΩΩÂú∞ÂùÄÈÄâÊã©Á§æÂå∫ÁâàËøõË°å‰∏ãËΩΩÂÆâË£Ö„ÄÇ ‰ΩøÁî® Neo4j Êèê‰æõ‰∫Ü Cypher Êü•ËØ¢ËØ≠Ë®ÄÂØπÊï∞ÊçÆÂ∫ìÊï∞ÊçÆËøõË°åÊìç‰ΩúÔºåÂú®‰ΩøÁî® Neo4j ‰πãÂâçÂøÖÈ°ªÂÖà‰∫ÜËß£ CypherÔºåÂèØ‰ª•ÂèÇËÄÉÂÆòÊñπÊèê‰æõ‰∫Ü‰∏Ä‰∫õ‰æãÁ®ãÂíåÂºÄÂèëÊñáÊ°£Ôºö Intro to Cypher The Neo4j Developer Manual v3.1 Á¨¨‰∏Ä‰∏™‰ªãÁªç‰∫Ü Cypher ÁöÑ‰∏Ä‰∫õÂü∫Êú¨Ê¶ÇÂøµÊñπ‰æøÂéªÁêÜËß£ Cypher ËØ≠Ë®ÄÔºåÁ¨¨‰∫å‰∏™ÂàôÊòØ‰∏Ä‰ªΩÂºÄÂèëËÄÖÊñáÊ°£ÔºåËØ¶ÁªÜ‰ªãÁªç‰∫ÜÂêÑÊìç‰ΩúÁöÑÂê´‰πâ‰ª•Âèä‰∏Ä‰∫õÁ§∫‰æãËØ≠Âè•„ÄÇ Âú®‰∫ÜËß£ Cypher ÂêéÔºåÂ∞±ÂèØ‰ª•Âà©Áî® Neo4j ÊéßÂà∂Âè∞ÂÅö‰∏Ä‰∫õÂü∫Êú¨ÁöÑÊü•ËØ¢ÊµãËØïÔºö * È¶ñÂÖàÈúÄË¶ÅÂºÄÂêØÊúçÂä°Âô®Ôºö * Âú®ÂºÄÂêØÊúçÂä°Âô®ÂêéËøõÂÖ• http://localhost:7474 Á¨¨‰∏ÄÊ¨°ËøõÂÖ•ÈúÄË¶ÅËÆæÁΩÆÂØÜÁ†Å * Âú®‰∏ªÁïåÈù¢‰∏≠ÈÄâÊã© Jump into codeÔºå‰πãÂêéÈÄâÊã© Movie Graph ‰∏≠ÁöÑ Create a graphÔºåÂàôÂèØ‰ª•ÁúãÂà∞‰∏Ä‰∏™ Neo4j ÂÆòÊñπÊèê‰æõÁöÑÊûÑÈÄ†Êï∞ÊçÆÂõæÁöÑ‰ª£Á†ÅÔºåÁÇπÂáª‰πãÂêéËøêË°åÂç≥ÂèØ„ÄÇ Âú®ÂàõÂª∫‰∫ÜÊï∞ÊçÆÂõæ‰πãÂêéÔºåÁÇπÂáªÂ∑¶‰æßÁöÑÁ¨¨‰∏Ä‰∏™ÂØºËà™Ê†èÔºåÂèØ‰ª•ÁúãËßÅÊï∞ÊçÆÂõæÁöÑÂêÑÈ°π‰ø°ÊÅØ„ÄÇ Êü•ËØ¢ ËøôÈáå‰ª•Êü•ËØ¢ËäÇÁÇπ name Â±ûÊÄß‰∏∫ Audrey Tautou Âà∞ËäÇÁÇπ title Â±ûÊÄß‰∏∫ As Good as It Gets ‰∏îËäÇÁÇπÂÖ≥Á≥ª‰∏∫ ACTED_IN Èó¥Èöî‰∏çË∂ÖËøá 5 ÁöÑÊúÄÁü≠Ë∑ØÂæÑ‰∏∫‰æãÔºåÂú®ËæìÂÖ•Ê°Ü‰∏≠ËæìÂÖ•Â¶Ç‰∏ã‰ª£Á†ÅÔºö 1234MATCH (you &#123;name:&quot;Audrey Tautou&quot;&#125;)MATCH (expert &#123;title:&quot;As Good as It Gets&quot;&#125;)MATCH path = shortestPath( (you)-[:ACTED_IN*..5]-(expert) )RETURN path ËøêË°å‰πãÂêéÁªìÊûúÂ¶Ç‰∏ãÔºö]]></content>
      <categories>
        <category>PythonÂÆûÊàò</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Neo4j</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python ‰∏ã Flask ÁªìÂêà Neo4j ÊûÑÂª∫ÁÆ°ÁêÜÁ≥ªÁªüÔºà‰∏ÄÔºâ]]></title>
    <url>%2F2017%2F04%2F09%2FPython%E4%B8%8BFlask%E7%BB%93%E5%90%88Neo4j%E6%9E%84%E5%BB%BA%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%EF%BC%88%E4%B8%80%EF%BC%89%2F</url>
    <content type="text"><![CDATA[ÁÆÄ‰ªã Flask ÊòØ‰∏Ä‰∏™‰ΩøÁî® Python ÁºñÂÜôÁöÑËΩªÈáèÁ∫ß Web Â∫îÁî®Ê°ÜÊû∂„ÄÇÂÖ∂ WSGI Â∑•ÂÖ∑ÁÆ±ÈááÁî® Werkzeug ÔºåÊ®°ÊùøÂºïÊìéÂàô‰ΩøÁî® Jinja2 „ÄÇ ÂÆâË£Ö Âú®ÁªàÁ´Ø‰∏≠ËæìÂÖ• sudo pip install Flask Âç≥ÂèØËøõË°åÂÆâË£ÖÔºàÂ¶ÇÊûú‰∏çÊÉ≥ËøõË°åÂÖ®Â±ÄÂÆâË£ÖÔºåËØ∑ÂèÇËÄÉÂÆòÊñπÊñáÊ°£Ôºâ„ÄÇ ÂàõÂª∫Êñá‰ª∂Â§π È¶ñÂÖàÈúÄË¶ÅÂàõÂª∫Â¶Ç‰∏ãÁªìÊûÑÁöÑÊñá‰ª∂Â§πÔºö 123/flaskr /static /templates flaskr ÊòØÂ∑•Á®ãÊñá‰ª∂Â§πÂêç static ÊòØÁî®‰∫éÊîæÁΩÆ css Âíå javascript Êñá‰ª∂ÁöÑÊñá‰ª∂Â§π templates ÊòØÊîæÁΩÆÁΩëÈ°µÊ®°ÊùøÁöÑÊñá‰ª∂Â§π Â¶ÇÊûúÁî® PyCharm ÂºÄÂèëÔºåÂú®ÂàõÂª∫ templates Êñá‰ª∂Â§πÂêéÈúÄË¶ÅÊåâ‰ΩèÂø´Êç∑ÈîÆ Command + , Âú® Project‚ÜíProject StructureÔºåÈÄâÊã© templates Êñá‰ª∂Â§πÂêéÁÇπÂáª Mark as ‰∏≠ÁöÑ Templates ÊµãËØï Âú® flaskr ÁõÆÂΩï‰∏ãÂàõÂª∫ app.py ÁöÑÊñá‰ª∂ÔºåËæìÂÖ•Â¶Ç‰∏ã‰ª£Á†ÅÔºö 123456789from flask import Flaskapp = Flask(__name__)@app.route('/')def hello_world(): return 'Hello World!'if __name__ == '__main__': app.run() app = Flask(__name__) ÂàõÂª∫‰∏Ä‰∏™ËØ•Á±ªÁöÑÂÆû‰æãÔºåÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞ÊòØÂ∫îÁî®Ê®°ÂùóÊàñËÄÖÂåÖÁöÑÂêçÁß∞„ÄÇ Â¶ÇÊûú‰Ω†‰ΩøÁî®Âçï‰∏ÄÁöÑÊ®°ÂùóÔºàÂ¶ÇÊú¨‰æãÔºâÔºå‰Ω†Â∫îËØ•‰ΩøÁî® name ÔºåÂõ†‰∏∫Ê®°ÂùóÁöÑÂêçÁß∞Â∞Ü‰ºöÂõ†ÂÖ∂‰Ωú‰∏∫ÂçïÁã¨Â∫îÁî®ÂêØÂä®ËøòÊòØ‰Ωú‰∏∫Ê®°ÂùóÂØºÂÖ•ËÄåÊúâ‰∏çÂêåÔºà ‰πüÂç≥ÊòØ 'main' ÊàñÂÆûÈôÖÁöÑÂØºÂÖ•ÂêçÔºâ„ÄÇËøôÊòØÂøÖÈ°ªÁöÑÔºåËøôÊ†∑ Flask ÊâçÁü•ÈÅìÂà∞Âì™ÂéªÊâæÊ®°Êùø„ÄÅÈùôÊÄÅÊñá‰ª∂Á≠âÁ≠â„ÄÇ __name__ ÊåáÂΩìÂâçÁöÑÊ®°ÂùóÂêçÔºåÂΩìÊ®°ÂùóÁõ¥Êé•ËøêË°åÊó∂Ôºå__name__ ‰∏∫ __main__ÔºåÂΩìÊ®°ÂùóË¢´ÂØºÂÖ•ËøêË°åÊó∂Ôºå__name__ ‰∏∫Ê®°ÂùóÂêçÂ≠ó„ÄÇ route() Ë£ÖÈ•∞Âô®ÂëäËØâ Flask ‰ªÄ‰πàÊ†∑ÁöÑURL ËÉΩËß¶ÂèëÊàë‰ª¨ÁöÑÂáΩÊï∞ÔºåÂáΩÊï∞ÁöÑÂêçÂ≠ó‰πüÂú®ÁîüÊàê URL Êó∂Ë¢´ÁâπÂÆöÁöÑÂáΩÊï∞ÈááÁî®ÔºåËøô‰∏™ÂáΩÊï∞ËøîÂõûÊàë‰ª¨ÊÉ≥Ë¶ÅÊòæÁ§∫Âú®Áî®Êà∑ÊµèËßàÂô®‰∏≠ÁöÑ‰ø°ÊÅØ„ÄÇ ËøêË°åÁªìÊûú ËøêË°å‰πãÂêéËøõÂÖ• http://localhost:5000 ÂèØ‰ª•ÁúãÂà∞Â¶Ç‰∏ãÁªìÊûúÔºö ÂèÇËÄÉËµÑÊñô Flask ÊñáÊ°£]]></content>
      <categories>
        <category>PythonÂÆûÊàò</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Flask</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python ‰∏ãÁî® Scrapy ÈááÈõÜÁü•ÁΩëÊúüÂàäÊï∞ÊçÆÔºàÂõõÔºâ]]></title>
    <url>%2F2017%2F04%2F08%2FPython%E4%B8%8B%E7%94%A8Scrapy%E9%87%87%E9%9B%86%E7%9F%A5%E7%BD%91%E6%9C%9F%E5%88%8A%E6%95%B0%E6%8D%AE%EF%BC%88%E5%9B%9B%EF%BC%89%2F</url>
    <content type="text"><![CDATA[Âú®Python ‰∏ãÁî® Scrapy ÈááÈõÜÁü•ÁΩëÊúüÂàäÊï∞ÊçÆÔºà‰∏âÔºâ‰∏≠ÈááÈõÜ‰∫ÜÊâÄÈúÄÊï∞ÊçÆÔºåÊé•‰∏ãÊù•ËØ•ËøõË°åÁöÑÂ∞±ÊòØÊï∞ÊçÆÁöÑÂ≠òÂÇ®ÂíåÂØºÂá∫„ÄÇ Êï∞ÊçÆÂ≠òÂÇ® ÂàõÂª∫ MySql Ë°® ÂØºÂÖ• pymysql Â∫ì import pymysql ÈÖçÁΩÆ MySql Âú® setting.py Êñá‰ª∂‰∏≠ÂÜôÂÖ•‰∏ãÂàóÈÖçÁΩÆ‰ª£Á†ÅÔºö 123456# start MySQL database configure settingMYSQL_HOST = &apos;localhost&apos;MYSQL_DBNAME = &apos;Êï∞ÊçÆÂ∫ìÂêç&apos;MYSQL_USER = &apos;ÁôªÂΩïÂêç&apos;MYSQL_PASSWD = &apos;ÂØÜÁ†Å&apos;# end of MySQL database configure setting ÁºñÂÜô item pipeline ÊØè‰∏™ item pipeline ÁªÑ‰ª∂(ÊúâÊó∂Áß∞‰πã‰∏∫ ‚ÄúItem Pipeline‚Äù )ÊòØÂÆûÁé∞‰∫ÜÁÆÄÂçïÊñπÊ≥ïÁöÑPythonÁ±ª„ÄÇ‰ªñ‰ª¨Êé•Êî∂Âà∞ItemÂπ∂ÈÄöËøáÂÆÉÊâßË°å‰∏Ä‰∫õË°å‰∏∫ÔºåÂêåÊó∂‰πüÂÜ≥ÂÆöÊ≠§ItemÊòØÂê¶ÁªßÁª≠ÈÄöËøápipelineÔºåÊàñÊòØË¢´‰∏¢ÂºÉËÄå‰∏çÂÜçËøõË°åÂ§ÑÁêÜ„ÄÇ ‰ª•ÈááÈõÜÂºïËØÅÊñáÁåÆÁöÑ item pipeline ‰∏∫‰æãÔºö 12345678910111213141516171819202122232425262728293031323334353637383940414243444546class CnkiPipeline(object): def __init__(self): self.connect = pymysql.connect( host=settings.MYSQL_HOST, db=settings.MYSQL_DBNAME, user=settings.MYSQL_USER, passwd=settings.MYSQL_PASSWD, charset='utf8', use_unicode=True) self.cursor = self.connect.cursor() def process_item(self, item, spider): if item.__class__ == Quote: try: self.cursor.execute("""select * from reference where literature_title = %s and quote_title = %s AND literature_author = %s AND literature_journalName = %s AND literature_time = %s""", (item["paper_title"], str(item['quote_title']), item['paper_author'], item['paper_journalName'], item['paper_time'])) ret = self.cursor.fetchone() if ret: self.cursor.execute( """update reference set literature_title = %s,literature_author = %s, literature_journalName = %s, literature_time = %s,quote_title = %s where literature_title = %s and quote_title = %s AND literature_author = %s""", (str(item['paper_title']), str(item['paper_author']), str(item['paper_journalName']), str(item['paper_time']), str(item['quote_title']), str(item['paper_title']), str(item['quote_title']), str(item['paper_author']))) else: self.cursor.execute( """insert into reference(literature_title,literature_author,literature_journalName, literature_time,quote_title) value (%s,%s,%s,%s,%s)""", (str(item['paper_title']), str(item['paper_author']), str(item['paper_journalName']), str(item['paper_time']), str(item['quote_title']))) self.connect.commit() except Exception as error: log(error) return item item pipeline ‰∏≠ÈúÄË¶ÅÂà§Êñ≠ item ÁöÑÁ±ªÂûãÊòØÂê¶ÊòØÈúÄË¶ÅË¢´Â§ÑÁêÜÁöÑÁ±ªÂûãÔºåËøõËÄåËøõË°åÊü•ËØ¢Âà§Êñ≠ËØ•Êù°ËÆ∞ÂΩïÊòØÂê¶Âú®Êï∞ÊçÆÂ∫ì‰∏≠Â≠òÂú®ÔºåÂ¶ÇÊûúÂ≠òÂú®ÂàôËøõË°åÊõ¥Êñ∞ÔºåÂê¶ÂàôËøõË°åÊèíÂÖ•„ÄÇ Áà¨ÂèñÁªìÊûú Êï∞ÊçÆÂØºÂá∫ ‰∏∫‰∫ÜÂ∞ÜÊï∞ÊçÆÂØºÂá∫‰∏∫ Excel Ê†ºÂºèÔºåÂà©Áî®Âà∞‰∫ÜxlrdÔºåxlsxwriterÔºåxlutils Â∫ìÔºåÂØºÂá∫‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293try: with connect.cursor() as cursor: # Create a new record sql_quote = "select * from periodical_data where journalName = %s and publicationDate = %s ORDER BY referenceNum DESC" sql_reference = "select * from reference where quote_title = %s" cursor.execute(sql_quote, (title, publicationDate)) results = cursor.fetchall() #oneup Áî®‰∫éËÆ∞ÂΩïÂºïÁî®Êï∞Âú®ÊØèÂπ¥‰∏ÄÊ¨°‰ª•‰∏äÁöÑÊñáÁåÆÊï∞Ôºåonelow Áî®‰∫éËÆ∞ÂΩïÂºïÁî®Êï∞Âú®ÊØèÂπ¥‰∏ÄÊ¨°‰ª•‰∏ãÁöÑÊñáÁåÆÊï∞Ôºånoone Áî®‰∫éËÆ∞ÂΩïÊ≤°ÊúâË¢´ÂºïÁî®ÁöÑÊñáÁåÆÊï∞ oneup=0 onelow=0 noone=0 endrows=0 for result in results: reference="" years=[] resultwork = xlrd.open_workbook(year + title + ".xls") sheet1 = resultwork.sheet_by_index(0) old_excel = copy.copy(resultwork) sheet_write = old_excel.get_sheet(0) rows = sheet1.nrows cols = sheet1.ncols quote_title = result['title'] if result['referenceNum'] != "0": cursor.execute(sql_reference, quote_title) reference = cursor.fetchall() if result['referenceNum']: if result['referenceNum'] &gt; (2016-int(year)): if oneup == 0: sheet_write.write(rows, 0, "ÂºïÁî®ÊØèÂπ¥‰∏ÄÊ¨°‰ª•‰∏ä") rows = rows + 1 oneup = oneup + 1 sheet_write.write(rows, 0, "1") sheet_write.write(rows, 1, result['title']) sheet_write.write(rows, 2, result['author']) sheet_write.write(rows, 3, result['journalName']) sheet_write.write(rows, 4, result['publicationDate']) sheet_write.write(rows, 5, result['referenceNum']) sheet_write.write(rows, 6, result['downloadNum']) else: if onelow == 0: sheet_write.write(rows, 0, "ÂºïÁî®ÊØèÂπ¥‰∏ÄÊ¨°‰ª•‰∏ã") rows = rows + 1 onelow = onelow + 1 sheet_write.write(rows, 0, "1") sheet_write.write(rows, 1, result['title']) sheet_write.write(rows, 2, result['author']) sheet_write.write(rows, 3, result['journalName']) sheet_write.write(rows, 4, result['publicationDate']) sheet_write.write(rows, 5, result['referenceNum']) sheet_write.write(rows, 6, result['downloadNum']) else: if noone == 0: sheet_write.write(rows, 0, "Ê≤°ÊúâÂºïÁî®") rows = rows + 1 noone = noone + 1 sheet_write.write(rows, 0, "1") sheet_write.write(rows, 1, result['title']) sheet_write.write(rows, 2, result['author']) sheet_write.write(rows, 3, result['journalName']) sheet_write.write(rows, 4, result['publicationDate']) sheet_write.write(rows, 5, result['referenceNum']) sheet_write.write(rows, 6, result['downloadNum']) for row in range(len(reference)): sheet_write.write(rows + row + 1, 0, "0") sheet_write.write(rows+row+1, 1, reference[row]['literature_title']) sheet_write.write(rows+row+1, 2, reference[row]['literature_author']) sheet_write.write(rows+row+1, 3, reference[row]['literature_journalName']) sheet_write.write(rows+row+1, 4, reference[row]['literature_time']) years.append(reference[row]['literature_time']) c = Counter(years) print(c.most_common(1)) print(result['title']) if result['referenceNum']: if result['referenceNum'] &gt; (2016-int(year)): if c.most_common(1): for most in c.most_common(1): most_year = str(most).split(",")[0].split("(")[1] most_time = str(most).split(",")[1].split(")")[0] sheet_write.write(rows, 7, most_year) sheet_write.write(rows, 8, most_time) old_excel.save(year + title + ".xls") endrows = rows + len(reference) + 2 resultwork = xlrd.open_workbook(year + title + ".xls") sheet1 = resultwork.sheet_by_index(0) old_excel = copy.copy(resultwork) sheet_write = old_excel.get_sheet(0) sheet_write.write(endrows, 0, "ÊØèÂπ¥ÂºïÁî®Ê¨°Êï∞‰∏ÄÊ¨°‰ª•‰∏äÁôæÂàÜÊØîÔºö" + str(float(oneup)/len(results))) sheet_write.write(endrows+1, 0, "ÊØèÂπ¥ÂºïÁî®Ê¨°Êï∞‰∏ÄÊ¨°‰ª•‰∏ãÁôæÂàÜÊØîÔºö" + str(float(onelow) / len(results))) sheet_write.write(endrows+2, 0, "ÊØèÂπ¥Ê≤°ÊúâÂºïÁî®ÁôæÂàÜÊØîÔºö" + str(float(noone) / len(results))) old_excel.save(year + title + ".xls")finally: connect.close() ÂØºÂá∫ÊïàÊûúÔºö ÂèÇËÄÉËµÑÊñô Scrapy ÊñáÊ°£]]></content>
      <categories>
        <category>PythonÂÆûÊàò</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Êï∞ÊçÆÂ§ÑÁêÜ</tag>
        <tag>Scrapy</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python ‰∏ãÁî® Scrapy ÈááÈõÜÁü•ÁΩëÊúüÂàäÊï∞ÊçÆÔºà‰∏âÔºâ]]></title>
    <url>%2F2017%2F04%2F08%2FPython%E4%B8%8B%E7%94%A8Scrapy%E9%87%87%E9%9B%86%E7%9F%A5%E7%BD%91%E6%9C%9F%E5%88%8A%E6%95%B0%E6%8D%AE%EF%BC%88%E4%B8%89%EF%BC%89%2F</url>
    <content type="text"><![CDATA[Âú®Python ‰∏ãÁî® Scrapy ÈááÈõÜÁü•ÁΩëÊúüÂàäÊï∞ÊçÆÔºà‰∫åÔºâ‰∏≠Â∑≤ÁªèËé∑Âèñ‰∫ÜÊúüÂàäÁöÑÊêúÁ¥¢ÁªìÊûúÔºåÊé•‰∏ãÊù•Â∞±ÂèØ‰ª•ÂºÄÂßãÈááÈõÜÊñáÁåÆÊï∞ÊçÆ‰∫Ü„ÄÇ ÈááÈõÜÊúüÂàäÊñáÁåÆÊï∞ÊçÆ ÂÆö‰πâ Items ‰∏∫‰∫ÜÂÆö‰πâÂ∏∏Áî®ÁöÑËæìÂá∫Êï∞ÊçÆÔºåScrapyÊèê‰æõ‰∫Ü Item Á±ª„ÄÇ Item ÂØπË±°ÊòØÁßçÁÆÄÂçïÁöÑÂÆπÂô®Ôºå‰øùÂ≠ò‰∫ÜÁà¨ÂèñÂà∞ÂæóÊï∞ÊçÆ„ÄÇ ÂÖ∂Êèê‰æõ‰∫Ü Á±ª‰ºº‰∫éËØçÂÖ∏(dictionary-like) ÁöÑAPI‰ª•ÂèäÁî®‰∫éÂ£∞ÊòéÂèØÁî®Â≠óÊÆµÁöÑÁÆÄÂçïËØ≠Ê≥ï„ÄÇ Âú® items.py Êñá‰ª∂‰∏≠Â¢ûÂä†Â¶Ç‰∏ã‰ª£Á†ÅÔºö 1234567class PaperItem(scrapy.Item): title = scrapy.Field() author = scrapy.Field() journalName = scrapy.Field() publicationDate = scrapy.Field() referenceNum = scrapy.Field() downloadNum = scrapy.Field() ÊèêÂèñÊï∞ÊçÆ 12345678910111213141516171819def parse(self, response): if "rurl" in str(requests_url): iden_code_url = str(requests_url).split("GET")[1].split("&gt;")[0].strip() yield scrapy.Request(iden_code_url, meta=&#123;'cookiejar': response.meta['cookiejar']&#125;, callback=self.handleCode, dont_filter=True) items = PaperItem() for result in response.css('tr[bgcolor]'): items['title'] = result.css("td &gt; a[class=fz14]").xpath("string(.)").extract_first() items['author'] = result.css("td[class=author_flag] &gt; a[class=KnowledgeNetLink]::text").extract() items['journalName'] = result.css("td[class=cjfdyxyz]").xpath("string(a)").extract_first() items['publicationDate'] = result.css("td[align] &gt; a[target=_blank]::text").extract_first().split("/")[0] items['referenceNum'] = result.css("span[class=KnowledgeNetcont] &gt; a::text").extract_first() items['downloadNum'] = result.css("span[class=downloadCount] &gt; a::text").extract_first() yield items next_page = response.xpath("//div/a[text()='‰∏ã‰∏ÄÈ°µ']/@href").extract() if next_page: next_page = response.urljoin(next_page[0]) yield scrapy.Request(next_page, meta=&#123;'cookiejar': response.meta['cookiejar']&#125;, callback=self.parse, dont_filter=True) if &quot;rurl&quot; in str(requests_url) Áî®‰∫éÂà§Êñ≠ÂΩìÂâçËØ∑Ê±ÇÊòØÂê¶ÊòØËØ∑Ê±ÇÈ™åËØÅÁ†ÅÁöÑËØ∑Ê±ÇÔºåÂ¶ÇÊûúÊòØÂàôÂõûË∞É handleCode(self, response) ËøõË°åÈ™åËØÅÁ†ÅÁöÑÂ§ÑÁêÜÔºåÁî±‰∫éÈ™åËØÅÁ†ÅÁöÑËØ∑Ê±ÇÈìæÊé•Â§ßÂ§öÁõ∏ÂêåÊâÄ‰ª•ÂøÖÈ°ªËÆæÁΩÆ dont_filter=True„ÄÇ for Âæ™ÁéØÁî®‰∫éÊèêÂèñÊñáÁåÆÁöÑÂêÑÈ°πÊï∞ÊçÆÔºånext_page ÊòØ‰∏ã‰∏ÄÈ°µÁöÑÈìæÊé•Ôºåresponse.urljoin() ÊñπÊ≥ïÊûÑÈÄ†‰∏Ä‰∏™ÁªùÂØπË∑ØÂæÑÁöÑ URL (È°µÈù¢‰∏äÁöÑÈìæÊé•ÈÉΩÊòØÁõ∏ÂØπË∑ØÂæÑÁöÑ)ÔºåÂèëÈÄÅ‰∏ã‰∏ÄÈ°µÁöÑËØ∑Ê±Ç‰πüÈúÄË¶ÅËÆæÁΩÆ dont_filter=True„ÄÇ È™åËØÅÁ†ÅÂ§ÑÁêÜ È™åËØÅÁ†ÅÁöÑÂ§ÑÁêÜ‰∏ªË¶ÅÂíåËøô‰∏§‰∏™ËØ∑Ê±ÇÁõ∏ÂÖ≥Ôºö Á¨¨‰∏Ä‰∏™ËØ∑Ê±ÇÁî®‰∫éÊòæÁ§∫ËæìÂÖ•È™åËØÅÁ†ÅÈ°µÈù¢ÂíåÊèê‰∫§È™åËØÅÁ†ÅÔºå‰∏ªË¶ÅÂíå‰∏§‰∏™ÂèÇÊï∞Áõ∏ÂÖ≥Ôºö Á¨¨‰∫å‰∏™ËØ∑Ê±ÇÂàô‰∏ªË¶ÅÁî®‰∫éËé∑ÂèñÈ™åËØÅÁ†ÅÔºö http://kns.cnki.net/kns/checkcode.aspx?t=%27+Math.random() Â§ÑÁêÜÈ™åËØÅÁ†ÅÁöÑ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 12345678910111213141516171819202122232425262728293031323334def handleCode(self, response): sid_kns = "" sessionId = "" ori_cookie = response.request.headers.getlist('Cookie') response_url = str(response.request.headers.getlist('Referer')).split("'")[1].split("rurl=")[1] if "vericode=" in response_url: response_url = re.sub(r"&amp;vericode.*", "", response_url) for cookie_parameter in str(ori_cookie).split(";"): if "SID_kns" in cookie_parameter: sid_kns = cookie_parameter.split("=")[1] if "ASP.NET_SessionId" in cookie_parameter: sessionId = cookie_parameter.split("=")[1] act_cookie = &#123;"ASP.NET_SessionId": sessionId, "SID_kns": sid_kns&#125; url = "http://kns.cnki.net/kns/checkcode.aspx?t='+Math.random()" result_file = self.downloadCodeImg(url, act_cookie) code_img = Image.open(result_file) code_img.show() ver_code = input("ËæìÂÖ•È™åËØÅÁ†Å:") print("Â∑≤ËæìÂÖ•È™åËØÅÁ†Å:", ver_code) return_url = "http://kns.cnki.net/kns/brief/vericode.aspx?rurl=" + response_url + "&amp;vericode=" + ver_code yield scrapy.Request(return_url, meta=&#123;'cookiejar': response.meta['cookiejar']&#125;, callback=self.parse, dont_filter=True)def downloadCodeImg(self, getCodeUrl, cookie): iden_code_img = "ver_code" + time.strftime('%Y-%m-%d', time.localtime(time.time())) + ".jpg" response = requests.get(getCodeUrl, stream=True, cookies=cookie) # here we need to set stream = True parameter requests.utils.add_dict_to_cookiejar(response.cookies, cookie) print(response.cookies) with open(iden_code_img, 'wb') as f: for chunk in response.iter_content(chunk_size=1024): if chunk: f.write(chunk) f.flush() f.close() return iden_code_img response_url ‰∏∫ rurl ÁöÑÂèÇÊï∞ÂÄº act_cookie ‰∏∫ËØ∑Ê±ÇÁöÑ cookies ÂÄº downloadCodeImg Áî®‰∫é‰∏ãËΩΩÈ™åËØÅÁ†Å ÈááÈõÜÂºïËØÅÊñáÁåÆ ÂÆö‰πâ Items 123456class Quote(scrapy.Item): paper_title = scrapy.Field() paper_author = scrapy.Field() paper_journalName = scrapy.Field() paper_time = scrapy.Field() quote_title = scrapy.Field() ÊèêÂèñÊï∞ÊçÆ ÂºïËØÅÊñáÁåÆÁöÑÊï∞ÊçÆÊèêÂèñÊòØÂä®ÊÄÅÁΩëÈ°µÔºåÊâÄ‰ª•‰∏çËÉΩÂ§üÁõ¥Êé•ÈááÈõÜÔºåÈÄöËøáÊäìÂåÖÂàÜÊûêÔºåÊï∞ÊçÆ‰∏ªË¶Å‰∏ãÂõæÁöÑËØ∑Ê±ÇÁõ∏ÂÖ≥Ôºö ‰∏∫‰∫ÜÂØπÂºïËØÅÊñáÁåÆÁöÑÊâÄÊúâÁ±ªÂà´ËøõË°åÁøªÈ°µÔºåÂèÇÊï∞ CurDBCode ÂøÖÈ°ªÂéªÈô§ÔºåÂèëÈÄÅËØ∑Ê±Ç‰πãÂêéÁöÑÈ°µÈù¢Â¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö Áî±‰∫éÊòØÁ∫ØÊñáÊú¨È°µÈù¢ÔºåÈô§‰∫ÜÁü•ÈÅì‰∏äÂõæÊâÄÁ§∫ÁöÑÂèÇÊï∞‰πãÂ§ñÔºåËøòÈúÄË¶ÅÁü•ÈÅìÂºïËØÅÊñáÁåÆÁöÑÊúÄÂ§ßÈ°µÊï∞ËøõË°åÁøªËØëÔºåÂÖ∑‰Ωì‰ª£Á†ÅÂ¶Ç‰∏ãÔºö ÂèëÈÄÅÂºïËØÅÊñáÁåÆËØ∑Ê±Ç 12345678910111213141516171819202122232425262728293031323334353637383940414243444546def parse(self, response): requests_url = response.request #True ‰ª£Ë°®ÊñáÁåÆÂºïËØÅÊñáÁåÆÊï∞Â§ß‰∫é 0ÔºåÂê¶Âàô‰ª£Ë°®ÊñáÁåÆÊ≤°ÊúâÂºïËØÅÊñáÁåÆ flag = True if "rurl" in str(requests_url): iden_code_url = str(requests_url).split("GET")[1].split("&gt;")[0].strip() yield scrapy.Request(iden_code_url, meta=&#123;'cookiejar': response.meta['cookiejar']&#125;, callback=self.handleCode , dont_filter=True) #quote_urls Áî®‰∫é‰øùÂ≠òÂºïËØÅÊñáÁåÆÊï∞Â§ß‰∫é 10 ÁöÑÈìæÊé•Ôºå‰ª£Ë°®ÁùÄÂºïËØÅÊñáÁåÆÈ°µÊï∞ÂèØËÉΩ‰∏§È°µ‰ª•‰∏äÈúÄË¶ÅËÆ°ÁÆóÈ°µÊï∞ quote_urls = [] #quote_direct Áî®‰∫é‰øùÂ≠òÂºïËØÅÊñáÁåÆÊï∞Â∞è‰∫éÁ≠â‰∫é 10 ÁöÑÈìæÊé•Ôºå‰ª£Ë°®ÁùÄÂºïËØÅÊñáÁåÆÈ°µÊï∞Âè™Êúâ‰∏ÄÈ°µÂè™Áî®Áõ¥Êé•ÈááÈõÜ quote_direct = [] for result in response.css('tr[bgcolor]'): quote_url = result.css("span[class=KnowledgeNetcont] &gt; a").xpath("@onclick").extract_first() num = result.css("span[class=KnowledgeNetcont] &gt; a::text").extract_first() if quote_url is not None: if int(num) &lt;= 10: pages = 1 else: pages = 1000 title = result.css("td &gt; a[class=fz14]").xpath("string(.)").extract_first() quote_code = self.get_quote_code(quote_url) origin_quote_url = "http://kns.cnki.net/kcms/detail/frame/asynlist.aspx" quote_parameters = &#123;'dbcode': 'CJFQ', 'search': title, 'code': quote_code, 'ds': 'frame/list.aspx', 'reftype': '18', 'page': pages, &#125; url = self.get_url(origin_quote_url, quote_parameters) if int(num) &lt;= 10: quote_direct.append(url) else: quote_urls.append(url) else: flag = False next_page = response.xpath("//div/a[text()='‰∏ã‰∏ÄÈ°µ']/@href").extract() if next_page and flag: next_page = response.urljoin(next_page[0]) yield scrapy.Request(next_page, meta=&#123;'cookiejar': response.meta['cookiejar']&#125;, callback=self.parse , dont_filter=True, priority=100) for get_quote_url in quote_urls: yield scrapy.Request(get_quote_url, meta=&#123;'cookiejar': response.meta['cookiejar']&#125;, callback=self.parse_first_quote) for get_quote_url in quote_direct: yield scrapy.Request(get_quote_url, meta=&#123;'cookiejar': response.meta['cookiejar']&#125;, callback=self.parse_quote) title ÊñáÁåÆÁöÑÁØáÂêç quote_code ÊñáÁåÆÁöÑÁºñÁ†Å pages È°µÊï∞ÔºåËÆæÁΩÆ‰∏∫ 1000Ôºå‰∏∫‰∫ÜÊñπ‰æøËÆ°ÁÆóÈ°µÊï∞ÔºåÂ¶ÇÊûúËÆæÁΩÆ‰∏∫ 1 ËøõË°åÈ°µÊï∞ËÆ°ÁÆóÔºåÈÇ£‰πàËøõË°åÊï∞ÊçÆÈááÈõÜÁöÑÊó∂ÈìæÊé•Â∞ÜË¢´ËøáÊª§Êéâ„ÄÇ priority=100 ‰ºòÂÖàÂ§ÑÁêÜÁøªÈ°µÁöÑËØ∑Ê±ÇÔºåÁøªÈ°µÊó∂Èó¥ËøáÈïøÂ∞ÜÂØºËá¥È°µÈù¢‰∏ç‰ºöÊåâÁÖßË¢´ÂºïÈáèÈôçÂ∫èÊéíÂàóÔºå‰ªéËÄåÂØºËá¥Êï∞ÊçÆ‰∏¢Â§±„ÄÇ ËÆ°ÁÆóÈ°µÊï∞ 1234567891011121314151617181920212223242526def parse_first_quote(self, response): result_html = Selector(response, type="html") regex = r"\Wcode=" quote_code = re.split(regex, response.url)[1] quote_code = quote_code.split("&amp;")[0] title = response.url.split("search=")[1] title = title.split("&amp;")[0] title = urllib.parse.unquote(title) origin_res = result_html.css("b[class=titleTotle] &gt; span[id]::text").extract() act_res = [] for result in origin_res: if result is not '\xa0': act_res.append(int(re.sub("\D", "", result.strip()))) if act_res: max_page = max(act_res) max_page = math.ceil(float(max_page)/10) else: max_page = 1 origin_url = 'http://kns.cnki.net/kcms/detail/frame/asynlist.aspx' for page_num in range(max_page): quote_parameters = &#123;'dbcode': 'CJFQ', 'search': title, 'code': quote_code, 'ds': 'frame/list.aspx', 'reftype': '18', 'page': str(page_num + 1), &#125; act_url = self.get_url(origin_url, quote_parameters) yield scrapy.Request(act_url, meta=&#123;'cookiejar': response.meta['cookiejar']&#125;, callback=self.parse_quote) origin_res Áî®‰∫éËé∑ÂèñÈ°µÈù¢‰∏äËÆ∞ÂΩïÁöÑÊù°Êï∞ max_page ÊúÄÂ§ßÁöÑÈ°µÊï∞ for Âæ™ÁéØÁî®‰∫éÂºïËØÅÊñáÁåÆÁöÑÁøªÈ°µ ÈááÈõÜ ÂºïËØÅÊñáÁåÆÁöÑÊ†ºÂºèÂèØ‰ª•ÂàÜ‰∏∫‰∏âÁ±ªÔºåÊâÄ‰ª•Ëøô‰∏âÁ±ªÈúÄË¶ÅÂçïÁã¨ËøõË°åÂ§ÑÁêÜ„ÄÇ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859def parse_quote(self, response): quote_item = Quote() ori_title = response.url.split("search=")[1] ori_title = ori_title.split("&amp;")[0] quote_title = urllib.parse.unquote(ori_title) for result in response.css("div[class=essayBox]"): dbTitle = result.xpath(".//div[@class='dbTitle']/text()").extract_first() if "‰∏≠ÂõΩÂ≠¶ÊúØÊúüÂàäÁΩëÁªúÂá∫ÁâàÊÄªÂ∫ì" in dbTitle: for result_cjfq in result.css("ul &gt; li"): paper_title = result_cjfq.xpath(".//em/text()").extract_first() +\ result_cjfq.xpath(".//a[@target='kcmstarget']").xpath('string(.)').extract_first() paper_author = result_cjfq.xpath("./text()").extract_first().replace("&amp;nbsp", '') paper_title = paper_title + paper_author.split(".")[0] paper_author = paper_author.split(".")[1].strip() paper_journalName = result_cjfq.xpath(".//a[@onclick]/text()").extract()[0] time_len = len(result_cjfq.xpath(".//a[@onclick]/text()")) paper_time = result_cjfq.xpath(".//a[@onclick]/text()").extract()[time_len - 1] paper_time = paper_time.split("(")[0] quote_item['paper_title'] = paper_title quote_item['paper_author'] = paper_author quote_item['paper_journalName'] = paper_journalName quote_item['paper_time'] = paper_time quote_item['quote_title'] = quote_title.replace("++", " ") yield quote_item if "‰∏≠ÂõΩÂçöÂ£´Â≠¶‰ΩçËÆ∫ÊñáÂÖ®ÊñáÊï∞ÊçÆÂ∫ì" in dbTitle or "‰∏≠ÂõΩ‰ºòÁßÄÁ°ïÂ£´Â≠¶‰ΩçËÆ∫ÊñáÂÖ®ÊñáÊï∞ÊçÆÂ∫ì" in dbTitle: for result_cjfq in result.css("ul &gt; li"): paper_title = result_cjfq.xpath(".//em/text()").extract_first() + \ result_cjfq.xpath(".//a[@target='kcmstarget']/text()").extract_first() paper_author = result_cjfq.xpath("./text()").extract_first() paper_title = paper_title + paper_author.split(".")[0] paper_author = paper_author.split(".")[1].strip() paper_journalName = result_cjfq.xpath(".//a[@onclick]/text()").extract()[0] paper_time = result_cjfq.xpath("./text()").extract()[1].strip() quote_item['paper_title'] = paper_title quote_item['paper_author'] = paper_author quote_item['paper_journalName'] = paper_journalName quote_item['paper_time'] = paper_time quote_item['quote_title'] = quote_title.replace("++", " ") yield quote_item if "‰∏≠ÂõΩÈáçË¶Å‰ºöËÆÆËÆ∫ÊñáÂÖ®ÊñáÊï∞ÊçÆÂ∫ì" in dbTitle or "ÂõΩÈôÖ‰ºöËÆÆËÆ∫ÊñáÂÖ®ÊñáÊï∞ÊçÆÂ∫ì" in dbTitle: for result_cjfq in result.css("ul &gt; li"): paper_title = result_cjfq.xpath(".//em/text()").extract_first() + \ result_cjfq.xpath(".//a[@target='kcmstarget']/text()").extract_first() other_data = result_cjfq.xpath("./text()").extract_first() paper_title = paper_title + other_data.split(".")[0] if len(other_data.split(".")) == 4: paper_author = other_data.split(".")[1].strip() paper_journalName = other_data.split(".")[2].strip() paper_time = other_data.split(".")[3].strip() elif len(other_data.split(".")) == 3: paper_author = "" paper_journalName = other_data.split(".")[1].strip() paper_time = other_data.split(".")[2].strip() quote_item['paper_title'] = paper_title quote_item['paper_author'] = paper_author quote_item['paper_journalName'] = paper_journalName quote_item['paper_time'] = paper_time quote_item['quote_title'] = quote_title.replace("++", " ") yield quote_item ÂèÇËÄÉËµÑÊñô Scrapy ÊñáÊ°£]]></content>
      <categories>
        <category>PythonÂÆûÊàò</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Êï∞ÊçÆÂ§ÑÁêÜ</tag>
        <tag>Scrapy</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python ‰∏ãÁî® Scrapy ÈááÈõÜÁü•ÁΩëÊúüÂàäÊï∞ÊçÆÔºà‰∫åÔºâ]]></title>
    <url>%2F2017%2F04%2F06%2FPython%E4%B8%8B%E7%94%A8Scrapy%E9%87%87%E9%9B%86%E7%9F%A5%E7%BD%91%E6%9C%9F%E5%88%8A%E6%95%B0%E6%8D%AE%EF%BC%88%E4%BA%8C%EF%BC%89%2F</url>
    <content type="text"><![CDATA[ÈúÄÊ±Ç Êú¨Ê¨°ÈááÈõÜÈúÄË¶ÅÈááÈõÜÊúüÂàä 2000ÔΩû2010 Âπ¥Èó¥ÁöÑÊï∞ÊçÆÔºåÁõ∏ÂÖ≥ÁöÑÊï∞ÊçÆÈ¶ñÂÖàÊòØÊúüÂàä‰∏≠ÂêÑÊñáÁåÆÁöÑÊï∞ÊçÆÔºö ÊñáÁåÆÊï∞ÊçÆ ‰∏ªË¶ÅÂåÖÊã¨ titleÔºàÁØáÂêçÔºâÔºåauthorÔºà‰ΩúËÄÖÔºâÔºåjournalNameÔºàÂàäÂêçÔºâÔºåpublicationDateÔºàÂèëË°®Êó∂Èó¥ÔºâÔºåreferenceNumÔºàË¢´ÂºïÊï∞Ôºâ ‰ª•Âèä downloadNum‰∏ãËΩΩÊï∞ ÂÖ∂Ê¨°ÊòØÊØèÁØáÊñáÁåÆÁöÑÂºïËØÅÊñáÁåÆÊï∞ÊçÆÔºö ÂºïÁî®ÊñáÁåÆÊï∞ÊçÆ ‰∏ªË¶ÅÂåÖÊã¨ paper_titleÔºàÁØáÂêçÔºâÔºåpaper_authorÔºà‰ΩúËÄÖÔºâÔºåpaper_journalNameÔºàÂàäÂêçÔºâÔºåpaper_timeÔºàÂèëË°®Êó∂Èó¥Ôºâ‰ª•Âèäquote_titleÔºàÂºïÁî®ÁöÑÊñáÁåÆÁØáÂêçÔºâ„ÄÇ ÊêúÁ¥¢ÊúüÂàä ÊäìÂåÖÂàÜÊûê Âú®ÈááÈõÜÊï∞ÊçÆ‰πãÂâçÈ¶ñÂÖàÈúÄË¶ÅËé∑ÂèñÂà∞ÊúüÂàäÁöÑÊêúÁ¥¢ÁªìÊûúÔºåËÄåÊú¨Ê¨°ÈááÈõÜ‰∏ªË¶ÅÂíå‰∏ãÂàóÁöÑÊêúÁ¥¢ÂèÇÊï∞Áõ∏ÂÖ≥Ôºö Ëµ∑ÂßãÂπ¥‰ªΩ Ê®°Á≥äÊàñÁ≤æÁ°ÆÊêúÁ¥¢ ÊúüÂàäÂêçÁß∞ ÊäìÂåÖ‰πãÂêéÂèëÁé∞ÊêúÁ¥¢ËøáÁ®ã‰∏ªË¶ÅÂíå‰∏ãÂõæÊ†áÊúâÁ∫¢Á∫øÁöÑ‰∏§‰∏™ËØ∑Ê±ÇÁõ∏ÂÖ≥ÔºåÁ¨¨‰∏Ä‰∏™ËØ∑Ê±ÇÁî®‰∫éÂæóÂà∞ÊêúÁ¥¢ÁªìÊûúÔºåÁ¨¨‰∫å‰∏™ËØ∑Ê±ÇÂàôÊòØÂ∞ÜÊêúÁ¥¢ÁöÑÁªìÊûúÊòæÁ§∫Âá∫Êù•„ÄÇ ÂØπÁ¨¨‰∏Ä‰∏™ËØ∑Ê±ÇËøõË°åÂàÜÊûê‰πãÂêéÂèëÁé∞‰∫Ü‰∏éÊêúÁ¥¢Êù°‰ª∂Áõ∏ÂØπÂ∫îÁöÑÊêúÁ¥¢ÂèÇÊï∞„ÄÇ Á¨¨‰∫å‰∏™ËØ∑Ê±ÇÂ§ßÈÉ®ÂàÜÊòØÂõ∫ÂÆöÂèÇÊï∞ÂÄº ÂèëÈÄÅËØ∑Ê±Ç ‰ªé Excel ËØªÂèñÂèÇÊï∞Ôºö Áî±‰∫éÈúÄË¶ÅÈááÈõÜÊØèÊú¨ÊúüÂàä 11 Âπ¥ÁöÑÊï∞ÊçÆÔºåÊâÄ‰ª•‰∏∫‰∫ÜÂáèÂ∞ëÊêúÁ¥¢ÁªìÊûú‰ªéËÄåÂ∞ΩÂèØËÉΩÈÅøÂÖçÈúÄË¶ÅËæìÂÖ•È™åËØÅÁ†ÅÔºåÊâÄ‰ª•Â∞ÜÊâÄÊúâÁöÑÊêúÁ¥¢Êù°‰ª∂‰øùÂ≠òÂú®‰∏Ä‰∏™ Excel Êñá‰ª∂ÈáåÈù¢Ôºö ËØªÂèñÂèÇÊï∞ËøáÁ®ãÂ¶Ç‰∏ãÔºö 1234567891011121314151617def read_excel(self): # ÊâìÂºÄÊñá‰ª∂ workbook = xlrd.open_workbook(r'/Users/firstdream/PycharmProjects/cnkiSprider/Êü•ËØ¢Êù°‰ª∂.xlsx') # Ëé∑ÂèñÊâÄÊúâsheet # Ê†πÊçÆsheetÁ¥¢ÂºïÊàñËÄÖÂêçÁß∞Ëé∑ÂèñsheetÂÜÖÂÆπ sheet1 = workbook.sheet_by_index(0) # sheetÁ¥¢Âºï‰ªé0ÂºÄÂßã search_setting = [] for row in range(sheet1.nrows): setting = "" for col in range(sheet1.ncols): if isinstance(sheet1.row(row)[col].value, float): setting = setting + str(int(sheet1.row(row)[col].value)) + "," else: setting = setting + str(sheet1.row(row)[col].value) search_setting.append(setting) return search_setting Â∞ÜÊØèË°åÁöÑÊêúÁ¥¢Êù°‰ª∂ÊãºÊé•Ëµ∑Êù•Âπ∂‰øùÂ≠òÂú®‰∏Ä‰∏™ list ÂΩì‰∏≠„ÄÇ ÁîüÊàêËØ∑Ê±Ç Áî±‰∫éËØ∑Ê±ÇÁöÑÂèÇÊï∞ËæÉÂ§öÔºåÊâÄ‰ª•ÈááÁî®ËØçÂÖ∏ËøõË°åËØ∑Ê±ÇÁöÑÂèÇÊï∞ÈÖçÁΩÆÔºåÂÜçÁî® get_url() Ëé∑ÂèñÊúÄÁªàÁöÑÈìæÊé•Ôºö ÁîüÊàêÁ¨¨‰∏Ä‰∏™ËØ∑Ê±ÇÔºö 12345678910111213141516171819def createUrls(self): search_setting = self.read_excel() urls = [] for setting in search_setting: year_from = setting.split(",")[0] year_to = setting.split(",")[1] magazine_setting = setting.split(",")[2] search_parameters = &#123;'action': '', 'ua': '1.21', 'PageName': 'ASP.brief_result_aspx', 'DbPreFix': 'CJFQ', 'DbCatalog': '‰∏≠ÂõΩÂ≠¶ÊúØÊúüÂàäÁΩëÁªúÂá∫ÁâàÊÄªÂ∫ì', 'ConfigFile': 'CJFQ.xml', 'db_opt': 'CJFQ', 'db_value': '‰∏≠ÂõΩÂ≠¶ÊúØÊúüÂàäÁΩëÁªúÂá∫ÁâàÊÄªÂ∫ì', 'magazine_value1': magazine_setting, 'year_type': 'echar', 'year_from': year_from, 'year_to': year_to, 'magazine_special1': '=' &#125; origin_url = "http://kns.cnki.net/kns/request/SearchHandler.ashx" url = self.get_url(origin_url, search_parameters) urls.append(url) return urls Â∞Ü Excel Êñá‰ª∂‰∏≠ËØªÂèñÁöÑÊêúÁ¥¢Êù°‰ª∂ÈÄöËøá createUrls() ÊñπÊ≥ïÁîüÊàêÂèØËø≠‰ª£ÁöÑËØ∑Ê±ÇÂàóË°®„ÄÇ ÁîüÊàêÁ¨¨‰∫å‰∏™ËØ∑Ê±ÇÔºö 12345result_parameters = &#123;'pagename': 'ASP.brief_result_aspx', 'DbPreFix': 'CJFQ', 'Research': 'off', 'KeyValue': '', 'S': '1', 'recordsperpage': '50' , "sorttype": "(Ë¢´ÂºïÈ¢ëÊ¨°,'INTEGER') desc"&#125;origin_url = "http://kns.cnki.net/kns/brief/brief.aspx"act_url = self.get_url(origin_url, result_parameters) Á¨¨‰∫å‰∏™ËØ∑Ê±Ç‰∏≠Â¢ûÂä†‰∫Ü recordsperpage Âíå sorttype ‰∏§‰∏™ÂèÇÊï∞ÔºåÂâçËÄÖ‰ª£Ë°®ÊØèÈ°µÊòæÁ§∫ÁöÑËÆ∞ÂΩïÊù°Êï∞ÔºàSprider ÊØèÈááÈõÜ 13 È°µÂ∑¶Âè≥ÔºåÁü•ÁΩë‰ºöÊèêÁ§∫ËæìÂÖ•È™åËØÅÁ†ÅÔºåÊâÄ‰ª•ËÆæÁΩÆ‰∏∫ÊúÄÂ§ßÂÄº 50 ÂáèÂ∞ëÁªìÊûúÁöÑÊÄªÈ°µÊï∞ÔºâÔºåÂêéËÄÖ‰ª£Ë°®ÁªìÊûúÁöÑÊéíÂ∫èÊñπÂºèÔºàÈááÈõÜÂºïËØÅÊñáÁåÆÊó∂ÔºåÁî±‰∫é‰∏Ä‰∫õÊñáÁåÆÊòØÊ≤°ÊúâË¢´ÂºïÁî®ÁöÑÔºåÊâÄ‰ª•ÈááÁî®ÊåâË¢´ÂºïÈáèÈÄíÂáèÁöÑÊñπÂºèÊéíÂ∫èÂéªËøáÊª§ÊéâÊó†Áî®ÁöÑËØ∑Ê±ÇÔºå‰ªéËÄåÁº©Áü≠ÈááÈõÜÊó∂Èó¥Ôºâ„ÄÇ get_url() ÊñπÊ≥ïÔºö 123456def get_url(self, origin_url, parameters): act_url = origin_url + "?" for key in parameters.keys(): act_url = act_url + key + "=" + urllib.request.quote(str(parameters[key])) + "&amp;" act_url = act_url.strip("&amp;") return act_url urllib.request.quote() ‰∏≠ÊñáÂ≠óÁ¨¶ËøõË°åÁºñÁ†ÅÂ§ÑÁêÜ„ÄÇ ÂèëÈÄÅ 12345678910111213141516171819def start_requests(self):headers_parameters = &#123; 'Host': 'kns.cnki.net', 'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.95 Safari/537.36', 'Referer': 'http://kns.cnki.net/kns/brief/result.aspx?dbPrefix=CJFQ'&#125;urls = self.createUrls()for i, url in enumerate(urls): yield scrapy.Request(url, meta=&#123;'cookiejar': i&#125;, callback=self.result_page, headers=headers_parameters) def result_page(self, response): result_parameters = &#123;'pagename': 'ASP.brief_result_aspx', 'DbPreFix': 'CJFQ', 'Research': 'off', 'KeyValue': '', 'S': '1', 'recordsperpage': '50' , "sorttype": "(Ë¢´ÂºïÈ¢ëÊ¨°,'INTEGER') desc"&#125;origin_url = "http://kns.cnki.net/kns/brief/brief.aspx"act_url = self.get_url(origin_url, result_parameters)return scrapy.Request(act_url, meta=&#123;'cookiejar': response.meta['cookiejar']&#125;, callback=self.parse, dont_filter=True) meta={'cookiejar': i} ‰øùÂ≠òÁöÑÊòØ cookie Áî®‰∫é‰øùÊåÅÊåÅ‰πÖÊÄßËøûÊé•„ÄÇ There is support for keeping multiple cookie sessions per spider by using the cookiejar Request meta key. By default it uses a single cookie jar (session), but you can pass an identifier to use different ones. For example: 123for i, url in enumerate(urls): yield scrapy.Request(url, meta=&#123;'cookiejar': i&#125;, callback=self.parse_page) start_requests(self) Âú®Ëé∑ÂèñÂà∞ÊêúÁ¥¢ÁªìÊûú‰πãÂêéÂõûË∞É result_page(self, response) ËøõË°åËøõ‰∏ÄÊ≠•Â§ÑÁêÜ„ÄÇ meta={'cookiejar': response.meta['cookiejar']} ÂèñÂá∫ cookie ÂÄºÂêë‰∏ã‰º†ÈÄí„ÄÇ Keep in mind that the cookiejar meta key is not ‚Äústicky‚Äù. You need to keep passing it along on subsequent requests. For example: 12345def parse_page(self, response): # do some processing return scrapy.Request("http://www.example.com/otherpage", meta=&#123;'cookiejar': response.meta['cookiejar']&#125;, callback=self.parse_other_page) dont_filter=True Áî±‰∫éÁ¨¨‰∫åÊ¨°ËØ∑Ê±ÇÁöÑÈìæÊé•Áõ∏ÂêåÔºåScrapy ÈªòËÆ§‰ºöËøáÊª§Âà∞Ëøô‰∫õËØ∑Ê±ÇÔºåÊâÄ‰ª•ÂøÖÈ°ªËÆæÁΩÆ‰∏∫ True„ÄÇ ÈÖçÁΩÆËÆøÈóÆÂºÇÂ∏∏ÈáçËØï ‰∏∫‰∫ÜÂ∞ΩÂèØËÉΩ‰øùËØÅÈááÈõÜÊï∞ÊçÆÁöÑÂÆåÊï¥ÊÄßÔºåÈúÄË¶ÅÈÖçÁΩÆ setting.py Êñá‰ª∂Âä†ÂÖ•Â¶Ç‰∏ã‰ª£Á†ÅÔºö 123456# ÂΩìËÆøÈóÆÂºÇÂ∏∏Êó∂ÊòØÂê¶ËøõË°åÈáçËØïRETRY_ENABLED = True# ÂΩìÈÅáÂà∞‰ª•‰∏ã http Áä∂ÊÄÅÁ†ÅÊó∂ËøõË°åÈáçËØïRETRY_HTTP_CODES = [500, 502, 503, 504, 400, 403, 404, 408]# ÈáçËØïÊ¨°Êï∞RETRY_TIMES = 5 ÂèÇËÄÉËµÑÊñô Scrapy ÊñáÊ°£]]></content>
      <categories>
        <category>PythonÂÆûÊàò</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Êï∞ÊçÆÂ§ÑÁêÜ</tag>
        <tag>Scrapy</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python ‰∏ãÁî® Scrapy ÈááÈõÜÁü•ÁΩëÊúüÂàäÊï∞ÊçÆÔºà‰∏ÄÔºâ]]></title>
    <url>%2F2017%2F04%2F06%2FPython%E4%B8%8B%E7%94%A8Scrapy%E9%87%87%E9%9B%86%E7%9F%A5%E7%BD%91%E6%9C%9F%E5%88%8A%E6%95%B0%E6%8D%AE%EF%BC%88%E4%B8%80%EF%BC%89%2F</url>
    <content type="text"><![CDATA[ÁÆÄ‰ªã Scrapy ÊòØ‰∏Ä‰∏™‰∏∫‰∫ÜÁà¨ÂèñÁΩëÁ´ôÊï∞ÊçÆÔºåÊèêÂèñÁªìÊûÑÊÄßÊï∞ÊçÆËÄåÁºñÂÜôÁöÑÂ∫îÁî®Ê°ÜÊû∂„ÄÇ ÂèØ‰ª•Â∫îÁî®Âú®ÂåÖÊã¨Êï∞ÊçÆÊåñÊéòÔºå‰ø°ÊÅØÂ§ÑÁêÜÊàñÂ≠òÂÇ®ÂéÜÂè≤Êï∞ÊçÆÁ≠â‰∏ÄÁ≥ªÂàóÁöÑÁ®ãÂ∫è‰∏≠„ÄÇ ÂÆâË£Ö Pycharm ÂÆâË£Ö Mac ‰∏ãÊåâ‰ΩèÂø´Êç∑ÈîÆ Command + , ÈÄâÊã© Project‚ÜíProject Interpreter ÁÇπÂáª + Âè∑ÂêéÊêúÁ¥¢ Scrapy ËøõË°åÂÆâË£ÖÂç≥ÂèØÔºö pipÂÆâË£Ö pip install Scrapy ÂàõÂª∫Â∑•Á®ã Âú®ÁªàÁ´Ø‰∏≠ËøõÂÖ•ÈúÄË¶ÅÂàõÂª∫Â∑•Á®ãÁöÑÁõÆÂΩïÔºåËæìÂÖ•ÂëΩ‰ª§Ôºö scrapy startproject tutorial Â∞Ü‰ºöÂàõÂª∫‰∏Ä‰∏™ tutorial ÁöÑÁõÆÂΩïÔºåÁõÆÂΩïÁªìÊûÑÂ¶Ç‰∏ãÔºö 1234567891011121314tutorial/ scrapy.cfg # ÈÉ®ÁΩ≤ÈÖçÁΩÆÊñá‰ª∂ tutorial/ # È°πÁõÆÁöÑ Python Ê®°ÂùóÔºåÂú®ËøôÈáåÂä†ÂÖ•‰ª£Á†Å __init__.py items.py # È°πÁõÆÁöÑ items ÂÆö‰πâÊñá‰ª∂ pipelines.py # È°πÁõÆÁöÑ pipelines Êñá‰ª∂ÔºåÁî®‰∫éÂ§ÑÁêÜ items settings.py # È°πÁõÆÁöÑËÆæÁΩÆÊñá‰ª∂ spiders/ # Spider ÁõÆÂΩïÊâÄÂú®Âú∞ __init__.py ÂàõÂª∫ Spider Âú® tutorial/spiders ÁõÆÂΩï‰∏ãÊñ∞Âª∫‰∏Ä‰∏™Âêç‰∏∫ quotes_spider.py ÁöÑÊñá‰ª∂ÔºåËæìÂÖ•Â¶Ç‰∏ã‰ª£Á†ÅÔºö 1234567891011121314151617181920import scrapyclass QuotesSpider(scrapy.Spider): name = "quotes" def start_requests(self): urls = [ 'http://quotes.toscrape.com/page/1/', 'http://quotes.toscrape.com/page/2/', ] for url in urls: yield scrapy.Request(url=url, callback=self.parse) def parse(self, response): page = response.url.split("/")[-2] filename = 'quotes-%s.html' % page with open(filename, 'wb') as f: f.write(response.body) self.log('Saved file %s' % filename) QuotesSpider ÁªßÊâø scrapy.SpiderÔºåÂêåÊó∂ÂÆö‰πâ‰∫Ü‰∏Ä‰∫õÂ±ûÊÄßÂíåÊñπÊ≥ïÔºö * nameÔºö‰Ωú‰∏∫Áà¨Ëô´ÁöÑÂîØ‰∏ÄÊ†áËØÜÔºåÂØπ‰∫éÂú®Âêå‰∏ÄÂ∑•Á®ã‰∏≠ÁöÑÁà¨Ëô´Ôºå‰∏çËÉΩÂ§üËÆæÁΩÆÁõ∏ÂêåÁöÑÂêçÁß∞„ÄÇ * start_requests()ÔºöËøîÂõû‰∏Ä‰∏™ÂèØËø≠‰ª£ÁöÑËØ∑Ê±ÇÔºåÁÑ∂Âêé Spider Â∞ÜÁà¨ÂèñËøô‰∫õËØ∑Ê±Ç * parse()ÔºöÁî®‰∫éÂ§ÑÁêÜËØ∑Ê±ÇÁöÑÁªìÊûú„ÄÇ ËøêË°å Sprider ÁªàÁ´ØÂëΩ‰ª§ËøêË°å Âú®ÂàõÂª∫ÁöÑÈ°πÁõÆÁõÆÂΩï‰∏ãÔºåËæìÂÖ•Ôºö scrapy crawl quotes quotes ‰∏∫ Sprider ÁöÑÊ†áËØÜ„ÄÇ Pycharm ‰∏ãËøêË°å Âú® tutorial ÁõÆÂΩï‰∏ãÂàõÂª∫Âêç‰∏∫ entrypoint.py ÁöÑÊñá‰ª∂ÔºåËæìÂÖ•Â¶Ç‰∏ã‰ª£Á†ÅÔºö 1234#!/usr/bin/env pythonfrom scrapy.cmdline import execute# quotes ‰∏∫ÂàöÂàöÂàõÂª∫ÁöÑ Spider ÁöÑ nameÔºåÂèØ‰ª•Âú®ËøôÈáåÂàáÊç¢‰∏çÂêåÁöÑ Spiderexecute(['scrapy', 'crawl', 'quotes']) ‰øÆÊîπÈÖçÁΩÆ Âú® Run ‰∏≠ÈÄâÊã© Edit ConfigurationsÔºåÂÅöÂ¶Ç‰∏ã‰øÆÊîπÔºö ÂèÇËÄÉËµÑÊñô Scrapy ÊñáÊ°£]]></content>
      <categories>
        <category>PythonÂÆûÊàò</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Êï∞ÊçÆÂ§ÑÁêÜ</tag>
        <tag>Scrapy</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python ‰∏ã pymsql Â∫ìÁöÑÂü∫Êú¨‰ΩøÁî®]]></title>
    <url>%2F2017%2F04%2F06%2FPython%E4%B8%8Bpymsql%E5%BA%93%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8%2F</url>
    <content type="text"><![CDATA[Â∫ìÁöÑÂØºÂÖ• import pymysql ËøûÊé• MySql ËøûÊé•ÈÖçÁΩÆ 1234MYSQL_HOST = &apos;localhost&apos;MYSQL_DBNAME = &apos;cnkiQuote&apos;MYSQL_USER = &apos;root&apos;MYSQL_PASSWD = &apos;123456&apos; ‰ªé‰∏äÂæÄ‰∏ã‰æùÊ¨°ÊòØ‰∏ªÊú∫ ipÔºåÊï∞ÊçÆÂ∫ìÂêçÔºåÁî®Êà∑ÂêçÂèäÂØÜÁ†Å„ÄÇ ËøûÊé• ÊåáÂÆöÁºñÁ†Å‰∏∫ utf8 1234567connection=pymysql.connect( host=MYSQL_HOST, db=MYSQL_DBNAME, user=MYSQL_USER, passwd=MYSQL_PASSWD, charset='utf8', use_unicode=True) Sql Êìç‰Ωú Êü•ËØ¢ 1234connection.cursor.execute("""select * from periodical_data where title = %s and publicationDate = %s and author = %s""",(item["title"],item['publicationDate'],str(item['author']))) ÊèíÂÖ• 1234567connection.cursor.execute("""insert into periodical_data(title,author,journalName,publicationDate,referenceNum, downloadNum) value (%s,%s,%s,%s,%s,%s)""",(item['title'],str(item['author']),item['journalName'],item['publicationDate'],item['referenceNum'],item['downloadNum'])) Êõ¥Êñ∞ 12345678910connection.cursor.execute("""update periodical_data set title = %s,author = %s,journalName = %s, publicationDate = %s,referenceNum = %s,downloadNum = %s where title = %s and publicationDate = %s and author = %s""",(str(item['title']),str(item['author']),str(item['journalName']),item['publicationDate'],item['referenceNum'],item['downloadNum'],str(item['title']),item['publicationDate'],str(item['author']))) Êèê‰∫§Êõ¥Êîπ connection.commit()]]></content>
      <categories>
        <category>PythonÂü∫Á°Ä</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>MySql Êìç‰Ωú</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python ‰∏ã Excel ÁöÑËØªÂèñ‰∏éÂÜôÂÖ•]]></title>
    <url>%2F2017%2F04%2F05%2FPython-%E4%B8%8BExcel-%E7%9A%84%E8%AF%BB%E5%8F%96%E4%B8%8E%E5%86%99%E5%85%A5%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä ÂâçÊÆµÊó∂Èó¥ÈúÄË¶ÅÂ∞Ü MySql ÁöÑÊï∞ÊçÆÂØºÂá∫Âà∞ÊåáÂÆöÊ†ºÂºèÁöÑ Excel Ë°®Ê†º‰∏≠ÂéªÔºåÁî±‰∫éÊòØÂü∫‰∫é Python3.5 ÁöÑÁ®ãÂ∫èÔºåÊâÄ‰ª•ÊúÄÂêéÈÄâÂÆö‰∫Ü xlrd Â∫ìÊù•ËøõË°å Excel ÁöÑËØªÂèñÊìç‰ΩúÔºåÂÜôÂÖ•Êìç‰ΩúÂàôÁî± xlsxwriter Âíå xlutils Â∫ìÊù•ËøõË°åÔºåÂÖ∂‰∏≠ xlutils Áî®‰∫éÂØπ Excel Êñá‰ª∂ÁöÑËøΩÂä†„ÄÇ Excel Êñá‰ª∂ÁöÑËØªÂèñ ÊâìÂºÄ Excel Êñá‰ª∂ workbook = xlrd.open_workbook(r'Êü•ËØ¢Êù°‰ª∂.xlsx') Ëé∑ÂèñÊâÄÊúâ sheet workbook.sheet_names() Ê†πÊçÆsheetÁ¥¢ÂºïÊàñËÄÖÂêçÁß∞Ëé∑Âèñ sheet ÂÜÖÂÆπ sheet1 = workbook.sheet_by_index(0) # sheetÁ¥¢Âºï‰ªé0ÂºÄÂßã sheet1 = data.sheet_by_name(u'Sheet1')#ÈÄöËøáÂêçÁß∞Ëé∑Âèñ Ëé∑Âèñ sheet1 ÁöÑË°åÊï∞ sheet1.nrows Ëé∑Âèñ sheet1 ÁöÑÂàóÊï∞ sheet1.ncols Ëé∑ÂèñÊåáÂÆöË°åÂàóÁöÑÂÄº sheet1.row(row)[col].value Excel Êñá‰ª∂ÁöÑÂÜôÂÖ•ËøΩÂä† ÂàõÂª∫ Excel Êñá‰ª∂ workbook = xlsxwriter.Workbook(year + title + &quot;.xls&quot;) Â¢ûÂä† Sheet worksheet = workbook.add_worksheet() ÂÜôÂÖ•Êï∞ÊçÆ 1234worksheet.write('A1', 'tag')worksheet.write('B1', 'ÊñáÁ´†ÂêçÂ≠ó')sheet_write.write(rows, 0, "1")workbook.close() ËøΩÂä†Êï∞ÊçÆ ËøΩÂä†‰πãÂâçÈúÄË¶ÅÂ∞Ü xlutils.copy ÂØºÂÖ•Âà∞Â∑•Á®ã‰∏≠ÔºåÈ¶ñÂÖàÁî® xlrd ÊâìÂºÄÊóßÁöÑ Excel Êñá‰ª∂ÔºåÁÑ∂ÂêéÂà©Áî® xlutils.copy ‰∏≠ÁöÑ copy() ÊñπÊ≥ïÂ§çÂà∂Â∑≤ÁªèÂ≠òÂú®ÁöÑÊï∞ÊçÆÔºåÊúÄÁªàÂú®ÂéüÊúâÊï∞ÊçÆÁöÑÂü∫Á°Ä‰∏äËøõË°åÂÜôÂÖ•„ÄÇÂÖ∑‰Ωì‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 123456789101112#ÂØºÂÖ•Ê®°Âùófrom xlutils.copy import copy#ÊâìÂºÄÊñá‰ª∂resultwork = xlrd.open_workbook(year + title + ".xls")#Ëé∑ÂèñË°åÊï∞sheet1 = resultwork.sheet_by_index(0)rows = sheet1.nrows#ËøΩÂä†Êï∞ÊçÆÔºå‰øùÂ≠òold_excel = copy.copy(resultwork)sheet_write = old_excel.get_sheet(0)sheet_write.write(rows, 0, "1")old_excel.save(year + title + ".xls") ÂèÇËÄÉËµÑÊñô xlsxwriter ÊñáÊ°£ Python‰∏≠‰ΩøÁî®Á¨¨‰∏âÊñπÂ∫ìxlutilsÊù•ËøΩÂä†ÂÜôÂÖ•ExcelÊñá‰ª∂Á§∫‰æã]]></content>
      <categories>
        <category>PythonÂü∫Á°Ä</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Êï∞ÊçÆÂ§ÑÁêÜ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Ê≠£ÂàôË°®ËææÂºèÂíå CSS ÈÄâÊã©Âô®‰ª•Âèä XPath]]></title>
    <url>%2F2017%2F04%2F05%2F%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%92%8Ccss%E9%80%89%E6%8B%A9%E5%99%A8%E4%BB%A5%E5%8F%8Axpath%2F</url>
    <content type="text"><![CDATA[Ê≠£ÂàôË°®ËææÂºè Ê≠£ÂàôË°®ËææÂºè‰∏ªË¶ÅÁî®‰∫éÂ≠óÁ¨¶‰∏≤ÂåπÈÖçÔºå‰ΩøÁî®Ê≠£ÂàôË°®ËææÂºè‰πãÂâçÈúÄË¶Å‰∫ÜËß£ÂêÑ‰∏™Á¨¶Âè∑ÁöÑÂê´‰πâÔºåËøôÈáåÊé®Ëçê ËèúÈ∏üÊïôÁ®ãÔºåÂú®‰∫ÜËß£ËØ≠Ê≥ï‰πãÂêéÊàë‰ª¨ÂèØ‰ª•ÈÄöËøá regex101 ËøõË°åÊ≠£ÂàôË°®ËææÂºèÁöÑÊµãËØï„ÄÇ CSS ÈÄâÊã©Âô® CSS ÈÄâÊã©Âô®Áî®‰∫éÁ≠õÈÄâ HTML ÊñáÊ°£‰∏≠ÁöÑÂÖÉÁ¥†ÔºåÂèØ‰ª•ÈÄöËøáÂÖÉÁ¥†ÁöÑÊ†áÁ≠æÂèäÂÖÉÁ¥†ÁöÑÂ±ûÊÄßËøõË°åÁ≠õÈÄâÔºåËøôÈáå‰ªãÁªç‰ΩøÁî®ËøáÁöÑ‰∏Ä‰∫õÂ∞è‰æãÂ≠êÔºö span[class=KnowledgeNetcont] &gt; a::text Á≠õÈÄâÂá∫ class Â±ûÊÄß‰∏∫ KnowledgeNetcont ÁöÑ span Ê†áÁ≠æ‰∏ãÁöÑ a Ê†áÁ≠æÁöÑÊñáÊú¨ÂÜÖÂÆπ„ÄÇ a[href*=image]::attr(href) Á≠õÈÄâÂá∫ a Ê†áÁ≠æÁöÑ href Â±ûÊÄßÂÄºÂåÖÂê´ image ÁöÑÂ±ûÊÄßÂÄº„ÄÇ XPath XPath ‰πüÁî®‰∫éÁ≠õÈÄâ HTML ÊñáÊ°£‰∏≠ÁöÑÂÖÉÁ¥†Ôºå‰∏ªË¶ÅÂü∫‰∫éÊñáÊ°£ÁöÑÁªìÊûÑËøõË°åÁ≠õÈÄâÔºåËøôÈáå‰æùÊóß‰ªãÁªç‰ΩøÁî®ËøáÁöÑ‰∏Ä‰∫õÂ∞è‰æãÂ≠êÔºö xpath(&quot;.//a[@target='kcmstarget']&quot;).xpath('string(.)') @ Áî®‰∫éÈÄâÂèñÂ±ûÊÄßÔºåstring(.) ÂèñÁöÑÂΩìÂâçËäÇÁÇπ‰∏ãÁöÑÊâÄÊúâÊñáÊú¨ÔºàÂåÖÂê´Â≠êÊ†áÁ≠æÁöÑÊñáÊú¨ÔºâÔºåÊï¥‰∏™ÁöÑÂê´‰πâÊòØÈÄâÂèñÂΩìÂâçËäÇÁÇπ‰∏ãÊâÄÊúâ target Â±ûÊÄßÂÄº‰∏∫ kcmstarget ÁöÑ a Ê†áÁ≠æ‰∏ãÁöÑÊâÄÊúâÊñáÊú¨„ÄÇ xpath(&quot;.//em/text()&quot;) Â¶ÇÊûúÂè™ÊÉ≥ÂèñÁöÑÂΩìÂâçËäÇÁÇπÁöÑÊñáÊú¨ËÄå‰∏çÈúÄË¶ÅÂ≠êÊ†áÁ≠æÁöÑÊñáÊú¨ÂàôÂèØ‰ª•Áî® text() ÂéªËé∑Âèñ„ÄÇ xpath(&quot;//div/a[text()='‰∏ã‰∏ÄÈ°µ']/@href&quot;) Ëé∑ÂèñÊñáÊú¨ÂÜÖÂÆπ‰∏∫‰∏ã‰∏ÄÈ°µÁöÑ a Ê†áÁ≠æÁöÑ href Â±ûÊÄßÂÄº„ÄÇ ÂèÇËÄÉËµÑÊñô Ê≠£ÂàôË°®ËææÂºè ‚Äì ÊïôÁ®ã XPath ÊïôÁ®ã CSS ÈÄâÊã©Âô®ÂèÇËÄÉÊâãÂÜå]]></content>
      <categories>
        <category>ÊùÇËÆ∞</category>
      </categories>
      <tags>
        <tag>HTML</tag>
        <tag>Â≠óÁ¨¶ÂåπÈÖç</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python ‰∏ã BeautifulSoup ÁöÑÂü∫Êú¨‰ΩøÁî®]]></title>
    <url>%2F2017%2F04%2F05%2FPython%E4%B8%8BBeautifulSoup%E7%9A%84%E4%BD%BF%E7%94%A8%2F</url>
    <content type="text"><![CDATA[BeautifulSoup ÁÆÄ‰ªã BeautifulSoup ÊòØ‰∏Ä‰∏™ÂèØ‰ª•‰ªé HTML Êàñ XML Êñá‰ª∂‰∏≠ÊèêÂèñÊï∞ÊçÆÁöÑ Python Â∫ì. Â∫ìÁöÑÂÆâË£Ö Â∫ìÁöÑÂÆâË£ÖÂèÇËÄÉÊ≠§ÁØáÊñáÁ´† requests Â∫ìÁöÑ‰ΩøÁî® Âü∫Êú¨‰ΩøÁî® ÂØºÂÖ• BeautifulSoup from bs4 import BeautifulSoup ÂàõÂª∫ÊñáÊ°£ÂØπË±° soup = BeautifulSoup(htmlÊñáÊ°£, 'html.parser') ÈÖçÂêà Python ÂÜÖÁΩÆÁöÑ html Ëß£ÊûêÂô®ÔºåÂ∞Ü html ÊñáÊ°£‰º†ÂÖ• BeautifulSoup ÊûÑÈÄ†ÊñπÊ≥ï„ÄÇ Ëé∑ÂèñÊï∞ÊçÆBeautifulSoupÊèê‰æõ‰∫ÜÂ¶Ç‰∏ãÂá†ÁßçÊñπÂºèÊêúÁ¥¢ÊñáÊ°£Ëé∑ÂèñÊï∞ÊçÆÔºö find_all() ÂÖ®ÊñáÊêúÁ¥¢ ËøîÂõûÊñáÊ°£‰∏≠ÊâÄÊúâÁ¨¶ÂêàË¶ÅÊ±ÇÁöÑÊï∞ÊçÆ„ÄÇ find() ÂçïÊ¨°ÊêúÁ¥¢ ËøîÂõûÊñáÊ°£‰∏≠Á¨¨‰∏Ä‰∏™Á¨¶ÂêàË¶ÅÊ±ÇÁöÑÊï∞ÊçÆ„ÄÇ select() CSSÈÄâÊã©Âô®Êü•Êâæ soup.select(&quot;td[align] &gt; a[target=_blank]&quot;) find_all() ‰∏≠ÂèØ‰ª•ÈÄöËøá limit ÂèÇÊï∞ÈôêÂà∂ÁªìÊûúÊï∞ÈáèÔºåÂ¶ÇÔºö soup.find_all(&quot;a&quot;, limit=2) ÂêåÊó∂‰∏äËø∞ÁöÑ find_all() Âíå find() ‰πüÂèØÈÖçÂêà CSS ÈÄâÊã©Âô®ËøõË°å‰ΩøÁî®ÔºåÂ¶ÇÔºö titleList = soup.find_all(&quot;a&quot;, {&quot;class&quot;: &quot;fz14&quot;}) ÂèÇËÄÉËµÑÊñô BeautifulSoup ÊñáÊ°£ ‚Äã]]></content>
      <categories>
        <category>PythonÂü∫Á°Ä</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Êï∞ÊçÆÂ§ÑÁêÜ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[‰ΩøÁî® requests Ëé∑Âèñ Discuz ËÆ∫ÂùõÈ™åËØÅÁ†Å]]></title>
    <url>%2F2017%2F04%2F04%2Frequests%E5%BA%93%E7%9A%84%E4%BD%BF%E7%94%A8%2F</url>
    <content type="text"><![CDATA[requests Â∫ìÁöÑÂÆâË£Ö Mac ‰∏ã‰ΩøÁî® Pycharm Êó∂Âè™ÈúÄÊåâ‰ΩèÂø´Êç∑ÈîÆ Command + , ÈÄâÊã© Project‚ÜíProject Interpreter ÁÇπÂáª + Âè∑ÂêéÊêúÁ¥¢ requests ËøõË°åÂÆâË£ÖÂç≥ÂèØÔºö Ëé∑ÂèñËøáÁ®ã‰ΩøÁî®ÁöÑÊñπÊ≥ï requests.get(url, params=None, **kwargs) url ÊòØËØ∑Ê±ÇÁöÑÈìæÊé•Ôºåparams ÊòØÂèëÈÄÅËØ∑Ê±ÇÊó∂ÂèÇÊï∞Ôºåkwargs ÊòØÂèØÈÄâÂèÇÊï∞„ÄÇ Ëé∑ÂèñËøáÁ®ã ‰∏∫‰∫Ü‰øùÊåÅËøûÊé•ÁöÑÊåÅ‰πÖÊÄß‰∏çËÉΩÁõ¥Êé•‰ΩøÁî® requests ÂèëÈÄÅËØ∑Ê±ÇÔºåËÄåÈúÄË¶ÅÂà©Áî® Session ÂØπË±°„ÄÇÂÖ∑‰ΩìËé∑Âèñ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 12345678910111213141516171819202122232425session = requests.session()ss = session.get("http://www.zhuixinfan.com/member.php?mod=register")result = ss.text#Ëé∑ÂèñÂèÇÊï∞params = re.findall("&lt;input.*(?:name=\"formhash\"|name=\"sechash\").*\&gt;", result)params = list(set(params))sechash = re.sub(".*value=\"", "", params[1])sechash = re.sub("\".*", "", sechash)#Êõ¥Êñ∞È™åËØÅÁ†Åactually_url = "http://www.zhuixinfan.com/misc.php?mod=seccode&amp;action=update&amp;idhash=" + sechashhtm = session.get(actually_url)#Ëé∑ÂèñÂõæÁâáÈìæÊé•update_url = re.findall(r"\bsrc=\S*", htm.text)update = re.sub("src=\"", "", update_url[0])update = re.sub("\"", "", update)#‰∏ãËΩΩÂõæÁâáheaders = &#123; 'Host': 'www.zhuixinfan.com', 'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.95 Safari/537.36', 'Referer': 'http://www.zhuixinfan.com/member.php?mod=register' &#125;url = "http://www.zhuixinfan.com/" + updateresult = session.get(url, headers=headers)im = Image.open(BytesIO(result.content))im.show() Ëé∑ÂèñËøáÁ®ã‰∏≠È¶ñÂÖàÂêëÁ´ôÁÇπÂèëÈÄÅËØ∑Ê±ÇÔºå‰ªéËøîÂõûÁöÑÁΩëÈ°µ‰ø°ÊÅØ‰∏≠Âà©Áî®Ê≠£ÂàôË°®ËææÂºèËé∑Âèñ sechash ÂèÇÊï∞Ôºå‰πãÂêéÂà©Áî®ÊâÄÂæóÂà∞ÁöÑ sechash ÂêëÁ´ôÁÇπÂèëÈÄÅÊõ¥Êñ∞È™åËØÅÁ†ÅÁöÑËØ∑Ê±ÇÂπ∂‰ªéËøîÂõûÁöÑ‰ø°ÊÅØ‰∏≠Ëé∑ÂèñÈ™åËØÅÁ†ÅÂõæÁâáÁöÑ urlÔºåÊúÄÂêé‰ªéÁ´ôÁÇπ‰∏ãËΩΩÂõæÁâáÂà©Áî® Image.open() ÊòæÁ§∫ÂõæÁâá„ÄÇ ÂèÇËÄÉËµÑÊñô Requests: ËÆ© HTTP ÊúçÂä°‰∫∫Á±ª]]></content>
      <categories>
        <category>PythonÂü∫Á°Ä</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>requests Â∫ì</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[HorizontalScrollView Âíå ViewPager Ëß¶ÊéßÂÜ≤Á™ÅËß£ÂÜ≥]]></title>
    <url>%2F2016%2F09%2F27%2FAndroid%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95HorizontalScrollView%E5%92%8CViewPager%E8%A7%A6%E6%8E%A7%E5%86%B2%E7%AA%81%E8%A7%A3%E5%86%B3%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä ÂΩì HorizontalScrollView Âíå ViewPager ‰∏ÄËµ∑‰ΩøÁî®ÁöÑÊó∂ÂÄô‰ºöÂá∫Áé∞ÊªëÂä®ÂÜ≤Á™ÅÁöÑÈóÆÈ¢ò Ëß£ÂÜ≥ËøáÁ®ã Ë¶Å‰∫ÜËß£ HorizontalScrollView Âíå ViewPager Ëß¶ÊéßÂÜ≤Á™ÅÁöÑÂéüÂõ†ÔºåÈ¶ñÂÖàÈúÄË¶Å‰∫ÜËß£Android Ëß¶Êë∏‰∫ã‰ª∂Â§ÑÁêÜÁöÑÁöÑÊú∫Âà∂ÔºåÂú®‰∫ÜËß£ÂêéÂèØ‰ª•Áü•ÈÅìÔºåÂΩì HorizontalScrollView ÂÜÖÂ±ÇÂµåÂ•ó‰ΩøÁî® ViewPager Êó∂ÔºåÁî±‰∫éËß¶Êë∏‰∫ã‰ª∂Ë¢´ HorizontalScrollView ÁöÑ onInterceptTouchEvent() Êã¶Êà™ÂØºËá¥‰∫ã‰ª∂‰∏çËÉΩÂêë‰∏ãÂ±Ç‰º†ÈÄíÔºåÊâÄ‰ª•ÂΩìÊªëÂä®Â±èÂπïÊó∂ÔºåHorizontalScrollView ÂèØ‰ª•Ê≠£Â∏∏ÊªëÂä®Ôºå‰ΩÜÊòØ ViewPager Âç¥‰∏çËÉΩÊ≠£Â∏∏ÊªëÂä®ÔºåËÄåËøô‰∏™Êó∂ÂÄôÊàë‰ª¨ÊúüÊúõÁöÑÊòØËæπÁºòÊªëÂä®Êó∂ÔºåHorizontalScrollView ÂìçÂ∫î‰∫ã‰ª∂ÔºåÈùûËæπÁºòÊªëÂä®Êó∂ÔºåViewPager ÂìçÂ∫î‰∫ã‰ª∂Ôºå‰∏∫‰∫ÜËææÂà∞Ëøô‰∏ÄÁõÆÁöÑÊàë‰ª¨ÈúÄË¶ÅÈáçÂÜô HorizontalScrollView ÁöÑ onInterceptTouchEvent() ÂáΩÊï∞ÔºåÂÖ∑‰Ωì‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 1234567public boolean onInterceptTouchEvent(MotionEvent ev) &#123; mXPoint = ev.getRawX(); if (mXPoint &gt; 100 &amp;&amp; mXPoint &lt; mMenuWidth) &#123; return false; &#125; return super.onInterceptTouchEvent(ev);&#125; ÈÄöËøáÈôêÂÆöÊªëÂä®ÁöÑÂ±èÂπïËåÉÂõ¥ÂÜ≥ÂÆöÊòØÂê¶‰∫ã‰ª∂Âú®Ëøô‰∏ÄÂ±ÇË¢´Â§ÑÁêÜÔºåÂú®ËøôÊ†∑Â§ÑÁêÜ‰πãÂêé HorizontalScrollView Âíå ViewPager ÈÉΩËÉΩÊ≠£Á°ÆÂìçÂ∫î‰∫ÜÔºå‰ΩÜÊòØÂΩì HorizontalScrollView ÊªëÂä®Ëá≥ÁªàÁÇπÊó∂ÔºåÂ±èÂπï‰∏≠Èó¥ÁöÑÈÉ®ÂàÜÂç¥‰∏çËÉΩÂ§üÊ≠£Á°ÆÂìçÂ∫î HorizontalScrollView ÁöÑÊªëÂä®‰∫ã‰ª∂ÔºåÊâÄ‰ª•Êàë‰ª¨ÈúÄË¶ÅÂÅöËøõ‰∏ÄÊ≠•Â§ÑÁêÜÔºåÂà§Êñ≠ HorizontalScrollView ÊòØÂê¶ÊªëÂä®Ëá≥ÁªàÁÇπÔºåÊâÄ‰ª•Âú® onTouchEvent ‰∫ã‰ª∂‰∏≠Âà©Áî®‰∏Ä‰∏™ flag ÁöÑÊ†áÂøó‰ΩçÂéªÂà§Êñ≠ÊòØÂê¶ÊªëÂä®Ëá≥ÁªàÁÇπÔºåÂÖ∑‰Ωì‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 12345678910111213141516public boolean onTouchEvent(MotionEvent ev) &#123; int action = ev.getAction(); switch (action) &#123; case MotionEvent.ACTION_UP: int scollX = getScrollX(); if (scollX &gt; mMenuHaltWidth) &#123; this.scrollTo(mMenuWidth, 0); sMenuFlag = false; &#125; else &#123; this.scrollTo(0, 0); sMenuFlag = true; &#125; return true; &#125; return super.onTouchEvent(ev);&#125; onInterceptTouchEvent() ÂáΩÊï∞Âà§Êñ≠Êù°‰ª∂Âèò‰∏∫Ôºö if (mXPoint &gt; 100 &amp;&amp; mXPoint &lt; mMenuWidth &amp;&amp; sMenuFlag == false) ÊúÄÁªàÊïàÊûú ÂèÇËÄÉËµÑÊñô Android Êéß‰ª∂ÁöÑËß¶Êë∏‰∫ã‰ª∂‰º†ÈÄí‰∏éÂ§ÑÁêÜ Android Ëß¶Êë∏‰∫ã‰ª∂Â§ÑÁêÜÊú∫Âà∂]]></content>
      <categories>
        <category>AndroidÂü∫Á°Ä</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python ËØ≠Ê≥ïÂü∫Á°Ä]]></title>
    <url>%2F2016%2F09%2F26%2FPython%E8%AF%AD%E6%B3%95%E5%9F%BA%E7%A1%80%2F</url>
    <content type="text"><![CDATA[ËøëÊÆµÊó∂Èó¥Â≠¶‰π†‰∫Ü‰∏ãPythonÔºå‰∫éÊòØÂ§ßÁï•ÊÄªÁªì‰∫Ü‰∏ãÊâÄÂ≠¶ÁöÑËØ≠Ê≥ïÁü•ËØÜÔºö ÂàóË°®ÁöÑÂàõÂª∫: 1movies = ["The Holy Grail", 1975, "Terry Jones &amp; Terry Gilliam", 91,["Graham Chapman", ["Michael Palin", "John Cleese", "Terry Gilliam", "Eric Idle", "Terry Jones"]]] ËøôÈáåÊòØ‰∏Ä‰∏™ÂµåÂ•óÂàóË°®ÁöÑÂàõÂª∫ÔºåÂÖ∂‰∏≠ÁöÑ‰∏≠Êã¨Âè∑‰πüÂèØ‰ª•Êç¢ÊàêÂ§ßÊã¨Âè∑ÔºåÂèåÂºïÂè∑ÂèØ‰ª•Áî®ÂçïÂºïÂè∑‰ª£ÊõøÔºåÂàóË°®ÈáåÈù¢ÂèØ‰ª•ÊòØÊ∑∑ÂêàÁöÑÊï∞ÊçÆ„ÄÇÂ∏∏Áî®ÁöÑÊñπÊ≥ïÊúâ Ôºö append()ÔºöÂú®ÂàóË°®Êú´Â∞æÂ¢ûÂä†‰∏Ä‰∏™Êï∞ÊçÆÈ°π pop()ÔºöÂú®ÂàóË°®ÁöÑÊú´Â∞æÂà†Èô§Êï∞ÊçÆ extend(Êï∞ÊçÆÈ°πÈõÜÂêà)ÔºöÂú®ÂàóË°®ÁöÑÊú´Â∞æÊ∑ªÂä†‰∏Ä‰∏™Êï∞ÊçÆÈ°πÈõÜÂêà remove(È°π)ÔºöÂà†Èô§‰∏Ä‰∏™ÁâπÂÆöÊï∞ÊçÆÁöÑÈ°π insert(Â∫èÂè∑, Êï∞ÊçÆÈ°π)ÔºöÂú®ÊåáÂÆöÂ∫èÂè∑ÁöÑÂâçÈù¢ÊèíÂÖ•Êï∞ÊçÆÈ°π ÂàóË°®ÁöÑÈÅçÂéÜ‰πã for Âæ™ÁéØ: ÂàóË°®ÁöÑÈÅçÂéÜÈúÄË¶ÅÁî®Âà∞ for Âæ™ÁéØÔºåÂÖ∂Âü∫Êú¨ËØ≠Ê≥ïÊòØÔºöfor ÂèòÈáè in ÂàóË°®È°πÔºöÔºåÁî±Ê≠§ÂèØ‰ª•Â∞ÜÂàóË°®‰∏≠ÁöÑÊØè‰∏ÄÈ°πÔºàÂè™‰ºöÈÅçÂéÜ‰∏ÄÁ∫ßÂàóË°®ÔºâÈÄöËøá print() ÂáΩÊï∞ËæìÂá∫„ÄÇ ÂµåÂ•óÂàóË°®ÁöÑÈÅçÂéÜ‰πã if Âà§Êñ≠: ÂØπ‰∫éÂµåÂ•óÂàóË°®ÁöÑÈÅçÂéÜÔºåÈúÄË¶ÅÂà§Êñ≠ for Âæ™ÁéØÊó∂ÊØè‰∏ÄÈ°πÊòØÂê¶ÊòØÂàóË°®È°πÔºåÂõ†Ê≠§ÈúÄË¶ÅÁî®Âà∞ if Âà§Êñ≠ËØ≠Âè•Âíå isinstanceÔºåisinstance(ÂèòÈáè, list) Áî®‰∫éÂà§Êñ≠ÊòØÂê¶ÊòØÂàóË°®Ôºåif ÁöÑËØ≠Ê≥ïÊòØÔºö 1234if Êüê‰∏™Êù°‰ª∂Êª°Ë∂≥: TrueÁªÑelse: FalseÁªÑ ÂµåÂ•óÂàóË°®ÁöÑÈÅçÂéÜ‰πãÂÆö‰πâÂáΩÊï∞Ôºö ‰∏äËø∞ÊúÄÂ§öÂè™ËÉΩÂ§üÂ§ÑÁêÜ‰∏ÄÂ±ÇÂµåÂ•óÁöÑÂàóË°®ÔºåÂ¶ÇÊûúÂ∏åÊúõÂ§ÑÁêÜÂ§öÂ±ÇÂµåÂ•óÁöÑÂàóË°®ÂàôÈúÄË¶ÅÂÆö‰πâÂáΩÊï∞Âπ∂ÂéªÈÄíÂΩíË∞ÉÁî®ÔºåÂÖ∂Âü∫Êú¨ËØ≠Ê≥ïÊòØÔºö 12def ÂáΩÊï∞Âêç(ÂèÇÊï∞): ‰ª£Á†ÅÂùó ËΩ¨Êç¢‰∏∫Ê®°ÂùóÔºö ‰ª£Á†ÅÂùó‰øùÂ≠ò‰∏∫ .py Êñá‰ª∂ÔºåÂàõÂª∫ setup.py ÁöÑÊñá‰ª∂ÔºåÂåÖÂê´Â¶Ç‰∏ãÂÜÖÂÆπÔºö 12345678910from distutils.core import setupsetup( name='HelloWorld', version='1.0.0', py_modules=['nester'], url='http://www.headfirstlabs', author='firstdream', author_email='firstdream10@icloud.com', description='A simple printer of nested lists') ÊûÑÂª∫ÂèëÂ∏ÉÊñá‰ª∂ (windows ‰∏ã): python setup.py sdist ÂÆâË£Ö Python ÂâØÊú¨Âà∞Êú¨Âú∞Ôºö python setup.py install ÂØºÂÖ•Ê®°ÂùóÔºö import Ê®°ÂùóÂêç Âêë PyPl ‰∏ä‰º†‰ª£Á†ÅÔºö python setup.py register(Á¨¨‰∏ÄÊ¨°‰∏ä‰º†) python setup.py sdist upload Â∏∏Áî® BIF 1234567891011121314#ÂàõÂª∫‰∏Ä‰∏™Á©∫ÁöÑÂàóË°®list()#ËøîÂõû‰∏Ä‰∏™Ëø≠‰ª£Âô®ÔºåÊ†πÊçÆÈúÄË¶ÅÁîüÊàê‰∏Ä‰∏™ÊåáÂÆöËåÉÂõ¥ÁöÑÊï∞Â≠óÔºåÂ∏∏ÈÖçÂêà for Âæ™ÁéØ‰ΩøÁî®range()for num in range(4): print(num)ÔºÉÂàõÂª∫ÊàêÂØπÊï∞ÊçÆÁöÑ‰∏Ä‰∏™ÁºñÂè∑ÂàóË°®Ôºå‰ªé 0 ÂºÄÂßãenumerate()#Â∞Ü‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÊàñÂè¶‰∏Ä‰∏™Êï∞ËΩ¨Êç¢‰∏∫‰∏Ä‰∏™Êï¥Êï∞(Â¶ÇÊûúÂèØË°å)int()#ËøîÂõû‰∏Ä‰∏™ Python Êï∞ÊçÆÂØπË±°ÁöÑÂîØ‰∏ÄÊ†áËØÜid()#ËøîÂõû‰∏Ä‰∏™ÂèØËø≠‰ª£Êï∞ÊçÆÁªìÊûÑ‰∏≠ÁöÑ‰∏ã‰∏ÄÈ°πnext() ‰∏∫ÂáΩÊï∞Êèê‰æõÈªòËÆ§ÂèÇÊï∞ def ÂáΩÊï∞Âêç(ÂèÇÊï∞=Áº∫ÁúÅÂÄº): 2016.10.7 Êñá‰ª∂Êìç‰Ωú 123456789101112#‰ª•ÈªòËÆ§ÁöÑ r Ê®°ÂºèÊâìÂºÄÊñá‰ª∂the_file = open("Êñá‰ª∂Âêç")#‰ª• w Ê®°ÂºèÊâìÂºÄÊñá‰ª∂out = open("Êñá‰ª∂Âêç", "w")#ÂÖ≥Èó≠Êñá‰ª∂the_file.close()#ËØªÂèñÊñá‰ª∂Êï∞ÊçÆË°åthe_file.readline()#ËøîÂõûÊñá‰ª∂Ëµ∑Âßã‰ΩçÁΩÆthe_file.seek(0)#ÂÜôÂÖ•Êï∞ÊçÆÂà∞Êñá‰ª∂print("ÂÜÖÂÆπ", file=Êñá‰ª∂ÂØπË±°Âêç) ÂºÇÂ∏∏Â§ÑÁêÜ 1234567891011121314try: ÂèØËÉΩÂèëÁîüÈîôËØØÁöÑ‰ª£Á†Åexcept: ÈîôËØØÊÅ¢Â§ç‰ª£Á†Åfinally: ÊúÄÂêéÁöÑÊâßË°å‰ª£Á†Å#Êï∞ÊçÆ‰∏çÁ¨¶ÂêàÊúüÊúõÁöÑÊ†ºÂºèÊó∂‰ºöÂá∫Áé∞ ValueError#Êï∞ÊçÆÊó†Ê≥ïÊ≠£Â∏∏ËÆøÈóÆÊó∂‰ºöÂá∫Áé∞ IOError#Áî®withÂ§ÑÁêÜÊñá‰ª∂ÔºåÂèØ‰∏çÈúÄË¶Å finally Ê®°Âùótry: with open() as data: ‰ª£Á†Åexcept ÂºÇÂ∏∏Ôºö ‰ª£Á†Å ÂÖ∂‰ΩôÊñπÊ≥ï 123456789101112131415161718#ÊòæÁ§∫ÂΩìÂâçÁõÆÂΩïÂèäÊõ¥ÊîπÂΩìÂâçÁõÆÂΩïimport osos.getcwd()os.chdir("Ë∑ØÂæÑ")#split() ÂàÜÂâ≤Â≠óÁ¨¶‰∏≤ÔºåËøîÂõû‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÂàóË°®(role, line_spoken) = each_line.split(":")#Âà©Áî® split ÁöÑÂèØÈÄâÂèÇÊï∞ÊåáÂÆö‰∏∫‰∏§ÈÉ®ÂàÜsplit(":", 1)#find() Êü•ÊâæÂ≠óÁ¨¶‰∏≤each_line.find(":")#not ÂèñÂèçÂà§Êñ≠Êù°‰ª∂if not each_line.find(':') == -1:#pass ‰Ωú‰∏∫PythonÁöÑÁ©∫ËØ≠Âè•ÊàñnullËØ≠Âè•#strip() ÊñπÊ≥ï‰ªéÂ≠óÁ¨¶‰∏≤‰∏≠ÂéªÈô§‰∏çÊÉ≥Ë¶ÅÁöÑÁ©∫ÁôΩÁ¨¶line_spoken.strip()#str() ÂèØ‰ª•Áî®Êù•ËÆøÈóÆ‰ªª‰ΩïÊï∞ÊçÆÂØπË±°ÁöÑÂ≠óÁ¨¶‰∏≤Ë°®Á§∫#locals() ËøîÂõûÂΩìÂâç‰ΩúÁî®Âüü‰∏≠ÁöÑÂèòÈáèÈõÜÂêàif 'man_file' in locals(): 2016.10.15 pickle &quot;ËÖåÂà∂&quot;Êï∞ÊçÆÂíåÊÅ¢Â§çÊï∞ÊçÆ Python Êèê‰æõ‰∫Ü‰∏Ä‰∏™Ê†áÂáÜÂ∫ì pickle Áî®‰∫é‰øùÂ≠òÂíåÂä†ËΩΩ Python ÁöÑÊï∞ÊçÆÂØπË±°Ôºå‰ΩøÁî®ÊñπÊ≥ïÔºö 12345678import pickle...#pickle Â§ÑÁêÜÊñá‰ª∂Êï∞ÊçÆÊó∂ÂøÖÈ°ª‰ª•‰∫åËøõÂà∂ËÆøÈóÆwith open('mydata.pickle', 'wb') as mysavedata: pickle.dump([1, 2, ''three], mysavedata) ...with open('mydata.pickle', 'rb') as myrestoredata: a_list = pickle.load(myrestoredata) ÂàóË°®Êé®ÂØº ÂàóË°®Êé®ÂØºÁî®‰∫éÂáèÂ∞ëËΩ¨Êç¢ÂàóË°®Êó∂ÁöÑ‰ª£Á†ÅÈáè 12345Êñ∞ÂàóË°® = [ËΩ¨Êç¢ÂáΩÊï∞(t) for t in ÂéüÂàóË°®]new_l = []for t in old_l: new_l.append(len(t))new_l = [len(t) for t in old_l] ÈõÜÂêà set Python Êèê‰æõ‰∏ÄÁßçÂêç‰∏∫ÈõÜÂêàÁöÑÊï∞ÊçÆÁªìÊûÑÔºåÈõÜÂêà‰∏≠ÁöÑÊï∞ÊçÆÊòØÊó†Â∫èÁöÑÔºåËÄå‰∏î‰∏çÂÖÅËÆ∏ÈáçÂ§ç ÂàõÂª∫ÈõÜÂêàÔºö 123#set() -&gt; new empty set object#set(iterable) -&gt; new set objectÈõÜÂêàÂêç = set(object) Â≠óÂÖ∏ Â≠óÂÖ∏Â∞Ü value Âíå key ÂÖ≥ËÅîÔºå‰ΩøÁî®Â≠óÂÖ∏: 123456#ÂàõÂª∫Â≠óÂÖ∏Â≠óÂÖ∏Âêç = &#123;&#125;Â≠óÂÖ∏Âêç = dict()#Â¢ûÂä†Êï∞ÊçÆÂ≠óÂÖ∏Âêç[key] = value #vlaueÂèØ‰ª•‰∏∫‰ªªÊÑèÊï∞ÊçÆÁ±ªÂûãÂ≠óÂÖ∏Âêç = &#123;‚Äôkey‚Äò:value, 'key':value&#125; Á±ª 123456#ÂÆö‰πâÁ±ªclass Á±ªÂêç: def _init_(self): #ÂàùÂßãÂåñÂØπË±°ÁöÑ‰ª£Á†Å#ÂàõÂª∫ÂØπË±°ÂÆû‰æãÂØπË±° = Á±ªÂêç() ÁªßÊâø 123class Á±ªÂêç(ÁªßÊâøÁöÑÁ±ªÂêç): def _init_(self, ÂèÇÊï∞):#ÂàùÂßãÂåñÂØπË±°ÁöÑ‰ª£Á†Å ÂÖ∂ÂÆÉ print(ÂàóË°®[-1]) ËæìÂá∫ÊúÄÂêé‰∏Ä‰∏™Êï∞ÊçÆÈ°π strip() ÊñπÊ≥ïÂèØ‰ª•‰ªéÂ≠óÁ¨¶‰∏≤‰∏≠ÂéªÈô§‰∏çÊÉ≥Ë¶ÅÁöÑÁ©∫ÁôΩÁ¨¶ in Êìç‰ΩúÁ¨¶Áî®‰∫éÊ£ÄÊü•ÊàêÂëòÂÖ≥Á≥ª ÂéüÂú∞ÊéíÂ∫è sort()ÔºåÂéüÂàóË°®È°∫Â∫èÊîπÂèò Â§çÂà∂ÊéíÂ∫è sorted()ÔºåËøîÂõû‰∏Ä‰∏™ÊéíÂ∫èËøáÁöÑÂéüÂàóË°®ÂâØÊú¨ ÂàÜÁâáËÆøÈóÆÂàóË°®ÂàóË°®[Ëµ∑ÂßãÂÄºÔºöÁªìÊùüÂÄº]ÂèØ‰ª•ËÆøÈóÆËµ∑ÂßãÂà∞ÁªìÊùü(‰∏çÂåÖÊã¨ÁªìÊùüÂÄº)ÁöÑÂàóË°®È°π]]></content>
      <categories>
        <category>PythonÂü∫Á°Ä</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Âü∫Á°ÄËØ≠Ê≥ï</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Android ‰∏ãËé∑Âèñ activity_main.xml ÁöÑÊ†π View]]></title>
    <url>%2F2016%2F09%2F22%2FAndroid%E4%B8%8B%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8DXML%E7%9A%84%E6%A0%B9View%2F</url>
    <content type="text"><![CDATA[ÊúÄËøëÂÅöÊµãËØïÁöÑÊó∂ÂÄôÈúÄË¶ÅËé∑ÂèñÂΩìÂâç XML ÁöÑÊ†πËßÜÂõæËøõË°åÊìç‰ΩúÔºåÊü•ËØ¢ÂêéÂèëÁé∞ÁΩë‰∏äÊèêÂà∞‰∫Ü getDecorView()ÔºågetRootView()ÔºåÂèÇÁÖßÂà´‰∫∫ÁöÑÊµãËØïËá™Â∑±‰πüÂÅö‰∫Ü‰∏Ä‰∏™Â∞èÁöÑÊµãËØïÔºåÈ¶ñÂÖàÊòØ‰∏Ä‰∏™ View Â±ÇÊ¨°ÁªìÊûÑÂõæÔºåÊñπ‰æøÁêÜËß£ÊµãËØïÔºåÂéüÊñáÂú∞ÂùÄÂú®ÊñáÁ´†ÊúÄÂêéÔºö activity_main Âíå btn_lay Â∏ÉÂ±ÄÂ¶Ç‰∏ãÔºö 12345678910111213141516&lt;?xml version="1.0" encoding="utf-8"?&gt;&lt;android.support.constraint.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android" xmlns:tools="http://schemas.android.com/tools" android:layout_width="match_parent" android:layout_height="match_parent" tools:context="com.rookieyang.test.MainActivity"&gt; &lt;Button android:id="@+id/btn" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="hello" /&gt; &lt;include layout="@layout/btn_lay" /&gt;&lt;/android.support.constraint.ConstraintLayout&gt; 12345678910111213&lt;?xml version="1.0" encoding="utf-8"?&gt;&lt;LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" android:layout_width="match_parent" android:layout_height="match_parent" android:orientation="vertical"&gt; &lt;Button android:id="@+id/btn2" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="test" /&gt;&lt;/LinearLayout&gt; Êé•‰∏ãÊù•ÊòØÊµãËØï‰ª£Á†ÅÔºö 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758public class MainActivity extends AppCompatActivity &#123; private View mDecorView; private View mRootView; private View mContentView; private View mCurrentView; private View mCurrentView2; private TextView mOneText; private TextView mTwoText; private Button mBtn; private Button mBtn2; private Button mBtn3; private View mView; @Override protected void onCreate(Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); init(); logView(); &#125; private void init() &#123; mDecorView = getWindow().getDecorView(); mRootView = mDecorView.getRootView(); mContentView = mDecorView.findViewById(android.R.id.content); mCurrentView = ((ViewGroup) mContentView).getChildAt(0); mOneText = (TextView) ((ViewGroup) mCurrentView).getChildAt(0); mCurrentView2 = ((ViewGroup) mRootView .findViewById(android.R.id.content)).getChildAt(0); mTwoText = (TextView) ((ViewGroup) mCurrentView2).getChildAt(0); mView = LayoutInflater.from(this).inflate(R.layout.btn_lay, null); mBtn = (Button) findViewById(R.id.btn); mBtn2 = (Button) mView.findViewById(R.id.btn2); mBtn3 = (Button) findViewById(R.id.btn2); &#125; private void logView() &#123; Log.i("MainActivity", "DecorView:" + mDecorView ); Log.i("MainActivity", "DecorView ID:" + mDecorView.getId()); Log.i("MainActivity", "RootView:" + mRootView); Log.i("MainActivity", "RootView ID:" + mRootView.getId()); Log.i("MainActivity", "ContentView:" + mContentView); Log.i("MainActivity", "ContentView ID:" + mContentView.getId()); Log.i("MainActivity", "CurrentView:" + mCurrentView); Log.i("MainActivity", "CurrentView ID:" + mCurrentView.getId()); Log.i("MainActivity", "CurrentView2:" + mCurrentView2); Log.i("MainActivity", "CurrentView2 ID:" + mCurrentView2.getId()); Log.i("MainActivity", "mOneText ID:" + mOneText.getText()); Log.i("MainActivity", "mTwoText ID:" + mTwoText.getText()); Log.i("MainActivity", "mBtn RootView:" + mBtn.getRootView()); Log.i("MainActivity", "mBtn2 RootView:" + mBtn2.getRootView()); Log.i("MainActivity", "mBtn3 RootView:" + mBtn3.getRootView()); &#125;&#125; ËøêË°åÁªìÊûúÂ¶Ç‰∏ãÔºö È¶ñÂÖàÂèØ‰ª•ÁúãÂà∞ getWindow().getDecorView() Âíå getDecorView().getRootView() Ëé∑ÂæóÁöÑ View Âíå id ÊòØ‰∏ÄÊ†∑ÁöÑÔºå ËØ¥Êòé DecorView ÊòØÊï¥‰∏™ Window ÁïåÈù¢ÊúÄÈ°∂Â±ÇÁöÑ View„ÄÇ ‰ΩÜÊòØÂØπÊØî mBtn2.getRootView() Âíå mBtn3.getRootView() Âç¥ÂèëÁé∞‰∏§ËÄÖËæìÂá∫ÁªìÊûúÂÆåÂÖ®‰∏çÂêåÔºåmBtn3.getRootView() Ëé∑ÂèñÂà∞ÁöÑÊòØ DecorViewÔºåËÄå mBtn2.getRootView() Ëé∑ÂèñÂà∞ÁöÑÂàôÊòØ LinearLayoutÔºå‰∏§ËÄÖÁöÑ‰∏çÂêå‰πãÂ§ÑÂú®‰∫é mBtn2 ÈÄöËøá mView.findViewById(R.id.btn2) Ëé∑ÂèñÔºåmBtn3 Âç¥ÊòØÁõ¥Êé•ÈÄöËøá findViewById(R.id.btn2) Ëé∑Âèñ„ÄÇÂú®Êü•ËØ¢ LayoutInflater ÁöÑ API ÊñáÊ°£ÂêéÔºåÁ¨¨‰∏ÄË°åÁöÑÊèèËø∞ÊòØËøôÊ†∑ÁöÑÔºö „ÄåInstantiates a layout XML file into its corresponding View objects„Äç ‰πüÂ∞±ËØ¥ÈÄöËøá LayoutInflater.from(this).inflate(R.layout.btn_lay, null)Ôºåbtn_lay Â∏ÉÂ±ÄË¢´ÂÆû‰æãÂåñ‰∫ÜÂà∞ÂØπÂ∫îÁöÑ View ÂØπË±°‰∏≠ÔºåÊâÄ‰ª•ÂØºËá¥ mView ÁöÑÊ†πËßÜÂõæÊòØ LinearLayoutÔºåËá™ÁÑ∂ mBtn2 ÁöÑÊ†πËßÜÂõæ‰πüÊòØ LinearLayout„ÄÇ findViewById(android.R.id.content) Áî®‰∫éËé∑Âèñ activity_main Â§ñÂ±ÇÁöÑËßÜÂõæÔºåÂç≥‰∏äÂõæÁöÑ mContentParent„ÄÇ Âú®Ëé∑Âèñ‰∫Ü mContentParent ‰πãÂêéÔºåÁî±‰∫é activity_main ÁöÑÊ†πËßÜÂõæÊòØ mContentParent ÁöÑÁ¨¨‰∏Ä‰∏™Â≠êÂÖÉÁ¥†ÔºåÊâÄ‰ª•Âà©Áî® getChildAt(0) Âç≥ÂèØËé∑Âèñ ConstraintLayout„ÄÇmCurrentView Âíå mCurrentView2 ÁöÑËæìÂá∫ÁªìÊûúÂèØ‰ª•Âç∞ËØÅËØ•ÁÇπ„ÄÇ ÊÄªÁªìÔºö Ëé∑Âèñ activity_main.xml Ê†π ViewÔºö 12View rootView = ((ViewGroup)(getWindow().getDecorView() .findViewById(android.R.id.content))).getChildAt(0); Ëé∑Âèñ btn_lay.xml Ê†π View: 1View rootView = LayoutInflater.from(this).inflate(R.layout.btn_lay, null).getRootView(); getDecorView(): Retrieve the top-level window decor view (containing the standard window frame/decorations and the client's content inside of that), which can be added as a window to the window manager. getRootView(): Finds the topmost view in the current view hierarchy. ÂèÇËÄÉÈìæÊé• view.getRootView() ÁöÑÁúüÊ≠£Âê´‰πâÂèäÊµãËØï Android View Ê∫êÁ†ÅËß£ËØª]]></content>
      <categories>
        <category>AndroidÈóÆÈ¢òËÆ∞ÂΩï</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>Âü∫Á°ÄÈóÆÈ¢òËÆ∞ÂΩï</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Âà©Áî® TabLayout Âíå ToolBar ÂÆûÁé∞ÊªëÂä®Ê†áÁ≠æÈ°µ]]></title>
    <url>%2F2016%2F09%2F08%2FAndroid%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8E%A7%E4%BB%B6%E5%88%A9%E7%94%A8TabLayout%E5%92%8CToolBar%E5%AE%9E%E7%8E%B0%E6%BB%91%E5%8A%A8%E6%A0%87%E7%AD%BE%E9%A1%B5%2F</url>
    <content type="text"><![CDATA[ÊúÄËøëÂú®ÂÆûÁé∞‰æøÁ≠æÊªëÂä®È°µÁöÑÊó∂ÂÄôÁ™ÅÁÑ∂ÂèëÁé∞ ActionBar Â∑≤Áªè‰∏çË¢´ÂÆòÊñπÊé®Ëçê‰ΩøÁî®ÔºåÊØîËæÉÂ•ΩÁöÑ‰∏Ä‰∏™ÊñπÊ≥ïÂ∞±ÊòØÂà©Áî® ToolBar Âíå TabLayout Êù•ÂÆûÁé∞Ôºå‰ª•‰∏ãÊòØÂÆûÁé∞Ê≠•È™§Ôºö TalLayout ÊòØ Android Support Design ‰∏≠ÁöÑ‰∏Ä‰∏™Êéß‰ª∂ÔºåÂú®‰ΩøÁî®‰πãÂâçÈúÄË¶ÅÂú® build.gradle Êñá‰ª∂‰∏≠Ê∑ªÂä†compile'com.android.support:design:23.2.0' ÊâçËÉΩÂ§üÊ≠£Â∏∏‰ΩøÁî®„ÄÇ ÂØπ values ‰∏≠ÁöÑ style Êñá‰ª∂ËøõË°åËÆæÁΩÆ‰ª•Â±èËîΩ Activity ÁöÑ ActionBarÔºåËÆ©‰∏ªÈ¢òÁªßÊâø‰∫é NoActionBarÔºåÂ¶ÇÊûúÈúÄË¶ÅÊîπÂèò Acitivity ÁöÑËÉåÊôØÈ¢úËâ≤ËÆæÁΩÆ windowBackground Âç≥ÂèØÔºö 123456789&lt;!-- Base application theme. --&gt;&lt;style name="AppTheme" parent="Theme.AppCompat.NoActionBar"&gt; &lt;!-- Customize your theme here. --&gt; &lt;item name="colorPrimary"&gt;@color/material_blue_grey_800&lt;/item&gt; &lt;!--Status bar color--&gt; &lt;item name="colorPrimaryDark"&gt;@color/accent_material_light&lt;/item&gt; &lt;!--Window color--&gt; &lt;item name="colorAccent"&gt;@color/colorAccent&lt;/item&gt;&lt;/style&gt; Áî±‰∫éÈúÄË¶ÅÂÆûÁé∞Ê†áÁ≠æÈ°µÁöÑÊªëÂä®ÊïàÊûúÊâÄ‰ª•ÈúÄË¶ÅÁî®Âà∞ ViewPager ÔºåÂä†‰∏ä TabLayout Âíå TooBar Âü∫Êú¨ÁöÑÂ∏ÉÂ±ÄÂ¶Ç‰∏ãÔºö 12345678910111213141516171819&lt;android.support.v7.widget.Toolbar android:id="@+id/topToolBar" android:layout_width="match_parent" android:layout_height="wrap_content" android:paddingTop="@dimen/bar_top_padding"&gt;&lt;/android.support.v7.widget.Toolbar&gt;&lt;android.support.design.widget.TabLayout android:id="@+id/tabLayout" android:layout_width="match_parent" android:layout_height="wrap_content" android:layout_below="@id/topToolBar" app:tabSelectedTextColor="#3da6a2" app:tabTextColor="#817f7f"&gt;&lt;/android.support.design.widget.TabLayout&gt;&lt;android.support.v4.view.ViewPager android:id="@+id/viewPager" android:layout_width="match_parent" android:layout_height="match_parent" android:layout_below="@id/tabLayout"&gt;&lt;/android.support.v4.view.ViewPager&gt; ÂÖ∂‰∏≠ TabLayout ‰∏≠tabSelectedTextColor Áî®‰∫éËÆæÁΩÆÈÄâ‰∏≠TabÁöÑÂ≠ó‰ΩìÈ¢úËâ≤ÔºåtabTextColor Áî®‰∫éËÆæÁΩÆÊú™ÈÄâ‰∏≠ÁöÑTabÂ≠ó‰ΩìÁöÑÈ¢úËâ≤ÔºåToolbar ‰∏≠ËÆæÁΩÆ paddingTop ‰∏ªË¶ÅÁî®‰∫é4.4‰∏≠Ê≤âÊµ∏ÂºèÁä∂ÊÄÅÊ†èÁöÑÈÄÇÈÖçÔºåÈò≤Ê≠¢ ToolBar ÂíåÁä∂ÊÄÅÊ†èÈáçÂêà„ÄÇ ‰πãÂêéÊòØ‰∏∫ ToolBar ËÆæÁΩÆÂêÑÁßçÂ±ûÊÄßÂàõÂª∫ FramePagerAdapterÔºåÂØπ ViewPager Âíå TabLayout ËÆæÁΩÆÁõëÂê¨‰∫ã‰ª∂Ôºö 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697public class Bar_Activity extends AppCompatActivity &#123; Toolbar topToolBar; TabLayout tabLayout; ViewPager viewPager; FragmentPagerAdapter pagerAdapter; @Override protected void onCreate(Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); setContentView(R.layout.activity_bar_); init(); topToolBar.setTitle("BarDemo"); setSupportActionBar(topToolBar); /*ËÆæÁΩÆÁä∂ÊÄÅÊ†è‰∏∫ÈÄèÊòé*/ WindowManager.LayoutParams layoutParams = getWindow().getAttributes(); layoutParams.flags = (WindowManager.LayoutParams.FLAG_TRANSLUCENT_STATUS | layoutParams.flags); getSupportActionBar().setDisplayHomeAsUpEnabled(false); //ÈÅçÂéÜFragmentPagerAdapter‰∏∫TabLayoutÊ∑ªÂä†Tab for (int i = 0; i &lt; pagerAdapter.getCount(); i++) &#123; tabLayout.addTab( tabLayout.newTab().setText(pagerAdapter.getPageTitle(i))); &#125; //‰∏∫ViewPagerËÆæÁΩÆÈÄÇÈÖçÂô® viewPager.setAdapter(pagerAdapter); //‰∏∫viewPagerËÆæÁΩÆÁõëÂê¨‰∫ã‰ª∂ÔºåÂΩìframeÊîπÂèòÊó∂Êõ¥ÊîπTab viewPager.addOnPageChangeListener( new TabLayout.TabLayoutOnPageChangeListener(tabLayout)); //‰∏∫tabLayoutËÆæÁΩÆÁõëÂê¨‰∫ã‰ª∂ÔºåÂΩìÈÄâ‰∏≠tabÁöÑÊó∂ÂÄôÂàáÊç¢frame tabLayout.setOnTabSelectedListener(new TabLayout.OnTabSelectedListener() &#123; @Override public void onTabSelected(TabLayout.Tab tab) &#123; viewPager.setCurrentItem(tab.getPosition()); &#125; @Override public void onTabUnselected(TabLayout.Tab tab) &#123; &#125; @Override public void onTabReselected(TabLayout.Tab tab) &#123; &#125; &#125;); topToolBar.setNavigationIcon(R.drawable.ic_account_circle_white_24dp); &#125; protected void init() &#123; topToolBar = (Toolbar) findViewById(R.id.topToolBar); tabLayout = (TabLayout) findViewById(R.id.tabLayout); viewPager = (ViewPager) findViewById(R.id.viewPager); topToolBar.setBackgroundColor(Color.parseColor("#1aae98")); tabLayout.setBackgroundColor(Color.GRAY); //ÂàõÂª∫ÈíàÂØπViewPagerÁöÑFragmentPagerAdapter pagerAdapter = new FragmentPagerAdapter(getSupportFragmentManager()) &#123; @Override public Fragment getItem(int position) &#123; Fragment tabFragment = new TabFragment(); Bundle args = new Bundle(); args.putInt(TabFragment.FLAG_TAB, position + 1); tabFragment.setArguments(args); return tabFragment; &#125; @Override public int getCount() &#123; return 3; &#125; @Override public CharSequence getPageTitle(int position) &#123; switch (position) &#123; case 0: return "tab1"; case 1: return "tab2"; case 2: return "tab3"; &#125; return null; &#125; &#125;; &#125; //ËÆæÁΩÆ toolBar Âè≥‰∏äËßíÁöÑËèúÂçïÈ°π @Override public boolean onCreateOptionsMenu(Menu menu) &#123; getMenuInflater().inflate(R.menu.menu, menu); return true; &#125; @Override public boolean onOptionsItemSelected(MenuItem item) &#123; return super.onOptionsItemSelected(item); &#125;&#125; ÊúÄÂêéÁúã‰∏ã menu Êñá‰ª∂ 12345678&lt;menu xmlns:android="http://schemas.android.com/apk/res/android" xmlns:app="http://schemas.android.com/apk/res-auto"&gt; &lt;item android:id="@+id/search_item" android:title="search" android:icon="@drawable/ic_search_white_24dp" app:actionViewClass="android.support.v7.widget.SearchView" app:showAsAction="ifRoom|collapseActionView"&gt;&lt;/item&gt;&lt;/menu&gt; ÊúÄÁªàÂÆûÁé∞ÊïàÊûúÂ¶ÇÂõæÊâÄÁ§∫Ôºö]]></content>
      <categories>
        <category>AndroidÂü∫Á°Ä</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>Ëá™ÂÆö‰πâÊéß‰ª∂</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[‰ΩøÁî®ËßÜÂõæÊòæÁ§∫ÂõæÁâáÂíåËèúÂçï]]></title>
    <url>%2F2016%2F05%2F27%2F%E4%BD%BF%E7%94%A8%E8%A7%86%E5%9B%BE%E6%98%BE%E7%A4%BA%E5%9B%BE%E7%89%87%E5%92%8C%E8%8F%9C%E5%8D%95%2F</url>
    <content type="text"><![CDATA[ÊòæÁ§∫ÂõæÁâáÁöÑËßÜÂõæÊéß‰ª∂ GridView Ê∑ªÂä†ÊñπÂºèÔºö 123456789&lt;GridView android:layout_width="wrap_content" android:layout_height="wrap_content" android:id="@+id/gridview" android:numColumns="auto_fit" android:verticalSpacing="10dp" android:horizontalSpacing="10dp" android:columnWidth="90dp" android:stretchMode="columnWidth"/&gt;//Áº©Êîæ‰∏éÂàóÂÆΩÂêåÊ≠• ÂÖ∂‰∏≠ verticalSpacing Ë°®Á§∫ grid ÂÖÉÁ¥†‰πãÈó¥ÁöÑÁ´ñÁõ¥Ë∑ùÁ¶ªÔºåhorizontalSpacing Ë°®Á§∫ grid ÂÖÉÁ¥†‰πãÈó¥ÁöÑÊ∞¥Âπ≥Ë∑ùÁ¶ª„ÄÇ Â∏∏Áî®ÊñπÊ≥ï: 1234567gridView.setAdapter(new ImageAdapter(this));gridView.setOnItemClickListener(new AdapterView.OnItemClickListener() &#123; @Override public void onItemClick(AdapterView&lt;?&gt; parent, View view, int position, long id) &#123; Toast.makeText(getBaseContext(), "pic" + (position + 1) + "selected", Toast.LENGTH_SHORT).show(); &#125;&#125;); ÊòæÁ§∫ÊïàÊûúÔºö ËèúÂçïÂíåËßÜÂõæ‰∏ÄËµ∑ÊòæÁ§∫ Â∏∏Áî®ÊñπÊ≥ïÔºö CreateMenu(Menu menu) ÂàõÂª∫ËèúÂçïÈ°π 1234567891011private void CreateMenu(Menu menu) &#123; MenuItem mnu1 = menu.add(0, 0, 0, "Item 1"); &#123; mnu1.setAlphabeticShortcut('a'); &#125; MenuItem mnu2 = menu.add(0, 1, 1, "Item 2"); &#123; mnu2.setAlphabeticShortcut('a'); &#125;&#125; add() ÊñπÊ≥ï‰∏≠4‰∏™ÂèÇÊï∞Ôºö groupId ËèúÂçïÈ°πÊâÄÂú®ÁöÑÁªÑÁöÑÊ†áËØÜÁ¨¶Ôºå0 Ë°®Á§∫‰∏çÂú®‰∏Ä‰∏™ÁªÑ‰∏≠„ÄÇ itemId ÂîØ‰∏ÄÁöÑËèúÂçïÈ°πID order ËèúÂçïÈ°πÊòæÁ§∫ÁöÑÈ°∫Â∫è title ËèúÂçïÈ°πÊòæÁ§∫ÁöÑÊñáÊú¨ MenuChoice(MenuItem item) Áî®‰∫éÂà§Êñ≠ËèúÂçïÈ°πÊòØÂê¶Ë¢´ÈÄâ‰∏≠ 1234567891011 private boolean MenuChoice(MenuItem item) &#123; switch (item.getItemId()) &#123; case 0: Toast.makeText(this, "You clicked on Item1", Toast.LENGTH_SHORT).show(); return true; case 1: Toast.makeText(this, "You clicked on Item2", Toast.LENGTH_SHORT).show(); return true;&#125; return false; &#125;= onCreateOptionsMenu() ÂΩì MENU ÊåâÈíÆÊåâ‰∏ãÊó∂Ë∞ÉÁî® 12345public boolean onCreateOptionsMenu (Menu menu) &#123; super.onCreateOptionsMenu(menu); CreateMenu(menu); return true;&#125; onOptionsItemSelected() ÈÄâÊã©ËèúÂçïÊó∂Ë∞ÉÁî® 123public boolean onOptionsItemSelected (MenuItem item)&#123; return MenuChoice(item);&#125; setOnCreateContextMenuListener ËÆæÁΩÆ‰∏ä‰∏ãÊñáËèúÂçï ÈÄöËøáËÆæÁΩÆ setOnCreateContextMenuListener ÊñπÊ≥ïÔºåÁÑ∂ÂêéÂÆûÁé∞ onCreateContextMenu ÊñπÊ≥ïÂç≥ÂèØ„ÄÇ 12345public void onCreateContextMenu(ContextMenu menu, View view, ContextMenuInfo menuInfo) &#123; super.onCreateContextMenu(menu, view, menuInfo); CreateMenu(menu); &#125; ÂÆûÁé∞ÊïàÊûúÂ¶ÇÂõæÔºö WebView Ê∑ªÂä† WebView 1234&lt;WebView android:layout_width="wrap_content" android:layout_height="wrap_content" android:id="@+id/webview"/&gt; ÈÅøÂÖçÂêØÂä®ËÆæÂ§áÁöÑ Web ÊµèËßàÂô® ÂÆûÁé∞ WebViewClient Á±ªÈáçÂÜô shouldOverrideUrlLoading 1234567webView.setWebViewClient(new CallBack());public class CallBack extends WebViewClient &#123; @Override public boolean shouldOverrideUrlLoading(WebView view, String url) &#123; return (false); &#125;&#125;]]></content>
      <categories>
        <category>AndroidÂü∫Á°Ä</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>Âü∫Á°ÄÊéß‰ª∂</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Êéß‰ª∂Ê∑ªÂä†Âè≥ÈîÆËèúÂçïÈ°π]]></title>
    <url>%2F2016%2F04%2F22%2FJava%E5%9F%BA%E7%A1%80%E4%B9%8B%E6%8E%A7%E4%BB%B6%E6%B7%BB%E5%8A%A0%E5%8F%B3%E9%94%AE%E8%8F%9C%E5%8D%95%E9%A1%B9%2F</url>
    <content type="text"><![CDATA[‰ª• JList Êéß‰ª∂‰∏∫‰æã È¶ñÂÖàÊéß‰ª∂ÈúÄË¶ÅÊ∑ªÂä†Èº†Ê†áÁöÑÁõëÂê¨‰∫ã‰ª∂ 12345678mUserList.addMouseListener(new MouseAdapter() &#123; @Override public void mouseReleased(MouseEvent e) &#123; super.mouseReleased(e); showPopup(e); &#125;&#125;); showPopup() ÊòæÁ§∫ËèúÂçïÁöÑÂäüËÉΩ 1234567public void showPopup(MouseEvent e) &#123; if (e.isPopupTrigger() &amp;&amp; mUserList.getSelectedIndex() != -1 &amp;&amp; !mUserList.getSelectedValue().equals("ÁÆ°ÁêÜÂëò")) &#123; Object selected = mUserName.getElementAt(mUserList.getSelectedIndex()); popupMenu.show(e.getComponent(), e.getX(), e.getY()); &#125;&#125; e.isPopupTrigger() Ê£ÄÊµãÊòØÂê¶ÊòØÂè≥ÈîÆÔºåmUserList.getSelectedIndex() Èò≤Ê≠¢Âú®ÂàóË°®Á©∫ÁôΩÂ§ÑÁÇπÂáª]]></content>
      <categories>
        <category>JavaÂü∫Á°Ä</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>AWT</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[DialogFragment ÂÆûÁé∞TimePickerDialog]]></title>
    <url>%2F2016%2F04%2F22%2FDialogFragment%E5%AE%9E%E7%8E%B0TimePickerDialog%2F</url>
    <content type="text"><![CDATA[Âú®ÂÆûÁé∞ onCreateDialog(int id) ÂèëÁé∞ÊñπÊ≥ïÂ∑≤ËøáÊó∂ÔºåÊñ∞ÁöÑÊñπÊ≥ïÊòØ DialogFragmentÔºåFragmentManager 12345678910111213141516171819202122public class TimePickerFragment extends DialogFragment implements TimePickerDialog.OnTimeSetListener &#123; int hour, minute; public Dialog onCreateDialog(Bundle savedInstanceState) &#123; return new TimePickerDialog(getActivity(), this, hour, minute, false);//ËøîÂõû‰∏Ä‰∏™TimePickerDialog &#125; @Override public void onTimeSet(TimePicker view, int hourOfDay, int minuteOfHour) &#123; hour = hourOfDay; minute = minuteOfHour; SimpleDateFormat simpleDateFormat = new SimpleDateFormat("hh:mm aa"); Date date; Calendar calendar = Calendar.getInstance();//DateÊûÑÈÄ†ÊñπÊ≥ïËøáÊó∂ÔºåCalendarËΩ¨Date calendar.set(0,0,0,hour,minute); date = calendar.getTime(); String strDate = simpleDateFormat.format(date); Toast.makeText(getActivity(), "you have selected" + strDate, Toast.LENGTH_SHORT).show(); &#125;&#125; ÊòæÁ§∫ Dialog 12DialogFragment dialogFragment = new TimePickerFragment();dialogFragment.show(getSupportFragmentManager(),"timePicker");]]></content>
      <categories>
        <category>AndroidÂü∫Á°Ä</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>Âü∫Á°ÄÊéß‰ª∂</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Android ËßÜÂõæËÆæËÆ°Áî®Êà∑ÁïåÈù¢]]></title>
    <url>%2F2016%2F04%2F21%2FAndroid%E8%A7%86%E5%9B%BE%E8%AE%BE%E8%AE%A1%E7%94%A8%E6%88%B7%E7%95%8C%E9%9D%A2%2F</url>
    <content type="text"><![CDATA[Âü∫Êú¨ËßÜÂõæ ToggleButtonÔºåRadioButtonÔºåRadioGroupÔºåAutoCompleteTextView ToggleButton Áî®‰∏Ä‰∏™ÁÅØÂÖâÊåáÁ§∫Âô®Êù•ÊòæÁ§∫ÈÄâ‰∏≠/Êú™ÈÄâ‰∏≠Áä∂ÊÄÅ 12345&lt;ToggleButton android:id="@+id/toggle1" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_below="@id/rdbGp1"/&gt; RadioButton Âíå RaidoGroup RadioButton Êúâ‰∏§‰∏™Áä∂ÊÄÅÔºöÈÄâ‰∏≠ÊàñÊú™ÈÄâ‰∏≠„ÄÇ RaidoGroup Áî®Êù•Êää‰∏Ä‰∏™ÊàñÂ§ö‰∏™ RaidoButton ËßÜÂõæÁªÑÂêàÂú®‰∏ÄËµ∑Ôºå‰ªéËÄåÂè™ÂÖÅËÆ∏‰∏Ä‰∏™ RaidoButton Ë¢´ÈÄâ‰∏≠„ÄÇ 1234567891011121314151617&lt;RadioGroup android:id="@+id/rdbGp1" android:layout_width="fill_parent" android:layout_height="wrap_content" android:orientation="horizontal" android:layout_below="@id/star"&gt; &lt;RadioButton android:id="@+id/rdb1" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="Option 1" /&gt; &lt;RadioButton android:id="@+id/rdb2" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="Option 2" /&gt;&lt;/RadioGroup&gt; ËßÜÂõæÊïàÊûúÂ¶Ç‰∏ãÔºö AutoCompleteTextViewÔºö‰∏é EditText Á±ª‰ººÔºåËæìÂÖ•Êó∂Êèê‰æõÂÄôÈÄâÈ°π 123456&lt;AutoCompleteTextView android:id="@+id/txtCountries" android:layout_width="match_parent" android:layout_height="wrap_content" android:layout_alignParentStart="true" android:layout_below="@+id/textView" /&gt; 1234ArrayAdapter&lt;String&gt; adapter = new ArrayAdapter&lt;String&gt;(this, android.R.layout.simple_dropdown_item_1line,presidents);//ÂàõÂª∫ÂÆπÂô®AutoCompleteTextView textView = (AutoCompleteTextView) findViewById(R.id.txtCountries); textView.setThreshold(3); textView.setAdapter(adapter);//ËÆæÁΩÆÂÄôÈÄâÈ°π ËßÜÂõæÊïàÊûúÔºö CheckBoxÔºåRadioButton ËßÜÂõæ‰∫ã‰ª∂ CheckBoxÔºöÈúÄÂ∞Ü onClick() ÊñπÊ≥ïÁöÑÂèÇÊï∞Á±ªÂûãËΩ¨Êç¢‰∏∫‰∏Ä‰∏™CheckBox ÔºåÁÑ∂ÂêéÊ£ÄÊü• isCheckBox() ÊñπÊ≥ïÊù•Á°ÆÂÆöÂÖ∂ÊòØÂê¶Ë¢´ÈÄâ‰∏≠ 12345678910CheckBox checkBox = (CheckBox)findViewById(R.id.chkAutosave);checkBox.setOnClickListener(new View.OnClickListener() &#123;@Overridepublic void onClick(View v) &#123; if (((CheckBox) v).isChecked()) DisplayToast("CheckBox is checked"); else DisplayToast("CheckBox is unchecked"); &#125;&#125;); RadioButtonÔºöÈúÄË¶Å‰ΩøÁî® RadioGroup ÁöÑ setOnCheckedChangeListener() ÊñπÊ≥ïÊ≥®ÂÜå‰∏Ä‰∏™ÂõûË∞ÉÂáΩÊï∞, ‰ª•‰æøËØ•ÁªÑ‰∏≠ÁöÑË¢´ÈÄâ‰∏≠ÁöÑ RadioButton ÂèëÁîüÂèòÂåñÁöÑÊó∂ÂÄôË∞ÉÁî®„ÄÇ 123456789101112RadioGroup radioGroup = (RadioGroup)findViewById(R.id.rdbGp1);radioGroup.setOnCheckedChangeListener(new OnCheckedChangeListener() &#123;@Overridepublic void onCheckedChanged(RadioGroup group, int checkedId) &#123; RadioButton rb1 = (RadioButton) findViewById(R.id.rdb1); if (rb1.isChecked()) &#123; DisplayToast("Option 1 checked"); &#125; else &#123; DisplayToast("Option 2 checked"); &#125; &#125;&#125;); ÂàóË°®ËßÜÂõæ ListView,Spinner ListViewÔºö 12345setListAdapter(new ArrayAdapter&lt;String&gt;(this,android.R.layout.simple_list_item_checked, presidents));//ËÆæÁΩÆÂàóË°®È°πpublic void onListItemClick(ListView parent, View v, int position, long id) &#123; Toast.makeText(this, "you have selected:" + presidents[position], Toast.LENGTH_SHORT).show();&#125; getListView() Ëé∑ÂèñÂΩìÂâçÁöÑÂàóË°®ËßÜÂõæÔºåÂè™ÊúâÂΩìÂâç Activity ÁªßÊâø ListAcitvity Êó∂ÊâçËÉΩÁî®„ÄÇ SpinnerÔºö 12345&lt;Spinner android:layout_width="wrap_content" android:layout_height="wrap_content" android:id="@+id/spinner" android:drawSelectorOnTop="true"/&gt; ËÆæÁΩÆÂàóË°®ÂíåÂà§Êñ≠ÈÄâÊã© 1234567891011121314151617 Spinner spinner = (Spinner) findViewById(R.id.spinner); ArrayAdapter&lt;String&gt; adapter = new ArrayAdapter&lt;String&gt;(this,android.R.layout.simple_spinner_item, prisidents); spinner.setAdapter(adapter);//ËÆæÁΩÆÂàóË°®È°π spinner.setOnItemSelectedListener(new OnItemSelectedListener() &#123;@Overridepublic void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) &#123; int index = parent.getSelectedItemPosition(); Toast.makeText(BasicViews6Activity.this, "you have selected item :" + prisidents[index], Toast.LENGTH_SHORT).show();&#125;@Overridepublic void onNothingSelected(AdapterView&lt;?&gt; parent) &#123;&#125; &#125;);//Âà§Êñ≠Âì™‰∏ÄÈ°πË¢´ÈÄâÊã©‰∫Ü ÁâπÊÆäÁ¢éÁâá ListFragmentÔºåDialogFramentÔºåPerferenceFragment Ë¶Å‰ΩøÁî® ListFragment È¶ñÂÖàÈúÄË¶ÅÂàõÂª∫‰∏Ä‰∏™ ListFragment ÁöÑÁ±ª (fragmnet1)ÔºåÂàõÂª∫‰∏Ä‰∏™ÂÖ≥‰∫é fragment1 ÁöÑËßÜÂõæÔºåÂú® Activity ÁöÑ Layout ‰∏≠Â£∞ÊòéÁ¢éÁâá„ÄÇÂú® Activity ‰∏≠ÊòæÁ§∫‰∫é fragment1 ÁöÑËßÜÂõæÔºåÂèØ‰ª•‰ΩøÁî® FragmentManger Âíå FragmentTransaction Á±ªÔºõ 1234567FragmentManager fragmentManager = getFragmentManager();FragmentTransaction fragmentTransaction = fragmentManager.beginTransaction();Fragment1 fragment1 = new Fragment1();fragmentTransaction.replace(android.R.id.content,fragment1);fragmentTransaction.addToBackStack(null);fragmentTransaction.commit(); PerferenceFragment ‰∏≠ PreferenceCategory Áî®‰∫éÂàõÂª∫Á±ªÂà´ PreferenceScreen Áî®‰∫éÊòæÁ§∫‰∏Ä‰∏™ PerferenceFragmnet ÁïåÈù¢ ÁªÉ‰π† ËÆøÈóÆÊîæÂú® Strings.xml Êñá‰ª∂‰∏≠ÁöÑÂ≠óÁ¨¶‰∏≤ËµÑÊ∫ê getResources() Ëé∑ÂèñÂΩìÂâçÊó•Êúü 1234Calendar today = Calendar.getInstance();yr = today.get(Calendar.YEAR);month = today.get(Calendar.MONTH);day = today.get(Calendar.DAY_OF_MONTH);]]></content>
      <categories>
        <category>AndroidÂü∫Á°Ä</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>Âü∫Á°ÄÊéß‰ª∂</tag>
      </tags>
  </entry>
</search>
